<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>帅羊羊的博客</title>
  
  <subtitle>坚持学习,努力学习...</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://shuaiyy.cn/"/>
  <updated>2018-11-27T08:18:48.666Z</updated>
  <id>http://shuaiyy.cn/</id>
  
  <author>
    <name>Shuai yy</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MacOS软件推荐</title>
    <link href="http://shuaiyy.cn/2018/11/01/%E5%B7%A5%E5%85%B7/MACOS%E8%BD%AF%E4%BB%B6%E6%8E%A8%E8%8D%90/"/>
    <id>http://shuaiyy.cn/2018/11/01/工具/MACOS软件推荐/</id>
    <published>2018-10-31T16:00:00.000Z</published>
    <updated>2018-11-27T08:18:48.666Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MACOS软件推荐"><a href="#MACOS软件推荐" class="headerlink" title="MACOS软件推荐"></a>MACOS软件推荐</h1><h1 id="系统设置"><a href="#系统设置" class="headerlink" title="系统设置"></a>系统设置</h1><ul><li>时钟屏保：fliqo</li><li>屏幕触发角，位于屏幕保护选项处，设置右上为通知中心，右下为启动器</li><li>dock栏大小调整，位于程序坞</li></ul><h1 id="系统工具"><a href="#系统工具" class="headerlink" title="系统工具"></a>系统工具</h1><ul><li><p>搜狗输入法</p></li><li><p>Clean MyMac</p></li><li><p>chrome浏览器</p></li><li><p>NTFS破解版</p></li><li><p>解压缩：Dr unachriver</p></li><li><p>截图： snip</p></li><li><p>快捷键提示： cheatsheet</p></li><li><h3 id="Qbserve-追踪用户使用mac软件消耗的时间，工作时间记录"><a href="#Qbserve-追踪用户使用mac软件消耗的时间，工作时间记录" class="headerlink" title="Qbserve 追踪用户使用mac软件消耗的时间，工作时间记录"></a>Qbserve 追踪用户使用mac软件消耗的时间，工作时间记录</h3></li><li><p>hellofont字体下载</p></li></ul><h1 id="工作效率"><a href="#工作效率" class="headerlink" title="工作效率"></a>工作效率</h1><ul><li><p>Wunderlist 奇妙清单</p></li><li><p>日历工具 - Fantastical 2 for Mac</p></li><li>日历工具 pendo</li><li>xmind pro 脑图</li><li>Alfred  快捷键、工作流，替代聚焦搜索</li><li>self control</li><li>office 3件套</li><li>Snipaste 截图 + 贴图</li><li>Paste 剪切板管理</li><li>OmniGraffle：专业制图工具</li></ul><h1 id="阅读写作"><a href="#阅读写作" class="headerlink" title="阅读写作"></a>阅读写作</h1><ul><li><p>typaro</p></li><li><h3 id="Tickeys-打字有触发声音"><a href="#Tickeys-打字有触发声音" class="headerlink" title="Tickeys 打字有触发声音"></a>Tickeys 打字有触发声音</h3></li><li><p>欧陆词典</p></li><li><p>PDF expert</p></li><li><p>专业杂志 英文PDF 教材阅读 ：<strong>MarginNote pro</strong></p></li></ul><h1 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h1><ul><li><p>homebrew</p></li><li><p>基础环境 python java go git</p></li><li><p>Anaconda</p></li><li><p>IDEA全家桶 IDEA、Pycharm、Goland</p></li><li><p>VS code，替代sublime text</p></li><li><p>oh-my-zsh + iterm2，选择合适的终端配色方案，然后窗口调整成半透明的</p></li><li><h3 id="Dash-文档阅读速查"><a href="#Dash-文档阅读速查" class="headerlink" title="Dash 文档阅读速查"></a>Dash 文档阅读速查</h3></li><li><p>parallel desktop 虚拟机</p></li><li><p>docker</p></li><li><h3 id="Charles和Wireshark-http，流量抓包"><a href="#Charles和Wireshark-http，流量抓包" class="headerlink" title="Charles和Wireshark  http，流量抓包"></a>Charles和Wireshark  http，流量抓包</h3></li></ul><h1 id="影音娱乐"><a href="#影音娱乐" class="headerlink" title="影音娱乐"></a>影音娱乐</h1><ul><li>IINA ，github，homebrew安装</li><li>网易云音乐</li></ul><h1 id="游戏"><a href="#游戏" class="headerlink" title="游戏"></a>游戏</h1><ul><li>steam</li></ul><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><ul><li>百度网盘</li><li>迅雷</li><li>Aria2 + Aria2GUI + chrome插件</li></ul><h1 id="聊天"><a href="#聊天" class="headerlink" title="聊天"></a>聊天</h1><ul><li>QQ</li><li>微信</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;MACOS软件推荐&quot;&gt;&lt;a href=&quot;#MACOS软件推荐&quot; class=&quot;headerlink&quot; title=&quot;MACOS软件推荐&quot;&gt;&lt;/a&gt;MACOS软件推荐&lt;/h1&gt;&lt;h1 id=&quot;系统设置&quot;&gt;&lt;a href=&quot;#系统设置&quot; class=&quot;headerli
      
    
    </summary>
    
      <category term="工具" scheme="http://shuaiyy.cn/categories/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="软件" scheme="http://shuaiyy.cn/categories/%E5%B7%A5%E5%85%B7/%E8%BD%AF%E4%BB%B6/"/>
    
      <category term="MacOS" scheme="http://shuaiyy.cn/categories/%E5%B7%A5%E5%85%B7/%E8%BD%AF%E4%BB%B6/MacOS/"/>
    
    
  </entry>
  
  <entry>
    <title>Go学习笔记</title>
    <link href="http://shuaiyy.cn/2018/11/01/%E6%8A%80%E6%9C%AF/Go%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://shuaiyy.cn/2018/11/01/技术/Go 学习笔记/</id>
    <published>2018-10-31T16:00:00.000Z</published>
    <updated>2018-11-27T10:37:15.395Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Go-学习笔记"><a href="#Go-学习笔记" class="headerlink" title="Go 学习笔记"></a>Go 学习笔记</h1><h1 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h1><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><ul><li><p>安装go</p></li><li><p>设置环境变量</p><ul><li>GOROOT 安装go的根目录</li><li>path: 添加 <code>$GOROOT/bin/</code></li><li>GOPATH: go project的目录</li></ul></li><li><p>安装调试工具</p><p><code>go get http://github.com/derekparker/delve/cmd/dlv</code></p><p>如果安装失败，需要删掉derekparker的目录，然后重新执行</p><p>idea的go插件无法debug，使用go目录里的dlv替换idea插件目录里的。用everything快速定位文件所在目录。</p></li></ul><h2 id="go特性"><a href="#go特性" class="headerlink" title="go特性"></a>go特性</h2><ol><li><p>垃圾回收<br>a. 内存自动回收，再也不需要开发人员管理内存<br>b. 开发人员专注业务实现，降低了心智负担<br>c. 只需要new分配内存，不需要释放 </p></li><li><p>天然并发<br>a. 从语言层面支持并发，非常简单<br>b. goroute，轻量级线程，创建成千上万个goroute成为可能<br>c. 基于CSP（Communicating Sequential Process）模型实现</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line"><span class="keyword">go</span> fmt.Println(“hello<span class="string">")</span></div><div class="line"><span class="string">&#125;</span></div></pre></td></tr></table></figure></li><li><p>channel<br>a. 管道，类似unix/linux中的pipe<br>b. 多个goroute之间通过channel进行通信<br>c. 支持任何类型 </p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">pipe := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>,<span class="number">3</span>)</div><div class="line">pipe &lt;- <span class="number">1</span></div><div class="line">pipe &lt;- <span class="number">2</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>多返回值<br>a. 一个函数返回多个值 </p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">calc</span><span class="params">(a <span class="keyword">int</span>, b <span class="keyword">int</span>)</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span> &#123;</div><div class="line">    sum := a + b</div><div class="line">    avg := (a+b)/<span class="number">2</span></div><div class="line">    <span class="keyword">return</span> sum, avg</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ol><h2 id="helllo-go"><a href="#helllo-go" class="headerlink" title="helllo go"></a>helllo go</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span>(</div><div class="line">“fmt”</div><div class="line">)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">fmt.Println(“hello world”)</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="包"><a href="#包" class="headerlink" title="包"></a>包</h2><ol><li>和python一样，把相同功能的代码放到一个目录，称之为包</li><li>包可以被其他包引用，使用import</li><li>main包是用来生成可执行文件，每个程序只有一个main包</li><li>包的主要用途是提高代码的可复用性 </li><li>访问可见性，包里的函数必须首字母大写才能被其他包访问</li><li>go get安装第三方包</li></ol><h1 id="基本数据类型和操作符"><a href="#基本数据类型和操作符" class="headerlink" title="基本数据类型和操作符"></a>基本数据类型和操作符</h1><h2 id="文件名-amp-关键字-amp-标识符"><a href="#文件名-amp-关键字-amp-标识符" class="headerlink" title="文件名&amp;关键字&amp;标识符"></a>文件名&amp;关键字&amp;标识符</h2><ol><li><p>所有go源码以.go结尾</p></li><li><p>标识符以字母或下划线开头，大小写敏感，比如：</p></li><li><p>_是特殊标识符，用来忽略结果</p></li><li><p>保留关键字</p><p>| break    | default    | func   | interface | select |<br>| ——– | ———- | —— | ——— | —— |<br>| case     | defer      | go     | map       | struct |<br>| chan     | else       | goto   | package   | switch |<br>| const    | fallthough | if     | range     | type   |<br>| continue | for        | import | return    | var    |</p></li></ol><h2 id="go程序的基本结构"><a href="#go程序的基本结构" class="headerlink" title="go程序的基本结构"></a>go程序的基本结构</h2><ol><li>任何一个代码文件隶属于一个包</li><li>import 关键字，引用其他包。包的相对路径是GOPATH下的src文件夹</li><li>import包时会执行init函数</li><li>golang可执行程序， package main，并且有且只有一个main入口函数</li><li>包中函数调用：<br>a. 同一个包中函数，直接调用<br>b. 不同包中函数，通过包名+点+函数名进行调用</li><li>包访问控制规则：<br>a. 大写意味着这个函数/变量是可导出<br>b. 小写意味着这个函数/变量是私有的，包外部不能访问 </li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> (</div><div class="line"><span class="string">"fmt"</span></div><div class="line">    a <span class="string">"test/utils"</span> <span class="comment">// 包的别名</span></div><div class="line">    _ <span class="string">"xxx"</span> <span class="comment">// 只执行包里的init</span></div><div class="line">)</div></pre></td></tr></table></figure><h2 id="函数声明和注释"><a href="#函数声明和注释" class="headerlink" title="函数声明和注释"></a>函数声明和注释</h2><ol><li>函数声明：<code>func 函数名字 (参数列表) (返回值列表） {}</code></li><li>注释，两种注释，单行注释: // 和多行注释 /<em> </em>/ </li></ol><h2 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h2><ol><li><p>常量使用const 修饰，代表永远是只读的，不能修改。</p></li><li><p>const 只能修饰boolean， number（int相关类型、浮点类型、 complex）和string。</p></li><li><p>语法： <code>const identifier [type] = value</code>，其中type可以省略。 </p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> b <span class="keyword">string</span> = “hello world”</div><div class="line"><span class="keyword">const</span> b = “hello world”</div><div class="line"><span class="keyword">const</span> Pi = <span class="number">3.1414926</span></div><div class="line"><span class="keyword">const</span> a = <span class="number">9</span>/<span class="number">3</span></div><div class="line"><span class="keyword">const</span> c = getValue()</div><div class="line"><span class="comment">// 枚举</span></div><div class="line"><span class="keyword">const</span> (</div><div class="line">a = <span class="number">0</span></div><div class="line">b = <span class="number">1</span></div><div class="line">c = <span class="number">2</span></div><div class="line">)</div><div class="line"><span class="keyword">const</span> (</div><div class="line">a = <span class="literal">iota</span></div><div class="line">b <span class="comment">//1</span></div><div class="line">c <span class="comment">//2</span></div><div class="line">)</div></pre></td></tr></table></figure><h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Var (</div><div class="line">    a <span class="keyword">int</span> <span class="comment">//默认为0</span></div><div class="line">    b <span class="keyword">string</span> <span class="comment">//默认为””</span></div><div class="line">    c <span class="keyword">bool</span> <span class="comment">//默认为false</span></div><div class="line">    d <span class="keyword">int</span> = <span class="number">8</span></div><div class="line">    e <span class="keyword">string</span> = “hello world”</div><div class="line">)</div></pre></td></tr></table></figure></li></ol><h2 id="值类型和引用类型"><a href="#值类型和引用类型" class="headerlink" title="值类型和引用类型"></a>值类型和引用类型</h2><ol><li><p>值类型：变量直接存储值，内存通常在栈中分配。<code>var i = 5</code></p><p>基本数据类型int、 float、 bool、 string以及数组和struct。</p></li><li><p>引用类型：变量存储的是一个地址，这个地址存储最终的值。内存通常在<br>堆上分配。通过GC回收。</p><p>引用类型：指针、 slice、 map、 chan等都是引用类型。 </p></li></ol><h2 id="变量的作用域"><a href="#变量的作用域" class="headerlink" title="变量的作用域"></a>变量的作用域</h2><ol><li>在函数内部声明的变量叫做局部变量，生命周期仅限于函数内部。</li><li>在函数外部声明的变量叫做全局变量，生命周期作用于整个包，如果是大写的，<br>则作用于整个程序。 </li></ol><h2 id="数据类型和操作符"><a href="#数据类型和操作符" class="headerlink" title="数据类型和操作符"></a>数据类型和操作符</h2><ol><li><p>bool类型，只能存true和false，默认值为false</p><p>相关操作符，<code>！、 &amp;&amp;、 ||</code></p></li><li><p>数字类型，主要有int、 int8、 int16、 int32、 int64、 uint8、 uint16、 uint32、 uint64，无符号整型</p></li><li><p>类型转换，<code>type(variable)</code>， 比如： <code>var a int=8; var b int32=int32(a)</code></p></li><li><p>逻辑操作符： == 、 !=、 &lt;、 &lt;=、 &gt;和 &gt;=</p></li><li><p>数学操作符： +、 -、 *、 /、%等等</p></li><li><p>字符类型： byte，0~127对应的ASCII码</p></li><li><p>字符串类型：</p><p>字符串表示两种方式： 双引号 和反引号，反引号为raw字符串。</p><p>两个字符串拼接 <code>+</code>，字符串底层是byte数组，支持index和切片</p></li></ol><h1 id="strings和strconv使用"><a href="#strings和strconv使用" class="headerlink" title="strings和strconv使用"></a>strings和strconv使用</h1><ol><li><code>strings.HasPrefix(s string, prefix string) bool</code>：判断字符串s是否以prefix开</li><li><p><code>strings.HasSuffix(s string, suffix string) bool</code>：判断字符串s是否以suffix结</p></li><li><p><code>strings.Index(s string, str string) in</code>：判断str在s中首次出现的位置，如果出现，则返回-1</p></li><li><p><code>strings.LastIndex(s string, str string) int</code>：判断str在s中最后出现的位置，出现，则返回-1</p></li><li><p><code>strings.Replace(str string, old string, new string, n int)</code>：字符串替换</p></li><li><code>strings.Count(str string, substr string)int</code>：字符串计数</li><li><code>strings.Repeat(str string, count int)string</code>：重复count次str</li><li><code>strings.ToLower(str string)string</code>：转为小写</li><li><code>strings.ToUpper(str string)string</code>：转为大写</li><li><code>strings.TrimSpace(str string)</code>：去掉字符串首尾空白字符</li><li>strings.Trim(str string, cut string)：去掉字符串首尾cut字符</li><li>strings.TrimLeft(str string, cut string)：去掉字符串首cut字符</li><li>strings.TrimRight(str string, cut string)：去掉字符串首cut字符</li><li>strings.Field(str string)：返回str空格分隔的所有子串的slice</li><li>strings.Split(str string, split string)：返回str split分隔的所有子串的s</li><li>strings.Join(s1 []string, sep string)：用sep把s1中的所有元素链接起来</li><li>strings.Itoa(i int)：把一个整数i转成字符串</li><li>strings.Atoi(str string)(int, error)：把一个字符串转成整数</li></ol><h1 id="时间和日期类型"><a href="#时间和日期类型" class="headerlink" title="时间和日期类型"></a>时间和日期类型</h1><p>time.Time类型，用来表示时间</p><ol><li>获取当前时间， <code>now := time.Now()</code></li><li><code>time.Now().Day()， time.Now().Minute()， time.Now().Month()， time.Now().Ye</code></li><li><p>格式化， <code>fmt.Printf(“%02d/%02d%02d %02d:%02d:%02d”, now.Year()…)</code></p><p>time.Duration用来表示纳秒</p></li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> (</div><div class="line">Nanosecond Duration = <span class="number">1</span></div><div class="line">Microsecond = <span class="number">1000</span> * Nanosecond</div><div class="line">Millisecond = <span class="number">1000</span> * Microsecond</div><div class="line">Second = <span class="number">1000</span> * Millisecond</div><div class="line">Minute = <span class="number">60</span> * Second</div><div class="line">Hour = <span class="number">60</span> * Minute</div><div class="line">)</div></pre></td></tr></table></figure><p>格式化：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// layout 必须是 2006-01-02 15:04:05.999999999，不能用其他的数字， 15点也可以是3点</span></div><div class="line">now := time.Now()</div><div class="line">fmt.Println(now.Format(“<span class="number">02</span>/<span class="number">1</span>/<span class="number">2006</span> <span class="number">15</span>:<span class="number">04</span>”))</div><div class="line">fmt.Println(now.Format(“<span class="number">2006</span>/<span class="number">1</span>/<span class="number">02</span> <span class="number">15</span>:<span class="number">04</span>”))</div><div class="line">fmt.Println(now.Format(“<span class="number">2006</span>/<span class="number">1</span>/<span class="number">02</span>”))</div></pre></td></tr></table></figure><h1 id="指针类型"><a href="#指针类型" class="headerlink" title="指针类型"></a>指针类型</h1><ol><li>普通类型，变量存的就是值，也叫值类型</li><li>获取变量的地址，用&amp;，比如： <code>var a int</code>, 获取a的地址： <code>&amp;a</code></li><li>指针类型，指针变量存的是一个地址，这个地址存的才是值。给指针变量赋值必须是一个地址。</li><li>获取指针类型所指向的值，使用： <code>*</code>，比如： <code>var *p int</code>, 使用<code>*p</code>获取p指向的值 </li></ol><h1 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h1><ol><li><p>If / else分支判断</p></li><li><p>switch case语句</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">switch</span> varX &#123;</div><div class="line">    <span class="keyword">case</span> var1:</div><div class="line">    <span class="keyword">fallthrough</span> <span class="comment">// 默认自带break</span></div><div class="line">    <span class="keyword">case</span> var2:</div><div class="line">    <span class="keyword">case</span> var3, var4, var5: <span class="comment">//多个值</span></div><div class="line">    <span class="keyword">default</span>:</div><div class="line">&#125;</div><div class="line"><span class="keyword">switch</span>&#123;</div><div class="line">    <span class="keyword">case</span> condition1：</div><div class="line">    <span class="keyword">case</span> condition2：</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>for 语句</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i := <span class="number">0</span> ; i &lt; <span class="number">100</span>; i++ &#123;</div><div class="line"> <span class="keyword">break</span> </div><div class="line"> <span class="keyword">continue</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> i &gt; <span class="number">0</span> &#123;</div><div class="line">fmt.Println(“i &gt; <span class="number">0</span>”)</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> <span class="literal">true</span> &#123;&#125; <span class="comment">// 等价于 for&#123;&#125;</span></div><div class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> str &#123;</div><div class="line">&#125;</div><div class="line"><span class="comment">// range 用来遍历切片、map、chan、str等</span></div></pre></td></tr></table></figure></li><li><p>goto 和 label 语句</p></li></ol><h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><ol><li><p>声明语法： <code>func 函数名 (参数列表) [(返回值列表)] {}</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">()</span></span> &#123;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(a <span class="keyword">int</span>, b <span class="keyword">int</span>)</span></span> &#123;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(a <span class="keyword">int</span>, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(a <span class="keyword">int</span>, b <span class="keyword">int</span>)</span> <span class="params">(low <span class="keyword">int</span>, max <span class="keyword">int</span>)</span></span> &#123;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span> &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>golang函数特点：<br>a. 不支持重载，一个包不能有两个名字一样的函数<br>b. 函数是一等公民，函数也是一种类型，一个函数可以赋值给变量<br>c. 匿名函数<br>d. 多返回值</p></li><li><p>函数参数传递方式：<br>1). 值传递<br>2). 引用传递</p><p>注意1：无论是值传递，还是引用传递，传递给函数的都是变量的副本，不过，值传递是值的拷贝。引用传递是地址的拷贝，一般来说，地址拷贝更为高效。而值拷贝取决于拷贝的对象大小，对象越大，则性能越低。</p><p>注意2： map、 slice、 chan、指针、 interface默认以引用的方式传递</p></li><li><p>命名返回值的名字：<code>func add(a, b int) (c int){}</code></p><p> <code>_</code>标识符，可以接收想要忽略的函数返回值</p></li><li><p>可变参数：<br><code>func add(arg…int) int {}</code> 0个或多个参数</p><p><code>func add(a int, b int, arg…int) int {}</code> 2个或多个参数<br>注意：其中arg是一个slice，我们可以通过<code>arg[index]</code>依次访问所有参数;通过<code>len(arg)</code>来判断传递参数的个数</p></li><li><p>defer用途：</p><ol><li>当函数返回时，执行defer语句。因此，可以用来做资源清理</li><li>多个defer语句，按先进后出的方式执行</li><li>defer语句中的变量，在defer声明时就决定了。</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 关闭文件句柄</span></div><div class="line">file := open(filename)</div><div class="line"><span class="keyword">defer</span> file.Close()</div><div class="line"><span class="comment">// 锁资源释放</span></div><div class="line">mc.Lock()</div><div class="line"><span class="keyword">defer</span> mc.Unlock()</div><div class="line"><span class="comment">// 数据库、网络连接</span></div><div class="line">conn := openDatabase()</div><div class="line"><span class="keyword">defer</span> conn.Close()</div></pre></td></tr></table></figure></li></ol><h2 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h2><ol><li>close：主要用来关闭channel</li><li>len：用来求长度，比如string、 array、 slice、 map、 channel</li><li>new：用来分配内存，主要用来分配值类型，比如int、 struct。返回的是指针</li><li>make：用来分配内存，主要用来分配引用类型，比如chan、 map、 slice</li><li>append：用来追加元素到数组、 slice中</li><li>panic和recover：用来做错误处理</li><li>new和make的区别</li><li>一个函数调用自己，就叫做递归。<br>递归的设计原则<br>递归函数<br>1）一个大的问题能够分解成相似的小问题<br>2）定义好出口条件</li></ol><h2 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h2><ol><li><p>闭包：定义的一个函数和与其相关的引用环境组合而成的实体</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"><span class="keyword">import</span> (</div><div class="line"><span class="string">"fmt"</span></div><div class="line"><span class="string">"strings"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">makeSuffixFunc</span><span class="params">(suffix <span class="keyword">string</span>)</span> <span class="title">func</span><span class="params">(<span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</div><div class="line">  <span class="comment">// 返回一个函数</span></div><div class="line">    <span class="keyword">var</span> x <span class="keyword">string</span>  <span class="comment">// 如果函数引用了x这个变量，x在其生命周期一直存在</span></div><div class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(name <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</div><div class="line"><span class="keyword">if</span> !strings.HasSuffix(name, suffix) &#123;</div><div class="line"><span class="keyword">return</span> name + suffix</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> name</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    func1 := makeSuffixFunc(<span class="string">".bmp"</span>)</div><div class="line">    func2 := makeSuffixFunc(<span class="string">".jpg"</span>)</div><div class="line">    fmt.Println(func1(<span class="string">"test"</span>))</div><div class="line">    fmt.Println(func2(<span class="string">"test"</span>))</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ol><h1 id="数组和切片"><a href="#数组和切片" class="headerlink" title="数组和切片"></a>数组和切片</h1><ol><li><p>数组：是同一种数据类型的固定长度的序列。</p><p>数组定义： <code>var a [len]int</code>, len必须是整数常量，不能传入变量，<code>a [10]int</code></p><p>长度是数组类型的一部分，因此， <code>var a[5] int</code>和<code>var a[10]int</code>是不同的类型</p></li><li><p>数组可以通过下标进行访问，下标是从0开始，最后一个元素下标是： len-1</p></li><li><p>访问越界，如果下标在数组合法范围之外，则触发访问越界，会panic</p></li><li><p>数组是值类型，因此改变副本的值，不会改变本身的值<br><code>arr2 := arr1 arr2[2] = 100</code> arr1的值不会变</p></li><li><p>数组初始化</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> age1 = [<span class="number">5</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</div><div class="line"><span class="keyword">var</span> age2 = […]<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>&#125;</div><div class="line"><span class="keyword">var</span> age0 [<span class="number">5</span>]<span class="keyword">int</span> = [<span class="number">5</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</div><div class="line"><span class="keyword">var</span> str = [<span class="number">5</span>]<span class="keyword">string</span>&#123;<span class="number">3</span>:”hello world”, <span class="number">4</span>:”tom”&#125;</div><div class="line"><span class="keyword">var</span> a [<span class="number">2</span>][<span class="number">3</span>]<span class="keyword">int</span> = [...][<span class="number">3</span>]<span class="keyword">int</span>&#123;&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;&#125;</div></pre></td></tr></table></figure></li></ol><p>切片</p><ol><li><p>切片：切片是数组的一个引用，因此切片是引用类型</p></li><li><p>切片的长度可以改变，因此，切片是一个可变的数组</p></li><li><p>切片遍历方式和数组一样，可以用len()求长度，cap可以求出slice最大的容量， 0 &lt;= len(slice) &lt;= (array)， 其中array是slice引用的数组</p></li><li><p>切片的定义：<code>var 变量名 []类型</code>，比如<code>var str []string</code>  <code>var arr []int</code></p></li><li><p>切片初始化： </p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> slice []<span class="keyword">int</span> = arr[start:end]</div><div class="line"><span class="keyword">var</span> slice []<span class="keyword">int</span>=arr[:end]</div><div class="line"><span class="keyword">var</span> slice []<span class="keyword">int</span> = arr[start]</div><div class="line"><span class="keyword">var</span> slice []<span class="keyword">int</span> = arr[:]</div></pre></td></tr></table></figure></li><li><p>通过make来创建切片</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> slice []<span class="keyword">type</span> = <span class="built_in">make</span>([]<span class="keyword">type</span>, <span class="built_in">len</span>)</div><div class="line">slice := <span class="built_in">make</span>([]<span class="keyword">type</span>, <span class="built_in">len</span>)</div><div class="line">slice := <span class="built_in">make</span>([]<span class="keyword">type</span>, <span class="built_in">len</span>, <span class="built_in">cap</span>)</div></pre></td></tr></table></figure></li><li><p>用append内置函数,在切片尾部添加元素</p></li><li><p>For range 遍历切片 <code>for index, val := range slice {}</code></p></li><li><p>切片resize</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = []<span class="keyword">int</span> &#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</div><div class="line">b := a[<span class="number">1</span>:<span class="number">2</span>]</div><div class="line">b = b[<span class="number">0</span>:<span class="number">3</span>]</div></pre></td></tr></table></figure></li><li><p>切片拷贝</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">s1 := []<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</div><div class="line">s2 := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">10</span>)</div><div class="line"><span class="built_in">copy</span>(s2, s1)</div><div class="line">s3 := []<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</div><div class="line">s3 = <span class="built_in">append</span>(s3, s2…)</div><div class="line">s3 = <span class="built_in">append</span>(s3, <span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)</div></pre></td></tr></table></figure></li><li><p>string与slice，string底层就是一个byte的数组，因此，也可以进行切片操作</p></li><li><p>如何改变string中的字符值？<br>string本身是不可变的，因此要改变string中字符，只能建立新的字符串</p></li><li><p>排序和查找操作</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">sort.Ints()<span class="comment">//对整数进行排序， </span></div><div class="line">sort.Strings() <span class="comment">// 对字符串进行排序, </span></div><div class="line">sort.Float64s() <span class="comment">//对浮点数进行排序.</span></div><div class="line">sort.SearchInts(a []<span class="keyword">int</span>, b <span class="keyword">int</span>) <span class="comment">//从数组a中查找b，前提是a必须有序</span></div><div class="line">sort.SearchFloats(a []<span class="keyword">float64</span>, b <span class="keyword">float64</span>) <span class="comment">//从数组a中查找b，前提是a必须有序</span></div><div class="line">sort.SearchStrings(a []<span class="keyword">string</span>, b <span class="keyword">string</span>) <span class="comment">//从数组a中查找b，前提是a必须有序</span></div></pre></td></tr></table></figure></li></ol><h1 id="map"><a href="#map" class="headerlink" title="map"></a>map</h1><blockquote><p>key-value的数据结构，又叫字典或关联数组</p></blockquote><ul><li><p>声明</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map1 <span class="keyword">map</span>[keytype]valuetype</div><div class="line"><span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></div><div class="line"><span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span></div><div class="line"><span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span></div><div class="line"><span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span> = <span class="built_in">make</span>( <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>,<span class="number">16</span>)</div></pre></td></tr></table></figure></li></ul><ol><li>map相关操作<br>插入和更新、查找、遍历<br><code>delete(a, “hello”)</code>删除<br><code>len(a)</code> 长度</li><li>map是引用类型</li><li>map排序<br>a. 先获取所有key，把key进行排序<br>b. 按照排序好的key，进行遍历</li></ol><h1 id="线程同步"><a href="#线程同步" class="headerlink" title="线程同步"></a>线程同步</h1><ul><li>import(“sync”)</li><li>互斥锁, <code>var mu sync.Mutex</code></li><li>读写锁, <code>var mu sync.RWMutex</code></li><li><code>go build -race xxx.go</code> race参数可以帮助分析是否有数据竞争</li></ul><h1 id="结构体和方法"><a href="#结构体和方法" class="headerlink" title="结构体和方法"></a>结构体和方法</h1><h2 id="struct"><a href="#struct" class="headerlink" title="struct"></a>struct</h2><ol><li>用来自定义复杂数据结构，Go语言没有class类型，只有struct类型</li><li>struct里面可以包含多个字段（属性）, 在内存上是连续分配的</li><li>struct类型可以绑定方法</li><li>struct类型是值类型，使用new初始化</li><li>struct类型可以嵌套</li><li>我们可以为struct中的每个字段，写上一个tag。这个tag可以通过反射的机制获取到，最常用的场景就是json序列化和反序列化</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</div><div class="line">    Name <span class="keyword">string</span> <span class="string">"tag name"</span></div><div class="line">    Age <span class="keyword">int</span> <span class="string">`json:"age"`</span></div><div class="line">    Score <span class="keyword">int</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> stu Student</div><div class="line">stu.Name = “tony”</div><div class="line">stu.Age = <span class="number">18</span></div><div class="line">stu.Score=<span class="number">20</span></div><div class="line">fmt.Printf(“name=%s age=%d score=%d”, stu.Name, stu.Age, stu.Score)</div></pre></td></tr></table></figure><h2 id="用struct构建链表和树"><a href="#用struct构建链表和树" class="headerlink" title="用struct构建链表和树"></a>用struct构建链表和树</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</div><div class="line">Name <span class="keyword">string</span></div><div class="line">Next* Student</div><div class="line">&#125;</div><div class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</div><div class="line">    Name <span class="keyword">string</span></div><div class="line">    Next* Student</div><div class="line">    Prev* Student</div><div class="line">&#125;</div><div class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</div><div class="line">    Name <span class="keyword">string</span></div><div class="line">    left* Student</div><div class="line">    right* Student</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="工厂模式创建struct"><a href="#工厂模式创建struct" class="headerlink" title="工厂模式创建struct"></a>工厂模式创建struct</h2><p>golang中的struct没有构造函数，一般可以使用工厂模式来解决这个问题</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> student <span class="keyword">struct</span> &#123;</div><div class="line">Name stirng</div><div class="line">Age <span class="keyword">int</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewStudent</span><span class="params">(name <span class="keyword">string</span>, age <span class="keyword">int</span>)</span> *<span class="title">student</span></span> &#123;</div><div class="line"><span class="keyword">return</span> &amp;student&#123;</div><div class="line">Name:name,</div><div class="line">Age:age,</div><div class="line">&#125; </div><div class="line">&#125;</div><div class="line"></div><div class="line">S := model.NewStudent(“tony”, <span class="number">20</span>)</div></pre></td></tr></table></figure><h2 id="匿名字段"><a href="#匿名字段" class="headerlink" title="匿名字段"></a>匿名字段</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Car <span class="keyword">struct</span> &#123;</div><div class="line">Name stirng</div><div class="line">Age <span class="keyword">int</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">type</span> Train <span class="keyword">struct</span> &#123;</div><div class="line">Car</div><div class="line">    <span class="keyword">int</span></div><div class="line">    Name <span class="comment">// 冲突字段</span></div><div class="line">Start time.Time</div><div class="line">&#125;</div><div class="line">train.<span class="keyword">int</span></div><div class="line">train.Name</div><div class="line">train.Car.Name = <span class="string">"train"</span></div></pre></td></tr></table></figure><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><ol><li><p>Golang中的方法是作用在特定类型的变量上，因此自定义类型都可以有方法，而不仅仅是struct<br>方法定义： <code>func (recevier type) methodName(参数列表)(返回值列表){}</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this A)</span> <span class="title">test</span><span class="params">()</span></span> &#123;</div><div class="line">fmt.Println(this.a)</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> t A</div><div class="line">t.test()</div></pre></td></tr></table></figure></li><li><p>方法的调用<code>receiver.method(args)</code></p></li><li><p>指针receiver vs 值receiver,本质上和函数的值传递和地址传递是一样的</p></li><li><p>方法的<strong>访问控制</strong>，通过大小写控制</p></li><li><p>方法<strong>继承</strong>: struct嵌套的匿名结构体，匿名结构体的方法可以直接调用，从而实现了继承。</p></li><li><p>组合和匿名字段<br>方法<br>如果一个struct嵌套了另一个匿名结构体，那么这个结构可以直接访问<br>匿名结构体的方法，从而实现了继承。<br>如果一个struct嵌套了另一个有名结构体，那么这个模式就叫组合。</p></li><li><p><strong>多重继承</strong> 一个struct嵌套多个匿名结构体，那么这个结构可以继承多个匿名结构体的方法</p></li><li><p>实现String()：方法如果一个变量实现了<code>String()</code>这个接口的方法，那么<code>fmt.Println</code>就会调用该方法。</p></li></ol><h1 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h1><h2 id="interface"><a href="#interface" class="headerlink" title="interface"></a>interface</h2><p>Interface类型可以定义一组方法，但是这些不需要实现。并且interface不能包含任何变量。</p><p>interface类型默认是一个指针.</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> example <span class="keyword">interface</span>&#123;</div><div class="line">    Method1(参数列表) 返回值列表</div><div class="line">    Method2(参数列表) 返回值列表</div><div class="line">&#125;</div></pre></td></tr></table></figure><ol><li><p>接口实现<br>a. Golang中的接口，不需要显示的实现。只要一个变量，含有接口类型中的所有方法，那么这个变量就实现这个接口。因此， golang中没有implement类似的关键字<br>b. 如果一个变量含有了多个interface类型的方法，那么这个变量就实现了多个接口。<br>c. 如果一个变量只含有了1个interface的部分方法，那么这个变量没有实现这个接口。</p></li><li><p><strong>多态</strong>: 一种事物的多种形态，都可以按照统一的接口进行操作</p></li><li><p>接口嵌套 :一个接口可以嵌套在另外的接口</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> ReadWrite <span class="keyword">interface</span> &#123;</div><div class="line">Read(b Buffer) <span class="keyword">bool</span></div><div class="line">Write(b Buffer) <span class="keyword">bool</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">type</span> Lock <span class="keyword">interface</span> &#123;</div><div class="line">Lock()</div><div class="line">Unlock()</div><div class="line">&#125;</div><div class="line"><span class="keyword">type</span> File <span class="keyword">interface</span> &#123;</div><div class="line">ReadWrite</div><div class="line">Lock</div><div class="line">Close()</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p><strong>类型断言</strong>，由于接口是一般类型，如果要转成具体类型,需要使用类型断言。或者采用<code>type switch</code>方式</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> t <span class="keyword">int</span></div><div class="line"><span class="keyword">var</span> x <span class="keyword">interface</span>&#123;&#125;</div><div class="line">x = t</div><div class="line">y = x.(<span class="keyword">int</span>) <span class="comment">//转成int</span></div><div class="line">y, ok = x.(<span class="keyword">int</span>) <span class="comment">//转成int，带检查</span></div><div class="line"></div><div class="line"><span class="keyword">switch</span> x.(<span class="keyword">type</span>) &#123;</div><div class="line">    <span class="keyword">case</span> *Circle: fmt.Printf(“Type Circle %T with value %v\n”, t, t)</div><div class="line"><span class="keyword">case</span> <span class="keyword">bool</span>: fmt.Printf(“param #%d is a <span class="keyword">bool</span>\n”</div><div class="line"><span class="keyword">case</span> <span class="keyword">float64</span>: fmt.Printf(“param #%d is a <span class="keyword">float64</span>\</div><div class="line"><span class="keyword">case</span> <span class="keyword">int</span>, <span class="keyword">int64</span>: fmt.Printf(“param #%d is an <span class="keyword">int</span>\n”</div><div class="line"><span class="keyword">case</span> <span class="literal">nil</span>: fmt.Printf(“param #%d is <span class="literal">nil</span>\n”, i)</div><div class="line"><span class="keyword">case</span> <span class="keyword">string</span>: fmt.Printf(“param #%d is a <span class="keyword">string</span>\n”,</div><div class="line"><span class="keyword">default</span>: fmt.Printf(“param #%d’s <span class="keyword">type</span> is unknown\n</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>空接口，<code>Interface{}</code>空接口没有任何方法，所以所有类型都实现了空接口。</p></li><li><p>判断一个变量是否实现了指定接口, 同样使用类型断言。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Stringer <span class="keyword">interface</span> &#123;</div><div class="line">String() <span class="keyword">string</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> v MyStruct</div><div class="line"><span class="keyword">if</span> sv, ok := v.(Stringer); ok &#123;</div><div class="line">fmt.Printf(“v implements String(): %s\n”, sv.String());</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ol><h2 id="sort-Interface"><a href="#sort-Interface" class="headerlink" title="sort.Interface"></a>sort.Interface</h2><p>被排序的对象必须实现<code>Interface</code>这个接口。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Interface <span class="keyword">interface</span> &#123;</div><div class="line"><span class="comment">// Len is the number of elements in the collection.</span></div><div class="line">Len() <span class="keyword">int</span></div><div class="line"><span class="comment">// Less reports whether the element with</span></div><div class="line"><span class="comment">// index i should sort before the element with index j.</span></div><div class="line">Less(i, j <span class="keyword">int</span>) <span class="keyword">bool</span></div><div class="line"><span class="comment">// Swap swaps the elements with indexes i and j.</span></div><div class="line">Swap(i, j <span class="keyword">int</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">Sort</span><span class="params">(data Interface)</span></span> &#123;</div><div class="line">n := data.Len()</div><div class="line">quickSort(data, <span class="number">0</span>, n, maxDepth(n))</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h1><p>反射：可以在运行时动态获取变量的相关信息</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> (“reflect”)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">test_reflact</span><span class="params">(b <span class="keyword">interface</span>&#123;&#125;)</span></span>  &#123;</div><div class="line">fmt.Println(<span class="string">"type: "</span>, reflect.TypeOf(b)) <span class="comment">//获取变量的类型</span></div><div class="line">fmt.Println(<span class="string">"value: "</span>, reflect.ValueOf(b))</div><div class="line">v := reflect.ValueOf(b) <span class="comment">//获取变量的值，返回reflect.Value类型</span></div><div class="line">fmt.Println(<span class="string">"kind: "</span>, v.Kind())<span class="comment">//获取变量的类别，返回一个常量</span></div><div class="line">fmt.Println(<span class="string">"type: "</span>, v.Type()) </div><div class="line">fmt.Println(<span class="string">"value: "</span>, v.Float()) <span class="comment">// 返回Float</span></div><div class="line">iv := v.Interface() <span class="comment">//reflect.Value.Interface() 转换成interface&#123;&#125;类型变量</span></div><div class="line">x, ok := iv.(<span class="keyword">float64</span>)</div><div class="line"><span class="keyword">if</span> ok &#123;</div><div class="line">fmt.Println(x)</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ol><li><p>reflect.Value.Kind()方法返回的常量</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> (</div><div class="line">Invalid Kind = <span class="literal">iota</span></div><div class="line">Bool</div><div class="line">Int</div><div class="line">Int8</div><div class="line">Int16</div><div class="line">Int32</div><div class="line">Int64</div><div class="line">Uint</div><div class="line">Uint8</div><div class="line">Uint16</div><div class="line">Uint32</div><div class="line">Uint64</div><div class="line">Uintptr</div><div class="line">Float32</div><div class="line">Float64</div><div class="line">Complex64</div><div class="line">Complex128</div><div class="line">Array</div><div class="line">Chan</div><div class="line">Func</div><div class="line">Interface</div><div class="line">Map</div><div class="line">Ptr</div><div class="line">Slice</div><div class="line">String</div><div class="line">Struct</div><div class="line">UnsafePointer</div><div class="line">)</div></pre></td></tr></table></figure></li><li><p>获取变量的值：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">reflect.ValueOf(x).Float()</div><div class="line">reflect.ValueOf(x).Int()</div><div class="line">reflect.ValueOf(x).String()</div><div class="line">reflect.ValueOf(x).Bool()</div></pre></td></tr></table></figure></li><li><p>通过反射的来改变变量的值</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// reflect.Value.SetXX相关方法，比如:</span></div><div class="line">reflect.Value.SetFloat()<span class="comment">//设置浮点数</span></div><div class="line">reflect.Value.SetInt() <span class="comment">//设置整数</span></div><div class="line">reflect.Value.SetString() <span class="comment">//设置字符串</span></div><div class="line">a := <span class="number">3.14</span></div><div class="line">fv := reflect.ValueOf(&amp;a)</div><div class="line">fv.Elem().SetFloat(<span class="number">3.3</span>)</div><div class="line">fmt.Printf(<span class="string">"%v\n"</span>, a)</div></pre></td></tr></table></figure><p>修改变量时要传入地址，访问变量时无法用<code>*</code>, 可以用 <code>p.Elem()</code></p></li><li><p>用反射操作结构体</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Rf_obj <span class="keyword">struct</span> &#123;</div><div class="line">Name <span class="keyword">string</span> <span class="string">`json:"name"`</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(rf *Rf_obj)</span> <span class="title">Print</span><span class="params">()</span></span>&#123;&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(rf *Rf_obj)</span> <span class="title">Set</span><span class="params">()</span></span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(b <span class="keyword">interface</span>&#123;&#125;)</span></span>  &#123;</div><div class="line">    <span class="comment">// 获取struct tag</span></div><div class="line">tp := reflect.TypeOf(b)</div><div class="line">fmt.Println(<span class="string">"type field tag: "</span>, tp.Elem().Field(<span class="number">0</span>).Tag.Get(<span class="string">"json"</span>))</div><div class="line"></div><div class="line">vP := reflect.ValueOf(b)</div><div class="line"><span class="keyword">if</span> vP.Kind() == reflect.Ptr &#123;</div><div class="line">fmt.Println(<span class="string">"这是个指针kind"</span>)</div><div class="line">&#125;</div><div class="line">vV := vP.Elem()</div><div class="line"><span class="keyword">if</span> vV.Kind() == reflect.Struct &#123;</div><div class="line">fmt.Println(<span class="string">"通过指针获取到了struct"</span>)</div><div class="line">&#125;</div><div class="line"><span class="comment">// 类型的Value上有field和部分方法</span></div><div class="line">fmt.Println(<span class="string">"struct field num: "</span>, vV.NumField()) <span class="comment">// 获取结构体中字段的个数</span></div><div class="line">fmt.Println(<span class="string">"field: "</span>, vV.Field(<span class="number">0</span>))</div><div class="line">    vV.Field(<span class="number">0</span>).SetString(<span class="string">"yyyy"</span>)</div><div class="line"><span class="comment">// 指针type上绑定的方法</span></div><div class="line">fmt.Println(<span class="string">"*ptr's method num: "</span>, vP.NumMethod())  <span class="comment">// 获取方法的个数</span></div><div class="line">vP.Method(<span class="number">0</span>).Call(<span class="literal">nil</span>) <span class="comment">// 来调用结构体中的方法</span></div><div class="line">vP.Method(<span class="number">1</span>).Call(<span class="literal">nil</span>)</div><div class="line">vP.Method(<span class="number">0</span>).Call(<span class="literal">nil</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ol><h1 id="IO和Json序列化"><a href="#IO和Json序列化" class="headerlink" title="IO和Json序列化"></a>IO和Json序列化</h1><h2 id="标准IO"><a href="#标准IO" class="headerlink" title="标准IO"></a>标准IO</h2><ul><li>os.Stdin：标准输入</li><li>os.Stdout：标准输出</li><li>os.Stderr：标准错误输出</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">fmt.Println(<span class="string">"Please enter your full name: "</span>)</div><div class="line">fmt.Scanln(&amp;firstName, &amp;lastName)</div><div class="line"><span class="comment">// fmt.Scanf("%s %s", &amp;firstName, &amp;lastName)</span></div><div class="line">fmt.Printf(<span class="string">"Hi %s %s!\n"</span>, firstName, lastName) <span class="comment">// Hi Chris Naegels</span></div><div class="line">fmt.Sscanf(input, format, &amp;f, &amp;i, &amp;s)</div><div class="line">fmt.Println(<span class="string">"From the string we read: "</span>, f, i, s)</div><div class="line">&#125;</div><div class="line"><span class="comment">// 带缓冲区的IO，提高读写性能</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    inputReader := bufio.NewReader(os.Stdin)</div><div class="line">    input, err := inputReader.ReadString(<span class="string">'\n'</span>)</div><div class="line">    <span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</div><div class="line">        fmt.Printf(<span class="string">"The input was: %s\n"</span>, input)</div><div class="line">    &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="File"><a href="#File" class="headerlink" title="File"></a>File</h2><ol><li>os.File封装所有文件相关操作，<code>os.Stdin,os.Stdout, os.Stderr</code> 都是<code>*os.File</code><br>a. 打开一个文件进行读操作： <code>os.Open(name string) (*File, error)</code><br>b. 关闭一个文件： <code>File.Close()</code></li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bufio 读文件</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">inputFile, err := os.Open(<span class="string">"input.dat"</span>)</div><div class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">fmt.Printf(<span class="string">"open file err:%v\n"</span>, err)</div><div class="line"><span class="keyword">return</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">defer</span> inputFile.Close()</div><div class="line">inputReader := bufio.NewReader(inputFile)</div><div class="line">    <span class="keyword">for</span> &#123;</div><div class="line">    inputString, readerError := inputReader.ReadString(<span class="string">'\n'</span>)</div><div class="line">    <span class="keyword">if</span> readerError == io.EOF &#123;</div><div class="line">    <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">   fmt.Printf(<span class="string">"The input was: %s"</span>, inputString)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// ioutil 一次性读取整个文件</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">inputFile := <span class="string">"products.txt"</span></div><div class="line">outputFile := <span class="string">"products_copy.txt"</span></div><div class="line">buf, err := ioutil.ReadFile(inputFile)</div><div class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">fmt.Fprintf(os.Stderr, <span class="string">"File Error: %s\n"</span>, err)</div><div class="line"><span class="keyword">return</span></div><div class="line">&#125;</div><div class="line">fmt.Printf(<span class="string">"%s\n"</span>, <span class="keyword">string</span>(buf))</div><div class="line">err = ioutil.WriteFile(outputFile, buf, <span class="number">0x644</span>)</div><div class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line"><span class="built_in">panic</span>(err.Error())</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 读gz压缩文件</span></div><div class="line"><span class="keyword">import</span> <span class="string">"compress/gzip"</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    fi, err := os.Open(<span class="string">"test.zip"</span>)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        fmt.Fprintf(os.Stderr, <span class="string">"Can’t open file: error: %s\n"</span>, err)</div><div class="line">    os.Exit(<span class="number">1</span>)</div><div class="line">&#125;</div><div class="line">fz, err := gzip.NewReader(fi)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">    fmt.Fprintf(os.Stderr, <span class="string">"open gzip failed, err: %v\n"</span>, err)</div><div class="line">    <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    r := bufio.NewReader(fz)</div><div class="line">    <span class="keyword">for</span> &#123;</div><div class="line">    line, err := r.ReadString(<span class="string">'\n'</span>)</div><div class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">            fmt.Println(<span class="string">"Done reading file"</span>)</div><div class="line">            os.Exit(<span class="number">0</span>)</div><div class="line">        &#125;</div><div class="line">        fmt.Println(line)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li><p>文件写入</p><p><code>os.OpenFile(“output.dat”, os.O_WRONLY|os.O_CREATE, 0666)</code></p><ol><li><code>os.O_WRONLY</code> 只写</li><li>os.O_CREATE：创建文件</li><li>os.O_RDONLY：只读</li><li>os.O_RDWR：读写</li><li>os.O_TRUNC ：清空</li></ol><p><code>outputWriter.Flush()</code></p></li><li><p>拷贝文件</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">CopyFile</span><span class="params">(dstName, srcName <span class="keyword">string</span>)</span> <span class="params">(written <span class="keyword">int64</span>, err error)</span></span> &#123;</div><div class="line">src, err := os.Open(srcName)</div><div class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line"><span class="keyword">return</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">defer</span> src.Close()</div><div class="line">dst, err := os.OpenFile(dstName, os.O_WRONLY|os.O_CREATE, <span class="number">0644</span>)</div><div class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line"><span class="keyword">return</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">defer</span> dst.Close()</div><div class="line"><span class="keyword">return</span> io.Copy(dst, src)</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ul><h2 id="命令行参数"><a href="#命令行参数" class="headerlink" title="命令行参数"></a>命令行参数</h2><ul><li><p><code>os.Args</code>是一个string的切片，用来存储所有的命令行参数.<code>len(os.Args)</code></p></li><li><p>flag包的使用，用来解析命令行参数：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">flag.BoolVar(&amp;test, <span class="string">"b"</span>, <span class="literal">false</span>, <span class="string">"require a bool val"</span>) <span class="comment">// 说明文字</span></div><div class="line">flag.StringVar(&amp;str, <span class="string">"s"</span>, <span class="string">""</span>, <span class="string">"require a str val"</span>)</div><div class="line">flag.IntVar(&amp;count, <span class="string">"c"</span>, <span class="number">1001</span>, <span class="string">"require a int val"</span>)</div><div class="line">flag.Parse()</div></pre></td></tr></table></figure></li></ul><h2 id="Json"><a href="#Json" class="headerlink" title="Json"></a>Json</h2><ul><li>“encoding/json”</li><li>序列化: json.Marshal(data interface{})</li><li><p>反序列化: json.UnMarshal(data []byte, v interface{})</p></li><li><p>json序列化结构体</p></li><li>json序列化map</li></ul><h1 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h1><ul><li><p><code>var errNotFound error = errors.New(&quot;Not found error&quot;)</code></p></li><li><p>error是一个接口</p></li><li><p>自定义错误</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> error <span class="keyword">interface</span> &#123;</div><div class="line">Error() <span class="keyword">string</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">type</span> PathError <span class="keyword">struct</span> &#123;</div><div class="line">Op <span class="keyword">string</span></div><div class="line">Path <span class="keyword">string</span></div><div class="line">err <span class="keyword">string</span></div><div class="line">&#125;</div><div class="line"><span class="comment">// 实现error接口</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e *PathError)</span> <span class="title">Error</span><span class="params">()</span> <span class="title">string</span></span> &#123;</div><div class="line"><span class="keyword">return</span> e.Op + <span class="string">" "</span> + e.Path + <span class="string">": "</span> + e.Err.Error()</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>判断error类型，使用类型断言<code>switch err.(type)</code> </p></li><li><p>Panic&amp;Recover</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">badCall</span><span class="params">()</span></span> &#123;</div><div class="line"><span class="built_in">panic</span>(<span class="string">"bad end"</span>)</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="comment">// recover 捕获panic</span></div><div class="line"><span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</div><div class="line"><span class="keyword">if</span> e := <span class="built_in">recover</span>(); e != <span class="literal">nil</span> &#123;</div><div class="line">fmt.Printf(<span class="string">"Panicking %s\r\n"</span>, e)</div><div class="line">&#125;</div><div class="line">&#125;()</div><div class="line">badCall()</div><div class="line">fmt.Printf(<span class="string">"After bad call\r\n"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ul><h1 id="goroutine和channel"><a href="#goroutine和channel" class="headerlink" title="goroutine和channel"></a>goroutine和channel</h1><ul><li><p>全局变量共享内存，需要加锁</p></li><li><p>go提供的channel机制，实现协程间的数据通信。线程安全的，类型unix的管道，先进先出</p><ul><li>make申请内存</li></ul></li><li><p>判断管道是否关闭</p><ul><li><code>if data, ok := &lt;- ch , ok{}</code> </li><li><code>for range</code>遍历channel，如果channel不关闭，会一直阻塞取数据。channel关闭后，取完就会退出<code>for range</code></li></ul></li><li><p>定时器</p><p>t.C是一个大小为1的<code>chan Time</code>类型管道，每隔指定的时间会尝试往其中写入一个时间</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">t := time.NewTicker(<span class="number">5</span> * time.Second)</div><div class="line"><span class="keyword">for</span> v := <span class="keyword">range</span> t.C &#123;</div><div class="line">    fmt.Println(v)</div><div class="line">&#125;</div><div class="line"><span class="comment">// 下面的After也会创建一个chan，但是不会在触发后立即被垃圾回收，存在内存泄露。不建议使用</span></div><div class="line">&lt;-time.After(<span class="number">5</span> * time.Second)</div></pre></td></tr></table></figure></li><li><p>判断chan状态以及读取写超时</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</div><div class="line">    t := time.NewTicker(<span class="number">5</span> * time.Second)</div><div class="line">    <span class="keyword">for</span> &#123;</div><div class="line">        <span class="keyword">select</span> &#123;</div><div class="line">            <span class="keyword">case</span> num := &lt;-channel:</div><div class="line">            fmt.Println(num)</div><div class="line">            <span class="keyword">case</span> &lt;-t.C:</div><div class="line">            fmt.Println(<span class="string">"超时"</span>)</div><div class="line">            <span class="keyword">case</span> &lt;-time.After(<span class="number">3</span> * time.Second): <span class="comment">// 不推荐使用，容易内存泄露</span></div><div class="line">            fmt.Println(<span class="string">"超时"</span>)</div><div class="line">            quit &lt;- <span class="literal">true</span></div><div class="line">        &#125;</div><div class="line">        t.Stop()</div><div class="line">    &#125;</div><div class="line">&#125;()</div></pre></td></tr></table></figure></li></ul><h1 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h1><ul><li>导入<code>testing</code>包</li><li>文件名以<code>_test.go</code>结尾的为测试用例文件</li><li>测试用例函数必须以<code>Test</code>开头， 传入的第一个参数为<code>*testing.T</code></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestAdd</span><span class="params">(t *testing.T)</span></span>&#123;</div><div class="line">    r := add(<span class="number">2</span>, <span class="number">4</span>)</div><div class="line">    <span class="keyword">if</span>(r != <span class="number">6</span>)&#123;</div><div class="line">        t.Fatalf(<span class="string">"add(2, 4) error, expect : %d, got: %d"</span>, <span class="number">6</span>, r)</div><div class="line">    &#125;</div><div class="line">    t.Log(<span class="string">"test add success"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>测试 <code>go test -v</code></li></ul><h1 id="socket编程"><a href="#socket编程" class="headerlink" title="socket编程"></a>socket编程</h1><ol><li><p>服务端的处理流程<br>a. 监听端口<br>b. 接收客户端的链接<br>c. 创建goroutine，处理该链接</p></li><li><p>客户端的处理流程<br>a. 建立与服务端的链接<br>b. 进行数据收发<br>c. 关闭链接</p></li><li><p>发送http请求</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">response, err := http.Get(<span class="string">"http://www.baidu.com"</span>)</div><div class="line"><span class="keyword">if</span> err!= <span class="literal">nil</span> &#123;</div><div class="line">    log.Println(err)</div><div class="line">&#125;</div><div class="line">body := response.Body</div><div class="line"><span class="keyword">defer</span> body.Close()</div><div class="line">res := <span class="string">""</span></div><div class="line">buf := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">2048</span>)</div><div class="line"><span class="keyword">for</span>  &#123;</div><div class="line">    n, err:= body.Read(buf)</div><div class="line">    log.Println(n)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> || n == <span class="number">0</span>&#123;</div><div class="line">        log.Println(err, n)</div><div class="line">        <span class="keyword">break</span></div><div class="line">    &#125;</div><div class="line">    res += <span class="keyword">string</span>(buf[:n])</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ol><h1 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h1><ol><li><p>redis连接库<br>使用第三方开源的redis库: <code>&quot;github.com/garyburd/redigo/redis&quot;</code><br>官方<a href="https://godoc.org/github.com/garyburd/redigo/redis" target="_blank" rel="external">文档</a></p></li><li><p>链接redis</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">c, err := redis.Dial(<span class="string">"tcp"</span>, <span class="string">"localhost:6379"</span>)</div><div class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">    fmt.Println(err, <span class="number">1</span>)</div><div class="line">    <span class="keyword">return</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">defer</span> c.Close()</div><div class="line"><span class="comment">// 认证</span></div><div class="line"><span class="keyword">if</span> _, err := c.Do(<span class="string">"AUTH"</span>, <span class="string">"mima"</span>); err != <span class="literal">nil</span> &#123;</div><div class="line">    c.Close()</div><div class="line">    <span class="keyword">return</span></div><div class="line">&#125;</div><div class="line"><span class="comment">// 选择db</span></div><div class="line"><span class="keyword">if</span> _, err := c.Do(<span class="string">"SELECT"</span>, <span class="number">0</span>); err != <span class="literal">nil</span> &#123;</div><div class="line">    c.Close()</div><div class="line">    <span class="keyword">return</span></div><div class="line">&#125;</div><div class="line"><span class="comment">// 读数据</span></div><div class="line"><span class="keyword">if</span> str, err := redis.String(c.Do(<span class="string">"GET"</span>, <span class="string">"a"</span>)); err != <span class="literal">nil</span>&#123;</div><div class="line">    fmt.Println(err)</div><div class="line">&#125;<span class="keyword">else</span> &#123;</div><div class="line">    fmt.Println(str)</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>通用操作接口<code>conn.Do(&quot;Command&quot;, &quot;key&quot;, &quot;value&quot;)</code></p><ul><li><p>读取GET  <code>GET key</code></p></li><li><p>写入SET</p><p><code>SET key value [EX seconds] [PX milliseconds] [NX|XX]</code></p><p>EX seconds – 指定过期时间，单位为秒.<br>PX milliseconds – 指定过期时间，单位为毫秒.<br>NX – 仅当键值不存在时设置键值.<br>XX – 仅当键值存在时设置键值. </p><p><code>c.Do(&quot;SET&quot;, &quot;password&quot;, &quot;123456&quot;, &quot;EX&quot;, &quot;10&quot;)</code></p></li><li><p>批量读、写</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//批量写入读取</span></div><div class="line">MGET key [key ...]</div><div class="line">MSET key value [key value ...]</div><div class="line"><span class="comment">//批量写入读取对象(Hashtable)</span></div><div class="line">HMSET key field value [field value ...]</div><div class="line">HMGET key field [field ...]</div></pre></td></tr></table></figure></li><li><p>检测key <code>EXISTS key</code></p></li><li><p>删除key <code>DEL key [key ...]</code></p></li><li><p>设置key过期时间 <code>EXPIRE key seconds</code></p></li></ul></li><li><p>Hash表操作</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_, err = c.Do(<span class="string">"HSet"</span>, <span class="string">"books"</span>, <span class="string">"abc"</span>, <span class="number">100</span>)</div><div class="line">r, err := redis.Int(c.Do(<span class="string">"HGet"</span>, <span class="string">"books"</span>, <span class="string">"abc"</span>))</div></pre></td></tr></table></figure></li><li><p>批量MSet  MGet</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_, err = c.Do(<span class="string">"MSet"</span>, <span class="string">"abc"</span>, <span class="number">100</span>, <span class="string">"efg"</span>, <span class="number">300</span>)</div><div class="line">rs, err := redis.Ints(c.Do(<span class="string">"MGet"</span>, <span class="string">"abc"</span>, <span class="string">"efg"</span>))</div></pre></td></tr></table></figure></li><li><p>过期时间 <code>_, err = c.Do(&quot;expire&quot;, &quot;abc&quot;, 10)</code></p></li><li><p>队列操作</p><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_, err = c.Do(<span class="string">"lpush"</span>, <span class="string">"book_list"</span>, <span class="string">"abc"</span>, <span class="string">"ceg"</span>, <span class="number">300</span>)</div><div class="line">r, err := redis.String(c.Do(<span class="string">"lpop"</span>, <span class="string">"book_list"</span>))</div></pre></td></tr></table></figure></li></ol><h2 id="连接池"><a href="#连接池" class="headerlink" title="连接池"></a>连接池</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> pool *redis.Pool</div><div class="line">pool := &amp;redis.Pool&#123;</div><div class="line">    MaxIdle:     <span class="number">16</span>,</div><div class="line">    MaxActive:   <span class="number">0</span>,</div><div class="line">    IdleTimeout: <span class="number">300</span>,</div><div class="line">  <span class="comment">// 连接方式</span></div><div class="line">  Dial: <span class="function"><span class="keyword">func</span> <span class="params">()</span> <span class="params">(redis.Conn, error)</span></span> &#123;</div><div class="line">        c, err := redis.Dial(<span class="string">"tcp"</span>, server)</div><div class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">          <span class="keyword">return</span> <span class="literal">nil</span>, err</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> _, err := c.Do(<span class="string">"AUTH"</span>, password); err != <span class="literal">nil</span> &#123;</div><div class="line">          c.Close()</div><div class="line">          <span class="keyword">return</span> <span class="literal">nil</span>, err</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> _, err := c.Do(<span class="string">"SELECT"</span>, db); err != <span class="literal">nil</span> &#123;</div><div class="line">          c.Close()</div><div class="line">          <span class="keyword">return</span> <span class="literal">nil</span>, err</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> c, <span class="literal">nil</span></div><div class="line">      &#125;,</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Go-学习笔记&quot;&gt;&lt;a href=&quot;#Go-学习笔记&quot; class=&quot;headerlink&quot; title=&quot;Go 学习笔记&quot;&gt;&lt;/a&gt;Go 学习笔记&lt;/h1&gt;&lt;h1 id=&quot;hello-world&quot;&gt;&lt;a href=&quot;#hello-world&quot; class=&quot;he
      
    
    </summary>
    
      <category term="技术" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Go" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Go/"/>
    
      <category term="标准库" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Go/%E6%A0%87%E5%87%86%E5%BA%93/"/>
    
    
      <category term="Go" scheme="http://shuaiyy.cn/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>秋招求职经历</title>
    <link href="http://shuaiyy.cn/2018/10/09/%E5%AD%A6%E4%B9%A0/%E6%89%BE%E5%B7%A5%E4%BD%9C/%E6%88%91%E7%9A%84%E7%A7%8B%E6%8B%9B%E6%B1%82%E8%81%8C%E7%BB%8F%E5%8E%86/"/>
    <id>http://shuaiyy.cn/2018/10/09/学习/找工作/我的秋招求职经历/</id>
    <published>2018-10-08T16:00:00.000Z</published>
    <updated>2018-11-27T10:45:52.513Z</updated>
    
    <content type="html"><![CDATA[<h1 id="我的求职经历"><a href="#我的求职经历" class="headerlink" title="我的求职经历"></a>我的求职经历</h1><h2 id="1-华为暑期实习"><a href="#1-华为暑期实习" class="headerlink" title="1. 华为暑期实习"></a>1. 华为暑期实习</h2><h3 id="投递简历"><a href="#投递简历" class="headerlink" title="投递简历"></a>投递简历</h3><ul><li>官网投递，有内推</li><li>java开发、web开发</li></ul><h3 id="性格测试"><a href="#性格测试" class="headerlink" title="性格测试"></a>性格测试</h3><ul><li>坑爹</li><li>很多题</li><li>超时了，我中间去取外卖。。。</li><li>选的中间值太多，1-9个选项，千万不要选456，否则后面会给你1-5个选项的类似题目。</li><li>同一题前后会出现2次，2次选了两个极端的，很容易挂。</li><li>如果挂了没有补考，除非你被strong hire，发offer前会补考。</li></ul><h3 id="在线笔试"><a href="#在线笔试" class="headerlink" title="在线笔试"></a>在线笔试</h3><ul><li><p>牛客网</p></li><li><p>5个编程题</p><p>其中有一道是背包问题</p></li></ul><h3 id="一面"><a href="#一面" class="headerlink" title="一面"></a>一面</h3><ul><li>没怎么聊项目</li><li>做了2个超级简单的编程题</li><li>面试官友好</li><li>然后直接二面</li></ul><h3 id="二面"><a href="#二面" class="headerlink" title="二面"></a>二面</h3><ul><li>为啥你的笔试成绩这么差？</li><li>为啥你的性格评测没过？</li><li>挂掉</li><li>面试官不友好</li></ul><h2 id="2-DJI校招"><a href="#2-DJI校招" class="headerlink" title="2. DJI校招"></a>2. DJI校招</h2><h3 id="投递简历-1"><a href="#投递简历-1" class="headerlink" title="投递简历"></a>投递简历</h3><ul><li>在线投递，有内推</li><li>后台开发</li></ul><h3 id="在线评测"><a href="#在线评测" class="headerlink" title="在线评测"></a>在线评测</h3><ul><li><p>价值输出很明显</p></li><li><p>题目也超级有意思</p></li><li><p>我很怀疑DJI是在借校招的名义进行调研。</p></li><li><p>做完在线评测，立刻就想卖身给DJI</p></li><li><p>很多题目给的选项非常的open，甚至是完全对立的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">数学问题:</div><div class="line">1. 包含透明方块和不透明方块立方体的三透视图</div><div class="line">2. abcde互相踢球</div><div class="line">3. 三男两女的专业推理问题</div><div class="line">4. 甲乙约会两人相互等待的概率问题</div><div class="line">5. 六宫格放4皇后的可能性问题</div><div class="line"></div><div class="line">个人工作发展：</div><div class="line">1.工作能力</div><div class="line">2.和领导冲突，</div><div class="line">3.重要项目决策</div><div class="line">4.小领导偷了你的idea</div><div class="line">5.协作项目发现可能存在隐患问题</div><div class="line">6. 你愿意花费在技术和管理的时间比例？</div><div class="line"></div><div class="line">dji产品问题：</div><div class="line">1. 哪个功能你觉得用的最少，全景，跟拍，指哪飞哪，延迟拍摄</div><div class="line">2. 产品feature和实际需求不一致</div><div class="line">3. dji和小米 华为 GoPro哪家合作更好</div><div class="line">4. dji低端飞行器是否要打上dji的logo</div><div class="line">5. 日本的高端电器产品只在国内销售确不在中国市场销售的原因？</div><div class="line">6. 大公司增加乏力，需要创新，拓展新业务，投入新创新项目的人员和资源占比问题？</div><div class="line"></div><div class="line">dji发展问题：</div><div class="line">1. 遇到专利流氓</div><div class="line">2. 被美国贸易制裁</div><div class="line">3. 好的公关应该是什么样子的</div><div class="line"></div><div class="line">隐私和政策问题</div><div class="line">1. 是否实名dji飞行器？</div><div class="line">2.哪种实名实施方法更合理？</div><div class="line">3. 内置sim卡实施汇报位置是否可行</div><div class="line">4.内置sim卡向飞管部门汇报属于监管上的进步还是退步？</div><div class="line"></div><div class="line">性格测试</div><div class="line">1. 有个人的传奇经历，你是否相信？</div><div class="line">2. 你的孩子(幼儿园)参加学校组织的野外露营，在老师禁止半夜外出时，于夜里三点叫醒小张，去河边玩水，受到惊吓。作为家长你应该。。。</div></pre></td></tr></table></figure></li></ul><h3 id="在线笔试-1"><a href="#在线笔试-1" class="headerlink" title="在线笔试"></a>在线笔试</h3><ul><li>有点low啊</li><li>传统的笔试，有很多选择和填空（共60分）</li><li>有几个和C++强相关的题我不会</li><li>竟然还有2个问答题，个人blog的sql表设计和blog部署；http的6中method。（20分）</li><li>最后2个编程题，竟然不是oj 形式，相当于在纸上手撸代码。一个sql查询语句；一个矩阵最后跳到底部的最少跳跃次数问题。（20分）</li></ul><p><img src="http://img.shuaiyy.cn/blog/180722/dBL14ICkKA.png?imageslim" alt="mark"></p><h2 id="3-百度SRE校招提前批"><a href="#3-百度SRE校招提前批" class="headerlink" title="3. 百度SRE校招提前批"></a>3. 百度SRE校招提前批</h2><h3 id="投递简历-2"><a href="#投递简历-2" class="headerlink" title="投递简历"></a>投递简历</h3><ul><li>邮箱，内推/自推</li><li>后台开发，运维开发，云开发</li></ul><h3 id="电话面试"><a href="#电话面试" class="headerlink" title="电话面试"></a>电话面试</h3><ul><li><p>聊项目</p></li><li><p>聊技术</p></li><li><p>2个编程题， 判断链表有环；100万个数据找出top10大的数</p></li><li><p>linux下怎么查找一个文本文件记录里的ip，我说了grep和awk，</p><p>问我对awk了解多少，我说用的不多，必须看要文档。面试官说你能提到awk就很棒了，然后又说awk很强大，数值计算，函数，文本处理等，需要专门写一本厚书来介绍。</p></li><li><p>如果客户投诉百度网站响应慢，如何电话指导他排除网络问题</p><p>我说的360傻瓜网络监测工具，ping。</p><p>后来面试官说还可以试试别的网站卡不卡。</p><p>印象深刻。</p></li><li><p>python如何动态改变函数的功能</p><p>我回答了装饰器和咖啡糖，经常使用，自己实现的不多。</p></li><li><p>对docker熟悉吗？docker的优势在哪里呢。</p></li></ul><h3 id="宣讲会"><a href="#宣讲会" class="headerlink" title="宣讲会"></a>宣讲会</h3><ul><li>百度的技术牛逼</li><li>通过手机陀螺仪检测恶意流量</li><li>搜索query的智能预充，晚上服务器空载时，进行query，第二天用户就可以从缓存中获取查询结果。</li><li>智能运维，智能流量监测啥的，好多内容记不住了。</li></ul><h3 id="线下一面"><a href="#线下一面" class="headerlink" title="线下一面"></a>线下一面</h3><ul><li><p>聊项目</p></li><li><p>聊技术</p></li><li><p>手撸代码</p><p>2G内存，10个1G的文件(key 空格 value)，找出现次数最高的top3 key记录，并求该key的value均值。</p><p>没撸出来，我手撸代码效率太低了(主要是心里也有点怵)，思路错了，挺尴尬的，没看我的代码，不过我很快给出了hash 分流，面试官说那就是hash桶呀。</p></li><li><p>给出你估算的武汉市红路灯数量，不管对错，说出理由即可。</p><p>不会啊，然后估算一下武大的井盖有多少，也不会强行过掉。</p></li><li><p>聊了70分钟，进入二面</p></li></ul><h3 id="线下二面"><a href="#线下二面" class="headerlink" title="线下二面"></a>线下二面</h3><ul><li><p>聊项目</p></li><li><p>聊技术</p></li><li><p>问了之前2面的情况</p></li><li><p>对个人的评价，没有回答好。</p></li><li><p>智力游戏，100个编号，一次能被1到100整除的人按一下手里的开关，求在40到50之间的开关打开的那个人。</p><p>倒计时2分钟，没搞出来。</p><p>然后说虽然你的思路是对的，但是不是考的计算，这么短的时间内是可以尝试找规律的。</p></li><li><p>求$a^b$结果的后3位值。</p><p>受上个题目的影响，我以为又要找规律。</p><p>然后给了我5分钟撸代码，过了一半的时间我还没动笔。面试官说这个不是找规律啊，先解决问题。</p><p>然后我写了个while循环的暴力代码。</p><p>面试官问有没有优化的方法，我说了一个将b以二进制划分的方法，面试官说思路是对的。</p></li><li><p>运维、故障排查、服务优化。</p><p>只能想到啥说啥，并没有成体系的知识结构。</p></li></ul><p>百度的技术大佬人真的超级nice，和他们交流收获很大。</p><h2 id="4-网易-JAVA开发"><a href="#4-网易-JAVA开发" class="headerlink" title="4. 网易 JAVA开发"></a>4. 网易 JAVA开发</h2><h3 id="投递简历-3"><a href="#投递简历-3" class="headerlink" title="投递简历"></a>投递简历</h3><ul><li>有内推码</li><li>投完直接在线测评</li></ul><h3 id="在线评测-1"><a href="#在线评测-1" class="headerlink" title="在线评测"></a>在线评测</h3><blockquote><p>心态爆炸，全程靠蒙</p><p>很多题是考公务员才会遇到的那种逻辑推理。图表分析和数值计算的更是难受。</p></blockquote><ul><li>60分钟，4类题型</li><li>阅读理解(10min，10题)</li><li>图表分析(10min, 10题)</li><li>看图找规律/不同（10,10）</li><li>性格测试（30min，90题）</li></ul><h3 id="在线笔试-2"><a href="#在线笔试-2" class="headerlink" title="在线笔试"></a>在线笔试</h3><ul><li>8.11， 4道算法题只AC了1个，不太理想</li></ul><h3 id="下线面试-杭州-8-23"><a href="#下线面试-杭州-8-23" class="headerlink" title="下线面试(杭州/8.23)"></a>下线面试(杭州/8.23)</h3><ul><li>准备中</li></ul><h2 id="5-网易游戏-后台开发SRE"><a href="#5-网易游戏-后台开发SRE" class="headerlink" title="5. 网易游戏 后台开发SRE"></a>5. 网易游戏 后台开发SRE</h2><h3 id="投简历"><a href="#投简历" class="headerlink" title="投简历"></a>投简历</h3><ul><li>有内推码</li><li>显示已处理，无下文</li></ul><h2 id="6-阿里巴巴国际"><a href="#6-阿里巴巴国际" class="headerlink" title="6. 阿里巴巴国际"></a>6. 阿里巴巴国际</h2><h3 id="投简历-1"><a href="#投简历-1" class="headerlink" title="投简历"></a>投简历</h3><ul><li>内推/自推</li></ul><h3 id="在线评测-2"><a href="#在线评测-2" class="headerlink" title="在线评测"></a>在线评测</h3><h3 id="在线编程-没做"><a href="#在线编程-没做" class="headerlink" title="在线编程 没做"></a>在线编程 没做</h3><h3 id="电话一面"><a href="#电话一面" class="headerlink" title="电话一面"></a>电话一面</h3><ul><li>我还没做测评和在线编程，就有面试官约电面</li><li>如果电面挂了，是不是测评也不用做T.T</li><li>主要是做JAVA web开发</li><li>问了下项目，成绩，和JVM。</li><li>直接GG</li></ul><h3 id="9-7-在线笔试"><a href="#9-7-在线笔试" class="headerlink" title="9.7 在线笔试"></a>9.7 在线笔试</h3><ul><li><p>没有投简历，自动复活的</p></li><li><p>又要把我捞出来鞭尸么</p></li><li><p>题目很难 10个选择题，涉及智商检查，逻辑推理、概率、积分、微分、机器学习、L1和L2正则化，我选择go die！！！！。</p><p>2道编程题为附加题，</p><ul><li><p>判断点是否在不规则多边形内部，如果不在，最小的距离是多少？</p></li><li><p>数组划分的种类</p><p>划分要求：将数组拆成若干个子数组(元素可以不连续)，每个子数组长度大于等于3，内部元素保持原始的相对顺序，子数组之间互相没有交集，。子数组内部为等差或等比数列。</p></li></ul></li></ul><h2 id="7-百度云中心"><a href="#7-百度云中心" class="headerlink" title="7. 百度云中心"></a>7. 百度云中心</h2><h3 id="电话一面-1"><a href="#电话一面-1" class="headerlink" title="电话一面"></a>电话一面</h3><ul><li>连续3个整数之积是否一定可以被6整除</li><li>CAP</li></ul><hr><h1 id="7-25号之后"><a href="#7-25号之后" class="headerlink" title="7.25号之后"></a>7.25号之后</h1><hr><h2 id="8-华为优招-云计算方向"><a href="#8-华为优招-云计算方向" class="headerlink" title="8. 华为优招 (云计算方向)"></a>8. 华为优招 (云计算方向)</h2><h3 id="直通面试"><a href="#直通面试" class="headerlink" title="直通面试"></a>直通面试</h3><ul><li>有华为比赛三等奖，可以免笔试</li></ul><h3 id="技术面-8-17"><a href="#技术面-8-17" class="headerlink" title="技术面 8.17"></a>技术面 8.17</h3><ul><li><p>spring cloud 微服务架构</p></li><li><p>爬虫</p></li><li><p>5000台租户虚拟机，监控代理每个上传监控数据的峰值为40kbps。不能直接用kafak收集日志，因为部署身份认证密钥很困难，如何解决？上传协议用什么，上传数据怎么处理？</p><p>涉及到ELK、Kafka、分布式通信，我能想到的就是rest 和消息队列。</p><p>面试官讲他们的做法是，在代理和kafak之间搭建一个消息中间件，使用https协议进行身份认证，然后将https的消息转换成kafka支持的协议，然后由kafka和ELK集群进行后面的数据处理。</p></li><li><p>技术大佬，人很nice。讲了他们的技术栈，也对我后面的学习提了一些建议。</p></li></ul><h3 id="综合面试-8-17"><a href="#综合面试-8-17" class="headerlink" title="综合面试 8.17"></a>综合面试 8.17</h3><ul><li><p>挂掉了，很伤。估计是我表达不够流利，表现的也不自信。或者是价值观不符，难道是运气太差？！</p></li><li><p>聊项目，认为我用的技术很简单</p></li><li><p>你在项目中遇到的困难，如何解决的？</p></li><li><p>为什么想来华为，想去深圳？</p></li><li><p>有什么兴趣爱好呢？</p></li><li><p>对华为公司有什么想了解的？</p><ul><li>不要聊生活压力、工作压力、房价之类的</li></ul></li><li><p>难道我的价值观不符？</p><p><img src="http://img.shuaiyy.cn/blog/180818/KakAb8AL1g.png?imageslim" alt="mark"></p></li></ul><h2 id="9-虾皮科技"><a href="#9-虾皮科技" class="headerlink" title="9. 虾皮科技"></a>9. 虾皮科技</h2><h3 id="简历、内推"><a href="#简历、内推" class="headerlink" title="简历、内推"></a>简历、内推</h3><ul><li>显示被淘汰，但是又给我发邮件说通过筛选，去做人才评测</li></ul><h3 id="在线评测-3"><a href="#在线评测-3" class="headerlink" title="在线评测"></a>在线评测</h3><ul><li>阅读理解、读表分析、找规律</li></ul><h2 id="10-链家-贝壳找房"><a href="#10-链家-贝壳找房" class="headerlink" title="10. 链家 贝壳找房"></a>10. 链家 贝壳找房</h2><p><img src="http://img.shuaiyy.cn/blog/180818/FGFaJehEhB.png?imageslim" alt="mark"></p><h3 id="投递简历-4"><a href="#投递简历-4" class="headerlink" title="投递简历"></a>投递简历</h3><ul><li>内推8.14</li></ul><h3 id="在线笔试-3"><a href="#在线笔试-3" class="headerlink" title="在线笔试"></a>在线笔试</h3><ul><li>8.18号</li></ul><h3 id="线下面试-北京9-01"><a href="#线下面试-北京9-01" class="headerlink" title="线下面试 北京9.01"></a>线下面试 北京9.01</h3><ul><li>凉凉</li><li>一面ok</li><li>二面时已经晚上7点了， 日狗。手撸代码，有处逻辑写错了，面试官很不耐烦，一直在催我；问到多线程，然后也不明白他想问啥。后来复习时，我猜他想表达的意思应该是CAS。真是人渣啊，</li><li>以后再也不去异地面了，劳神伤财，天时地利人和一个都没有。</li></ul><h2 id="11-拼多多"><a href="#11-拼多多" class="headerlink" title="11. 拼多多"></a>11. 拼多多</h2><ul><li>邮箱投递简历</li><li>8.5号笔试</li><li>笔试没通过</li></ul><h2 id="12-美团"><a href="#12-美团" class="headerlink" title="12. 美团"></a>12. 美团</h2><h3 id="投递简历-5"><a href="#投递简历-5" class="headerlink" title="投递简历"></a>投递简历</h3><p><img src="http://img.shuaiyy.cn/blog/180818/ehL6dHCigK.png?imageslim" alt="mark"></p><h3 id="9-6-笔试"><a href="#9-6-笔试" class="headerlink" title="9.6 笔试"></a>9.6 笔试</h3><ul><li>题目不难</li></ul><h3 id="9-11-光谷线下面试"><a href="#9-11-光谷线下面试" class="headerlink" title="9.11 光谷线下面试"></a>9.11 光谷线下面试</h3><h2 id="13-携程-云计算工程师"><a href="#13-携程-云计算工程师" class="headerlink" title="13. 携程 云计算工程师"></a>13. 携程 云计算工程师</h2><h3 id="投递简历-8-11"><a href="#投递简历-8-11" class="headerlink" title="投递简历 8.11"></a>投递简历 8.11</h3><p><img src="http://img.shuaiyy.cn/blog/180818/AeiBijjh33.png?imageslim" alt="mark"></p><h3 id="在线笔试-9-4"><a href="#在线笔试-9-4" class="headerlink" title="在线笔试 9.4"></a>在线笔试 9.4</h3><ul><li>题目很简单</li></ul><h2 id="14-微众银行-后台开发"><a href="#14-微众银行-后台开发" class="headerlink" title="14.微众银行 后台开发"></a>14.微众银行 后台开发</h2><h3 id="投递简历-8-19"><a href="#投递简历-8-19" class="headerlink" title="投递简历 8.19"></a>投递简历 8.19</h3><p><img src="http://img.shuaiyy.cn/blog/180819/DGB09E720i.png?imageslim" alt="mark"></p><h2 id="15-字节跳动-后台开发"><a href="#15-字节跳动-后台开发" class="headerlink" title="15. 字节跳动 后台开发"></a>15. 字节跳动 后台开发</h2><h3 id="投递简历-6"><a href="#投递简历-6" class="headerlink" title="投递简历"></a>投递简历</h3><ul><li>有内推码</li></ul><p><img src="http://img.shuaiyy.cn/blog/180819/9c18abj0DL.png?imageslim" alt="mark"></p><h3 id="在线笔试-8-25"><a href="#在线笔试-8-25" class="headerlink" title="在线笔试 8.25"></a>在线笔试 8.25</h3><ul><li>凉凉，宇宙条。</li></ul><h2 id="16-FreeWheel"><a href="#16-FreeWheel" class="headerlink" title="16. FreeWheel"></a>16. FreeWheel</h2><h3 id="9-3-华科线下笔试"><a href="#9-3-华科线下笔试" class="headerlink" title="9.3 华科线下笔试"></a>9.3 华科线下笔试</h3><ul><li><p>3道算法题，2道不会</p></li><li><p>osi tcp的7层模型， TCP3次握手</p></li><li><p>线程和进程的区别。</p></li><li><p>算法题</p><ol><li><p>给定的树，和某个叶子节点，以叶子节点为根，按照一定的要求重建树。</p></li><li><p>两条平行线（<code>y=0.0</code>和<code>y=(float) c</code>）之间有一系列的点和一个可以自由运动的圆，圆可以安全通过，即不碰到任意的点或水平线，求圆的最大直径。要求精确度为0.01.</p><p>这个我不会做，行哥给了一个思路：</p><ul><li><p>转化为图模型：将两条水平线视为图的两个Node，记为A、B；将所有的点视为图的节点；</p></li><li><p>对于给定的直径d，如果d&gt;任意两个节点的距离，则两点间有边，因而可以构建出一个图。</p></li><li><p>判定：如果从节点A到B存在路径(连通)，则水平线内的路是被封死的，因而无法通过。</p></li><li><p>二分查找：找到最大的直径d，对于每次尝试的直径，构建相应的图。</p></li></ul></li><li><p>集合运算</p><p><img src="http://img.shuaiyy.cn/blog/180903/cg4CLK46m8.png?imageslim" alt="mark"></p></li></ol></li></ul><pre><code>![](http://img.shuaiyy.cn/blog/180903/m2DGA6H9hK.png?imageslim)时间来不及了，没认真思考。+ 考虑用HashMap + bitmap实现  HashMap存储满足相应投放规则的广告集合(bitmap)，即key为投放规则，bitmap为满足要求的广告uid的合集；对于一个uid，如果满足某个规则，则相应的bitmap的uid的位置设为1，否则设为0；+ 空间复杂度分析  Key: 对于两个维度，坐标（loc，m种）和设备（dev，n种），那么共有$m+n+m*n$个key，满足loc的，满足dev的，必须同时满足loc和dev，三种情况。  value： 假设有2000W个广告，那么需要相应2000Wbit的存储空间，约为2.4MB。  假设有100个地区和10种设备，需要的内存空间约为2.5GB。+ 时间复杂度分析  需要`O(N)`的时间复杂度初始化HashMap  添加一条广告的记录为`O(1)*k`,k为该广告所满足的规则数。  针对给定用户`loc=A，dev=B`，查找其匹配的广告：即A、B、AB三种类型的广告集合求并集，  $O(1)$时间复杂度的bitmap的`&amp;`操作。  取出匹配的广告的uid，即在bitmap中查找所有为1的位置的下标，时间复杂度为`O(N)`,显然该操作可以通过多线程加速，map/reduce的思想。</code></pre><h3 id="9-4-华科线下一面与二面"><a href="#9-4-华科线下一面与二面" class="headerlink" title="9.4 华科线下一面与二面"></a>9.4 华科线下一面与二面</h3><ul><li>手撸代码，超级简单的编程题</li><li>问了一些基础知识和项目相关的</li><li>要求英文自我介绍GG</li><li>本来以为过不了笔试的，2道编程大题没做(40分)。</li><li>本想交流一下笔试题的，结果两个面试官都说题不是他出的，也不是他改的。</li></ul><h2 id="17-顺丰科技"><a href="#17-顺丰科技" class="headerlink" title="17. 顺丰科技"></a>17. 顺丰科技</h2><h3 id="投简历-JAVA研发8-24"><a href="#投简历-JAVA研发8-24" class="headerlink" title="投简历 JAVA研发8.24"></a>投简历 JAVA研发8.24</h3><ul><li>笔试面试很简单</li><li>拿到offer</li><li>拒绝，工资低，加上顺丰科技员工删数据库事件，对发展前景担忧。</li></ul><h2 id="18-小米科技"><a href="#18-小米科技" class="headerlink" title="18. 小米科技"></a>18. 小米科技</h2><h3 id="投简历-软件开发工程师-8-24"><a href="#投简历-软件开发工程师-8-24" class="headerlink" title="投简历 软件开发工程师 8.24"></a>投简历 软件开发工程师 8.24</h3><ul><li>线下笔试 9.15</li><li>线下一面和二面 10.16<ul><li>基础知识</li><li>手撸代码</li><li>项目经历</li><li>只有武汉岗位，放弃</li></ul></li></ul><h2 id="19-腾讯科技"><a href="#19-腾讯科技" class="headerlink" title="19. 腾讯科技"></a>19. 腾讯科技</h2><h3 id="投简历-8-24-web开发方向"><a href="#投简历-8-24-web开发方向" class="headerlink" title="投简历 8.24 web开发方向"></a>投简历 8.24 web开发方向</h3><ul><li>简历未通过</li></ul><h2 id="20-招商银行信用卡中心"><a href="#20-招商银行信用卡中心" class="headerlink" title="20.招商银行信用卡中心"></a>20.招商银行信用卡中心</h2><h3 id="投简历-IT类-开发-2018-08-25"><a href="#投简历-IT类-开发-2018-08-25" class="headerlink" title="投简历 IT类 开发 2018.08.25"></a>投简历 IT类 开发 2018.08.25</h3><h3 id="在线笔试-4"><a href="#在线笔试-4" class="headerlink" title="在线笔试"></a>在线笔试</h3><ul><li>9.8 题目很简单</li><li>面试放弃，时间冲突</li></ul><h2 id="21-BliBli"><a href="#21-BliBli" class="headerlink" title="21. BliBli"></a>21. BliBli</h2><ul><li>记不清啥时候投的简历和岗位了</li></ul><h3 id="9-4-电话一面"><a href="#9-4-电话一面" class="headerlink" title="9.4 电话一面"></a>9.4 电话一面</h3><ul><li>聊了一些基础知识，docker，微服务。</li><li>然后面试官花了15分钟给我介绍B站的情况<ul><li>在向技术驱动型公司转型</li><li>在探索docker和容器云，并逐步迁移业务至微服务</li><li>涉及运维、平台研发等，devops</li><li>有BAT的大佬，当前的云部门PaaS很像是内部创业，管理的服务器1000+，为80%的业务提供服务。</li></ul></li></ul><h3 id="9-5-电话二面"><a href="#9-5-电话二面" class="headerlink" title="9.5 电话二面"></a>9.5 电话二面</h3><ul><li>二面有点蒙圈</li><li>设计一个秒杀系统<ul><li>我只回答了二级队列</li></ul></li><li>分布式缓存的CAP问题，如何保持计算结果的一致性</li><li>手机APP缓存的数据<ul><li>时间戳</li></ul></li></ul><h3 id="10-15-电话三面"><a href="#10-15-电话三面" class="headerlink" title="10.15 电话三面"></a>10.15 电话三面</h3><ul><li>问了gitflow项目开发流程，不会</li><li>问我用过哪些Linux系统</li><li>如何解决工作中遇到的问题</li></ul><h2 id="22-快手"><a href="#22-快手" class="headerlink" title="22. 快手"></a>22. 快手</h2><h3 id="9-10-在线笔试"><a href="#9-10-在线笔试" class="headerlink" title="9.10 在线笔试"></a>9.10 在线笔试</h3><ul><li>笔试未通过</li></ul><h2 id="23-招银网络科技"><a href="#23-招银网络科技" class="headerlink" title="23. 招银网络科技"></a>23. 招银网络科技</h2><ul><li>拿到offer</li></ul><h2 id="24-Vivo"><a href="#24-Vivo" class="headerlink" title="24. Vivo"></a>24. Vivo</h2><ul><li>投简历</li><li>在线笔试，未通过</li></ul><h2 id="25-同花顺"><a href="#25-同花顺" class="headerlink" title="25. 同花顺"></a>25. 同花顺</h2><ul><li>简历未通过</li></ul><h2 id="26-新浪"><a href="#26-新浪" class="headerlink" title="26. 新浪"></a>26. 新浪</h2><ul><li><ol><li>8电话一面</li></ol></li><li><ol><li>15电话二面</li></ol></li></ul><p>没有下文</p><h2 id="30-虎牙-java"><a href="#30-虎牙-java" class="headerlink" title="30. 虎牙 java"></a>30. 虎牙 java</h2><ul><li>没有下文</li></ul><h2 id="31-keep"><a href="#31-keep" class="headerlink" title="31. keep"></a>31. keep</h2><h3 id="9-10-线下投简历"><a href="#9-10-线下投简历" class="headerlink" title="9.10 线下投简历"></a>9.10 线下投简历</h3><ul><li>之前线上投过简历的</li><li>笔试通过</li><li>时间冲突，没去面试</li></ul><h2 id="32-网易雷火-运维工程师"><a href="#32-网易雷火-运维工程师" class="headerlink" title="32. 网易雷火 运维工程师"></a>32. 网易雷火 运维工程师</h2><ul><li>线下笔试 9.16</li><li>电话一面 9.30</li><li>电话二面</li><li>电话三面</li></ul><p>面试进行的太晚了，估计hc早就没有了。</p><h2 id="33-BIGO"><a href="#33-BIGO" class="headerlink" title="33. BIGO"></a>33. BIGO</h2><p>东南亚的直播平台，java开发</p><p>一面面试通过</p><p>二面未过</p><p>放弃，因为面试官说后台岗位已满，希望转客户端前端开发，拒绝。</p><h2 id="34-杭州笛佛软件有限公司"><a href="#34-杭州笛佛软件有限公司" class="headerlink" title="34 杭州笛佛软件有限公司"></a>34 杭州笛佛软件有限公司</h2><p>ERP产品，软件产品——“网店管家”</p><p>简历未通过</p><h2 id="35-汉德软件"><a href="#35-汉德软件" class="headerlink" title="35 汉德软件"></a>35 汉德软件</h2><p>简历未通过</p><h2 id="36-玄武科技"><a href="#36-玄武科技" class="headerlink" title="36 玄武科技"></a>36 玄武科技</h2><ul><li>笔试未通过</li></ul><h2 id="37-滴滴-后端研发工程师"><a href="#37-滴滴-后端研发工程师" class="headerlink" title="37 滴滴 后端研发工程师"></a>37 滴滴 后端研发工程师</h2><h3 id="9-11-邮箱投递简历"><a href="#9-11-邮箱投递简历" class="headerlink" title="9.11 邮箱投递简历"></a>9.11 邮箱投递简历</h3><ul><li>笔试未通过</li></ul><h2 id="38-YY欢聚时代"><a href="#38-YY欢聚时代" class="headerlink" title="38 YY欢聚时代"></a>38 YY欢聚时代</h2><h3 id="9-11-邮箱投递简历-1"><a href="#9-11-邮箱投递简历-1" class="headerlink" title="9.11 邮箱投递简历"></a>9.11 邮箱投递简历</h3><h3 id="9-16-在线笔试"><a href="#9-16-在线笔试" class="headerlink" title="9.16 在线笔试"></a>9.16 在线笔试</h3><h3 id="9-25-线下一面"><a href="#9-25-线下一面" class="headerlink" title="9.25 线下一面"></a>9.25 线下一面</h3><ul><li>聊的还不错，面试官是做大数据的，爬虫工程应用懂得很多，问的很深入</li><li>没有下文</li><li>和面试官交流，感觉他们价值观有点问题，不仅爬自己内部的数据，竞争对手的数据，还会向黑客购买数据，还说的理直气壮。</li></ul><h2 id="39-4399"><a href="#39-4399" class="headerlink" title="39 4399"></a>39 4399</h2><h3 id="9-11-官网投递Web后端"><a href="#9-11-官网投递Web后端" class="headerlink" title="9.11 官网投递Web后端"></a>9.11 官网投递Web后端</h3><h3 id="9-12-线上笔试"><a href="#9-12-线上笔试" class="headerlink" title="9.12 线上笔试"></a>9.12 线上笔试</h3><p>没有下文</p><h2 id="40-平安智慧城"><a href="#40-平安智慧城" class="headerlink" title="40 平安智慧城"></a>40 平安智慧城</h2><ul><li>没有笔面试通知</li></ul><h2 id="41-乐贝-lebbay-与拼多多-同母公司"><a href="#41-乐贝-lebbay-与拼多多-同母公司" class="headerlink" title="41 乐贝 lebbay 与拼多多 同母公司"></a>41 乐贝 lebbay 与拼多多 同母公司</h2><ul><li><p>一面挂</p><p>现场手撸代码，没做出来。</p><p>是个贪心算法的题目。</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;我的求职经历&quot;&gt;&lt;a href=&quot;#我的求职经历&quot; class=&quot;headerlink&quot; title=&quot;我的求职经历&quot;&gt;&lt;/a&gt;我的求职经历&lt;/h1&gt;&lt;h2 id=&quot;1-华为暑期实习&quot;&gt;&lt;a href=&quot;#1-华为暑期实习&quot; class=&quot;headerlink&quot; 
      
    
    </summary>
    
      <category term="学习" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="求职" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/"/>
    
      <category term="经历" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/%E7%BB%8F%E5%8E%86/"/>
    
    
      <category term="求职" scheme="http://shuaiyy.cn/tags/%E6%B1%82%E8%81%8C/"/>
    
      <category term="经历" scheme="http://shuaiyy.cn/tags/%E7%BB%8F%E5%8E%86/"/>
    
  </entry>
  
  <entry>
    <title>��ת�ء�������˼��</title>
    <link href="http://shuaiyy.cn/2018/09/16/%E5%AD%A6%E4%B9%A0/%E5%86%99%E4%BD%9C/%E8%AF%BB%E4%B9%A6%E5%92%8C%E6%80%9D%E8%80%83/"/>
    <id>http://shuaiyy.cn/2018/09/16/学习/写作/读书和思考/</id>
    <published>2018-09-15T16:00:00.000Z</published>
    <updated>2018-11-27T10:43:16.483Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>�ǲ��ó����ˣ����������ļ�ʱ���ֵ�</p></blockquote><h2 id="�K���˼��"><a href="#�K���˼��" class="headerlink" title="�Ķ���˼��"></a>�Ķ���˼��</h2><p>ѧ����˼���裬˼����ѧ����</p><p>ѧϰ��˼�����ศ���ɵĽ������ϡ�</p><p>�࿴����������֪����Ҫ��������ƽʱ���������ڹ۲���˼����ϰ�ߣ����޷������յĸ�����֪ʶ�¹۵����ж���˼�����޷������������Լ��ܽ��ܵĺ���֮����Ҳ�޷�������˵���������ĵط����к������ɣ��Ǿͻ����ִ��ԡ�������������֢״�������㿴����Խ�࣬��������Խ�࣬����Խ��ã��Խ�����ʴӡ�</p><p>���ǽ�������ʱ���󲿷�����ѧϰ��·���������ĵط���</p><p>��������֦����˵����Ȼ�������ǹ������Ƕ���˼���������ܾ�������˵�ĺ��е������Ҿ�����Ҫ�����������㡣�������ף�����������������֪ʶ������˼άϰ����������֪�����ڱȽϵ͵Ĳ㼶���޷��Ա������߲㼶����֪�۵���������������</p><p>��������վ����άʱ�俴��άƽ�������ῴ��һ���������������������Լ���һ�������ڶ�ά��������ֽƬ�ˣ�����������Ŭ��������������ά�������������ˡ�</p><p>Ϊʲô�����ܳ����Ÿ���ҥ�ԣ�Ϊʲô��Щ�����ű��㽻����˰�ġ���ת�����й��ˡ�������������һ����һ��Ⱥ����������Ϊ�󲿷�����ȱ���㹻����֪ʶ������˼ά�������ֱ��Ƿ����١�</p><p>��������ָ�������²�˵�����ĺ��ķ�˿�����������˺�С�����꣬�������������Ǹ���ҥ�Ժ͡���ת�����й��ˡ���֧���ߺʹ����ߡ�</p><p>��Щ�ر����ױ����������ִ���ʽ����ƭ��ϴ�Ե��ˣ�������֪�����Ƚ������ˡ�</p><p>�����з�˿˵�ҵļ���/����/ͬѧ/ͬ��������ĳ����������ƭ��ϴ�ԣ���ȫ������������Ͷ��ȥ�ˣ���ô˵Ҳ˵��ͨ��������ô�졣</p><p>���ڡ����ģ�����һ��ƭ��Χ���������ˣ��ַ����������������������ش����������⣺��ֻ�ܽ��и����������գ��������Ź�򡢷Ƿ��н���</p><p>��Ϊ����ʵ������������֮���飬��֮�������ֳ��淽��ֻ����Щ��������ͬ��֪ˮƽ�������ã������ø�������û�ã�Ҫô������Ҫô�������ˣ�Ҫô�������</p><p>ǰ�����豻ײ������Ҳ�Ǻ������߰���ʵ����������û�ã� ֻ��һֽ��Ʊ�ĵ����ſڲŹ��á���֪���������µ�����֦�뿴���������豻ײ�������������߶�����һ�µ����½�չͨ������</p><p>��ά��������������������ά������ƽ���ˣ���֮ȴ���С���ά�ȵ���Ҫ�͵�ά�ȵ��˽���ֻ�ܱ��Ƚ�ά��</p><p>����Ҫ�����Լ�����֪������û��ʲô�ٳɰֻ࣬�н�һ���࿴���룬�����Ƕ࿴����ʱ���������ľ��䣬��������������֪Ч�ʣ���������֪ʶ������ˮ�ء�</p><p>����������ˮ�����ˣ�����ʲô��ӱ�����Ĺ۵����֣����Ͳ���һ��һէ�������е����ͻ����յ����ĳ������һ���Ŵ����Ĵ���������û����ֱ��������Ͱ��</p><hr><p>�һ����㣬ֻ�ǲ�����������ϵ��<br>ʱ�����ߣ��������ߡ�<br>��Щ���������ž���Ҳû��ϵ����Щ��˵���ټ�����Ҳ������<br>����ʱ��һֱ�ߵ���ô�죬���ǻ᲻�������䶼û��������<br>˵�õģ������ˡ�<br>�Һܺã���ô���أ�<br>��Щ�˕A���֣���Щ�����ˣ���Щ��ȴ����Զ�ǵá�<br>���磬�ЕA�ˣ��������޻���˵��<br>������ȴ�޻���˵��<br>������Ϥ�����ǣ��������������ǡ�<br>�㻹���㣬�һ����ң�ֻ�Ǳ���İ���ˡ�<br>��û����ôһ���ˣ�<br>��ɾ��ta��ȴ���������б���<br>Ȼ������Ҳ�������֡�<br>�����վ�����İ���ˣ�����ϵ�����ټ���<br>��ʱ������������Ҳֻ����������<br>��ʱ��ϲ��������Ҳֻ�ǲ�֪Ϊ�ε�һ����Ը��<br>����İ���ģ����������׵�ĳĳ��<br>�������仰ʱ�����������ĳ��λ�ã�ͻȻ�Ͳ�����һ�¡�<br>�㿴�����仰���ʺ����ǰ���<br>������������һ����ÿ�춼�ظ��š�<br>����ν�첻���֣��Ѳ��ѹ���<br>����Ī���ĸ裬����İ�����ˡ�<br>���ţ����š�<br>�ǲ��ǣ�����һ����Ҫ���ߣ�<br>����Ҳ�ã�����Ҳ�ա�<br>û��˭������Զ��˭�����ܻ��ڣ�����Ҫ������<br>̫�����£�������������ʱ��ȴ���ˣ�������׷���ϵġ�<br>������������Խ�����Լ��ͱ���Խ��Ĭ��<br>�������׸質�ģ�Խ����Խ�µ���Խ����Խ������<br>һ���˵�ʱ�������ᷢ�������������ĺܰ�����<br>���������˳�ӵ���Ľֵ����Ļ��ǻ��µ���<br>һ���ˣ�ϰ�߲�ϰ�ߵġ�<br>������ô������˵����Ҫ����Ե��<br>�Ż���ʶ���Ż�������<br>һ���˾��ˣ���Ҳ����ľ�ˡ�<br>��ʱ���ܻ����ú��ۣ�����Ϣ�������Ρ�<br>��Ϣʱ��ȴ�ֲ�֪����ʲô�ã�Ȼ����һ���ˡ�<br>��Ϊ�Ѿ�����ν�ˡ�<br>�ഺ���������ž͹��ˡ�<br>�����⣬�ŷ������Ƕ�������������<br>�ܶ��ºܶ��ˣ����˾��ǹ��ˣ����ٻ�����<br>���ԣ������ǻ����ᣬ���Լ������ģ����Լ������ģ���ϧ�ɣ�<br>�������У��˳���ôӵ����ȴ��ô�ա�<br>Խ������Խ�Ǽ�į�������Ƶ�·�������������У���Щ��į��Щ����������������<br>�⼸���������꣬����ҲԽ��Խ�䡣<br>һ���˱����Լ���Ȼ����ο��˵û��ϵ������ȥ�ġ�<br>����Ҫ�ģ���������������ů������ֻ��һ���򵥵��ʺ���<br>�����ˣ���ô��ͣ������������;�ķ羰��<br>������˳�ģ���ô��������Ϣ���úú������еĿ�����<br>���������ˣ���ô�ͷ��ˣ��������л������������ᷢ�ֺܶ����������㲻�������ġ�<br>���Լ��õ㣬��Ϊû�˻���ô���㣡<br>�����ǻ����ᣬ�����Ƕ����ڡ�<br>���Լ�ϲ�����£����Լ��������ˣ�ȥ�Լ���ȥ�ĵط���<br>��Ϊ��Ҳ���Ժ�������û�����ˡ�</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;�ǲ��ó����ˣ����������ļ�ʱ���ֵ�&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;�K���˼��&quot;&gt;&lt;a href=&quot;#�K���˼��&quot; class=&quot;headerlink&quot; title=&quot;�Ķ���˼��&quot;&gt;&lt;/a
      
    
    </summary>
    
      <category term="ѧϰ" scheme="http://shuaiyy.cn/categories/%D1%A7%CF%B0/"/>
    
      <category term="д��" scheme="http://shuaiyy.cn/categories/%D1%A7%CF%B0/%D0%B4%EF%BF%BD%EF%BF%BD/"/>
    
      <category term="�Ķ�" scheme="http://shuaiyy.cn/categories/%D1%A7%CF%B0/%D0%B4%EF%BF%BD%EF%BF%BD/%EF%BF%BDK%EF%BF%BD/"/>
    
    
  </entry>
  
  <entry>
    <title>技术面试题目收集</title>
    <link href="http://shuaiyy.cn/2018/06/03/%E6%8A%80%E6%9C%AF/%E6%8A%80%E6%9C%AF%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/"/>
    <id>http://shuaiyy.cn/2018/06/03/技术/技术面试题目收集/</id>
    <published>2018-06-02T16:00:00.000Z</published>
    <updated>2018-11-27T10:39:50.472Z</updated>
    
    <content type="html"><![CDATA[<h1 id="面试题收集"><a href="#面试题收集" class="headerlink" title="面试题收集"></a>面试题收集</h1><h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><ol><li><p>查看查询是否使用了索引</p><p><img src="http://img.shuaiyy.cn/blog/180503/mAmgLc8Id7.png?imageslim" alt="mark"></p></li><li><p>sql like与索引（后模糊匹配才能让索引有效）</p></li><li><p>全文索引与contains函数</p></li><li><p>索引的缺点：空间换时间，插入删除索引需要代价，因此需要合理设置索引</p></li><li><p>Mongodb的数据库优化、MongoDB建立索引</p></li><li><p>查询语句优化</p></li><li><p>建立索引</p><p>基础索引，单个field索引，组合索引，</p></li><li><p>聚集索引和非聚集索引？</p></li><li><p>索引类型，哈希，B+树的应用</p><p>​</p></li><li><p>SVN和Git的区别</p><p>SVN的优点：</p><p>1、采用集中式，易于权限管理，保证安全性；</p><p>2、代码的一致性高；</p><p>3、适合人数不多的项目开发；</p><p>SVN的缺点：</p><p>1、服务器压力太大，</p><p>2、必须连接在服务器上，否则基本不能工作、提交、对比、还原等；</p><p>3、不适合开源开发。</p><p>===========================</p><p>Git的优点：</p><p>1、适合分布式开发，公共的服务器压力小；</p><p>2、速度快， 成熟的架构，开发灵活；</p><p>3、任意两个开发者之间可以很容易的解决冲突，可以方便的版本回退；</p><p>4、离线工作开发，部署方便。</p><p>5、良好的分支机制，可以让主干代码保持干净。</p><p>Git的缺点：</p><p>1、学习成本比较大，学习周期比较长，要求人员素质比较高；</p><p>2、代码保密性差，一旦开发者把整个库克隆下来就可以完全公开所有代码和版本信息。</p></li></ol><p><strong>Linux:</strong></p><ol><li><p>十个常用的Linux命令</p><p>查看磁盘空间 <code>df -h</code></p><p>查看内存<code>free -h</code>    <code>cat /proc/meminfo</code></p></li><li><p>awk文本分割、查找</p></li></ol><p><strong>阿里面试题：</strong></p><ol><li><p>视频点播网站文件下载接口</p></li><li><p>基础变量/数组写出模拟maven导入包过程</p></li><li><p>50个白球50个红球，两个盒子，怎么放让人随机在一个盒子里抽到红球概率最高</p></li><li><p>有5个强盗分100枚金币，从1号开始进行分配，必须有半数服从分配才通过，否则1被毙掉，由2号开始分，问1号要怎样分才能使自己利益最大化？  要从后向前看。</p></li><li><p>n个数里取两个和为s的数</p></li><li><p>HashMap原理，自定义类型可以作为key吗？ rehash过程</p></li><li><p>HashMap和TreeMap、HashTable的区别</p></li><li><p>java内存模型 ， 垃圾回收算法，GC中可达性分析法，和引用计数法有什么不同？引用计数法有什么问题</p></li><li><p>JVM类加载机制</p></li><li><p>排序算法种类，以及快排的优化 ， Array.sort的排序方法，快速排序和堆排序的优缺点</p></li><li><p>Java多线程实现方式，多线程的同步措施，线程与进程的区别</p></li><li><p>操作系统同步方式、通信方式</p></li><li><p>计算机网络三次握手四次分手， wait_time的三种差别</p></li><li><p>Http Get和Post差别</p></li><li><p>https原理和加密过程，验证证书有效性</p></li><li><p>Java 64位指针的压缩</p></li><li><p>Java中锁的实现机制，种类</p></li><li><p>Java线程池达到提交上限的具体情况</p></li><li><p>Java如何定位内存泄露？</p></li><li><p>如何分析算法的时间复杂度？</p></li><li><p>如何判断链表是否有环路</p></li><li><p>数组中Arrays.sort的排序方法是什么？</p></li><li><p>快速排序和堆排序的优缺点</p><p>​</p></li><li><p>二分查找</p></li><li><p>堆排序</p></li><li><p>说一说GC算法。</p></li><li><p>怎么检测死锁。</p></li><li><p>说一说ThreadLocal关键字。</p></li><li><p>聚簇索引和非聚簇索引的区别。</p></li><li><p>线程池</p></li><li><p>​</p></li></ol><h2 id="JAVA"><a href="#JAVA" class="headerlink" title="JAVA"></a>JAVA</h2><h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><ol><li><p>Java集合有哪些？</p></li><li><p>ArrayList、Vector 以及 LinkedList的区别</p><p>ArrayList的默认初始长度是10</p></li><li><p>map， Hashmap和HashTable的区别</p></li><li><p>hashMap的底层数据结构，原理实现，如何扩容？</p></li><li><p>String的内存模型</p></li><li><p>Collection框架的结果</p><p>​</p></li></ol><h3 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h3><ol><li>有哪些设计模式</li><li>实现单例模式的几种方式</li><li>实现代理模式、工厂模式</li><li>观察者模式</li></ol><h3 id="线程和并发"><a href="#线程和并发" class="headerlink" title="线程和并发"></a>线程和并发</h3><ul><li><p>sleep让出cpu时间，但不放弃同步锁。wait放弃锁，线程进入等待notify唤醒。</p></li><li><p>volatile修饰的list是否是线程安全的？</p><p>不安全，修饰的是引用的可见性。</p><p>Volatile 变量具有 synchronized 的可见性特性，但是不具备原子特性。这就是说线程能够自动发现 volatile 变量的最新值。Volatile 变量可用于提供线程安全，但是只能应用于非常有限的一组用例：多个变量之间或者某个变量的当前值与修改后值之间没有约束。因此，单独使用 volatile 还不足以实现计数器、互斥锁或任何具有与多个变量相关的不变式（Invariants）的类。</p></li><li><p>创建线程的几种方法</p></li><li><p>线程同步的方式有哪些</p></li><li><p>Executor线程池用法</p></li><li><p>同步和异步的区别</p></li><li><p>线程安全的单例模式</p></li><li><p>如何实现Java线程池</p></li><li><p>ThreadLocal，ThreadLocalMap和HashMap的区别</p></li><li><p>ConcurrentHashMap的源码实现</p></li><li><p>Java进程间通信</p></li><li><p>对项目中的高并发如何解决？</p></li></ul><h3 id="虚拟机"><a href="#虚拟机" class="headerlink" title="虚拟机"></a>虚拟机</h3><ul><li><p>JVM分区</p></li><li><p>Myclass = new Myclass()在jvm中的内存分配</p></li><li><p>堆分区，新生代的GC动作如何触发？</p></li><li><p>垃圾回收时，哪些可以对象作为GCRoot？</p></li><li><p>单例模式</p></li><li><p>OOM的例子，如何导致OOM</p><p>堆上的OOM</p><p><img src="http://img.shuaiyy.cn/blog/180503/Ka5IcHc9Bm.png?imageslim" alt="mark"></p></li><li><p>如何导致持久代内存溢出</p></li><li><p>如何避免内存泄露</p></li><li><p>Java内存泄露和垃圾回收机制</p></li><li><p>Tomcat默认的GC回收方式？</p></li></ul><h3 id="框架"><a href="#框架" class="headerlink" title="框架"></a>框架</h3><ol><li><p>Mybatis或Hibernate的原理</p></li><li><p>Servlet生命周期</p></li><li><p>Spring依赖注入的原理</p></li><li><p>Spring AOP是如何实现的</p></li><li><p>Spring的启动初始化流程和依赖注入流程， 互相依赖是怎么处理的？</p></li><li><p>SpringMVC的工作流程</p><p><img src="http://img.shuaiyy.cn/blog/180503/B0h68K4g36.png?imageslim" alt="mark"></p></li><li><p>Spring的线程池</p></li><li><p>Spring的事务隔离和传播机制</p></li><li><p>Maven的作用</p></li><li><p>Tomcat的架构和请求处理流程</p></li><li><p>redis源码阅读</p></li><li><p>负载均衡解决方案</p></li><li><p>缓存解决方案</p></li><li><p>memcache的一致性hash</p></li></ol><h2 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h2><ol><li><p>有哪些排序算法？复杂度和稳定性</p><ul><li><p>快排</p><p><img src="http://img.shuaiyy.cn/blog/180503/DaAa97g45C.png?imageslim" alt="mark"></p></li></ul></li><li><p>红黑树和平衡二叉树</p></li></ol><h1 id="编程题"><a href="#编程题" class="headerlink" title="编程题"></a>编程题</h1><ol><li><p>连续子数组的最大和 </p><p>包含负数</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">findMaxSum</span> </span>&#123;  </div><div class="line">      </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">FindGreatestSumOfSubArray</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;  </div><div class="line">          </div><div class="line">        <span class="keyword">if</span>(array == <span class="keyword">null</span> || (array.length == <span class="number">1</span> &amp;&amp; array[<span class="number">0</span>] &lt;= <span class="number">0</span>))  </div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">          </div><div class="line">        <span class="keyword">int</span> cur = array[<span class="number">0</span>];  </div><div class="line">        <span class="keyword">int</span> sum = array[<span class="number">0</span>];  </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; array.length;i++)&#123;  </div><div class="line">            <span class="keyword">if</span>(cur &lt; <span class="number">0</span>)  </div><div class="line">                cur = <span class="number">0</span>;  </div><div class="line">            cur = cur + array[i];  </div><div class="line">            <span class="keyword">if</span>(sum &lt;= cur)  </div><div class="line">                sum = cur;  </div><div class="line">        &#125;         </div><div class="line">        <span class="keyword">return</span> sum;  </div><div class="line">    &#125;  </div><div class="line">      </div><div class="line">    <span class="comment">//用动态规划  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">FindGreatestSumOfSubArray2</span><span class="params">(<span class="keyword">int</span>[] arr,<span class="keyword">int</span> n)</span></span>&#123;  </div><div class="line">        <span class="keyword">int</span> sum = arr[<span class="number">0</span>];  </div><div class="line">        <span class="keyword">int</span> max = arr[<span class="number">0</span>];  </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;  </div><div class="line">            sum = getMax(sum+arr[i],arr[i]);  </div><div class="line">            <span class="keyword">if</span>(sum &gt;= max)  </div><div class="line">                max = sum;  </div><div class="line">        &#125;  </div><div class="line">          </div><div class="line">        <span class="keyword">return</span> max;  </div><div class="line">    &#125;  </div><div class="line">      </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMax</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;  </div><div class="line">        <span class="keyword">return</span> a &gt; b ? a: b;  </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>反转链表</p></li><li><p>用两个栈实现队列</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">* 入队只进stack1， 出队只从stack2 pop</span></div><div class="line"><span class="comment">* stack2为空时，从stack1 取出数据压入 stack2。</span></div><div class="line"><span class="comment">**/</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StackQueue</span> </span>&#123;</div><div class="line">    </div><div class="line">    Stack&lt;Integer&gt; stack1 = <span class="keyword">new</span> Stack&lt;Integer&gt;();</div><div class="line">    Stack&lt;Integer&gt; stack2 = <span class="keyword">new</span> Stack&lt;Integer&gt;();</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> node)</span></span>&#123;</div><div class="line">        </div><div class="line">        stack1.push(node);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">pop</span><span class="params">()</span></span>&#123;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span>(stack2.empty())&#123;</div><div class="line">            <span class="keyword">while</span>(!stack1.empty())</div><div class="line">                stack2.push(stack1.pop());</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> stack2.pop();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>字符的集合<br>题目描述：输入一个字符串，求出该字符串包含的字符集合</p><p>输入描述：每组数据输入一个字符串，字符串最大长度为100，且只包含字母，不可能为空串，区分大小写。</p><p>输出描述：每组数据一行，按字符串原有的字符顺序，输出字符集合，即重复出现并靠后的字母不输出。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">*  1. 使用字典判断是否重复出现</span></div><div class="line"><span class="comment">*  2. 使用列表记录第一次出现的key值顺序</span></div><div class="line"><span class="comment">**/</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>（美团）二维数组打印 题目描述：</p><p>有一个二维数组(n*n),写程序实现从右上角到左下角沿主对角线方向打印。</p><p>给定一个二位数组arr及题目中的参数n，请返回结果数组。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> *  题意很简单，主要是边界的处理：</span></div><div class="line"><span class="comment"> *   1. 沿着主对角线打印，所以每次打印之后x与y都要加1，直到x或y超出边界。</span></div><div class="line"><span class="comment"> *   2. 每轮遍历的起始点，是遵循(0,n-1)...（0,0）...（n-1,0）。</span></div><div class="line"><span class="comment">  *           也就是y先减小到0，然后x增加到n-1。所以遍历的终止条件是startX&gt;=n。 *</span></div><div class="line"><span class="comment"> **/</span></div><div class="line"><span class="keyword">import</span> java.util.*;</div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Printer</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] arrayPrint(<span class="keyword">int</span>[][] arr, <span class="keyword">int</span> n) &#123;</div><div class="line">        <span class="comment">// write code here</span></div><div class="line">        <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[n*n];</div><div class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> startX = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> startY = n-<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span>(startX&lt;n)&#123;</div><div class="line">            <span class="keyword">int</span> x = startX;</div><div class="line">            <span class="keyword">int</span> y = startY;</div><div class="line">            <span class="keyword">while</span>(x&lt;n&amp;&amp;y&lt;n)</div><div class="line">                res[index++]=arr[x++][y++];</div><div class="line">            <span class="keyword">if</span>(startY&gt;<span class="number">0</span>)</div><div class="line">                startY--;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                startX++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>（去哪儿）表达式合法判断</p><p>题目描述：<br>写一段代码，判断一个包括’{‘,’[‘,’(‘,’)’,’]’,’}’的表达式是否合法(注意看样例的合法规则。)<br>给定一个表达式A,请返回一个bool值，代表它是否合法。</p></li><li><p>（奇虎360）挑选镇长</p><p>题目描述：<br>360员工桂最近申请了一个长假，一个人背着包出去自助游了。<br>路上，他经过了一个小镇，发现小镇的人们都围在一棵树下争吵。桂上前询问情况，得知小镇的人们正缺一个镇长，他们希望能选一个知名又公正的镇长，即，大家希望能选出一个人，所有人都认识他，但同时他不认识镇上除自己以外的其他人（在此，我们默认每个人自己认识自己）。可是小镇里的人太多了，一下子大家谁也说服不了谁。<br> “这简单啊。”桂表示。于是他一下子统计出来了镇上人们相互之间的认识关系，并且一下子找到了合适的镇长人选。<br>现在你手上也拿到了这样一份认识关系的清单。其中上面给出的认识关系是单向的，即，A认识B与B认识A是相互独立的，只给出A认识B就不能认为B认识A，例如，我认识你，你不一定认识我。而且，这里的认识关系也不具有传递性，即，A认识B，B认识C，但这不代表A认识C。同时，为了方便处理，这份清单中，镇上的N个人依次编号为1到N。你能否像桂一样快速找到合适的镇长人选呢？</p><p>输入描述：<br>首先一个正整数T（T≤20），表示数据组数。<br>之后每组数据的第一行有2个整数n  和m  (1≤n≤105 ,0≤m≤3×105 )，依次表示镇上的人数和相互之间的认识关系数。<br>之后m行，第 i 行每行两个数Ai和Bi   (1≤Ai ,Bi ≤n  )，表示Ai认识Bi。（保证没有重复的认识关系，但可能存在自己认识自己的认识关系）<br>保证所有数据中80%的数据满足n≤1000,m≤10000</p><p>输出描述：<br>一共2T 行，每组数据对应2行。<br>第一行，一个整数，表示你所找出来的合适的镇长人选人数num i   。<br>第二行，num i 个整数，每两个数中间用空格隔开，表示你所选的合适的镇长的编号。<br>特别的，如果并没有找到合适的镇长，第一行输出一个数0，第二行留空即可（参见样例）。</p></li><li><p>（华为）字符集合</p><p>题目描述：<br>输入一个字符串，求出该字符串包含的字符集合</p><p>输入描述：<br>每组数据输入一个字符串，字符串最大长度为100，且只包含字母，不可能为空串，区分大小写。</p><p>输出描述：<br>每组数据一行，按字符串原有的字符顺序，输出字符集合，即重复出现并靠后的字母不输出。</p></li><li><p>1 1 1 2 3的所有组合</p></li><li><p>m以内的素数</p></li><li><p>递归求阶乘</p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;面试题收集&quot;&gt;&lt;a href=&quot;#面试题收集&quot; class=&quot;headerlink&quot; title=&quot;面试题收集&quot;&gt;&lt;/a&gt;面试题收集&lt;/h1&gt;&lt;h2 id=&quot;数据库&quot;&gt;&lt;a href=&quot;#数据库&quot; class=&quot;headerlink&quot; title=&quot;数据库&quot;&gt;&lt;/
      
    
    </summary>
    
      <category term="学习" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="求职" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/"/>
    
      <category term="面试" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/%E9%9D%A2%E8%AF%95/"/>
    
    
      <category term="求职" scheme="http://shuaiyy.cn/tags/%E6%B1%82%E8%81%8C/"/>
    
      <category term="面试" scheme="http://shuaiyy.cn/tags/%E9%9D%A2%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>LeetCode Python题解</title>
    <link href="http://shuaiyy.cn/2018/05/06/%E5%AD%A6%E4%B9%A0/%E6%89%BE%E5%B7%A5%E4%BD%9C/LeetCode%20Python%E9%A2%98%E8%A7%A3/"/>
    <id>http://shuaiyy.cn/2018/05/06/学习/找工作/LeetCode Python题解/</id>
    <published>2018-05-05T16:00:00.000Z</published>
    <updated>2018-11-27T10:32:48.305Z</updated>
    
    <content type="html"><![CDATA[<p><strong>已经放弃使用Python，转向Java了</strong></p><ul><li>Python的语言特性使得很多问题有简洁、巧妙却不通用的解法</li><li>Python的性能低，很多答案无法通过OJ的时间限制</li><li>我参考的算法书给出的是Java代码</li></ul><h2 id="LeetCode刷题之旅"><a href="#LeetCode刷题之旅" class="headerlink" title="LeetCode刷题之旅"></a>LeetCode刷题之旅</h2><h3 id="1-Two-Sum"><a href="#1-Two-Sum" class="headerlink" title="1. Two Sum"></a>1. Two Sum</h3><ul><li>Difficulty: <strong>Easy</strong></li></ul><p>Given an array of integers, return <strong>indices</strong> of the two numbers such that they add up to a specific target.</p><p>You may assume that each input would have <strong>exactly</strong> one solution, and you may not use the <em>same</em> element twice.</p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Given nums = [2, 7, 11, 15], target = 9,</div><div class="line"></div><div class="line">Because nums[0] + nums[1] = 2 + 7 = 9,</div><div class="line">return [0, 1].</div></pre></td></tr></table></figure><p><strong>Solution：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(self, nums, target)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line"><span class="string">        :type nums: List[int]</span></div><div class="line"><span class="string">        :type target: int</span></div><div class="line"><span class="string">        :rtype: List[int]</span></div><div class="line"><span class="string">        """</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)<span class="number">-1</span>):</div><div class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, len(nums)):</div><div class="line">                <span class="keyword">if</span> nums[i] + nums[j] == target:</div><div class="line">                    <span class="keyword">return</span> [i, j]</div></pre></td></tr></table></figure><p><strong>Better Solution:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(self, nums, target)</span>:</span></div><div class="line">        <span class="keyword">if</span> len(nums) &lt;= <span class="number">1</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">        buff_dict = &#123;&#125;</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</div><div class="line">            <span class="keyword">if</span> nums[i] <span class="keyword">in</span> buff_dict:</div><div class="line">                <span class="keyword">return</span> [buff_dict[nums[i]], i]</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                buff_dict[target - nums[i]] = i</div></pre></td></tr></table></figure><h3 id="2-Add-Two-Numbers"><a href="#2-Add-Two-Numbers" class="headerlink" title="2.Add Two Numbers"></a>2.Add Two Numbers</h3><p>You are given two <strong>non-empty</strong> linked lists representing two non-negative integers. The digits are stored in reverse order and each of their nodes contain a single digit. Add the two numbers and return it as a linked list.</p><p>You may assume the two numbers do not contain any leading zero, except the number 0 itself.</p><p><strong>Input:</strong> (2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)<br><strong>Output:</strong> 7 -&gt; 0 -&gt; 8</p><p>两个用链表表示的逆序整数求和</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Definition for singly-linked list.</span></div><div class="line"><span class="comment"># class ListNode(object):</span></div><div class="line"><span class="comment">#     def __init__(self, x):</span></div><div class="line"><span class="comment">#         self.val = x</span></div><div class="line"><span class="comment">#         self.next = None</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span><span class="params">(self, l1, l2)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line"><span class="string">        :type l1: ListNode</span></div><div class="line"><span class="string">        :type l2: ListNode</span></div><div class="line"><span class="string">        :rtype: ListNode</span></div><div class="line"><span class="string">        """</span></div><div class="line">        x1 = <span class="number">0</span></div><div class="line">        x2 = <span class="number">0</span></div><div class="line">        s1 = []</div><div class="line">        s2 = []</div><div class="line">        ans = []</div><div class="line">        <span class="keyword">while</span>(l1):</div><div class="line">            s1.append(l1.val)</div><div class="line">            l1 = l1.next</div><div class="line">        <span class="keyword">while</span>(l2):</div><div class="line">            s2.append(l2.val)</div><div class="line">            l2 = l2.next</div><div class="line">   </div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> s1[::<span class="number">-1</span>]:</div><div class="line">            x1 = x1 * <span class="number">10</span> + i</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> s2[::<span class="number">-1</span>]:</div><div class="line">            x2 = x2*<span class="number">10</span> + i</div><div class="line">        x3 = x1 + x2</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> x3&lt;<span class="number">10</span>:</div><div class="line">            <span class="keyword">return</span> ListNode(x3)</div><div class="line">        </div><div class="line">        <span class="keyword">while</span>(x3 &gt; <span class="number">0</span>):</div><div class="line">            ans.append(ListNode(x3 % <span class="number">10</span>))</div><div class="line">            x3 = x3 // <span class="number">10</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(ans)<span class="number">-1</span>):</div><div class="line">            ans[i].next = ans[i+<span class="number">1</span>]</div><div class="line">        <span class="keyword">return</span> ans[<span class="number">0</span>]</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Definition for singly-linked list.</span></div><div class="line"><span class="comment"># class ListNode(object):</span></div><div class="line"><span class="comment">#     def __init__(self, x):</span></div><div class="line"><span class="comment">#         self.val = x</span></div><div class="line"><span class="comment">#         self.next = None</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span><span class="params">(self, l1, l2)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line"><span class="string">        :type l1: ListNode</span></div><div class="line"><span class="string">        :type l2: ListNode</span></div><div class="line"><span class="string">        :rtype: ListNode</span></div><div class="line"><span class="string">        """</span></div><div class="line">        l = p = ListNode(<span class="number">0</span>)</div><div class="line">        inc = <span class="number">0</span></div><div class="line">        <span class="keyword">while</span>(l1 <span class="keyword">or</span> l2):</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> l1:</div><div class="line">                q = ListNode(l2.val + inc)</div><div class="line">                l2 = l2.next</div><div class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> l2:</div><div class="line">                q = ListNode(l1.val + inc)</div><div class="line">                l1 = l1.next</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                q = ListNode(l1.val + l2.val + inc)</div><div class="line">                l1 = l1.next</div><div class="line">                l2 = l2.next</div><div class="line">            <span class="keyword">if</span> q.val &gt; <span class="number">9</span>:</div><div class="line">                inc = <span class="number">1</span></div><div class="line">                q.val = q.val % <span class="number">10</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                inc = <span class="number">0</span></div><div class="line">            p.next = q</div><div class="line">            p = p.next</div><div class="line">        <span class="keyword">if</span> inc &gt; <span class="number">0</span> :</div><div class="line">            q = ListNode(inc)</div><div class="line">            p.next = q</div><div class="line">            p = p.next</div><div class="line">        <span class="keyword">return</span> l.next</div></pre></td></tr></table></figure><h3 id="7-Reverse-digits-of-an-integer"><a href="#7-Reverse-digits-of-an-integer" class="headerlink" title="7.Reverse digits of an integer."></a>7.Reverse digits of an integer.</h3><p><strong>Example1:</strong> x = 123, return 321<br><strong>Example2:</strong> x = -123, return -321</p><p><strong>Note:</strong><br>The input is assumed to be a 32-bit signed integer. Your function should <strong>return 0 when the reversed integer overflows</strong>.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverse</span><span class="params">(self, x)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line"><span class="string">        :type x: int</span></div><div class="line"><span class="string">        :rtype: int</span></div><div class="line"><span class="string">        """</span></div><div class="line">        <span class="keyword">if</span> x &gt;= <span class="number">0</span>:</div><div class="line">            x = int(str(x)[::<span class="number">-1</span>])</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            x = <span class="number">0</span> - int(str(-x)[::<span class="number">-1</span>])</div><div class="line">        <span class="keyword">if</span> (x &gt; <span class="number">0x7FFFFFFF</span>) <span class="keyword">or</span> (x &lt; <span class="number">-0x80000000</span>):</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span></div><div class="line">        <span class="keyword">return</span> x</div></pre></td></tr></table></figure><h3 id="9-Palindrome-Number"><a href="#9-Palindrome-Number" class="headerlink" title="9. Palindrome Number"></a>9. Palindrome Number</h3><p>回文数字</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isPalindrome</span><span class="params">(self, x)</span>:</span></div><div class="line">        s = str(x)</div><div class="line">        <span class="keyword">if</span> s == s[::<span class="number">-1</span>]:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">        <span class="string">"""</span></div><div class="line"><span class="string">        :type x: int</span></div><div class="line"><span class="string">        :rtype: bool</span></div><div class="line"><span class="string">        """</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;已经放弃使用Python，转向Java了&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Python的语言特性使得很多问题有简洁、巧妙却不通用的解法&lt;/li&gt;
&lt;li&gt;Python的性能低，很多答案无法通过OJ的时间限制&lt;/li&gt;
&lt;li&gt;我参考的算法书给出的
      
    
    </summary>
    
      <category term="学习" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="求职" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/"/>
    
      <category term="算法" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="求职" scheme="http://shuaiyy.cn/tags/%E6%B1%82%E8%81%8C/"/>
    
      <category term="刷题" scheme="http://shuaiyy.cn/tags/%E5%88%B7%E9%A2%98/"/>
    
      <category term="LeetCode" scheme="http://shuaiyy.cn/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>LeetCode Java题解</title>
    <link href="http://shuaiyy.cn/2018/05/03/%E5%AD%A6%E4%B9%A0/%E6%89%BE%E5%B7%A5%E4%BD%9C/Leetcode%20Java%E9%A2%98%E8%A7%A3/"/>
    <id>http://shuaiyy.cn/2018/05/03/学习/找工作/Leetcode Java题解/</id>
    <published>2018-05-02T16:00:00.000Z</published>
    <updated>2018-11-27T10:28:33.314Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Awesome-Java-Leetcode"><a href="#Awesome-Java-Leetcode" class="headerlink" title="Awesome Java Leetcode"></a>Awesome Java Leetcode</h1><p>镇楼诗：</p><blockquote><p>明有科举八股，今有 LeetCode。<br>八股定格式而取文采心意，LeetCode 定题目且重答案背诵。<br>美其名曰：”practice makes perfect.”<br>为何今不如古？<br>非也非也，<br>科举为国取士，LeetCode 为 Google 筛码工，各取所需也。  </p></blockquote><h2 id="Easy"><a href="#Easy" class="headerlink" title="Easy"></a>Easy</h2><table><thead><tr><th style="text-align:left">#</th><th style="text-align:left">Title</th><th style="text-align:left">Tag</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:left">Two Sum</td><td style="text-align:left">Array, Hash Table</td></tr><tr><td style="text-align:left">7</td><td style="text-align:left">Reverse Integer</td><td style="text-align:left">Math</td></tr><tr><td style="text-align:left">9</td><td style="text-align:left">Palindrome Number</td><td style="text-align:left">Math</td></tr><tr><td style="text-align:left">13</td><td style="text-align:left">Roman to Integer</td><td style="text-align:left">Math, String</td></tr><tr><td style="text-align:left">14</td><td style="text-align:left">Longest Common Prefix</td><td style="text-align:left">String</td></tr><tr><td style="text-align:left">20</td><td style="text-align:left">Valid Parentheses</td><td style="text-align:left">Stack, String</td></tr><tr><td style="text-align:left">21</td><td style="text-align:left">Merge Two Sorted Lists</td><td style="text-align:left">Linked List</td></tr><tr><td style="text-align:left">26</td><td style="text-align:left">Remove Duplicates from Sorted Array</td><td style="text-align:left">Array, Two Pointers</td></tr><tr><td style="text-align:left">27</td><td style="text-align:left">Remove Element</td><td style="text-align:left">Array, Two Pointers</td></tr><tr><td style="text-align:left">28</td><td style="text-align:left">Implement strStr()</td><td style="text-align:left">Two Pointers, String</td></tr><tr><td style="text-align:left">35</td><td style="text-align:left">Search Insert Position</td><td style="text-align:left">String</td></tr><tr><td style="text-align:left">38</td><td style="text-align:left">Count and Say</td><td style="text-align:left">String</td></tr><tr><td style="text-align:left">53</td><td style="text-align:left">Maximum Subarray</td><td style="text-align:left">Array, Divide and Conquer, Dynamic Programming</td></tr><tr><td style="text-align:left">58</td><td style="text-align:left">Length of Last Word</td><td style="text-align:left">String</td></tr><tr><td style="text-align:left">66</td><td style="text-align:left">Plus One</td><td style="text-align:left">Array, Math</td></tr><tr><td style="text-align:left">67</td><td style="text-align:left">Add Binary</td><td style="text-align:left">Math, String</td></tr><tr><td style="text-align:left">69</td><td style="text-align:left">Sqrt(x)</td><td style="text-align:left">Binary Search, Math</td></tr><tr><td style="text-align:left">70</td><td style="text-align:left">Climbing Stairs</td><td style="text-align:left">Dynamic Programming</td></tr><tr><td style="text-align:left">83</td><td style="text-align:left">Remove Duplicates from Sorted List</td><td style="text-align:left">Linked List</td></tr><tr><td style="text-align:left">88</td><td style="text-align:left">Merge Sorted Array</td><td style="text-align:left">Array, Two Pointers</td></tr><tr><td style="text-align:left">100</td><td style="text-align:left">Same Tree</td><td style="text-align:left">Tree, Depth-first Search</td></tr><tr><td style="text-align:left">101</td><td style="text-align:left">Symmetric Tree</td><td style="text-align:left">Tree, Depth-first Search, Breadth-first Search</td></tr><tr><td style="text-align:left">104</td><td style="text-align:left">Maximum Depth of Binary Tree</td><td style="text-align:left">Tree, Depth-first Search</td></tr><tr><td style="text-align:left">107</td><td style="text-align:left">Binary Tree Level Order Traversal II</td><td style="text-align:left">Tree, Breadth-first Search</td></tr><tr><td style="text-align:left">108</td><td style="text-align:left">Convert Sorted Array to Binary Search Tree</td><td style="text-align:left">Tree, Depth-first Search</td></tr><tr><td style="text-align:left">110</td><td style="text-align:left">Balanced Binary Tree</td><td style="text-align:left">Tree, Depth-first Search</td></tr><tr><td style="text-align:left">111</td><td style="text-align:left">Minimum Depth of Binary Tree</td><td style="text-align:left">Tree, Depth-first Search, Breadth-first Search</td></tr><tr><td style="text-align:left">112</td><td style="text-align:left">Path Sum</td><td style="text-align:left">Tree, Depth-first Search</td></tr><tr><td style="text-align:left">118</td><td style="text-align:left">Pascal’s Triangle</td><td style="text-align:left">Array</td></tr><tr><td style="text-align:left">119</td><td style="text-align:left">Pascal’s Triangle II</td><td style="text-align:left">Array</td></tr><tr><td style="text-align:left">121</td><td style="text-align:left">Best Time to Buy and Sell Stock</td><td style="text-align:left">Array, Dynamic Programmin</td></tr><tr><td style="text-align:left">122</td><td style="text-align:left">Best Time to Buy and Sell Stock II</td><td style="text-align:left">Array, Greedy</td></tr><tr><td style="text-align:left">543</td><td style="text-align:left">Diameter of Binary Tree</td><td style="text-align:left">Tree</td></tr></tbody></table><h2 id="Medium"><a href="#Medium" class="headerlink" title="Medium"></a>Medium</h2><table><thead><tr><th style="text-align:left">#</th><th style="text-align:left">Title</th><th style="text-align:left">Tag</th></tr></thead><tbody><tr><td style="text-align:left">2</td><td style="text-align:left">Add Two Numbers</td><td style="text-align:left">Linked List, Math</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">Longest Substring Without Repeating Characters</td><td style="text-align:left">Hash Table, Two Pointers, String</td></tr><tr><td style="text-align:left">5</td><td style="text-align:left">Longest Palindromic Substring</td><td style="text-align:left">String</td></tr><tr><td style="text-align:left">6</td><td style="text-align:left">ZigZag Conversion</td><td style="text-align:left">String</td></tr><tr><td style="text-align:left">8</td><td style="text-align:left">String to Integer (atoi)</td><td style="text-align:left">Math, String</td></tr><tr><td style="text-align:left">11</td><td style="text-align:left">Container With Most Water</td><td style="text-align:left">Array, Two Pointers</td></tr><tr><td style="text-align:left">12</td><td style="text-align:left">Integer to Roman</td><td style="text-align:left">Math, String</td></tr><tr><td style="text-align:left">15</td><td style="text-align:left">3Sum</td><td style="text-align:left">Array, Two Pointers</td></tr><tr><td style="text-align:left">16</td><td style="text-align:left">3Sum Closest</td><td style="text-align:left">Array, Two Pointers</td></tr><tr><td style="text-align:left">17</td><td style="text-align:left">Letter Combinations of a Phone Number</td><td style="text-align:left">String, Backtracking</td></tr><tr><td style="text-align:left">18</td><td style="text-align:left">4Sum</td><td style="text-align:left">Array, Hash Table, Two Pointers</td></tr><tr><td style="text-align:left">19</td><td style="text-align:left">Remove Nth Node From End of List</td><td style="text-align:left">Linked List, Two Pointers</td></tr><tr><td style="text-align:left">22</td><td style="text-align:left">Generate Parentheses</td><td style="text-align:left">String, Backtracking</td></tr><tr><td style="text-align:left">24</td><td style="text-align:left">Swap Nodes in Pairs</td><td style="text-align:left">Linked List</td></tr><tr><td style="text-align:left">29</td><td style="text-align:left">Divide Two Integers</td><td style="text-align:left">Math, Binary Search</td></tr><tr><td style="text-align:left">33</td><td style="text-align:left">Search in Rotated Sorted Array</td><td style="text-align:left">Arrays, Binary Search</td></tr><tr><td style="text-align:left">43</td><td style="text-align:left">Multiply Strings</td><td style="text-align:left">Math, String</td></tr><tr><td style="text-align:left">49</td><td style="text-align:left">Group Anagrams</td><td style="text-align:left">Hash Table, String</td></tr><tr><td style="text-align:left">50</td><td style="text-align:left">Pow(x, n)</td><td style="text-align:left">Math, Binary Search</td></tr><tr><td style="text-align:left">56</td><td style="text-align:left">Merge Intervals</td><td style="text-align:left">Array, Sort</td></tr><tr><td style="text-align:left">554</td><td style="text-align:left">Brick Wall</td><td style="text-align:left">Hash Table</td></tr></tbody></table><h2 id="Hard"><a href="#Hard" class="headerlink" title="Hard"></a>Hard</h2><table><thead><tr><th style="text-align:left">#</th><th style="text-align:left">Title</th><th style="text-align:left">Tag</th></tr></thead><tbody><tr><td style="text-align:left">4</td><td style="text-align:left">Median of Two Sorted Arrays</td><td style="text-align:left">Array, Binary Search, Divide and Conquer</td></tr><tr><td style="text-align:left">10</td><td style="text-align:left">Regular Expression Matching</td><td style="text-align:left">String, Dynamic Programming, Backtracking</td></tr><tr><td style="text-align:left">23</td><td style="text-align:left">Merge k Sorted Lists</td><td style="text-align:left">Linked List, Divide and Conquer, Heap</td></tr><tr><td style="text-align:left">25</td><td style="text-align:left">Reverse Nodes in k-Group</td><td style="text-align:left">Linked List</td></tr><tr><td style="text-align:left">44</td><td style="text-align:left">Wildcard Matching</td><td style="text-align:left">String, Dynamic Programming, Backtracking, Greedy</td></tr><tr><td style="text-align:left">57</td><td style="text-align:left">Insert Interval</td><td style="text-align:left">Array, Sort</td></tr><tr><td style="text-align:left">68</td><td style="text-align:left">Text Justification</td><td style="text-align:left">String</td></tr></tbody></table><h1 id="001-Two-Sum"><a href="#001-Two-Sum" class="headerlink" title="001 Two Sum"></a><a href="#">001 Two Sum</a></h1><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>Given an array of integers, return <strong>indices</strong> of the two numbers such that they add up to a specific target.</p><p>You may assume that each input would have <strong><em>exactly</em></strong> one solution, and you may not use the same element twice.</p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Given nums = [2, 7, 11, 15], target = 9,</div><div class="line"></div><div class="line">Because nums[0] + nums[1] = 2 + 7 = 9,</div><div class="line">return [0, 1].</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Array, Hash Table</p><h2 id="思路-0"><a href="#思路-0" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是让你从给定的数组中找到两个元素的和为指定值的两个索引，最容易的当然是循环两次，复杂度为 <code>O(n^2)</code>，首次提交居然是 2ms，打败了 100% 的提交，谜一样的结果，之后再次提交就再也没跑到过 2ms 了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] twoSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; nums.length; ++j) &#123;</div><div class="line">                <span class="keyword">if</span> (nums[i] + nums[j] == target) &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i, j&#125;;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1"><a href="#思路-1" class="headerlink" title="思路 1"></a>思路 1</h2><p>利用 HashMap 作为存储，键为目标值减去当前元素值，索引为值，比如 <code>i = 0</code> 时，此时首先要判断 <code>nums[0] = 2</code> 是否在 map 中，如果不存在，那么插入键值对 <code>key = 9 - 2 = 7, value = 0</code>，之后当 <code>i = 1</code> 时，此时判断 <code>nums[1] = 7</code> 已存在于 map 中，那么取出该 <code>value = 0</code> 作为第一个返回值，当前 <code>i</code> 作为第二个返回值，具体代码如下所示。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] twoSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</div><div class="line">        <span class="keyword">int</span> len = nums.length;</div><div class="line">        HashMap&lt;Integer, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</div><div class="line">            <span class="keyword">if</span> (map.containsKey(nums[i])) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;map.get(nums[i]), i&#125;;</div><div class="line">            &#125;</div><div class="line">            map.put(target - nums[i], i);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="002-Add-Two-Numbers"><a href="#002-Add-Two-Numbers" class="headerlink" title="002 Add Two Numbers"></a><a href="#">002 Add Two Numbers</a></h1><h2 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h2><p>You are given two <strong>non-empty</strong> linked lists representing two non-negative integers. The digits are stored in <strong>reverse order</strong> and each of their nodes contain a single digit. Add the two numbers and return it as a linked list.</p><p>You may assume the two numbers do not contain any leading zero, except the number 0 itself.</p><p><strong>Example</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Input: (2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)</div><div class="line">Output: 7 -&gt; 0 -&gt; 8</div><div class="line">Explanation: 342 + 465 = 807.</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Linked List, Math</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>题意我也是看了好久才看懂，就是以链表表示一个数，低位在前，高位在后，所以题中的例子就是 <code>342 + 465 = 807</code>，所以我们模拟计算即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for singly-linked list.</span></div><div class="line"><span class="comment"> * public class ListNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     ListNode next;</span></div><div class="line"><span class="comment"> *     ListNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">addTwoNumbers</span><span class="params">(ListNode l1, ListNode l2)</span> </span>&#123;</div><div class="line">        ListNode node = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">        ListNode n1 = l1, n2 = l2, t = node;</div><div class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (n1 != <span class="keyword">null</span> || n2 != <span class="keyword">null</span>) &#123;</div><div class="line">            sum /= <span class="number">10</span>;</div><div class="line">            <span class="keyword">if</span> (n1 != <span class="keyword">null</span>) &#123;</div><div class="line">                sum += n1.val;</div><div class="line">                n1 = n1.next;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (n2 != <span class="keyword">null</span>) &#123;</div><div class="line">                sum += n2.val;</div><div class="line">                n2 = n2.next;</div><div class="line">            &#125;</div><div class="line">            t.next = <span class="keyword">new</span> ListNode(sum % <span class="number">10</span>);</div><div class="line">            t = t.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (sum / <span class="number">10</span> != <span class="number">0</span>) t.next = <span class="keyword">new</span> ListNode(<span class="number">1</span>);</div><div class="line">        <span class="keyword">return</span> node.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="003-Longest-Substring-Without-Repeating-Characters"><a href="#003-Longest-Substring-Without-Repeating-Characters" class="headerlink" title="003 Longest Substring Without Repeating Characters"></a><a href="#">003 Longest Substring Without Repeating Characters</a></h1><h2 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h2><p>Given a string, find the length of the <strong>longest substring</strong> without repeating characters.</p><p><strong>Examples:</strong></p><p>Given <code>&quot;abcabcbb&quot;</code>, the answer is <code>&quot;abc&quot;</code>, which the length is 3.</p><p>Given <code>&quot;bbbbb&quot;</code>, the answer is <code>&quot;b&quot;</code>, with the length of 1.</p><p>Given <code>&quot;pwwkew&quot;</code>, the answer is <code>&quot;wke&quot;</code>, with the length of 3. Note that the answer must be a <strong>substring</strong>, <code>&quot;pwke&quot;</code> is a <em>subsequence</em> and not a substring.</p><p><strong>Tags:</strong> Hash Table, Two Pointers, String</p><h2 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h2><p>题意是计算不带重复字符的最长子字符串的长度，开辟一个 hash 数组来存储该字符上次出现的位置，比如 <code>hash[a] = 3</code> 就是代表 <code>a</code> 字符前一次出现的索引在 3，遍历该字符串，获取到上次出现的最大索引（只能向前，不能退后），与当前的索引做差获取的就是本次所需长度，从中迭代出最大值就是最终答案。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> len;</div><div class="line">        <span class="keyword">if</span> (s == <span class="keyword">null</span> || (len = s.length()) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> preP = <span class="number">0</span>, max = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span>[] hash = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">128</span>];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</div><div class="line">            <span class="keyword">char</span> c = s.charAt(i);</div><div class="line">            <span class="keyword">if</span> (hash[c] &gt; preP) &#123;</div><div class="line">                preP = hash[c];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> l = i - preP + <span class="number">1</span>;</div><div class="line">            hash[c] = i + <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span> (l &gt; max) max = l;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="004-Median-of-Two-Sorted-Arrays"><a href="#004-Median-of-Two-Sorted-Arrays" class="headerlink" title="004 Median of Two Sorted Arrays"></a><a href="#">004 Median of Two Sorted Arrays</a></h1><h2 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h2><p>There are two sorted arrays <strong>nums1</strong> and <strong>nums2</strong> of size m and n respectively.</p><p>Find the median of the two sorted arrays. The overall run time complexity should be O(log (m+n)).</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">nums1 = [1, 3]</div><div class="line">nums2 = [2]</div><div class="line"></div><div class="line">The median is 2.0</div></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">nums1 = [1, 2]</div><div class="line">nums2 = [3, 4]</div><div class="line"></div><div class="line">The median is (2 + 3)/2 = 2.5</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Array, Binary Search, Divide and Conquer</p><h2 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h2><p>题意是给你两个已排序的递增数组，让你找出其中位数。</p><p>乍一看这题并不是很难，因为两序列有序，所以我们很容想到时间复杂度为 <code>O(m + n)</code> 的做法：依次取出两数组中较小的元素，然后找到中间的元素即可。但这题要求的时间复杂度为 <code>O(log(m + n))</code>，那么我们自然而然地就能想到二分查找法进行求解。</p><p>题目是让找两数组的中位数，我们可以泛化为求两数组中第 <code>k</code> 大的元素，那么，求中位数就是其中的一个特例而已。<code>helper</code> 函数所起到的作用就是求两数组中第 <code>k</code> 大的元素，下面来解释其原理：</p><p>假设数组分别记为 <code>A</code>，<code>B</code>，当前需要搜索第 <code>k</code> 大的数，于是我们可以考虑从数组 <code>A</code> 中取出前 <code>m</code> 个元素，从数组 <code>B</code> 中取出前 <code>k - m</code> 个元素。由于数组 <code>A</code>，<code>B</code> 分别排序，则 <code>A[m - 1]</code> 大于从数组 <code>A</code> 中取出的其他所有元素，<code>B[k - m - 1]</code> 大于数组 <code>B</code> 中取出的其他所有元素。此时，尽管取出元素之间的相对大小关系不确定，但 <code>A[m - 1]</code> 与 <code>B[k - m - 1]</code> 的较大者一定是这 <code>k</code> 个元素中最大的。那么，较小的那个元素一定不是第 <code>k</code> 大的，这里留给读者自己想象。</p><p>为叙述方便，假设 <code>A[m - 1]</code> 是较小的那个元素，那么我们可以把 <code>A[0]</code>，<code>A[1]</code>…<code>A[m - 1]</code> 排除掉，并且更新 <code>k</code> 值为 <code>k - m</code>，也就是下一次就是从剩余的元素中寻找第 <code>k - m</code> 大的元素，这样，我们就完成了一次范围缩小，同理进行下一轮的操作。</p><p>那么什么时候停止操作呢？分两种情况：</p><ol><li><p>当某个数组的数都被取完了，那么直接返回另一个数组的后 <code>k</code> 个元素即可。</p></li><li><p>当 <code>k = 1</code> 时，也就是只需再找一个数即可，也就是取两者当前较小的那个即可。</p></li></ol><p>特别地，我们选取 <code>m = k / 2</code>，下面是我画的草图，希望能帮助大家理解。</p><p><img src="https://raw.githubusercontent.com/Blankj/awesome-java-leetcode/master/note/004/my_draw.jpg" alt=""></p><p>借助上面的理论，你能写出相关代码了吗？</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> len = nums1.length + nums2.length;</div><div class="line">        <span class="keyword">if</span> (len % <span class="number">2</span> == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> (helper(nums1, <span class="number">0</span>, nums2, <span class="number">0</span>, len / <span class="number">2</span>) + helper(nums1, <span class="number">0</span>, nums2, <span class="number">0</span>, len / <span class="number">2</span> + <span class="number">1</span>)) / <span class="number">2.0</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> helper(nums1, <span class="number">0</span>, nums2, <span class="number">0</span>, (len + <span class="number">1</span>) / <span class="number">2</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span> m, <span class="keyword">int</span>[] nums2, <span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (m &gt;= nums1.length) <span class="keyword">return</span> nums2[n + k - <span class="number">1</span>];</div><div class="line">        <span class="keyword">if</span> (n &gt;= nums2.length) <span class="keyword">return</span> nums1[m + k - <span class="number">1</span>];</div><div class="line">        <span class="keyword">if</span> (k == <span class="number">1</span>) <span class="keyword">return</span> Math.min(nums1[m], nums2[n]);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> p1 = m + k / <span class="number">2</span> - <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> p2 = n + k / <span class="number">2</span> - <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> mid1 = p1 &lt; nums1.length ? nums1[p1] : Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">int</span> mid2 = p2 &lt; nums2.length ? nums2[p2] : Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">if</span> (mid1 &lt; mid2) &#123;</div><div class="line">            <span class="keyword">return</span> helper(nums1, m + k / <span class="number">2</span>, nums2, n, k - k / <span class="number">2</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> helper(nums1, m, nums2, n + k / <span class="number">2</span>, k - k / <span class="number">2</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="005-Longest-Palindromic-Substring"><a href="#005-Longest-Palindromic-Substring" class="headerlink" title="005 Longest Palindromic Substring"></a><a href="#">005 Longest Palindromic Substring</a></h1><h2 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h2><p>Given a string <strong>s</strong>, find the longest palindromic substring in <strong>s</strong>. You may assume that the maximum length of <strong>s</strong> is 1000.</p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Input: &quot;babad&quot;</div><div class="line"></div><div class="line">Output: &quot;bab&quot;</div><div class="line"></div><div class="line">Note: &quot;aba&quot; is also a valid answer.</div></pre></td></tr></table></figure><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Input: &quot;cbbd&quot;</div><div class="line"></div><div class="line">Output: &quot;bb&quot;</div></pre></td></tr></table></figure><p><strong>Tags:</strong> String</p><h2 id="思路-0-1"><a href="#思路-0-1" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是寻找出字符串中最长的回文串，所谓回文串就是正序和逆序相同的字符串，也就是关于中间对称。我们先用最常规的做法，依次去求得每个字符的最长回文，要注意每个字符有奇数长度的回文串和偶数长度的回文串两种情况，相信你可以很轻易地从如下代码中找到相关代码，记录最长回文的始末位置即可，时间复杂度的话，首先要遍历一遍字符串，然后对每个字符都去求得最长回文，所以时间复杂度为 <code>O(n^2)</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> st, end;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">longestPalindrome</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> len = s.length();</div><div class="line">        <span class="keyword">if</span> (len &lt;= <span class="number">1</span>) <span class="keyword">return</span> s;</div><div class="line">        <span class="keyword">char</span>[] chars = s.toCharArray();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">            helper(chars, i, i);</div><div class="line">            helper(chars, i, i + <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> s.substring(st, end + <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(<span class="keyword">char</span>[] chars, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span> (l &gt;= <span class="number">0</span> &amp;&amp; r &lt; chars.length &amp;&amp; chars[l] == chars[r]) &#123;</div><div class="line">            --l;</div><div class="line">            ++r;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (end - st &lt; r - l - <span class="number">2</span>) &#123;</div><div class="line">            st = l + <span class="number">1</span>;</div><div class="line">            end = r - <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-1"><a href="#思路-1-1" class="headerlink" title="思路 1"></a>思路 1</h2><p>如果利用暴力法遍历所有字串是否回文的情况这道题肯定是 <code>Time Limit Exceeded</code> 的，那么我们是否可以把之前遍历的结果利用上呢，那么动态规划的想法就呼之欲出了，我们定义 <code>dp[i][j]</code> 的意思为字符串区间 <code>[i, j]</code> 是否为回文串，那么我们分三种情况：</p><ol><li><p>当 <code>i == j</code> 时，那么毫无疑问 <code>dp[i][j] = true</code>；</p></li><li><p>当 <code>i + 1 == j</code> 时，那么 <code>dp[i][j]</code> 的值取决于 <code>s[i] == s[j]</code>；</p></li><li><p>当 <code>i + 1 &lt; j</code> 时，那么 <code>dp[i][j]</code> 的值取决于 <code>dp[i + 1][j - 1] &amp;&amp; s[i] == s[j]</code>。</p></li></ol><p>根据以上的动态转移方程，我们的问题即可迎刃而解，时间复杂度的话显而易见，也是 <code>O(n^2)</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">longestPalindrome</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> len = s.length();</div><div class="line">        <span class="keyword">if</span> (len &lt;= <span class="number">1</span>) <span class="keyword">return</span> s;</div><div class="line">        <span class="keyword">int</span> st = <span class="number">0</span>, end = <span class="number">0</span>;</div><div class="line">        <span class="keyword">char</span>[] chars = s.toCharArray();</div><div class="line">        <span class="keyword">boolean</span>[][] dp = <span class="keyword">new</span> <span class="keyword">boolean</span>[len][len];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">            dp[i][i] = <span class="keyword">true</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (j + <span class="number">1</span> == i) &#123;</div><div class="line">                    dp[j][i] = chars[j] == chars[i];</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    dp[j][i] = dp[j + <span class="number">1</span>][i - <span class="number">1</span>] &amp;&amp; chars[j] == chars[i];</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span> (dp[j][i] &amp;&amp; i - j &gt; end - st) &#123;</div><div class="line">                    st = j;</div><div class="line">                    end = i;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> s.substring(st, end + <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-2"><a href="#思路-2" class="headerlink" title="思路 2"></a>思路 2</h2><p>马拉车算法(Manacher’s Algorithm)</p><h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>给定一个字符串，求出其最长回文子串（回文字符串就是从左到右读和从右往左读完全一样，也就是字符串关于中间对称）。例如：</p><ol><li><p>s = “babad”，最长回文长度为 <code>3</code>，可以是 <code>bab</code> 或者 <code>aba</code>；</p></li><li><p>s = “cbbda”，最长回文长度为 <code>2</code>，即 <code>bb</code>；</p></li><li><p>s = “abcde”，最长回文长度为 <code>1</code>，即单个字符本身。</p></li></ol><p>这个问题等同于 LeetCode 上的 <a href="https://leetcode.com/problems/longest-palindromic-substring" target="_blank" rel="external">Longest Palindromic Substring</a>，其相关题解可以查看这里：<a href="https://github.com/Blankj/awesome-java-leetcode/blob/master/note/005/README.md" target="_blank" rel="external">传送门</a></p><p>以上问题的传统思路大概是遍历每一个字符，以该字符为中心向两边查找，其时间复杂度为 <code>O(n^2)</code>，效率很差。</p><p>1975 年，一个叫 Manacher 的人发明了 Manacher 算法（中文名：马拉车算法），该算法可以把时间复杂度提升到 <code>O(n)</code>，下面我以我理解的思路来讲解其原理。</p><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>由于回文串的奇偶行不确定，比如 <code>lol</code> 是奇回文，而 <code>lool</code> 是偶回文，马拉车算法的第一步就是对其进行预处理，做法就是在每个字符两侧都加上一个特殊字符，一般就是不会出现在原串中的即可，我们可以选取 <code>#</code>，那么</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">lol  -&gt; #l#o#l#</div><div class="line">lool -&gt; #l#o#o#l#</div></pre></td></tr></table></figure><p>这样处理后，不管原来字符串长度是奇数还是偶数，最终得到的长度都将是奇数，从而能把两种情况合并起来一起考虑，记预处理后的字符串为 <code>str</code>。</p><p>我们把一个回文串中最左或最右位置的字符与其对称轴的距离称为回文半径。</p><p>马拉车算法定义了一个回文半径数组 <code>len</code>，用 <code>len[i]</code> 表示以第 <code>i</code> 个字符为对称轴的回文串的回文半径，比如以 <code>str[i]</code> 为中心的最长回文串是 <code>str[l, r]</code>，那么 <code>len[i] = r - i + 1</code></p><p>我们以 <code>lollool</code> 为例，参看下表。</p><table><thead><tr><th style="text-align:left">str</th><th style="text-align:left">#</th><th style="text-align:left">l</th><th style="text-align:left">#</th><th style="text-align:left">o</th><th style="text-align:left">#</th><th style="text-align:left">l</th><th style="text-align:left">#</th><th style="text-align:left">l</th><th style="text-align:left">#</th><th style="text-align:left">o</th><th style="text-align:left">#</th><th style="text-align:left">o</th><th style="text-align:left">#</th><th style="text-align:left">l</th><th style="text-align:left">#</th></tr></thead><tbody><tr><td style="text-align:left">len[]</td><td style="text-align:left">1</td><td style="text-align:left">2</td><td style="text-align:left">1</td><td style="text-align:left">4</td><td style="text-align:left">l</td><td style="text-align:left">2</td><td style="text-align:left">5</td><td style="text-align:left">2</td><td style="text-align:left">1</td><td style="text-align:left">2</td><td style="text-align:left">5</td><td style="text-align:left">2</td><td style="text-align:left">1</td><td style="text-align:left">2</td><td style="text-align:left">1</td></tr></tbody></table><p>可以发现 <code>len[i] - 1</code> 就等于该回文串在原串中的长度。</p><p>证明：在转换后的字符串 <code>str</code> 中，那么对于以 <code>str[i]</code> 为中心的最长回文串的长度为 <code>2 * len[i] - 1</code>，其中又有 <code>len[i]</code> 个分隔符，所以在原字符串中的回文串长度就是 <code>len[i] - 1</code>。</p><p>那么我们剩下的工作就是求 <code>len</code> 数组。</p><p>为了防止数组越界，我们在首位再加上非 <code>#</code> 的不常用字符，比如 <code>~</code>，那么 <code>lollool</code> 就表示为 <code>~#l#o#l#l#o#o#l#~</code>，这样我们就省去写很多 <code>if else</code> 的边界处理。</p><p>我们先看一张图，如下所示：</p><h1 id="006-ZigZag-Conversion"><a href="#006-ZigZag-Conversion" class="headerlink" title="006 ZigZag Conversion"></a><a href="#">006 ZigZag Conversion</a></h1><h2 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h2><p>The string <code>&quot;PAYPALISHIRING&quot;</code> is written in a zigzag pattern on a given number of rows like this: (you may want to display this pattern in a fixed font for better legibility)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">P   A   H   N</div><div class="line">A P L S I I G</div><div class="line">Y   I   R</div></pre></td></tr></table></figure><p>And then read line by line: <code>&quot;PAHNAPLSIIGYIR&quot;</code></p><p>Write the code that will take a string and make this conversion given a number of rows:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">string convert(string text, int nRows);</div></pre></td></tr></table></figure><p><code>convert(&quot;PAYPALISHIRING&quot;, 3)</code> should return <code>&quot;PAHNAPLSIIGYIR&quot;</code>.</p><p><strong>Tags:</strong> String</p><h2 id="思路-0-2"><a href="#思路-0-2" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是让你把字符串按波浪形排好，然后返回横向读取的字符串。</p><p>听不懂的话，看下面的表示应该就明白了：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">0                           2n-2                        4n-4</div><div class="line">1                    2n-3   2n-1                 4n-5   4n-5</div><div class="line">2              2n-4         2n               4n-6       .</div><div class="line">.           .               .             .             .</div><div class="line">.       n+1                 .          3n-1             .</div><div class="line">n-2   n                     3n-4   3n-2                 5n-6</div><div class="line">n-1                         3n-3                        5n-5</div></pre></td></tr></table></figure><p>那么我们可以根据上面找规律，可以看到波峰和波谷是单顶点的，它们周期是 <code>2 * (n - 1)</code>，单独处理即可；中间的部分每个周期会出现两次，规律很好找，留给读者自己想象，不懂的可以结合以下代码。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">convert</span><span class="params">(String s, <span class="keyword">int</span> numRows)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (numRows &lt;= <span class="number">1</span>) <span class="keyword">return</span> s;</div><div class="line">        <span class="keyword">int</span> len = s.length();</div><div class="line">        <span class="keyword">char</span>[] chars = s.toCharArray();</div><div class="line">        <span class="keyword">int</span> cycle = <span class="number">2</span> * (numRows - <span class="number">1</span>);</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; len; j += cycle) &#123;</div><div class="line">            sb.append(chars[j]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; numRows - <span class="number">1</span>; i++) &#123;</div><div class="line">            <span class="keyword">int</span> step = <span class="number">2</span> * i;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; len; j += step) &#123;</div><div class="line">                sb.append(chars[j]);</div><div class="line">                step = cycle - step;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = numRows - <span class="number">1</span>; j &lt; len; j += cycle) &#123;</div><div class="line">            sb.append(chars[j]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-2"><a href="#思路-1-2" class="headerlink" title="思路 1"></a>思路 1</h2><p>另外一种思路就是开辟相应行数的 <code>StringBuilder</code> 对象，然后模拟波浪生成的样子分别插入到相应的 <code>StringBuilder</code> 对象，比较直白简单，具体代码如下。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">convert</span><span class="params">(String s, <span class="keyword">int</span> numRows)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (numRows &lt;= <span class="number">1</span>) <span class="keyword">return</span> s;</div><div class="line">        <span class="keyword">int</span> len = s.length();</div><div class="line">        <span class="keyword">char</span>[] chars = s.toCharArray();</div><div class="line">        StringBuilder[] sbs = <span class="keyword">new</span> StringBuilder[numRows];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numRows; i++) &#123;</div><div class="line">            sbs[i] = <span class="keyword">new</span> StringBuilder();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt; len) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; numRows &amp;&amp; i &lt; len; ++j) &#123;</div><div class="line">                sbs[j].append(chars[i++]);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = numRows - <span class="number">2</span>; j &gt;= <span class="number">1</span> &amp;&amp; i &lt; len; --j) &#123;</div><div class="line">                sbs[j].append(chars[i++]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; numRows; i++) &#123;</div><div class="line">            sbs[<span class="number">0</span>].append(sbs[i]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sbs[<span class="number">0</span>].toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="007-Reverse-Integer"><a href="#007-Reverse-Integer" class="headerlink" title="007 Reverse Integer"></a><a href="#">007 Reverse Integer</a></h1><h2 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h2><p>Given a 32-bit signed integer, reverse digits of an integer.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: 123</div><div class="line">Output:  321</div></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: -123</div><div class="line">Output: -321</div></pre></td></tr></table></figure><p><strong>Example 3:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: 120</div><div class="line">Output: 21</div></pre></td></tr></table></figure><p><strong>Note:</strong></p><p>Assume we are dealing with an environment which could only hold integers within the 32-bit signed integer range. For the purpose of this problem, assume that your function returns 0 when the reversed integer overflows.</p><p><strong>Tags:</strong> Math</p><h2 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h2><p>题意是给你一个整型数，求它的逆序整型数，而且有个小坑点，当它的逆序整型数溢出的话，那么就返回 0，用我们代码表示的话可以求得结果保存在 long 中，最后把结果和整型的两个范围比较即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">        <span class="keyword">long</span> res = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (; x != <span class="number">0</span>; x /= <span class="number">10</span>)</div><div class="line">            res = res * <span class="number">10</span> + x % <span class="number">10</span>;</div><div class="line">        <span class="keyword">return</span> res &gt; Integer.MAX_VALUE || res &lt; Integer.MIN_VALUE ? <span class="number">0</span> : (<span class="keyword">int</span>) res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="008-String-to-Integer-atoi"><a href="#008-String-to-Integer-atoi" class="headerlink" title="008 String to Integer (atoi)"></a><a href="#">008 String to Integer (atoi)</a></h1><h2 id="Description-7"><a href="#Description-7" class="headerlink" title="Description"></a>Description</h2><p>Implement atoi to convert a string to an integer.</p><p><strong>Hint:</strong> Carefully consider all possible input cases. If you want a challenge, please do not see below and ask yourself what are the possible input cases.</p><p><strong>Notes:</strong> It is intended for this problem to be specified vaguely (ie, no given input specs). You are responsible to gather all the input requirements up front.</p><p><strong>Spoilers:</strong></p><p><strong>Requirements for atoi:</strong></p><p>The function first discards as many whitespace characters as necessary until the first non-whitespace character is found. Then, starting from this character, takes an optional initial plus or minus sign followed by as many numerical digits as possible, and interprets them as a numerical value.</p><p>The string can contain additional characters after those that form the integral number, which are ignored and have no effect on the behavior of this function.</p><p>If the first sequence of non-whitespace characters in str is not a valid integral number, or if no such sequence exists because either str is empty or it contains only whitespace characters, no conversion is performed.</p><p>If no valid conversion could be performed, a zero value is returned. If the correct value is out of the range of representable values, INT_MAX (2147483647) or INT_MIN (-2147483648) is returned.</p><p><strong>Tags:</strong> Math, String</p><h2 id="思路-4"><a href="#思路-4" class="headerlink" title="思路"></a>思路</h2><p>题意是把一个字符串转为整型，但要注意所给的要求，先去除最前面的空格，然后判断正负数，注意正数可能包含 <code>+</code>，如果之后存在非数字或全为空则返回 <code>0</code>，而如果合法的值超过 int 表示的最大范围，则根据正负号返回 <code>INT_MAX</code> 或 <code>INT_MIN</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">myAtoi</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, ans = <span class="number">0</span>, sign = <span class="number">1</span>, len = str.length();</div><div class="line">        <span class="keyword">while</span> (i &lt; len &amp;&amp; str.charAt(i) == <span class="string">' '</span>) ++i;</div><div class="line">        <span class="keyword">if</span> (i &lt; len &amp;&amp; (str.charAt(i) == <span class="string">'-'</span> || str.charAt(i) == <span class="string">'+'</span>)) &#123;</div><div class="line">            sign = str.charAt(i++) == <span class="string">'+'</span> ? <span class="number">1</span> : -<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (; i &lt; len; ++i) &#123;</div><div class="line">            <span class="keyword">int</span> tmp = str.charAt(i) - <span class="string">'0'</span>;</div><div class="line">            <span class="keyword">if</span> (tmp &lt; <span class="number">0</span> || tmp &gt; <span class="number">9</span>)</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">if</span> (ans &gt; Integer.MAX_VALUE / <span class="number">10</span> || ans == Integer.MAX_VALUE / <span class="number">10</span> &amp;&amp; Integer.MAX_VALUE % <span class="number">10</span> &lt; tmp)</div><div class="line">                <span class="keyword">return</span> sign == <span class="number">1</span> ? Integer.MAX_VALUE : Integer.MIN_VALUE;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                ans = ans * <span class="number">10</span> + tmp;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sign * ans;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="009-Palindrome-Number"><a href="#009-Palindrome-Number" class="headerlink" title="009 Palindrome Number"></a><a href="#">009 Palindrome Number</a></h1><h2 id="Description-8"><a href="#Description-8" class="headerlink" title="Description"></a>Description</h2><p>Determine whether an integer is a palindrome. Do this without extra space.</p><p><strong>Spoilers:</strong></p><p><strong>Some hints:</strong></p><p>Could negative integers be palindromes? (ie, -1)</p><p>If you are thinking of converting the integer to string, note the restriction of using extra space.</p><p>You could also try reversing an integer. However, if you have solved the problem “Reverse Integer”, you know that the reversed integer might overflow. How would you handle such case?</p><p>There is a more generic way of solving this problem.</p><p><strong>Tags:</strong> Math</p><h2 id="思路-0-3"><a href="#思路-0-3" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是判断一个有符号整型数是否是回文，也就是逆序过来的整数和原整数相同，首先负数肯定不是，接下来我们分析一下最普通的解法，就是直接算出他的回文数，然后和给定值比较即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPalindrome</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">int</span> copyX = x, reverse = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (copyX &gt; <span class="number">0</span>) &#123;</div><div class="line">            reverse = reverse * <span class="number">10</span> + copyX % <span class="number">10</span>;</div><div class="line">            copyX /= <span class="number">10</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> x == reverse;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-3"><a href="#思路-1-3" class="headerlink" title="思路 1"></a>思路 1</h2><p>好好思考下是否需要计算整个长度，比如 1234321，其实不然，我们只需要计算一半的长度即可，就是在计算过程中的那个逆序数比不断除 10 的数大就结束计算即可，但是这也带来了另一个问题，比如 10 的倍数的数 10010，它也会返回 <code>true</code>，所以我们需要对 10 的倍数的数再加个判断即可，代码如下所示。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPalindrome</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span> || (x != <span class="number">0</span> &amp;&amp; x % <span class="number">10</span> == <span class="number">0</span>)) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">int</span> halfReverseX = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (x &gt; halfReverseX) &#123;</div><div class="line">            halfReverseX = halfReverseX * <span class="number">10</span> + x % <span class="number">10</span>;</div><div class="line">            x /= <span class="number">10</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> halfReverseX == x || halfReverseX / <span class="number">10</span> == x;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="010-Regular-Expression-Matching"><a href="#010-Regular-Expression-Matching" class="headerlink" title="010 Regular Expression Matching"></a><a href="#">010 Regular Expression Matching</a></h1><h2 id="Description-9"><a href="#Description-9" class="headerlink" title="Description"></a>Description</h2><p>Implement regular expression matching with support for <code>&#39;.&#39;</code> and <code>&#39;*&#39;</code>.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&apos;.&apos; Matches any single character.</div><div class="line">&apos;*&apos; Matches zero or more of the preceding element.</div><div class="line"></div><div class="line">The matching should cover the entire input string (not partial).</div><div class="line"></div><div class="line">The function prototype should be:</div><div class="line">bool isMatch(const char *s, const char *p)</div><div class="line"></div><div class="line">Some examples:</div><div class="line">isMatch(&quot;aa&quot;, &quot;a&quot;) → false</div><div class="line">isMatch(&quot;aa&quot;, &quot;aa&quot;) → true</div><div class="line">isMatch(&quot;aaa&quot;, &quot;aa&quot;) → false</div><div class="line">isMatch(&quot;aa&quot;, &quot;a*&quot;) → true</div><div class="line">isMatch(&quot;aa&quot;, &quot;.*&quot;) → true</div><div class="line">isMatch(&quot;ab&quot;, &quot;.*&quot;) → true</div><div class="line">isMatch(&quot;aab&quot;, &quot;c*a*b&quot;) → true</div></pre></td></tr></table></figure><p><strong>Tags:</strong> String, Dynamic Programming, Backtracking</p><h2 id="思路-0-4"><a href="#思路-0-4" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是让让你从判断 <code>s</code> 字符串是否正则匹配于 <code>p</code>，这道题和 [Wildcard Matching][044] 很是相似，区别在于 <code>*</code>，通配符的 <code>*</code> 是可以随意出现的，跟前面字符没有任何关系，其作用是可以表示任意字符串；而正则匹配的 <code>*</code> 不能单独存在，前面必须具有一个字符，其意义是表明前面的这个字符个数可以是任意个数，包括 0 个。首先我们用递归的方式来实现，其思路如下：</p><ul><li><p>如果 <code>s</code> 和 <code>p</code> 都为空，那么返回 <code>true</code>；</p></li><li><p>如果 <code>p</code> 的长度为 1，当 <code>s</code> 的长度也为 1，并且他们首位匹配则返回 <code>true</code>，否则返回 <code>false</code>；</p></li><li><p>如果 <code>p</code> 的第二个字符不为 ‘*’，如果 <code>s</code> 为空，那就返回 <code>false</code>，首位匹配则返回递归调用他们去掉首位的子字符串，否则返回 <code>false</code>；</p></li><li><p>如果 <code>p</code> 的第二个字符为 ‘*’，循环当 <code>s</code> 不为空，且首位匹配，如果递归调用是否匹配 <code>s</code> 字符串和 <code>p</code> 去掉前两位的子字符串，则返回 <code>true</code>，否则 <code>s</code> 去掉首字母继续循环；</p></li><li><p>返回递归调用 <code>s</code> 字符串和 <code>p</code> 去掉前两位的子字符串是否匹配。</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isMatch</span><span class="params">(String s, String p)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (p.isEmpty()) <span class="keyword">return</span> s.isEmpty();</div><div class="line">        <span class="keyword">if</span> (p.length() == <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">return</span> s.length() == <span class="number">1</span> &amp;&amp; (p.charAt(<span class="number">0</span>) == s.charAt(<span class="number">0</span>) || p.charAt(<span class="number">0</span>) == <span class="string">'.'</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (p.charAt(<span class="number">1</span>) != <span class="string">'*'</span>) &#123;</div><div class="line">            <span class="keyword">if</span> (s.isEmpty()) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            <span class="keyword">return</span> (p.charAt(<span class="number">0</span>) == s.charAt(<span class="number">0</span>) || p.charAt(<span class="number">0</span>) == <span class="string">'.'</span>)</div><div class="line">                    &amp;&amp; isMatch(s.substring(<span class="number">1</span>), p.substring(<span class="number">1</span>));</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// match 1 or more preceding element</span></div><div class="line">        <span class="keyword">while</span> (!s.isEmpty() &amp;&amp; (p.charAt(<span class="number">0</span>) == s.charAt(<span class="number">0</span>) || p.charAt(<span class="number">0</span>) == <span class="string">'.'</span>)) &#123;</div><div class="line">            <span class="keyword">if</span> (isMatch(s, p.substring(<span class="number">2</span>))) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            s = s.substring(<span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// match 0 preceding element</span></div><div class="line">        <span class="keyword">return</span> isMatch(s, p.substring(<span class="number">2</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-4"><a href="#思路-1-4" class="headerlink" title="思路 1"></a>思路 1</h2><p>我们可以把上面的思路更简单化，如下：</p><ul><li><p>如果 <code>s</code> 和 <code>p</code> 都为空，那么返回 <code>true</code>；</p></li><li><p>如果 <code>p</code> 的第二个字符为 <code>*</code>，由于 <code>*</code> 前面的字符个数可以为任意，那么我们先递归调用个数为 0 的情况；或者当 <code>s</code> 不为空，如果他们的首字母匹配，那么我们就递归调用去掉去掉首字母的 <code>s</code> 和完整的 <code>p</code>；</p></li><li><p>如果 <code>p</code> 的第二个字符不为 <code>*</code>，那么我们就老老实实判断第一个字符是否匹配并且递归调用他们去掉首位的子字符串。</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isMatch</span><span class="params">(String s, String p)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (p.isEmpty()) <span class="keyword">return</span> s.isEmpty();</div><div class="line">        <span class="keyword">if</span> (p.length() &gt; <span class="number">1</span> &amp;&amp; p.charAt(<span class="number">1</span>) == <span class="string">'*'</span>) &#123;</div><div class="line">            <span class="keyword">return</span> isMatch(s, p.substring(<span class="number">2</span>))</div><div class="line">                    || (!s.isEmpty() &amp;&amp; (p.charAt(<span class="number">0</span>) == s.charAt(<span class="number">0</span>) || p.charAt(<span class="number">0</span>) == <span class="string">'.'</span>)</div><div class="line">                    &amp;&amp; isMatch(s.substring(<span class="number">1</span>), p));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> !s.isEmpty() &amp;&amp; (p.charAt(<span class="number">0</span>) == s.charAt(<span class="number">0</span>) || p.charAt(<span class="number">0</span>) == <span class="string">'.'</span>)</div><div class="line">                &amp;&amp; isMatch(s.substring(<span class="number">1</span>), p.substring(<span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-2-1"><a href="#思路-2-1" class="headerlink" title="思路 2"></a>思路 2</h2><p>另一种思路就是动态规划了，我们定义 <code>dp[i][j]</code> 的真假来表示 <code>s[0..i)</code> 是否匹配 <code>p[0..j)</code>，通过思路 1，我们可以确定其状态转移方程如下所示：</p><ul><li><p>如果 <code>p[j - 1] == &#39;*&#39;</code>, <code>dp[i][j] = dp[i][j - 2] || (pc[j - 2] == sc[i - 1] || pc[j - 2] == &#39;.&#39;) &amp;&amp; dp[i - 1][j];</code>；</p></li><li><p>如果 <code>p[j - 1] != &#39;*&#39;</code>，<code>dp[i][j] = dp[i - 1][j - 1] &amp;&amp; (pc[j - 1] == &#39;.&#39; || pc[j - 1] == sc[i - 1]);</code>。</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isMatch</span><span class="params">(String s, String p)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (p.length() == <span class="number">0</span>) <span class="keyword">return</span> s.length() == <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> sL = s.length(), pL = p.length();</div><div class="line">        <span class="keyword">boolean</span>[][] dp = <span class="keyword">new</span> <span class="keyword">boolean</span>[sL + <span class="number">1</span>][pL + <span class="number">1</span>];</div><div class="line">        <span class="keyword">char</span>[] sc = s.toCharArray(), pc = p.toCharArray();</div><div class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= pL; ++i) &#123;</div><div class="line">            <span class="keyword">if</span> (pc[i - <span class="number">1</span>] == <span class="string">'*'</span> &amp;&amp; dp[<span class="number">0</span>][i - <span class="number">2</span>]) &#123;</div><div class="line">                dp[<span class="number">0</span>][i] = <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= sL; ++i) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pL; ++j) &#123;</div><div class="line">                <span class="keyword">if</span> (pc[j - <span class="number">1</span>] == <span class="string">'*'</span>) &#123;</div><div class="line">                    dp[i][j] = dp[i][j - <span class="number">2</span>] || (pc[j - <span class="number">2</span>] == sc[i - <span class="number">1</span>] || pc[j - <span class="number">2</span>] == <span class="string">'.'</span>) &amp;&amp; dp[i - <span class="number">1</span>][j];</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    dp[i][j] = dp[i - <span class="number">1</span>][j - <span class="number">1</span>] &amp;&amp; (pc[j - <span class="number">1</span>] == <span class="string">'.'</span> || pc[j - <span class="number">1</span>] == sc[i - <span class="number">1</span>]);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dp[sL][pL];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="011-Container-With-Most-Water"><a href="#011-Container-With-Most-Water" class="headerlink" title="011 Container With Most Water"></a><a href="#">011 Container With Most Water</a></h1><h2 id="Description-10"><a href="#Description-10" class="headerlink" title="Description"></a>Description</h2><p>Given <em>n</em> non-negative integers <em>a1</em>, <em>a2</em>, …, <em>an</em>, where each represents a point at coordinate (<em>i</em>, <em>ai</em>). <em>n</em> vertical lines are drawn such that the two endpoints of line <em>i</em> is at (<em>i</em>, <em>ai</em>) and (<em>i</em>, 0). Find two lines, which together with x-axis forms a container, such that the container contains the most water.</p><p>Note: You may not slant the container and <em>n</em> is at least 2.</p><p><strong>Tags:</strong> Array, Two Pointers</p><h2 id="思路-5"><a href="#思路-5" class="headerlink" title="思路"></a>思路</h2><p>题意是给你 <em>a1</em>, <em>a2</em>, …, <em>an</em> 这 <em>n</em> 个数，代表 (<em>i</em>, <em>ai</em>) 坐标，让你从中找两个点与 x 轴围成的容器可以容纳最多的水。</p><p>不明白的话可以看数据为 <code>1 8 6 2 5 4 8 3 7</code> 所示的图。</p><p><img src="https://raw.githubusercontent.com/Blankj/awesome-java-leetcode/master/note/011/water.png" alt=""></p><p>如果用暴力法求每种情况的结果，其时间复杂度为 O(n^2)，相信肯定会超时，我们可以探索下是否有更巧妙的办法呢，题目的标签有双指针，是否就可以想到首尾各放一指针，然后根据条件来收缩。首先计算一次首尾构成的最大面积，然后分析下该移动哪个指针，如果移动大的那个指针的话，那样只会减小面积，所以我们要移动小的那个指针，小的那个指针移动到哪呢？当然是移动到大于之前的值的地方，否则面积不都比之前小么，然后继续更新最大值即可，借助如上分析写出如下代码应该不是什么难事了吧。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxArea</span><span class="params">(<span class="keyword">int</span>[] height)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = height.length - <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>, h = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (l &lt; r) &#123;</div><div class="line">            h = Math.min(height[l], height[r]);</div><div class="line">            max = Math.max(max, (r - l) * h);</div><div class="line">            <span class="keyword">while</span> (height[l] &lt;= h &amp;&amp; l &lt; r) ++l;</div><div class="line">            <span class="keyword">while</span> (height[r] &lt;= h &amp;&amp; l &lt; r) --r;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="012-Integer-to-Roman"><a href="#012-Integer-to-Roman" class="headerlink" title="012 Integer to Roman"></a><a href="#">012 Integer to Roman</a></h1><h2 id="Description-11"><a href="#Description-11" class="headerlink" title="Description"></a>Description</h2><p>Given an integer, convert it to a roman numeral.</p><p>Input is guaranteed to be within the range from 1 to 3999.</p><p><strong>Tags:</strong> Math, String</p><h2 id="思路-6"><a href="#思路-6" class="headerlink" title="思路"></a>思路</h2><p>题意是整型数转罗马数字，范围从 1 到 3999，查看下百度百科的罗马数字介绍如下：</p><ul><li><p>相同的数字连写，所表示的数等于这些数字相加得到的数，如 Ⅲ=3；</p></li><li><p>小的数字在大的数字的右边，所表示的数等于这些数字相加得到的数，如 Ⅷ=8、Ⅻ=12；</p></li><li><p>小的数字（限于 Ⅰ、X 和 C）在大的数字的左边，所表示的数等于大数减小数得到的数，如 Ⅳ=4、Ⅸ=9。</p></li></ul><p>那么我们可以把整数的每一位分离出来，让其每一位都用相应的罗马数字位表示，最终拼接完成。比如 <code>621</code> 我们可以分离百、十、个分别为 <code>6</code>、<code>2</code>、<code>1</code>，那么 <code>600</code> 对应的罗马数字是 <code>DC</code>，<code>20</code> 对应的罗马数字是 <code>XX</code>，<code>1</code> 对应的罗马数字是 <code>I</code>，所以最终答案便是 <code>DCXXI</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">intToRoman</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</div><div class="line">        String M[] = &#123;<span class="string">""</span>, <span class="string">"M"</span>, <span class="string">"MM"</span>, <span class="string">"MMM"</span>&#125;;</div><div class="line">        String C[] = &#123;<span class="string">""</span>, <span class="string">"C"</span>, <span class="string">"CC"</span>, <span class="string">"CCC"</span>, <span class="string">"CD"</span>, <span class="string">"D"</span>, <span class="string">"DC"</span>, <span class="string">"DCC"</span>, <span class="string">"DCCC"</span>, <span class="string">"CM"</span>&#125;;</div><div class="line">        String X[] = &#123;<span class="string">""</span>, <span class="string">"X"</span>, <span class="string">"XX"</span>, <span class="string">"XXX"</span>, <span class="string">"XL"</span>, <span class="string">"L"</span>, <span class="string">"LX"</span>, <span class="string">"LXX"</span>, <span class="string">"LXXX"</span>, <span class="string">"XC"</span>&#125;;</div><div class="line">        String I[] = &#123;<span class="string">""</span>, <span class="string">"I"</span>, <span class="string">"II"</span>, <span class="string">"III"</span>, <span class="string">"IV"</span>, <span class="string">"V"</span>, <span class="string">"VI"</span>, <span class="string">"VII"</span>, <span class="string">"VIII"</span>, <span class="string">"IX"</span>&#125;;</div><div class="line">        <span class="keyword">return</span> M[num / <span class="number">1000</span>] + C[(num % <span class="number">1000</span>) / <span class="number">100</span>] + X[(num % <span class="number">100</span>) / <span class="number">10</span>] + I[num % <span class="number">10</span>];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="013-Roman-to-Integer"><a href="#013-Roman-to-Integer" class="headerlink" title="013 Roman to Integer"></a><a href="#">013 Roman to Integer</a></h1><h2 id="Description-12"><a href="#Description-12" class="headerlink" title="Description"></a>Description</h2><p>Given a roman numeral, convert it to an integer.</p><p>Input is guaranteed to be within the range from 1 to 3999.</p><p><strong>Tags:</strong> Math, String</p><h2 id="思路-7"><a href="#思路-7" class="headerlink" title="思路"></a>思路</h2><p>题意是罗马数字转整型数，范围从 1 到 3999，查看下百度百科的罗马数字介绍如下：</p><ul><li><p>相同的数字连写，所表示的数等于这些数字相加得到的数，如 Ⅲ=3；</p></li><li><p>小的数字在大的数字的右边，所表示的数等于这些数字相加得到的数，如 Ⅷ=8、Ⅻ=12；</p></li><li><p>小的数字（限于 Ⅰ、X 和 C）在大的数字的左边，所表示的数等于大数减小数得到的数，如 Ⅳ=4、Ⅸ=9。</p></li></ul><p>那么我们可以利用 map 来完成罗马数字的 7 个数字符号：I、V、X、L、C、D、M 和整数的映射关系，然后根据上面的解释来模拟完成即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">romanToInt</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        Map&lt;Character, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        map.put(<span class="string">'I'</span>, <span class="number">1</span>);</div><div class="line">        map.put(<span class="string">'V'</span>, <span class="number">5</span>);</div><div class="line">        map.put(<span class="string">'X'</span>, <span class="number">10</span>);</div><div class="line">        map.put(<span class="string">'L'</span>, <span class="number">50</span>);</div><div class="line">        map.put(<span class="string">'C'</span>, <span class="number">100</span>);</div><div class="line">        map.put(<span class="string">'D'</span>, <span class="number">500</span>);</div><div class="line">        map.put(<span class="string">'M'</span>, <span class="number">1000</span>);</div><div class="line">        <span class="keyword">int</span> len = s.length();</div><div class="line">        <span class="keyword">int</span> sum = map.get(s.charAt(len - <span class="number">1</span>));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">2</span>; i &gt;= <span class="number">0</span>; --i) &#123;</div><div class="line">            <span class="keyword">if</span> (map.get(s.charAt(i)) &lt; map.get(s.charAt(i + <span class="number">1</span>))) &#123;</div><div class="line">                sum -= map.get(s.charAt(i));</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                sum += map.get(s.charAt(i));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sum;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="014-Longest-Common-Prefix"><a href="#014-Longest-Common-Prefix" class="headerlink" title="014 Longest Common Prefix"></a><a href="#">014 Longest Common Prefix</a></h1><h2 id="Description-13"><a href="#Description-13" class="headerlink" title="Description"></a>Description</h2><p>Write a function to find the longest common prefix string amongst an array of strings.</p><p><strong>Tags:</strong> String</p><h2 id="思路-8"><a href="#思路-8" class="headerlink" title="思路"></a>思路</h2><p>题意是让你从字符串数组中找出公共前缀，我的想法是找出最短的那个字符串的长度 <code>minLen</code>，然后在 <code>0...minLen</code> 的范围比较所有字符串，如果比较到有不同的字符，那么直接返回当前索引长度的字符串即可，否则最后返回最短的字符串即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">longestCommonPrefix</span><span class="params">(String[] strs)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> len = strs.length;</div><div class="line">        <span class="keyword">if</span> (len == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">        <span class="keyword">int</span> minLen = <span class="number">0x7fffffff</span>;</div><div class="line">        <span class="keyword">for</span> (String str : strs) minLen = Math.min(minLen, str.length());</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; minLen; ++j)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</div><div class="line">                <span class="keyword">if</span> (strs[<span class="number">0</span>].charAt(j) != strs[i].charAt(j))</div><div class="line">                    <span class="keyword">return</span> strs[<span class="number">0</span>].substring(<span class="number">0</span>, j);</div><div class="line">        <span class="keyword">return</span> strs[<span class="number">0</span>].substring(<span class="number">0</span>, minLen);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="015-3Sum"><a href="#015-3Sum" class="headerlink" title="015 3Sum"></a><a href="#">015 3Sum</a></h1><h2 id="Description-14"><a href="#Description-14" class="headerlink" title="Description"></a>Description</h2><p>Given an array <em>S</em> of <em>n</em> integers, are there elements <em>a</em>, <em>b</em>, <em>c</em> in <em>S</em> such that <em>a</em> + <em>b</em> + <em>c</em> = 0? Find all unique triplets in the array which gives the sum of zero.</p><p><strong>Note:</strong> The solution set must not contain duplicate triplets.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">For example, given array S = [-1, 0, 1, 2, -1, -4],</div><div class="line"></div><div class="line">A solution set is:</div><div class="line">[</div><div class="line">  [-1, 0, 1],</div><div class="line">  [-1, -1, 2]</div><div class="line">]</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Array, Two Pointers</p><h2 id="思路-9"><a href="#思路-9" class="headerlink" title="思路"></a>思路</h2><p>题意是让你从数组中找出所有三个和为 0 的元素构成的非重复序列，这样的话我们可以把数组先做下排序，然后遍历这个排序数组，用两个指针分别指向当前元素的下一个和数组尾部，判断三者的和与 0 的大小来移动两个指针，其中细节操作就是优化和去重。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; threeSum(<span class="keyword">int</span>[] nums) &#123;</div><div class="line">        List&lt;List&lt;Integer&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> len = nums.length;</div><div class="line">        <span class="keyword">if</span> (len &lt; <span class="number">3</span>) <span class="keyword">return</span> list;</div><div class="line">        Arrays.sort(nums);</div><div class="line">        <span class="keyword">int</span> max = nums[len - <span class="number">1</span>];</div><div class="line">        <span class="keyword">if</span> (max &lt; <span class="number">0</span>) <span class="keyword">return</span> list;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">2</span>; ) &#123;</div><div class="line">            <span class="keyword">if</span> (nums[i] &gt; <span class="number">0</span>) <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">if</span> (nums[i] + <span class="number">2</span> * max &lt; <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">while</span> (nums[i] == nums[++i] &amp;&amp; i &lt; len - <span class="number">2</span>) ;</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> left = i + <span class="number">1</span>, right = len - <span class="number">1</span>;</div><div class="line">            <span class="keyword">while</span> (left &lt; right) &#123;</div><div class="line">                <span class="keyword">int</span> sum = nums[i] + nums[left] + nums[right];</div><div class="line">                <span class="keyword">if</span> (sum == <span class="number">0</span>) &#123;</div><div class="line">                    list.add(Arrays.asList(nums[i], nums[left], nums[right]));</div><div class="line">                    <span class="keyword">while</span> (nums[left] == nums[++left] &amp;&amp; left &lt; right) ;</div><div class="line">                    <span class="keyword">while</span> (nums[right] == nums[--right] &amp;&amp; left &lt; right) ;</div><div class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sum &lt; <span class="number">0</span>) ++left;</div><div class="line">                <span class="keyword">else</span> --right;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">while</span> (nums[i] == nums[++i] &amp;&amp; i &lt; len - <span class="number">2</span>) ;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="016-3Sum-Closest"><a href="#016-3Sum-Closest" class="headerlink" title="016 3Sum Closest"></a><a href="#">016 3Sum Closest</a></h1><h2 id="Description-15"><a href="#Description-15" class="headerlink" title="Description"></a>Description</h2><p>Given an array <em>S</em> of <em>n</em> integers, find three integers in <em>S</em> such that the sum is closest to a given number, target. Return the sum of the three integers. You may assume that each input would have exactly one solution.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">For example, given array S = &#123;-1 2 1 -4&#125;, and target = 1.</div><div class="line"></div><div class="line">The sum that is closest to the target is 2. (-1 + 2 + 1 = 2).</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Array, Two Pointers</p><h2 id="思路-10"><a href="#思路-10" class="headerlink" title="思路"></a>思路</h2><p>题意是让你从数组中找出最接近 <code>target</code> 的三个数的和，该题和 [3Sum][015] 的思路基本一样，先对数组进行排序，然后遍历这个排序数组，用两个指针分别指向当前元素的下一个和数组尾部，判断三者的和与 <code>target</code> 的差值来移动两个指针，并更新其结果，当然，如果三者的和直接与 <code>target</code> 值相同，那么返回 <code>target</code> 结果即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">threeSumClosest</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> delta = <span class="number">0x7fffffff</span>, res = <span class="number">0</span>;</div><div class="line">        Arrays.sort(nums);</div><div class="line">        <span class="keyword">int</span> len = nums.length - <span class="number">2</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">            <span class="keyword">int</span> left = i + <span class="number">1</span>, right = nums.length - <span class="number">1</span>;</div><div class="line">            <span class="keyword">while</span> (left &lt; right) &#123;</div><div class="line">                <span class="keyword">int</span> sum = nums[i] + nums[left] + nums[right];</div><div class="line">                <span class="keyword">int</span> curDelta = Math.abs(sum - target);</div><div class="line">                <span class="keyword">if</span> (curDelta == <span class="number">0</span>) <span class="keyword">return</span> sum;</div><div class="line">                <span class="keyword">if</span> (curDelta &lt; delta) &#123;</div><div class="line">                    delta = curDelta;</div><div class="line">                    res = sum;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span> (sum &gt; target) --right;</div><div class="line">                <span class="keyword">else</span> ++left;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="017-Letter-Combinations-of-a-Phone-Number"><a href="#017-Letter-Combinations-of-a-Phone-Number" class="headerlink" title="017 Letter Combinations of a Phone Number"></a><a href="#">017 Letter Combinations of a Phone Number</a></h1><h2 id="Description-16"><a href="#Description-16" class="headerlink" title="Description"></a>Description</h2><p>Given a digit string, return all possible letter combinations that the number could represent.</p><p>A mapping of digit to letters (just like on the telephone buttons) is given below.</p><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/Telephone-keypad2.svg/200px-Telephone-keypad2.svg.png" alt="img"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input:Digit string &quot;23&quot;</div><div class="line">Output: [&quot;ad&quot;, &quot;ae&quot;, &quot;af&quot;, &quot;bd&quot;, &quot;be&quot;, &quot;bf&quot;, &quot;cd&quot;, &quot;ce&quot;, &quot;cf&quot;].</div></pre></td></tr></table></figure><p><strong>Note:</strong></p><p>Although the above answer is in lexicographical order, your answer could be in any order you want.</p><p><strong>Tags:</strong> String, Backtracking</p><h2 id="思路-0-5"><a href="#思路-0-5" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是给你按键，让你组合出所有不同结果，首先想到的肯定是回溯了，对每个按键的所有情况进行回溯，回溯的终点就是结果字符串长度和按键长度相同。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String[] map = <span class="keyword">new</span> String[]&#123;<span class="string">"abc"</span>, <span class="string">"def"</span>, <span class="string">"ghi"</span>, <span class="string">"jkl"</span>, <span class="string">"mno"</span>, <span class="string">"pqrs"</span>, <span class="string">"tuv"</span>, <span class="string">"wxyz"</span>&#125;;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">letterCombinations</span><span class="params">(String digits)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (digits.length() == <span class="number">0</span>) <span class="keyword">return</span> Collections.emptyList();</div><div class="line">        List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        helper(list, digits, <span class="string">""</span>);</div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(List&lt;String&gt; list, String digits, String ans)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (ans.length() == digits.length()) &#123;</div><div class="line">            list.add(ans);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : map[digits.charAt(ans.length()) - <span class="string">'2'</span>].toCharArray()) &#123;</div><div class="line">            helper(list, digits, ans + c);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-5"><a href="#思路-1-5" class="headerlink" title="思路 1"></a>思路 1</h2><p>还有一种思路就是利用队列，根据上一次队列中的值，该值拼接当前可选值来不断迭代其结果，具体代码如下。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String[] map = <span class="keyword">new</span> String[]&#123;<span class="string">"abc"</span>, <span class="string">"def"</span>, <span class="string">"ghi"</span>, <span class="string">"jkl"</span>, <span class="string">"mno"</span>, <span class="string">"pqrs"</span>, <span class="string">"tuv"</span>, <span class="string">"wxyz"</span>&#125;;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">letterCombinations</span><span class="params">(String digits)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (digits.length() == <span class="number">0</span>) <span class="keyword">return</span> Collections.emptyList();</div><div class="line">        LinkedList&lt;String&gt; list = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        list.add(<span class="string">""</span>);</div><div class="line">        <span class="keyword">char</span>[] charArray = digits.toCharArray();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; charArray.length; i++) &#123;</div><div class="line">            <span class="keyword">char</span> c = charArray[i];</div><div class="line">            <span class="keyword">while</span> (list.getFirst().length() == i) &#123;</div><div class="line">                String pop = list.removeFirst();</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">char</span> v : map[c - <span class="string">'2'</span>].toCharArray()) &#123;</div><div class="line">                    list.addLast(pop + v);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="018-4Sum"><a href="#018-4Sum" class="headerlink" title="018 4Sum"></a><a href="#">018 4Sum</a></h1><h2 id="Description-17"><a href="#Description-17" class="headerlink" title="Description"></a>Description</h2><p>Given an array <em>S</em> of <em>n</em> integers, are there elements <em>a</em>, <em>b</em>, <em>c</em>, and <em>d</em> in <em>S</em> such that <em>a</em> + <em>b</em> + <em>c</em> + <em>d</em> = target? Find all unique quadruplets in the array which gives the sum of target.</p><p><strong>Note:</strong> The solution set must not contain duplicate quadruplets.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">For example, given array S = [1, 0, -1, 0, -2, 2], and target = 0.</div><div class="line"></div><div class="line">A solution set is:</div><div class="line">[</div><div class="line">  [-1,  0, 0, 1],</div><div class="line">  [-2, -1, 1, 2],</div><div class="line">  [-2,  0, 0, 2]</div><div class="line">]</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Array, Hash Table, Two Pointers</p><h2 id="思路-0-6"><a href="#思路-0-6" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是让你从数组中找出所有四个数的和为 <code>target</code> 的元素构成的非重复序列，该题和 [3Sum][015] 的思路基本一样，先对数组进行排序，然后遍历这个排序数组，因为这次是四个元素的和，所以外层需要两重循环，然后还是用两个指针分别指向当前元素的下一个和数组尾部，判断四者的和与 <code>target</code> 的大小来移动两个指针，其中细节操作还是优化和去重。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; fourSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</div><div class="line">        List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> len = nums.length;</div><div class="line">        <span class="keyword">if</span> (len &lt; <span class="number">4</span>) <span class="keyword">return</span> res;</div><div class="line">        Arrays.sort(nums);</div><div class="line">        <span class="keyword">int</span> max = nums[len - <span class="number">1</span>];</div><div class="line">        <span class="keyword">if</span> (<span class="number">4</span> * max &lt; target) <span class="keyword">return</span> res;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">3</span>;) &#123;</div><div class="line">            <span class="keyword">if</span> (nums[i] * <span class="number">4</span> &gt; target) <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">if</span> (nums[i] + <span class="number">3</span> * max &lt; target) &#123;</div><div class="line">                <span class="keyword">while</span> (nums[i] == nums[++i] &amp;&amp; i &lt; len - <span class="number">3</span>) ;</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; len - <span class="number">2</span>;) &#123;</div><div class="line">                <span class="keyword">int</span> subSum = nums[i] + nums[j];</div><div class="line">                <span class="keyword">if</span> (nums[i] + nums[j] * <span class="number">3</span> &gt; target) <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">if</span> (subSum + <span class="number">2</span> * max &lt; target) &#123;</div><div class="line">                    <span class="keyword">while</span> (nums[j] == nums[++j] &amp;&amp; j &lt; len - <span class="number">2</span>) ;</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="keyword">int</span> left = j + <span class="number">1</span>, right = len - <span class="number">1</span>;</div><div class="line">                <span class="keyword">while</span> (left &lt; right) &#123;</div><div class="line">                    <span class="keyword">int</span> sum = subSum + nums[left] + nums[right];</div><div class="line">                    <span class="keyword">if</span> (sum == target) &#123;</div><div class="line">                        res.add(Arrays.asList(nums[i], nums[j], nums[left], nums[right]));</div><div class="line">                        <span class="keyword">while</span> (nums[left] == nums[++left] &amp;&amp; left &lt; right);</div><div class="line">                        <span class="keyword">while</span> (nums[right] == nums[--right] &amp;&amp; left &lt; right);</div><div class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sum &lt; target) ++left;</div><div class="line">                    <span class="keyword">else</span> --right;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">while</span> (nums[j] == nums[++j] &amp;&amp; j &lt; len - <span class="number">2</span>) ;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">while</span> (nums[i] == nums[++i] &amp;&amp; i &lt; len - <span class="number">3</span>) ;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-6"><a href="#思路-1-6" class="headerlink" title="思路 1"></a>思路 1</h2><p>从 [Two Sum][001]、[3Sum][015] 到现在的 4Sum，其实都是把高阶降为低阶，那么我们就可以写出 kSum 的函数来对其进行降阶处理，降到 2Sum 后那么我们就可以对其进行最后的判断了，代码如下所示，其也做了相应的优化和去重。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; fourSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</div><div class="line">        Arrays.sort(nums);</div><div class="line">        <span class="keyword">int</span> len = nums.length;</div><div class="line">        <span class="keyword">if</span> (len &lt; <span class="number">4</span>) <span class="keyword">return</span> Collections.emptyList();</div><div class="line">        <span class="keyword">int</span> max = nums[len - <span class="number">1</span>];</div><div class="line">        <span class="keyword">if</span> (<span class="number">4</span> * max &lt; target) <span class="keyword">return</span> Collections.emptyList();</div><div class="line">        <span class="keyword">return</span> kSum(nums, <span class="number">0</span>, <span class="number">4</span>, target);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> List&lt;List&lt;Integer&gt;&gt; kSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> start, <span class="keyword">int</span> k, <span class="keyword">int</span> target) &#123;</div><div class="line">        List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">if</span> (k == <span class="number">2</span>) &#123;</div><div class="line">            <span class="keyword">int</span> left = start, right = nums.length - <span class="number">1</span>;</div><div class="line">            <span class="keyword">while</span> (left &lt; right) &#123;</div><div class="line">                <span class="keyword">int</span> sum = nums[left] + nums[right];</div><div class="line">                <span class="keyword">if</span> (sum == target) &#123;</div><div class="line">                    List&lt;Integer&gt; twoSum = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">                    twoSum.add(nums[left]);</div><div class="line">                    twoSum.add(nums[right]);</div><div class="line">                    res.add(twoSum);</div><div class="line">                    <span class="keyword">while</span> (nums[left] == nums[++left] &amp;&amp; left &lt; right) ;</div><div class="line">                    <span class="keyword">while</span> (nums[right] == nums[--right] &amp;&amp; left &lt; right) ;</div><div class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sum &lt; target) ++left;</div><div class="line">                <span class="keyword">else</span> --right;</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">int</span> i = start, end = nums.length - (k - <span class="number">1</span>), max = nums[nums.length - <span class="number">1</span>];</div><div class="line">            <span class="keyword">while</span> (i &lt; end) &#123;</div><div class="line">                <span class="keyword">if</span> (nums[i] * k &gt; target) <span class="keyword">return</span> res;</div><div class="line">                <span class="keyword">if</span> (nums[i] + (k - <span class="number">1</span>) * max &lt; target) &#123;</div><div class="line">                    <span class="keyword">while</span> (nums[i] == nums[++i] &amp;&amp; i &lt; end) ;</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                &#125;</div><div class="line">                List&lt;List&lt;Integer&gt;&gt; temp = kSum(nums, i + <span class="number">1</span>, k - <span class="number">1</span>, target - nums[i]);</div><div class="line">                <span class="keyword">for</span> (List&lt;Integer&gt; t : temp) &#123;</div><div class="line">                    t.add(<span class="number">0</span>, nums[i]);</div><div class="line">                &#125;</div><div class="line">                res.addAll(temp);</div><div class="line">                <span class="keyword">while</span> (nums[i] == nums[++i] &amp;&amp; i &lt; end) ;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="019-Remove-Nth-Node-From-End-of-List"><a href="#019-Remove-Nth-Node-From-End-of-List" class="headerlink" title="019 Remove Nth Node From End of List"></a><a href="#">019 Remove Nth Node From End of List</a></h1><h2 id="Description-18"><a href="#Description-18" class="headerlink" title="Description"></a>Description</h2><p>Given a linked list, remove the <em>n</em><sup>th</sup> node from the end of list and return its head.</p><p>For example,</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Given linked list: 1-&gt;2-&gt;3-&gt;4-&gt;5, and n = 2.</div><div class="line"></div><div class="line">After removing the second node from the end, the linked list becomes 1-&gt;2-&gt;3-&gt;5.</div></pre></td></tr></table></figure><p><strong>Note:</strong></p><p>Given <em>n</em> will always be valid.</p><p>Try to do this in one pass.</p><p><strong>Tags:</strong> Linked List, Two Pointers</p><h2 id="思路-11"><a href="#思路-11" class="headerlink" title="思路"></a>思路</h2><p>题意是让你删除链表中的倒数第 n 个数，我的解法是利用双指针，这两个指针相差 n 个元素，当后面的指针扫到链表末尾的时候，自然它前面的那个指针所指向的下一个元素就是要删除的元素，即 <code>pre.next = pre.next.next;</code>，但是如果一开始后面的指针指向的为空，此时代表的意思就是要删除第一个元素，即 <code>head = head.next;</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for singly-linked list.</span></div><div class="line"><span class="comment"> * public class ListNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     ListNode next;</span></div><div class="line"><span class="comment"> *     ListNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">removeNthFromEnd</span><span class="params">(ListNode head, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        ListNode pre = head;</div><div class="line">        ListNode afterPreN = head;</div><div class="line">        <span class="keyword">while</span> (n-- != <span class="number">0</span>) &#123;</div><div class="line">            afterPreN = afterPreN.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (afterPreN != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">while</span> (afterPreN.next != <span class="keyword">null</span>) &#123;</div><div class="line">                pre = pre.next;</div><div class="line">                afterPreN = afterPreN.next;</div><div class="line">            &#125;</div><div class="line">            pre.next = pre.next.next;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            head = head.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> head;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="020-Valid-Parentheses"><a href="#020-Valid-Parentheses" class="headerlink" title="020 Valid Parentheses"></a><a href="#">020 Valid Parentheses</a></h1><h2 id="Description-19"><a href="#Description-19" class="headerlink" title="Description"></a>Description</h2><p>Given a string containing just the characters <code>&#39;(&#39;</code>, <code>&#39;)&#39;</code>, <code>&#39;{&#39;</code>, <code>&#39;}&#39;</code>, <code>&#39;[&#39;</code> and <code>&#39;]&#39;</code>, determine if the input string is valid.</p><p>The brackets must close in the correct order, <code>&quot;()&quot;</code> and <code>&quot;()[]{}&quot;</code> are all valid but <code>&quot;(]&quot;</code> and <code>&quot;([)]&quot;</code> are not.</p><p><strong>Tags:</strong> Stack, String</p><h2 id="思路-12"><a href="#思路-12" class="headerlink" title="思路"></a>思路</h2><p>题意是判断括号匹配是否正确，很明显，我们可以用栈来解决这个问题，当出现左括号的时候入栈，当遇到右括号时，判断栈顶的左括号是否何其匹配，不匹配的话直接返回 <code>false</code> 即可，最终判断是否空栈即可，这里我们可以用数组模拟栈的操作使其操作更快，有个细节注意下 <code>top =  1;</code>，从而省去了之后判空的操作和 <code>top - 1</code> 导致数组越界的错误。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isValid</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">char</span>[] stack = <span class="keyword">new</span> <span class="keyword">char</span>[s.length() + <span class="number">1</span>];</div><div class="line">        <span class="keyword">int</span> top = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : s.toCharArray()) &#123;</div><div class="line">            <span class="keyword">if</span> (c == <span class="string">'('</span> || c == <span class="string">'['</span> || c == <span class="string">'&#123;'</span>) &#123;</div><div class="line">                stack[top++] = c; </div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">')'</span> &amp;&amp; stack[--top] != <span class="string">'('</span>) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">']'</span> &amp;&amp; stack[--top] != <span class="string">'['</span>) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">'&#125;'</span> &amp;&amp; stack[--top] != <span class="string">'&#123;'</span>) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> top == <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="021-Merge-Two-Sorted-Lists"><a href="#021-Merge-Two-Sorted-Lists" class="headerlink" title="021 Merge Two Sorted Lists"></a><a href="#">021 Merge Two Sorted Lists</a></h1><h2 id="Description-20"><a href="#Description-20" class="headerlink" title="Description"></a>Description</h2><p>Merge two sorted linked lists and return it as a new list. The new list should be made by splicing together the nodes of the first two lists.</p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: 1-&gt;2-&gt;4, 1-&gt;3-&gt;4</div><div class="line">Output: 1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Linked List</p><h2 id="思路-13"><a href="#思路-13" class="headerlink" title="思路"></a>思路</h2><p>题意是用一个新链表来合并两个已排序的链表，那我们只需要从头开始比较已排序的两个链表，新链表指针每次指向值小的节点，依次比较下去，最后，当其中一个链表到达了末尾，我们只需要把新链表指针指向另一个没有到末尾的链表此时的指针即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for singly-linked list.</span></div><div class="line"><span class="comment"> * public class ListNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     ListNode next;</span></div><div class="line"><span class="comment"> *     ListNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">mergeTwoLists</span><span class="params">(ListNode l1, ListNode l2)</span> </span>&#123;</div><div class="line">        ListNode head = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</div><div class="line">        ListNode temp = head;</div><div class="line">        <span class="keyword">while</span> (l1 != <span class="keyword">null</span> &amp;&amp; l2 != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">if</span> (l1.val &lt; l2.val) &#123;</div><div class="line">                temp.next = l1;</div><div class="line">                l1 = l1.next;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                temp.next = l2;</div><div class="line">                l2 = l2.next;</div><div class="line">            &#125;</div><div class="line">            temp = temp.next;</div><div class="line">        &#125;</div><div class="line">        temp.next = l1 != <span class="keyword">null</span> ? l1 : l2;</div><div class="line">        <span class="keyword">return</span> head.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="022-Generate-Parentheses"><a href="#022-Generate-Parentheses" class="headerlink" title="022 Generate Parentheses"></a><a href="#">022 Generate Parentheses</a></h1><h2 id="Description-21"><a href="#Description-21" class="headerlink" title="Description"></a>Description</h2><p>Given <em>n</em> pairs of parentheses, write a function to generate all combinations of well-formed parentheses.</p><p>For example, given <em>n</em> = 3, a solution set is:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &quot;((()))&quot;,</div><div class="line">  &quot;(()())&quot;,</div><div class="line">  &quot;(())()&quot;,</div><div class="line">  &quot;()(())&quot;,</div><div class="line">  &quot;()()()&quot;</div><div class="line">]</div></pre></td></tr></table></figure><p><strong>Tags:</strong> String, Backtracking</p><h2 id="思路-0-7"><a href="#思路-0-7" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是给你 <code>n</code> 值，让你找到所有格式正确的圆括号匹配组，题目中已经给出了 <code>n = 3</code> 的所有结果。遇到这种问题，第一直觉就是用到递归或者堆栈，我们选取递归来解决，也就是 <code>helper</code> 函数的功能，从参数上来看肯定很好理解了，<code>leftRest</code> 代表还有几个左括号可以用，<code>rightNeed</code> 代表还需要几个右括号才能匹配，初始状态当然是 <code>rightNeed = 0, leftRest = n</code>，递归的终止状态就是 <code>rightNeed == 0 &amp;&amp; leftRest == 0</code>，也就是左右括号都已匹配完毕，然后把 <code>str</code> 加入到链表中即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">generateParenthesis</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        helper(list, <span class="string">""</span>, <span class="number">0</span>, n);</div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(List&lt;String&gt; list, String str, <span class="keyword">int</span> rightNeed, <span class="keyword">int</span> leftRest)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (rightNeed == <span class="number">0</span> &amp;&amp; leftRest == <span class="number">0</span>) &#123;</div><div class="line">            list.add(str);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (rightNeed &gt; <span class="number">0</span>) helper(list, str + <span class="string">")"</span>, rightNeed - <span class="number">1</span>, leftRest);</div><div class="line">        <span class="keyword">if</span> (leftRest &gt; <span class="number">0</span>) helper(list, str + <span class="string">"("</span>, rightNeed + <span class="number">1</span>, leftRest - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-7"><a href="#思路-1-7" class="headerlink" title="思路 1"></a>思路 1</h2><p>另一种实现方式就是迭代的思想了，我们来找寻其规律如下所示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">f(0): “”</div><div class="line"></div><div class="line">f(1): “(“f(0)”)”</div><div class="line"></div><div class="line">f(2): &quot;(“f(0)”)&quot;f(1), “(“f(1)”)”</div><div class="line"></div><div class="line">f(3): &quot;(“f(0)”)&quot;f(2), &quot;(“f(1)”)&quot;f(1), “(“f(2)”)”</div><div class="line">...</div></pre></td></tr></table></figure><p>可以递推出 <code>f(n) = &quot;(“f(0)”)&quot;f(n-1) , &quot;(“f(1)”)&quot;f(n-2) &quot;(“f(2)”)&quot;f(n-3) … &quot;(“f(i)”)“f(n-1-i) … “(f(n-1)”)”</code></p><p>根据如上递推式写出如下代码应该不难了吧。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">generateParenthesis</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        HashMap&lt;Integer, List&lt;String&gt;&gt; hashMap = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        hashMap.put(<span class="number">0</span>, Collections.singletonList(<span class="string">""</span>));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">            List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</div><div class="line">                <span class="keyword">for</span> (String fj : hashMap.get(j)) &#123;</div><div class="line">                    <span class="keyword">for</span> (String fi_j_1 : hashMap.get(i - j - <span class="number">1</span>)) &#123;</div><div class="line">                        list.add(<span class="string">"("</span> + fj + <span class="string">")"</span> + fi_j_1);<span class="comment">// calculate f(i)</span></div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            hashMap.put(i, list);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> hashMap.get(n);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="023-Merge-k-Sorted-Lists"><a href="#023-Merge-k-Sorted-Lists" class="headerlink" title="023 Merge k Sorted Lists"></a><a href="#">023 Merge k Sorted Lists</a></h1><h2 id="Description-22"><a href="#Description-22" class="headerlink" title="Description"></a>Description</h2><p>Merge <em>k</em> sorted linked lists and return it as one sorted list. Analyze and describe its complexity.</p><p><strong>Tags:</strong> Linked List, Divide and Conquer, Heap</p><h2 id="思路-0-8"><a href="#思路-0-8" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是合并多个已排序的链表，分析并描述其复杂度，我们可以用分治法来两两合并他们，假设 <code>k</code> 为总链表个数，<code>N</code> 为总元素个数，那么其时间复杂度为 <code>O(Nlogk)</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for singly-linked list.</span></div><div class="line"><span class="comment"> * public class ListNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     ListNode next;</span></div><div class="line"><span class="comment"> *     ListNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">mergeKLists</span><span class="params">(ListNode[] lists)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (lists.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">return</span> helper(lists, <span class="number">0</span>, lists.length - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> ListNode <span class="title">helper</span><span class="params">(ListNode[] lists, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (left &gt;= right) <span class="keyword">return</span> lists[left];</div><div class="line">        <span class="keyword">int</span> mid = left + right &gt;&gt;&gt; <span class="number">1</span>;</div><div class="line">        ListNode l0 = helper(lists, left, mid);</div><div class="line">        ListNode l1 = helper(lists, mid + <span class="number">1</span>, right);</div><div class="line">        <span class="keyword">return</span> merge2Lists(l0, l1);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> ListNode <span class="title">merge2Lists</span><span class="params">(ListNode l0, ListNode l1)</span> </span>&#123;</div><div class="line">        ListNode node = <span class="keyword">new</span> ListNode(<span class="number">0</span>), tmp = node;</div><div class="line">        <span class="keyword">while</span> (l0 != <span class="keyword">null</span> &amp;&amp; l1 != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">if</span> (l0.val &lt;= l1.val) &#123;</div><div class="line">                tmp.next = <span class="keyword">new</span> ListNode(l0.val);</div><div class="line">                l0 = l0.next;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                tmp.next = <span class="keyword">new</span> ListNode(l1.val);</div><div class="line">                l1 = l1.next;</div><div class="line">            &#125;</div><div class="line">            tmp = tmp.next;</div><div class="line">        &#125;</div><div class="line">        tmp.next = l0 != <span class="keyword">null</span> ? l0 : l1;</div><div class="line">        <span class="keyword">return</span> node.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-8"><a href="#思路-1-8" class="headerlink" title="思路 1"></a>思路 1</h2><p>还有另一种思路是利用优先队列，该数据结构用到的是堆排序，所以对总链表个数为 <code>k</code> 的复杂度为 <code>logk</code>，总元素为个数为 <code>N</code> 的话，其时间复杂度也为 <code>O(Nlogk)</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for singly-linked list.</span></div><div class="line"><span class="comment"> * public class ListNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     ListNode next;</span></div><div class="line"><span class="comment"> *     ListNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">mergeKLists</span><span class="params">(ListNode[] lists)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (lists.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        PriorityQueue&lt;ListNode&gt; queue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(lists.length, <span class="keyword">new</span> Comparator&lt;ListNode&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(ListNode o1, ListNode o2)</span> </span>&#123;</div><div class="line">                <span class="keyword">if</span> (o1.val &lt; o2.val) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (o1.val == o2.val) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">                <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        ListNode node = <span class="keyword">new</span> ListNode(<span class="number">0</span>), tmp = node;</div><div class="line">        <span class="keyword">for</span> (ListNode l : lists) &#123;</div><div class="line">            <span class="keyword">if</span> (l != <span class="keyword">null</span>) queue.add(l);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (!queue.isEmpty()) &#123;</div><div class="line">            tmp.next = queue.poll();</div><div class="line">            tmp = tmp.next;</div><div class="line">            <span class="keyword">if</span> (tmp.next != <span class="keyword">null</span>) queue.add(tmp.next);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> node.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="024-Swap-Nodes-in-Pairs"><a href="#024-Swap-Nodes-in-Pairs" class="headerlink" title="024 Swap Nodes in Pairs"></a><a href="#">024 Swap Nodes in Pairs</a></h1><h2 id="Description-23"><a href="#Description-23" class="headerlink" title="Description"></a>Description</h2><p>Given a linked list, swap every two adjacent nodes and return its head.</p><p>For example,<br>Given <code>1-&gt;2-&gt;3-&gt;4</code>, you should return the list as <code>2-&gt;1-&gt;4-&gt;3</code>.</p><p>Your algorithm should use only constant space. You may <strong>not</strong> modify the values in the list, only nodes itself can be changed.</p><p><strong>Tags:</strong> Linked List</p><h2 id="思路-0-9"><a href="#思路-0-9" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是让你交换链表中相邻的两个节点，最终返回交换后链表的头，限定你空间复杂度为 O(1)。我们可以用递归来算出子集合的结果，递归的终点就是指针指到链表末少于两个元素时，如果不是终点，那么我们就对其两节点进行交换，这里我们需要一个临时节点来作为交换桥梁，就不多说了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for singly-linked list.</span></div><div class="line"><span class="comment"> * public class ListNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     ListNode next;</span></div><div class="line"><span class="comment"> *     ListNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">swapPairs</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) <span class="keyword">return</span> head;</div><div class="line">        ListNode node = head.next;</div><div class="line">        head.next = swapPairs(node.next);</div><div class="line">        node.next = head;</div><div class="line">        <span class="keyword">return</span> node;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-9"><a href="#思路-1-9" class="headerlink" title="思路 1"></a>思路 1</h2><p>另一种实现方式就是用循环来实现了，两两交换节点，也需要一个临时节点来作为交换桥梁，直到当前指针指到链表末少于两个元素时停止，代码很简单，如下所示。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for singly-linked list.</span></div><div class="line"><span class="comment"> * public class ListNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     ListNode next;</span></div><div class="line"><span class="comment"> *     ListNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">swapPairs</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">        ListNode preHead = <span class="keyword">new</span> ListNode(<span class="number">0</span>), cur = preHead;</div><div class="line">        preHead.next = head;</div><div class="line">        <span class="keyword">while</span> (cur.next != <span class="keyword">null</span> &amp;&amp; cur.next.next != <span class="keyword">null</span>) &#123;</div><div class="line">            ListNode temp = cur.next.next;</div><div class="line">            cur.next.next = temp.next;</div><div class="line">            temp.next = cur.next;</div><div class="line">            cur.next = temp;</div><div class="line">            cur = cur.next.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> preHead.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="025-Reverse-Nodes-in-k-Group"><a href="#025-Reverse-Nodes-in-k-Group" class="headerlink" title="025 Reverse Nodes in k-Group"></a><a href="#">025 Reverse Nodes in k-Group</a></h1><h2 id="Description-24"><a href="#Description-24" class="headerlink" title="Description"></a>Description</h2><p>Given a linked list, reverse the nodes of a linked list <em>k</em> at a time and return its modified list.</p><p><em>k</em> is a positive integer and is less than or equal to the length of the linked list. If the number of nodes is not a multiple of <em>k</em> then left-out nodes in the end should remain as it is.</p><p>You may not alter the values in the nodes, only nodes itself may be changed.</p><p>Only constant memory is allowed.</p><p>For example,</p><p>Given this linked list: <code>1-&gt;2-&gt;3-&gt;4-&gt;5</code></p><p>For <em>k</em> = 2, you should return: <code>2-&gt;1-&gt;4-&gt;3-&gt;5</code></p><p>For <em>k</em> = 3, you should return: <code>3-&gt;2-&gt;1-&gt;4-&gt;5</code></p><p><strong>Tags:</strong> Linked List</p><h2 id="思路-14"><a href="#思路-14" class="headerlink" title="思路"></a>思路</h2><p>题意是让你以 <code>k</code> 个元素为一组来翻转链表，最后不足 <code>k</code> 个的话不需要翻转，最传统的思路就是每遇到 <code>k</code> 个元素，对其 <code>k</code> 个元素进行翻转，而难点就是在此，下面介绍其原理，我们以例子中的 <code>k = 3</code> 为例，其 <code>pre</code> 和 <code>next</code> 如下所示。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">0-&gt;1-&gt;2-&gt;3-&gt;4-&gt;5</div><div class="line">|           |</div><div class="line">pre        next</div></pre></td></tr></table></figure><p>我们要做的就是把 <code>pre</code> 和 <code>next</code> 之间的元素逆序，思想是依次从第二个元素到第 <code>k</code> 个元素，依次把它插入到 <code>pre</code> 后面，过程如下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> head move</div><div class="line">   |  |</div><div class="line">0-&gt;1-&gt;2-&gt;3-&gt;4-&gt;5</div><div class="line">|           |</div><div class="line">pre        next</div><div class="line"></div><div class="line">    head move</div><div class="line">      |  |</div><div class="line">0-&gt;2-&gt;1-&gt;3-&gt;4-&gt;5</div><div class="line">|           |</div><div class="line">pre        next</div><div class="line"></div><div class="line">       head move</div><div class="line">         |  |</div><div class="line">0-&gt;3-&gt;2-&gt;1-&gt;4-&gt;5</div><div class="line">|           |</div><div class="line">pre        next</div></pre></td></tr></table></figure><p>好了，根据原理，那写出代码就不难了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for singly-linked list.</span></div><div class="line"><span class="comment"> * public class ListNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     ListNode next;</span></div><div class="line"><span class="comment"> *     ListNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">reverseKGroup</span><span class="params">(ListNode head, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (head == <span class="keyword">null</span> || k == <span class="number">1</span>) <span class="keyword">return</span> head;</div><div class="line">        ListNode node = <span class="keyword">new</span> ListNode(<span class="number">0</span>), pre = node;</div><div class="line">        node.next = head;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; head != <span class="keyword">null</span>; ++i) &#123;</div><div class="line">            <span class="keyword">if</span> (i % k == <span class="number">0</span>) &#123;</div><div class="line">                pre = reverse(pre, head.next);</div><div class="line">                head = pre.next;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                head = head.next;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> node.next;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> ListNode <span class="title">reverse</span><span class="params">(ListNode pre, ListNode next)</span> </span>&#123;</div><div class="line">        ListNode head = pre.next;</div><div class="line">        ListNode move = head.next;</div><div class="line">        <span class="keyword">while</span> (move != next) &#123;</div><div class="line">            head.next = move.next;</div><div class="line">            move.next = pre.next;</div><div class="line">            pre.next = move;</div><div class="line">            move = head.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> head;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="026-Remove-Duplicates-from-Sorted-Array"><a href="#026-Remove-Duplicates-from-Sorted-Array" class="headerlink" title="026 Remove Duplicates from Sorted Array"></a><a href="#">026 Remove Duplicates from Sorted Array</a></h1><h2 id="Description-25"><a href="#Description-25" class="headerlink" title="Description"></a>Description</h2><p>Given a sorted array, remove the duplicates <a href="https://en.wikipedia.org/wiki/In-place_algorithm" target="_blank" rel="external"><strong>in-place</strong></a> such that each element appear only <em>once</em> and return the new length.</p><p>Do not allocate extra space for another array, you must do this by <strong>modifying the input array in-place</strong> with O(1) extra memory.</p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Given nums = [1,1,2],</div><div class="line"></div><div class="line">Your function should return length = 2, with the first two elements of nums being 1 and 2 respectively.</div><div class="line">It doesn&apos;t matter what you leave beyond the new length.</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Array, Two Pointers</p><h2 id="思路-15"><a href="#思路-15" class="headerlink" title="思路"></a>思路</h2><p>题意是让你从一个有序的数组中移除重复的元素，并返回之后数组的长度。我的思路是判断长度小于等于 1 的话直接返回原长度即可，否则的话遍历一遍数组，用一个 <code>tail</code> 变量指向尾部，如果后面的元素和前面的元素不同，就让 <code>tail</code> 变量加一，最后返回 <code>tail</code> 即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">removeDuplicates</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> len = nums.length;</div><div class="line">        <span class="keyword">if</span> (len &lt;= <span class="number">1</span>) <span class="keyword">return</span> len;</div><div class="line">        <span class="keyword">int</span> tail = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i) &#123;</div><div class="line">            <span class="keyword">if</span> (nums[i - <span class="number">1</span>] != nums[i]) &#123;</div><div class="line">                nums[tail++] = nums[i];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> tail;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="027-Remove-Element"><a href="#027-Remove-Element" class="headerlink" title="027 Remove Element"></a><a href="#">027 Remove Element</a></h1><h2 id="Description-26"><a href="#Description-26" class="headerlink" title="Description"></a>Description</h2><p>Given an array and a value, remove all instances of that value <a href="https://en.wikipedia.org/wiki/In-place_algorithm" target="_blank" rel="external"><strong>in-place</strong></a> and return the new length.</p><p>Do not allocate extra space for another array, you must do this by <strong>modifying the input array <a href="https://en.wikipedia.org/wiki/In-place_algorithm" target="_blank" rel="external">in-place</a></strong> with O(1) extra memory.</p><p>The order of elements can be changed. It doesn’t matter what you leave beyond the new length.</p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Given nums = [3,2,2,3], val = 3,</div><div class="line"></div><div class="line">Your function should return length = 2, with the first two elements of nums being 2.</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Array, Two Pointers</p><h2 id="思路-16"><a href="#思路-16" class="headerlink" title="思路"></a>思路</h2><p>题意是移除数组中值等于 <code>val</code> 的元素，并返回之后数组的长度，并且题目中指定空间复杂度为 O(1)，我的思路是用 <code>tail</code> 标记尾部，遍历该数组时当索引元素不等于 <code>val</code> 时，<code>tail</code> 加一，尾部指向当前元素，最后返回 <code>tail</code> 即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">removeElement</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> tail = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, len = nums.length; i &lt; len; ++i) &#123;</div><div class="line">            <span class="keyword">if</span> (nums[i] != val) &#123;</div><div class="line">                nums[tail++] = nums[i];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> tail;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="028-Implement-strStr"><a href="#028-Implement-strStr" class="headerlink" title="028 Implement strStr()"></a><a href="#">028 Implement strStr()</a></h1><h2 id="Description-27"><a href="#Description-27" class="headerlink" title="Description"></a>Description</h2><p>Implement <a href="http://www.cplusplus.com/reference/cstring/strstr/" target="_blank" rel="external">strStr()</a>.</p><p>Return the index of the first occurrence of needle in haystack, or <strong>-1</strong> if needle is not part of haystack.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: haystack = &quot;hello&quot;, needle = &quot;ll&quot;</div><div class="line">Output: 2</div></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: haystack = &quot;aaaaa&quot;, needle = &quot;bba&quot;</div><div class="line">Output: -1</div></pre></td></tr></table></figure><p>Tags:** Two Pointers, String</p><h2 id="思路-17"><a href="#思路-17" class="headerlink" title="思路"></a>思路</h2><p>题意是从主串中找到子串的索引，如果找不到则返回-1，当子串长度大于主串，直接返回-1，然后我们只需要遍历比较即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">strStr</span><span class="params">(String haystack, String needle)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> l1 = haystack.length(), l2 = needle.length();</div><div class="line">        <span class="keyword">if</span> (l1 &lt; l2) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; ; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (i + l2 &gt; l1) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; ; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (j == l2) <span class="keyword">return</span> i;</div><div class="line">                <span class="keyword">if</span> (haystack.charAt(i + j) != needle.charAt(j)) <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="029-Divide-Two-Integers"><a href="#029-Divide-Two-Integers" class="headerlink" title="029 Divide Two Integers"></a><a href="#">029 Divide Two Integers</a></h1><h2 id="Description-28"><a href="#Description-28" class="headerlink" title="Description"></a>Description</h2><p>Divide two integers without using multiplication, division and mod operator.</p><p>If it is overflow, return MAX_INT.</p><p><strong>Tags:</strong> Math, Binary Search</p><h2 id="思路-18"><a href="#思路-18" class="headerlink" title="思路"></a>思路</h2><p>题意是让你算两个整型数相除后的结果，如果结果溢出就返回 <code>MAX_INT</code>，但不能使用乘、除、余的操作符，如果是用加减操作符的话肯定会超时哈，这样的话我们就只能想到位操作符了。</p><p>首先，我们分析下溢出的情况，也就是当被除数为 <code>Integer.MIN_VALUE</code>，除数为 <code>-1</code> 时会溢出，因为 <code>|Integer.MIN_VALUE| = Integer.MAX_VALUE + 1</code>。</p><p>然后，我们把除数和被除数都转为 <code>long</code> 类型的正数去做下一步操作，我这里以 <code>22</code> 和 <code>3</code> 相除为例子，因为 <code>22 &gt;= 3</code>，我们对 <code>3</code> 进行左移一位，也就是乘 2，结果为 <code>6</code>，比 <code>22</code> 小，我们继续对 <code>6</code> 左移一位结果为 <code>12</code>，还是比 <code>22</code> 小，我们继续对 <code>12</code> 左移一位为 <code>24</code>，比 <code>22</code> 大，这时我们可以分析出，<code>22</code> 肯定比 <code>3</code> 的 <code>4</code> 倍要大，<code>4</code> 是怎么来的？因为我们左移了两次，也就是 <code>1 &lt;&lt; 2 = 4</code>，此时我们记下这个 <code>4</code>，然后让 <code>22 - 3 * 4 = 10</code>，因为 <code>10 &gt;= 3</code>，对 <code>10</code> 和 <code>3</code> 进行同样的操作，我们可以得到 <code>2</code>，此时加上上次的 <code>4</code>，和为 <code>6</code>，也就是 <code>22</code> 比 <code>3</code> 的 <code>6</code> 倍要大，此时还剩余 <code>10 - 6 = 4</code>，因为 <code>4 &gt;= 3</code>，所以对 <code>4</code> 和 <code>3</code> 进行同样的操作，我们发现并不能对 <code>3</code> 进行左移了，因为 <code>4 &gt;= 3</code>，所以 <code>1</code> 倍还是有的，所以加上最后的 <code>1</code>，结果为 <code>6 + 1 = 7</code>，也就是 <code>22</code> 整除 <code>3</code> 结果为 <code>7</code>。</p><p>最终，我们对结果赋予符号位即可，根据以上思路来书写如下代码应该不是难事了吧。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">divide</span><span class="params">(<span class="keyword">int</span> dividend, <span class="keyword">int</span> divisor)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (dividend == Integer.MIN_VALUE &amp;&amp; divisor == -<span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">return</span> Integer.MAX_VALUE;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">long</span> dvd = Math.abs((<span class="keyword">long</span>) dividend);</div><div class="line">        <span class="keyword">long</span> dvr = Math.abs((<span class="keyword">long</span>) divisor);</div><div class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (dvd &gt;= dvr) &#123;</div><div class="line">            <span class="keyword">long</span> temp = dvr, multiple = <span class="number">1</span>;</div><div class="line">            <span class="keyword">while</span> (dvd &gt;= temp &lt;&lt; <span class="number">1</span>) &#123;</div><div class="line">                temp &lt;&lt;= <span class="number">1</span>;</div><div class="line">                multiple &lt;&lt;= <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            dvd -= temp;</div><div class="line">            res += multiple;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> (dividend &lt; <span class="number">0</span>) ^ (divisor &lt; <span class="number">0</span>) ? -res : res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="033-Search-in-Rotated-Sorted-Array"><a href="#033-Search-in-Rotated-Sorted-Array" class="headerlink" title="033 Search in Rotated Sorted Array"></a><a href="#">033 Search in Rotated Sorted Array</a></h1><h2 id="Description-29"><a href="#Description-29" class="headerlink" title="Description"></a>Description</h2><p>Suppose an array sorted in ascending order is rotated at some pivot unknown to you beforehand.</p><p>(i.e., <code>0 1 2 4 5 6 7</code> might become <code>4 5 6 7 0 1 2</code>).</p><p>You are given a target value to search. If found in the array return its index, otherwise return -1.</p><p>You may assume no duplicate exists in the array.</p><p><strong>Tags:</strong> Arrays, Binary Search</p><h2 id="思路-19"><a href="#思路-19" class="headerlink" title="思路"></a>思路</h2><p>题意是让你从一个旋转过后的递增序列中寻找给定值，找到返回索引，找不到返回-1，我们在下面这组数据中寻找规律。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">1 2 4 5 6 7 0</div><div class="line">2 4 5 6 7 0 1</div><div class="line">4 5 6 7 0 1 2</div><div class="line">5 6 7 0 1 2 4</div><div class="line">6 7 0 1 2 4 5</div><div class="line">7 0 1 2 4 5 6</div></pre></td></tr></table></figure><p>由于是旋转一次，所以肯定有一半及以上的序列仍然是具有递增性质的，我们观察到如果中间的数比左面的数大的话，那么左半部分序列是递增的，否则右半部分就是递增的，那么我们就可以确定给定值是否在递增序列中，从而决定取舍哪半边。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = nums.length - <span class="number">1</span>, mid;</div><div class="line">        <span class="keyword">while</span> (l &lt;= r) &#123;</div><div class="line">            mid = l + r &gt;&gt;&gt; <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span> (nums[mid] == target) <span class="keyword">return</span> mid;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (nums[mid] &gt;= nums[l]) &#123;</div><div class="line">                <span class="keyword">if</span> (nums[l] &lt;= target &amp;&amp; target &lt; nums[mid]) r = mid - <span class="number">1</span>;</div><div class="line">                <span class="keyword">else</span> l = mid + <span class="number">1</span>;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">if</span> (nums[mid] &lt; target &amp;&amp; target &lt;= nums[r]) l = mid + <span class="number">1</span>;</div><div class="line">                <span class="keyword">else</span> r = mid - <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="035-Search-Insert-Position"><a href="#035-Search-Insert-Position" class="headerlink" title="035 Search Insert Position"></a><a href="#">035 Search Insert Position</a></h1><h2 id="Description-30"><a href="#Description-30" class="headerlink" title="Description"></a>Description</h2><p>Given a sorted array and a target value, return the index if the target is found. If not, return the index where it would be if it were inserted in order.</p><p>You may assume no duplicates in the array.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: [1,3,5,6], 5</div><div class="line">Output: 2</div></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: [1,3,5,6], 2</div><div class="line">Output: 1</div></pre></td></tr></table></figure><p><strong>Example 3:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: [1,3,5,6], 7</div><div class="line">Output: 4</div></pre></td></tr></table></figure><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: [1,3,5,6], 0</div><div class="line">Output: 0</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Array, Binary Search</p><h2 id="思路-20"><a href="#思路-20" class="headerlink" title="思路"></a>思路</h2><p>题意是让你从一个没有重复元素的已排序数组中找到插入位置的索引。因为数组已排序，所以我们可以想到二分查找法，因为查找到的条件是找到第一个等于或者大于 <code>target</code> 的元素的位置，所以二分法略作变动即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">searchInsert</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = nums.length - <span class="number">1</span>, mid = (right + left) &gt;&gt; <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (left &lt;= right) &#123;</div><div class="line">            <span class="keyword">if</span> (target &lt;= nums[mid]) right = mid - <span class="number">1</span>;</div><div class="line">            <span class="keyword">else</span> left = mid + <span class="number">1</span>;</div><div class="line">            mid = (right + left) &gt;&gt; <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> left;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="038-Count-and-Say"><a href="#038-Count-and-Say" class="headerlink" title="038 Count and Say"></a><a href="#">038 Count and Say</a></h1><h2 id="Description-31"><a href="#Description-31" class="headerlink" title="Description"></a>Description</h2><p>The count-and-say sequence is the sequence of integers with the first five terms as following:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1.     1</div><div class="line">2.     11</div><div class="line">3.     21</div><div class="line">4.     1211</div><div class="line">5.     111221</div></pre></td></tr></table></figure><p><code>1</code> is read off as <code>&quot;one 1&quot;</code> or <code>11</code>.</p><p><code>11</code> is read off as <code>&quot;two 1s&quot;</code> or <code>21</code>.</p><p><code>21</code> is read off as <code>&quot;one 2</code>, then <code>one 1&quot;</code> or <code>1211</code>.</p><p>Given an integer <em>n</em>, generate the <em>n</em><sup>th</sup> term of the count-and-say sequence.</p><p>Note: Each term of the sequence of integers will be represented as a string.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: 1</div><div class="line">Output: &quot;1&quot;</div></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: 4</div><div class="line">Output: &quot;1211&quot;</div></pre></td></tr></table></figure><p><strong>Tags:</strong> String</p><h2 id="思路-21"><a href="#思路-21" class="headerlink" title="思路"></a>思路</h2><p>题意是数和说，根据如下序列 <code>1, 11, 21, 1211, 111221, ...</code>，求第 n 个数，规则很简单,就是数和说，数就是数这个数数字有几个，说就是说这个数，所以 <code>1</code> 就是 1 个 1：<code>11</code>,<code>11</code> 就是有 2 个 1：<code>21</code>，<code>21</code> 就是 1 个 2、1 个 1：<code>1211</code>，可想而知后面就是 <code>111221</code>，思路的话就是按这个逻辑模拟出来即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">countAndSay</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        String str = <span class="string">"1"</span>;</div><div class="line">        <span class="keyword">while</span> (--n &gt; <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">int</span> times = <span class="number">1</span>;</div><div class="line">            StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">            <span class="keyword">char</span>[] chars = str.toCharArray();</div><div class="line">            <span class="keyword">int</span> len = chars.length;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; len; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (chars[j - <span class="number">1</span>] == chars[j]) &#123;</div><div class="line">                    times++;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    sb.append(times).append(chars[j - <span class="number">1</span>]);</div><div class="line">                    times = <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            str = sb.append(times).append(chars[len - <span class="number">1</span>]).toString();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> str;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="043-Multiply-Strings"><a href="#043-Multiply-Strings" class="headerlink" title="043 Multiply Strings"></a><a href="#">043 Multiply Strings</a></h1><h2 id="Description-32"><a href="#Description-32" class="headerlink" title="Description"></a>Description</h2><p>Given two non-negative integers <code>num1</code> and <code>num2</code> represented as strings, return the product of <code>num1</code> and <code>num2</code>.</p><p><strong>Note:</strong></p><ol><li><p>The length of both <code>num1</code> and <code>num2</code> is &lt; 110.</p></li><li><p>Both <code>num1</code> and <code>num2</code> contains only digits <code>0-9</code>.</p></li><li><p>Both <code>num1</code> and <code>num2</code> does not contain any leading zero.</p></li><li><p>You <strong>must not use any built-in BigInteger library</strong> or <strong>convert the inputs to integer</strong> directly.</p></li></ol><p><strong>Tags:</strong> Math, String</p><h2 id="思路-22"><a href="#思路-22" class="headerlink" title="思路"></a>思路</h2><p>题意是让你计算两个非负字符串的乘积，我们模拟小学数学的方式来做，一位一位模拟计算，再各位累加。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">multiply</span><span class="params">(String num1, String num2)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (num1.equals(<span class="string">"0"</span>) || num2.equals(<span class="string">"0"</span>)) <span class="keyword">return</span> <span class="string">"0"</span>;</div><div class="line">        <span class="keyword">int</span> l1 = num1.length(), l2 = num2.length(), l = l1 + l2;</div><div class="line">        <span class="keyword">char</span>[] ans = <span class="keyword">new</span> <span class="keyword">char</span>[l];</div><div class="line">        <span class="keyword">char</span>[] c1 = num1.toCharArray();</div><div class="line">        <span class="keyword">char</span>[] c2 = num2.toCharArray();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l1 - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</div><div class="line">            <span class="keyword">int</span> c = c1[i] - <span class="string">'0'</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = l2 - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j) &#123;</div><div class="line">                ans[i + j + <span class="number">1</span>] +=  c * (c2[j] - <span class="string">'0'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l - <span class="number">1</span>; i &gt; <span class="number">0</span>; ++i) &#123;</div><div class="line">            <span class="keyword">if</span> (ans[i] &gt; <span class="number">9</span>) &#123;</div><div class="line">                ans[i - <span class="number">1</span>] += ans[i] / <span class="number">10</span>;</div><div class="line">                ans[i] %= <span class="number">10</span>;        </div><div class="line">            &#125;</div><div class="line">         &#125;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (; ; ++i) <span class="keyword">if</span> (ans[i] != <span class="number">0</span>) <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">for</span> (; i &lt; ans.length; ++i) sb.append((<span class="keyword">char</span>) (ans[i] + <span class="string">'0'</span>));</div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="044-Wildcard-Matching"><a href="#044-Wildcard-Matching" class="headerlink" title="044 Wildcard Matching"></a><a href="#">044 Wildcard Matching</a></h1><h2 id="Description-33"><a href="#Description-33" class="headerlink" title="Description"></a>Description</h2><p>Implement wildcard pattern matching with support for <code>&#39;?&#39;</code> and <code>&#39;*&#39;</code>.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&apos;?&apos; Matches any single character.</div><div class="line">&apos;*&apos; Matches any sequence of characters (including the empty sequence).</div><div class="line"></div><div class="line">The matching should cover the entire input string (not partial).</div><div class="line"></div><div class="line">The function prototype should be:</div><div class="line">bool isMatch(const char *s, const char *p)</div><div class="line"></div><div class="line">Some examples:</div><div class="line">isMatch(&quot;aa&quot;,&quot;a&quot;) → false</div><div class="line">isMatch(&quot;aa&quot;,&quot;aa&quot;) → true</div><div class="line">isMatch(&quot;aaa&quot;,&quot;aa&quot;) → false</div><div class="line">isMatch(&quot;aa&quot;, &quot;*&quot;) → true</div><div class="line">isMatch(&quot;aa&quot;, &quot;a*&quot;) → true</div><div class="line">isMatch(&quot;ab&quot;, &quot;?*&quot;) → true</div><div class="line">isMatch(&quot;aab&quot;, &quot;c*a*b&quot;) → false</div></pre></td></tr></table></figure><p><strong>Tags:</strong> String, Dynamic Programming, Backtracking, Greedy</p><h2 id="思路-0-10"><a href="#思路-0-10" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是让让你从判断 <code>s</code> 字符串是否通配符匹配于 <code>p</code>，这道题和[Regular Expression Matching][010]很是相似，区别在于 <code>*</code>，正则匹配的 <code>*</code> 不能单独存在，前面必须具有一个字符，其意义是表明前面的这个字符个数可以是任意个数，包括 0 个；而通配符的 <code>*</code> 是可以随意出现的，跟前面字符没有任何关系，其作用是可以表示任意字符串。在此我们可以利用 <em>贪心算法</em> 来解决这个问题，需要两个额外指针 <code>p</code> 和 <code>match</code> 来分别记录最后一个 <code>*</code> 的位置和 <code>*</code> 匹配到 <code>s</code> 字符串的位置，其贪心体现在如果遇到 <code>*</code>，那就尽可能取匹配后方的内容，如果匹配失败，那就回到上一个遇到 <code>*</code> 的位置来继续贪心。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isMatch</span><span class="params">(String s, String p)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (p.length() == <span class="number">0</span>) <span class="keyword">return</span> s.length() == <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> si = <span class="number">0</span>, pi = <span class="number">0</span>, match = <span class="number">0</span>, star = -<span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> sl = s.length(), pl = p.length();</div><div class="line">        <span class="keyword">char</span>[] sc = s.toCharArray(), pc = p.toCharArray();</div><div class="line">        <span class="keyword">while</span> (si &lt; sl) &#123;</div><div class="line">            <span class="keyword">if</span> (pi &lt; pl &amp;&amp; (pc[pi] == sc[si] || pc[pi] == <span class="string">'?'</span>)) &#123;</div><div class="line">                si++;</div><div class="line">                pi++;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pi &lt; pl &amp;&amp; pc[pi] == <span class="string">'*'</span>) &#123;</div><div class="line">                star = pi++;</div><div class="line">                match = si;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (star != -<span class="number">1</span>) &#123;</div><div class="line">                si = ++match;</div><div class="line">                pi = star + <span class="number">1</span>;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (pi &lt; pl &amp;&amp; pc[pi] == <span class="string">'*'</span>) pi++;</div><div class="line">        <span class="keyword">return</span> pi == pl;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-10"><a href="#思路-1-10" class="headerlink" title="思路 1"></a>思路 1</h2><p>另一种思路就是动态规划了，我们定义 <code>dp[i][j]</code> 的真假来表示 <code>s[0..i)</code> 是否匹配 <code>p[0..j)</code>，其状态转移方程如下所示：</p><ul><li><p>如果 <code>p[j - 1] != &#39;*&#39;</code>，<code>P[i][j] = P[i - 1][j - 1] &amp;&amp; (s[i - 1] == p[j - 1] || p[j - 1] == &#39;?&#39;);</code></p></li><li><p>如果 <code>p[j - 1] == &#39;*&#39;</code>，<code>P[i][j] = P[i][j - 1] || P[i - 1][j]</code></p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isMatch</span><span class="params">(String s, String p)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (p.length() == <span class="number">0</span>) <span class="keyword">return</span> s.length() == <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> sl = s.length(), pl = p.length();</div><div class="line">        <span class="keyword">boolean</span>[][] dp = <span class="keyword">new</span> <span class="keyword">boolean</span>[sl + <span class="number">1</span>][pl + <span class="number">1</span>];</div><div class="line">        <span class="keyword">char</span>[] sc = s.toCharArray(), pc = p.toCharArray();</div><div class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pl; ++i) &#123;</div><div class="line">            <span class="keyword">if</span> (pc[i - <span class="number">1</span>] == <span class="string">'*'</span>) dp[<span class="number">0</span>][i] = dp[<span class="number">0</span>][i - <span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= sl; ++i) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= pl; ++j) &#123;</div><div class="line">                <span class="keyword">if</span> (pc[j - <span class="number">1</span>] != <span class="string">'*'</span>) &#123;</div><div class="line">                    dp[i][j] = dp[i - <span class="number">1</span>][j - <span class="number">1</span>] &amp;&amp; (sc[i - <span class="number">1</span>] == pc[j - <span class="number">1</span>] || pc[j - <span class="number">1</span>] == <span class="string">'?'</span>);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    dp[i][j] = dp[i][j - <span class="number">1</span>] || dp[i - <span class="number">1</span>][j];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dp[sl][pl];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="049-Group-Anagrams"><a href="#049-Group-Anagrams" class="headerlink" title="049 Group Anagrams"></a><a href="#">049 Group Anagrams</a></h1><h2 id="Description-34"><a href="#Description-34" class="headerlink" title="Description"></a>Description</h2><p>Given an array of strings, group anagrams together.</p><p>For example, given: <code>[&quot;eat&quot;, &quot;tea&quot;, &quot;tan&quot;, &quot;ate&quot;, &quot;nat&quot;, &quot;bat&quot;]</code>,</p><p>Return:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  [&quot;ate&quot;, &quot;eat&quot;,&quot;tea&quot;],</div><div class="line">  [&quot;nat&quot;,&quot;tan&quot;],</div><div class="line">  [&quot;bat&quot;]</div><div class="line">]</div></pre></td></tr></table></figure><p><strong>Note:</strong> All inputs will be in lower-case.</p><p><strong>Tags:</strong> Hash Table, String</p><h2 id="思路-23"><a href="#思路-23" class="headerlink" title="思路"></a>思路</h2><p>题意是给你一组字符串，让你把其中同位异构字符串分组，同位异构字符串就是组成字符串的字符都相同，但是字符放的位置可以不同。既然要分组，那么关键就是如何确定他们是同位异构字符串呢，想到的自然就是对其排序，排序之后他们就都是同一个字符串了，就可以归为一类了，代码如下所示。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;String&gt;&gt; groupAnagrams(String[] strs) &#123;</div><div class="line">        <span class="keyword">if</span> (strs == <span class="keyword">null</span> || strs.length == <span class="number">0</span>) <span class="keyword">return</span> Collections.emptyList();</div><div class="line">        List&lt;List&lt;String&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        Map&lt;String, Integer&gt; hash = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (String str : strs) &#123;</div><div class="line">            <span class="keyword">char</span>[] c = str.toCharArray();</div><div class="line">            Arrays.sort(c);</div><div class="line">            String sortStr = String.valueOf(c);</div><div class="line">            <span class="keyword">if</span> (!hash.containsKey(sortStr)) &#123;</div><div class="line">                hash.put(sortStr, i++);</div><div class="line">                List&lt;String&gt; sub = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">                sub.add(str);</div><div class="line">                list.add(sub);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                list.get(hash.get(sortStr)).add(str);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="050-Pow-x-n"><a href="#050-Pow-x-n" class="headerlink" title="050 Pow(x, n)"></a><a href="#">050 Pow(x, n)</a></h1><h2 id="Description-35"><a href="#Description-35" class="headerlink" title="Description"></a>Description</h2><p>Implement <a href="http://www.cplusplus.com/reference/valarray/pow/" target="_blank" rel="external">pow(<em>x</em>, <em>n</em>)</a>.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: 2.00000, 10</div><div class="line">Output: 1024.00000</div></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: 2.10000, 3</div><div class="line">Output: 9.26100</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Math, Binary Search</p><h2 id="思路-24"><a href="#思路-24" class="headerlink" title="思路"></a>思路</h2><p>题意是让你计算 <code>x^n</code>，如果直接计算肯定会超时，那么我们可以想到可以使用二分法来降低时间复杂度。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">myPow</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (n &lt; <span class="number">0</span>) <span class="keyword">return</span> helper(<span class="number">1</span> / x, -n);</div><div class="line">        <span class="keyword">return</span> helper(x, n);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">helper</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span> x;</div><div class="line">        <span class="keyword">double</span> d = helper(x, n &gt;&gt;&gt; <span class="number">1</span>);</div><div class="line">        <span class="keyword">if</span> (n % <span class="number">2</span> == <span class="number">0</span>) <span class="keyword">return</span> d * d;</div><div class="line">        <span class="keyword">return</span> d * d * x;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="053-Maximum-Subarray"><a href="#053-Maximum-Subarray" class="headerlink" title="053 Maximum Subarray"></a><a href="#">053 Maximum Subarray</a></h1><h2 id="Description-36"><a href="#Description-36" class="headerlink" title="Description"></a>Description</h2><p>Find the contiguous subarray within an array (containing at least one number) which has the largest sum.</p><p>For example, given the array <code>[-2,1,-3,4,-1,2,1,-5,4]</code>,</p><p>the contiguous subarray <code>[4,-1,2,1]</code> has the largest sum = <code>6</code>.</p><p><strong>More practice:</strong></p><p>If you have figured out the O(<em>n</em>) solution, try coding another solution using the divide and conquer approach, which is more subtle.</p><p><strong>Tags:</strong> Array, Divide and Conquer, Dynamic Programming</p><h2 id="思路-0-11"><a href="#思路-0-11" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是求数组中子数组的最大和，这种最优问题一般第一时间想到的就是动态规划，我们可以这样想，当部分序列和大于零的话就一直加下一个元素即可，并和当前最大值进行比较，如果出现部分序列小于零的情况，那肯定就是从当前元素算起。其转移方程就是 <code>dp[i] = nums[i] + (dp[i - 1] &gt; 0 ? dp[i - 1] : 0);</code>，由于我们不需要保留 dp 状态，故可以优化空间复杂度为 1，即 <code>dp = nums[i] + (dp &gt; 0 ? dp : 0);</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> len = nums.length, dp = nums[<span class="number">0</span>], max = dp;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i) &#123;</div><div class="line">            dp = nums[i] + (dp &gt; <span class="number">0</span> ? dp : <span class="number">0</span>);</div><div class="line">            <span class="keyword">if</span> (dp &gt; max) max = dp;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-11"><a href="#思路-1-11" class="headerlink" title="思路 1"></a>思路 1</h2><p>题目也给了我们另一种思路，就是分治，所谓分治就是把问题分割成更小的，最后再合并即可，我们把 <code>nums</code> 一分为二先，那么就有两种情况，一种最大序列包括中间的值，一种就是不包括，也就是在左边或者右边；当最大序列在中间的时候那我们就把它两侧的最大和算出即可；当在两侧的话就继续分治即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> helper(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (left &gt;= right) <span class="keyword">return</span> nums[left];</div><div class="line">        <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> leftAns = helper(nums, left, mid);</div><div class="line">        <span class="keyword">int</span> rightAns = helper(nums, mid + <span class="number">1</span>, right);</div><div class="line">        <span class="keyword">int</span> leftMax = nums[mid], rightMax = nums[mid + <span class="number">1</span>];</div><div class="line">        <span class="keyword">int</span> temp = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = mid; i &gt;= left; --i) &#123;</div><div class="line">            temp += nums[i];</div><div class="line">            <span class="keyword">if</span> (temp &gt; leftMax) leftMax = temp;</div><div class="line">        &#125;</div><div class="line">        temp = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = mid + <span class="number">1</span>; i &lt;= right; ++i) &#123;</div><div class="line">            temp += nums[i];</div><div class="line">            <span class="keyword">if</span> (temp &gt; rightMax) rightMax = temp;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> Math.max(Math.max(leftAns, rightAns), leftMax + rightMax);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="056-Merge-Intervals"><a href="#056-Merge-Intervals" class="headerlink" title="056 Merge Intervals"></a><a href="#">056 Merge Intervals</a></h1><h2 id="Description-37"><a href="#Description-37" class="headerlink" title="Description"></a>Description</h2><p>Given a collection of intervals, merge all overlapping intervals.</p><p>For example,</p><p>Given <code>[1,3],[2,6],[8,10],[15,18]</code>,</p><p>return <code>[1,6],[8,10],[15,18]</code>.</p><p><strong>Tags:</strong> Array, Sort</p><h2 id="思路-25"><a href="#思路-25" class="headerlink" title="思路"></a>思路</h2><p>题意是给你一组区间，让你把区间合并成没有交集的一组区间。我们可以把区间按 <code>start</code> 进行排序，然后遍历排序后的区间，如果当前的 <code>start</code> 小于前者的 <code>end</code>，那么说明这两个存在交集，我们取两者中较大的 <code>end</code> 即可；否则的话直接插入到结果序列中即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for an interval.</span></div><div class="line"><span class="comment"> * public class Interval &#123;</span></div><div class="line"><span class="comment"> *     int start;</span></div><div class="line"><span class="comment"> *     int end;</span></div><div class="line"><span class="comment"> *     Interval() &#123; start = 0; end = 0; &#125;</span></div><div class="line"><span class="comment"> *     Interval(int s, int e) &#123; start = s; end = e; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Interval&gt; <span class="title">merge</span><span class="params">(List&lt;Interval&gt; intervals)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (intervals == <span class="keyword">null</span> || intervals.size() &lt;= <span class="number">1</span>) <span class="keyword">return</span> intervals;</div><div class="line">        intervals.sort(<span class="keyword">new</span> Comparator&lt;Interval&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Interval o1, Interval o2)</span> </span>&#123;</div><div class="line">                <span class="keyword">if</span> (o1.start &lt; o2.start) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">                <span class="keyword">if</span> (o1.start &gt; o2.start) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">                <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        List&lt;Interval&gt; ans = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> start = intervals.get(<span class="number">0</span>).start;</div><div class="line">        <span class="keyword">int</span> end = intervals.get(<span class="number">0</span>).end;</div><div class="line">        <span class="keyword">for</span> (Interval interval : intervals) &#123;</div><div class="line">            <span class="keyword">if</span> (interval.start &lt;= end) &#123;</div><div class="line">                end = Math.max(end, interval.end);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                ans.add(<span class="keyword">new</span> Interval(start, end));</div><div class="line">                start = interval.start;</div><div class="line">                end = interval.end;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        ans.add(<span class="keyword">new</span> Interval(start, end));</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="057-Insert-Interval"><a href="#057-Insert-Interval" class="headerlink" title="057 Insert Interval"></a><a href="#">057 Insert Interval</a></h1><h2 id="Description-38"><a href="#Description-38" class="headerlink" title="Description"></a>Description</h2><p>Given a set of <em>non-overlapping</em> intervals, insert a new interval into the intervals (merge if necessary).</p><p>You may assume that the intervals were initially sorted according to their start times.</p><p><strong>Example 1:</strong></p><p>Given intervals <code>[1,3],[6,9]</code>, insert and merge <code>[2,5]</code> in as <code>[1,5],[6,9]</code>.</p><p><strong>Example 2:</strong></p><p>Given <code>[1,2],[3,5],[6,7],[8,10],[12,16]</code>, insert and merge <code>[4,9]</code> in as <code>[1,2],[3,10],[12,16]</code>.</p><p>This is because the new interval <code>[4,9]</code> overlaps with <code>[3,5],[6,7],[8,10]</code>.</p><p><strong>Tags:</strong> Array, Sort</p><h2 id="思路-26"><a href="#思路-26" class="headerlink" title="思路"></a>思路</h2><p>题意是给你一组有序区间，和一个待插入区间，让你待插入区间插入到前面的区间中，我们分三步走：</p><ol><li><p>首先把有序区间中小于待插入区间的部分加入到结果中；</p></li><li><p>其次是插入待插入区间，如果有交集的话取两者交集的端点值；</p></li><li><p>最后把有序区间中大于待插入区间的部分加入到结果中；</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for an interval.</span></div><div class="line"><span class="comment"> * public class Interval &#123;</span></div><div class="line"><span class="comment"> *     int start;</span></div><div class="line"><span class="comment"> *     int end;</span></div><div class="line"><span class="comment"> *     Interval() &#123; start = 0; end = 0; &#125;</span></div><div class="line"><span class="comment"> *     Interval(int s, int e) &#123; start = s; end = e; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Interval&gt; <span class="title">insert</span><span class="params">(List&lt;Interval&gt; intervals, Interval newInterval)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (intervals.isEmpty()) <span class="keyword">return</span> Collections.singletonList(newInterval);</div><div class="line">        List&lt;Interval&gt; ans = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, len = intervals.size();</div><div class="line">        <span class="keyword">for</span> (; i &lt; len; ++i) &#123;</div><div class="line">            Interval interval = intervals.get(i);</div><div class="line">            <span class="keyword">if</span> (interval.end &lt; newInterval.start) ans.add(interval);</div><div class="line">            <span class="keyword">else</span> <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (; i &lt; len; ++i) &#123;</div><div class="line">            Interval interval = intervals.get(i);</div><div class="line">            <span class="keyword">if</span> (interval.start &lt;= newInterval.end) &#123;</div><div class="line">                newInterval.start = Math.min(newInterval.start, interval.start);</div><div class="line">                newInterval.end = Math.max(newInterval.end, interval.end);</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        ans.add(newInterval);</div><div class="line">        <span class="keyword">for</span> (; i &lt; len; ++i) &#123;</div><div class="line">            ans.add(intervals.get(i));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="058-Length-of-Last-Word"><a href="#058-Length-of-Last-Word" class="headerlink" title="058 Length of Last Word"></a><a href="#">058 Length of Last Word</a></h1><h2 id="Description-39"><a href="#Description-39" class="headerlink" title="Description"></a>Description</h2><p>Given a string <em>s</em> consists of upper/lower-case alphabets and empty space characters <code>&#39; &#39;</code>, return the length of last word in the string.</p><p>If the last word does not exist, return 0.</p><p><strong>Note:</strong> A word is defined as a character sequence consists of non-space characters only.</p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: &quot;Hello World&quot;</div><div class="line">Output: 5</div></pre></td></tr></table></figure><p><strong>Tags:</strong> String</p><h2 id="思路-27"><a href="#思路-27" class="headerlink" title="思路"></a>思路</h2><p>题意是让你从一个只包含大小字母和空格字符的字符串中得到最后一个单词的长度，很简单，我们倒序遍历，先得到最后一个非空格字符的索引，然后再得到它前面的空格字符索引，两者相减即可。当然，我们使用 API 来完成这件事更加方便，只需一行代码 <code>return s.trim().length() - s.trim().lastIndexOf(&quot; &quot;) - 1;</code>，但我相信作者出这道题的目的肯定不是考你 API 的使用，所以我们还是用自己的思路来实现。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLastWord</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> p = s.length() - <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (p &gt;= <span class="number">0</span> &amp;&amp; s.charAt(p) == <span class="string">' '</span>) p--;</div><div class="line">        <span class="keyword">int</span> end = p;</div><div class="line">        <span class="keyword">while</span> (p &gt;= <span class="number">0</span> &amp;&amp; s.charAt(p) != <span class="string">' '</span>) p--;</div><div class="line">        <span class="keyword">return</span> end - p;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="066-Plus-One"><a href="#066-Plus-One" class="headerlink" title="066 Plus One"></a><a href="#">066 Plus One</a></h1><h2 id="Description-40"><a href="#Description-40" class="headerlink" title="Description"></a>Description</h2><p>Given a non-negative integer represented as a <strong>non-empty</strong> array of digits, plus one to the integer.</p><p>You may assume the integer do not contain any leading zero, except the number 0 itself.</p><p>The digits are stored such that the most significant digit is at the head of the list.</p><p><strong>Tags:</strong> Array, Math</p><h2 id="思路-28"><a href="#思路-28" class="headerlink" title="思路"></a>思路</h2><p>题意是给你一个数字数组，高位在前，并且首位不为 0 除非这个数组就是 <code>[0]</code>，让你给该数组低位加一求其结果，那么我们就模拟小学数学那样进位去算即可，如果一直进位到首位，这种情况也就是都是由 9 组成的数组，此时我们只要 new 出一个多一个长度的数组即可，并把第 0 个元素赋 1 即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] plusOne(<span class="keyword">int</span>[] digits) &#123;</div><div class="line">        <span class="keyword">int</span> p = digits.length - <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (digits[p] &lt; <span class="number">9</span>) &#123;</div><div class="line">            digits[p] = ++digits[p];</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                digits[p--] = <span class="number">0</span>;</div><div class="line">            &#125; <span class="keyword">while</span> (p &gt;= <span class="number">0</span> &amp;&amp; digits[p] == <span class="number">9</span>);</div><div class="line">            <span class="keyword">if</span> (digits[<span class="number">0</span>] != <span class="number">0</span>) &#123;</div><div class="line">                ++digits[p];</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                digits = <span class="keyword">new</span> <span class="keyword">int</span>[digits.length + <span class="number">1</span>];</div><div class="line">                digits[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> digits;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="067-Add-Binary"><a href="#067-Add-Binary" class="headerlink" title="067 Add Binary"></a><a href="#">067 Add Binary</a></h1><h2 id="Description-41"><a href="#Description-41" class="headerlink" title="Description"></a>Description</h2><p>Given two binary strings, return their sum (also a binary string).</p><p>For example,</p><p>a = <code>&quot;11&quot;</code></p><p>b = <code>&quot;1&quot;</code></p><p>Return <code>&quot;100&quot;</code>.</p><p><strong>Tags:</strong> Math, String</p><h2 id="思路-29"><a href="#思路-29" class="headerlink" title="思路"></a>思路</h2><p>题意是给你两个二进制串，求其和的二进制串。我们就按照小学算数那么来做，用 <code>carry</code> 表示进位，从后往前算，依次往前，每算出一位就插入到最前面即可，直到把两个二进制串都遍历完即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addBinary</span><span class="params">(String a, String b)</span> </span>&#123;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">int</span> carry = <span class="number">0</span>, p1 = a.length() - <span class="number">1</span>, p2 = b.length() - <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (p1 &gt;= <span class="number">0</span> &amp;&amp; p2 &gt;= <span class="number">0</span>) &#123;</div><div class="line">            carry += p1 &gt;= <span class="number">0</span> ? a.charAt(p1--) - <span class="string">'0'</span> : <span class="number">0</span>;</div><div class="line">            carry += p2 &gt;= <span class="number">0</span> ? b.charAt(p2--) - <span class="string">'0'</span> : <span class="number">0</span>;</div><div class="line">            sb.insert(<span class="number">0</span>, (<span class="keyword">char</span>) (carry % <span class="number">2</span> + <span class="string">'0'</span>));</div><div class="line">            carry &gt;&gt;= <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (p1 &gt;= <span class="number">0</span>) &#123;</div><div class="line">            carry += p1 &gt;= <span class="number">0</span> ? a.charAt(p1--) - <span class="string">'0'</span> : <span class="number">0</span>;</div><div class="line">            sb.insert(<span class="number">0</span>, (<span class="keyword">char</span>) (carry % <span class="number">2</span> + <span class="string">'0'</span>));</div><div class="line">            carry &gt;&gt;= <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (p2 &gt;= <span class="number">0</span>) &#123;</div><div class="line">            carry += p2 &gt;= <span class="number">0</span> ? b.charAt(p2--) - <span class="string">'0'</span> : <span class="number">0</span>;</div><div class="line">            sb.insert(<span class="number">0</span>, (<span class="keyword">char</span>) (carry % <span class="number">2</span> + <span class="string">'0'</span>));</div><div class="line">            carry &gt;&gt;= <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (carry == <span class="number">1</span>) &#123;</div><div class="line">            sb.insert(<span class="number">0</span>, <span class="string">'1'</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="068-Text-Justification"><a href="#068-Text-Justification" class="headerlink" title="068 Text Justification"></a><a href="#">068 Text Justification</a></h1><h2 id="Description-42"><a href="#Description-42" class="headerlink" title="Description"></a>Description</h2><p>Given an array of words and a length <em>L</em>, format the text such that each line has exactly <em>L</em> characters and is fully (left and right) justified.</p><p>You should pack your words in a greedy approach; that is, pack as many words as you can in each line. Pad extra spaces <code>&#39; &#39;</code> when necessary so that each line has exactly <em>L</em> characters.</p><p>Extra spaces between words should be distributed as evenly as possible. If the number of spaces on a line do not divide evenly between words, the empty slots on the left will be assigned more spaces than the slots on the right.</p><p>For the last line of text, it should be left justified and no extra space is inserted between words.</p><p>For example,</p><p><strong>words</strong>: <code>[&quot;This&quot;, &quot;is&quot;, &quot;an&quot;, &quot;example&quot;, &quot;of&quot;, &quot;text&quot;, &quot;justification.&quot;]</code></p><p><strong>L</strong>: <code>16</code>.</p><p>Return the formatted lines as:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">   &quot;This    is    an&quot;,</div><div class="line">   &quot;example  of text&quot;,</div><div class="line">   &quot;justification.  &quot;</div><div class="line">]</div></pre></td></tr></table></figure><p><strong>Note:</strong> Each word is guaranteed not to exceed <em>L</em> in length.</p><p><strong>Corner Cases:</strong></p><ul><li><p>A line other than the last line might contain only one word. What should you do in this case?</p><p>In this case, that line should be left-justified.</p></li></ul><p><strong>Tags:</strong> String</p><h2 id="思路-30"><a href="#思路-30" class="headerlink" title="思路"></a>思路</h2><p>题意是给你一组单词和最大行宽，让你对齐他们，对齐的规则就是尽可能一行可以放下足够多的单词，如果最后有多余的空格，那就把空格均匀地插入到单词之间，如果不能平分的话，那就从左开始依次多插一个空格，最后一行单词之间就正常地一个空格即可，如果凑不到最大行宽，那就在末尾补充空格即可，描述地比较差，不懂的话其实看看 demo 也就懂了哈。题还是比较坑的，毕竟踩的比赞的人多，我也是靠模拟老老实实做出来的，求出可以最多插入空格数，然后用它除以可以插入的槽数获取每个单词之间的空格，它两取余的话就是最面需要多插入一个空格的个数，最后一行的话就单独处理即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">fullJustify</span><span class="params">(String[] words, <span class="keyword">int</span> maxWidth)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> len = words.length;</div><div class="line">        List&lt;String&gt; ans = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        StringBuilder spaces = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxWidth; ++i) &#123;</div><div class="line">            spaces.append(<span class="string">" "</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> curLen = -<span class="number">1</span>, start = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</div><div class="line">            <span class="keyword">if</span> (curLen + words[i].length() + <span class="number">1</span> &lt;= maxWidth) &#123;</div><div class="line">                curLen += words[i].length() + <span class="number">1</span>;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                StringBuilder sub = <span class="keyword">new</span> StringBuilder(words[start]);</div><div class="line">                <span class="keyword">int</span> rest = maxWidth - curLen;</div><div class="line">                <span class="keyword">int</span> l = i - start - <span class="number">1</span>;</div><div class="line">                <span class="keyword">if</span> (l &lt;= <span class="number">0</span>) &#123;</div><div class="line">                    sub.append(spaces.substring(<span class="number">0</span>, rest));</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">int</span> m = rest / l + <span class="number">1</span>;</div><div class="line">                    <span class="keyword">int</span> mod = rest % l;</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> j = start + <span class="number">1</span>; j &lt; i; ++j) &#123;</div><div class="line">                        <span class="keyword">if</span> (mod-- &gt; <span class="number">0</span>) &#123;</div><div class="line">                            sub.append(spaces.substring(<span class="number">0</span>, m + <span class="number">1</span>)).append(words[j]);</div><div class="line">                        &#125; <span class="keyword">else</span> &#123;</div><div class="line">                            sub.append(spaces.substring(<span class="number">0</span>, m)).append(words[j]);</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                ans.add(sub.toString());</div><div class="line">                start = i;</div><div class="line">                curLen = words[i].length();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        StringBuilder sub = <span class="keyword">new</span> StringBuilder(words[start]);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = start + <span class="number">1</span>; i &lt; len; ++i) &#123;</div><div class="line">            sub.append(<span class="string">" "</span>).append(words[i]);</div><div class="line">        &#125;</div><div class="line">        ans.add(sub + spaces.substring(<span class="number">0</span>, maxWidth - sub.length()));</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="069-Sqrt-x"><a href="#069-Sqrt-x" class="headerlink" title="069 Sqrt(x)"></a><a href="#">069 Sqrt(x)</a></h1><h2 id="Description-43"><a href="#Description-43" class="headerlink" title="Description"></a>Description</h2><p>Implement <code>int sqrt(int x)</code>.</p><p>Compute and return the square root of <em>x</em>.</p><p><strong>x</strong> is guaranteed to be a non-negative integer.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Input: 4</div><div class="line">Output: 2</div></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Input: 8</div><div class="line">Output: 2</div><div class="line">Explanation: The square root of 8 is 2.82842..., and since we want to return an integer, the decimal part will be truncated.</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Binary Search, Math</p><h2 id="思路-31"><a href="#思路-31" class="headerlink" title="思路"></a>思路</h2><p>题意是求平方根，参考 <a href="https://wenku.baidu.com/view/6b74c622bcd126fff7050bfe.html" target="_blank" rel="external">牛顿迭代法求平方根</a>，然后再参考维基百科的 <a href="https://en.wikipedia.org/wiki/Integer_square_root#Using_only_integer_division" target="_blank" rel="external">Integer square root</a> 即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mySqrt</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">        <span class="keyword">long</span> n = x;</div><div class="line">        <span class="keyword">while</span> (n * n &gt; x) &#123;</div><div class="line">            n = (n + x / n) &gt;&gt; <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>) n;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="070-Climbing-Stairs"><a href="#070-Climbing-Stairs" class="headerlink" title="070 Climbing Stairs"></a><a href="#">070 Climbing Stairs</a></h1><h2 id="Description-44"><a href="#Description-44" class="headerlink" title="Description"></a>Description</h2><p>You are climbing a stair case. It takes <em>n</em> steps to reach to the top.</p><p>Each time you can either climb 1 or 2 steps. In how many distinct ways can you climb to the top?</p><p><strong>Note:</strong> Given <em>n</em> will be a positive integer.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Input: 2</div><div class="line">Output:  2</div><div class="line">Explanation:  There are two ways to climb to the top.</div><div class="line"></div><div class="line">1. 1 step + 1 step</div><div class="line">2. 2 steps</div></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Input: 3</div><div class="line">Output:  3</div><div class="line">Explanation:  There are three ways to climb to the top.</div><div class="line"></div><div class="line">1. 1 step + 1 step + 1 step</div><div class="line">2. 1 step + 2 steps</div><div class="line">3. 2 steps + 1 step</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Dynamic Programming</p><h2 id="思路-32"><a href="#思路-32" class="headerlink" title="思路"></a>思路</h2><p>题意是爬楼梯，每次你只能爬一步或者两步，问到顶层共有多少种方案。我们假设到顶层共有 <code>f(n)</code> 种，那么 <code>f(n) = f(n - 1) + f(n - 2)</code> 肯定是成立的，意思就是我们迈向顶层的最后一步是在倒数第一级台阶或者在倒数第二级台阶。算法我对空间复杂度进行了优化，因为在迭代过程中只需要两个变量即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">climbStairs</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> a = <span class="number">1</span>, b = <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (--n &gt; <span class="number">0</span>) &#123;</div><div class="line">            b += a;</div><div class="line">            a = b - a;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> b;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="083Remove-Duplicates-from-Sorted-List"><a href="#083Remove-Duplicates-from-Sorted-List" class="headerlink" title="083Remove Duplicates from Sorted List"></a><a href="#">083Remove Duplicates from Sorted List</a></h1><h2 id="Description-45"><a href="#Description-45" class="headerlink" title="Description"></a>Description</h2><p>Given a sorted linked list, delete all duplicates such that each element appear only <em>once</em>.</p><p>For example,</p><p>Given <code>1-&gt;1-&gt;2</code>, return <code>1-&gt;2</code>.</p><p>Given <code>1-&gt;1-&gt;2-&gt;3-&gt;3</code>, return <code>1-&gt;2-&gt;3</code>.</p><p><strong>Tags:</strong> Linked List</p><h2 id="思路-33"><a href="#思路-33" class="headerlink" title="思路"></a>思路</h2><p>题意是删除链表中重复的元素，很简单，我们只需要遍历一遍链表，遇到链表中相邻元素相同时，把当前指针指向下下个元素即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for singly-linked list.</span></div><div class="line"><span class="comment"> * public class ListNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     ListNode next;</span></div><div class="line"><span class="comment"> *     ListNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">deleteDuplicates</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) <span class="keyword">return</span> head;</div><div class="line">        ListNode curr = head;</div><div class="line">        <span class="keyword">while</span> (curr.next != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">if</span> (curr.next.val == curr.val) &#123;</div><div class="line">                curr.next = curr.next.next;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                curr = curr.next;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> head;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="088-Merge-Sorted-Array"><a href="#088-Merge-Sorted-Array" class="headerlink" title="088 Merge Sorted Array"></a><a href="#">088 Merge Sorted Array</a></h1><h2 id="Description-46"><a href="#Description-46" class="headerlink" title="Description"></a>Description</h2><p>Given two sorted integer arrays <em>nums1</em> and <em>nums2</em>, merge <em>nums2</em> into <em>nums1</em> as one sorted array.</p><p><strong>Note:</strong></p><p>You may assume that <em>nums1</em> has enough space (size that is greater or equal to <em>m</em> + <em>n</em>) to hold additional elements from <em>nums2</em>. The number of elements initialized in <em>nums1</em> and <em>nums2</em> are <em>m</em> and <em>n</em> respectively.</p><p><strong>Tags:</strong> Array, Two Pointers</p><h2 id="思路-34"><a href="#思路-34" class="headerlink" title="思路"></a>思路</h2><p>题意是给两个已排序的数组 <code>nums1</code> 和 <code>nums2</code>，合并 <code>nums2</code> 到 <code>nums1</code> 中，两数组元素个数分别为 <code>m</code> 和 <code>n</code>，而且 <code>nums1</code> 数组的长度足够容纳 <code>m + n</code> 个元素，如果我们按顺序排下去，那肯定要开辟一个新数组来保存元素，如果我们选择逆序，这样利用 <code>nums1</code> 自身空间足矣，不会出现覆盖的情况，依次把大的元素插入到 <code>nums1</code> 的末尾，确保 <code>nums2</code> 中的元素全部插入到 <code>nums1</code> 即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span> m, <span class="keyword">int</span>[] nums2, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> p = m-- + n-- - <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (m &gt;= <span class="number">0</span> &amp;&amp; n &gt;= <span class="number">0</span>)</div><div class="line">            nums1[p--] = nums1[m] &gt; nums2[n] ? nums1[m--] : nums2[n--];</div><div class="line">        <span class="keyword">while</span> (n &gt;= <span class="number">0</span>)</div><div class="line">            nums1[p--] = nums2[n--];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="100-Same-Tree"><a href="#100-Same-Tree" class="headerlink" title="100 Same Tree"></a><a href="#">100 Same Tree</a></h1><h2 id="Description-47"><a href="#Description-47" class="headerlink" title="Description"></a>Description</h2><p>Given two binary trees, write a function to check if they are the same or not.</p><p>Two binary trees are considered the same if they are structurally identical and the nodes have the same value.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Input:     1         1</div><div class="line">          / \       / \</div><div class="line">         2   3     2   3</div><div class="line"></div><div class="line">        [1,2,3],   [1,2,3]</div><div class="line"></div><div class="line">Output: true</div></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Input:     1         1</div><div class="line">          /           \</div><div class="line">         2             2</div><div class="line"></div><div class="line">        [1,2],     [1,null,2]</div><div class="line"></div><div class="line">Output: false</div></pre></td></tr></table></figure><p><strong>Example 3:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Input:     1         1</div><div class="line">          / \       / \</div><div class="line">         2   1     1   2</div><div class="line"></div><div class="line">        [1,2,1],   [1,1,2]</div><div class="line"></div><div class="line">Output: false</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Tree, Depth-first Search</p><h2 id="思路-35"><a href="#思路-35" class="headerlink" title="思路"></a>思路</h2><p>题意是比较两棵二叉树是否相同，那么我们就深搜比较各个节点即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSameTree</span><span class="params">(TreeNode p, TreeNode q)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (p == <span class="keyword">null</span> &amp;&amp; q == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">if</span> (p == <span class="keyword">null</span> || q == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">if</span> (p.val == q.val) &#123;</div><div class="line">            <span class="keyword">return</span> isSameTree(p.left, q.left) &amp;&amp; isSameTree(p.right, q.right);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="101-Symmetric-Tree"><a href="#101-Symmetric-Tree" class="headerlink" title="101 Symmetric Tree"></a><a href="#">101 Symmetric Tree</a></h1><h2 id="Description-48"><a href="#Description-48" class="headerlink" title="Description"></a>Description</h2><p>Given a binary tree, check whether it is a mirror of itself (ie, symmetric around its center).</p><p>For example, this binary tree <code>[1,2,2,3,4,4,3]</code> is symmetric:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">    1</div><div class="line">   / \</div><div class="line">  2   2</div><div class="line"> / \ / \</div><div class="line">3  4 4  3</div></pre></td></tr></table></figure><p>But the following <code>[1,2,2,null,3,null,3]</code> is not:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">  1</div><div class="line"> / \</div><div class="line">2   2</div><div class="line"> \   \</div><div class="line"> 3    3</div></pre></td></tr></table></figure><p><strong>Note:</strong></p><p>Bonus points if you could solve it both recursively and iteratively.</p><p><strong>Tags:</strong> Tree, Depth-first Search, Breadth-first Search</p><h2 id="思路-0-12"><a href="#思路-0-12" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是判断一棵二叉树是否左右对称，首先想到的是深搜，比较根结点的左右两棵子树是否对称，如果左右子树的值相同，那么再分别对左子树的左节点和右子树的右节点，左子树的右节点和右子树的左节点做比较即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSymmetric</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> root == <span class="keyword">null</span> || helper(root.left, root.right);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">helper</span><span class="params">(TreeNode left, TreeNode right)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (left == <span class="keyword">null</span> || right == <span class="keyword">null</span>) <span class="keyword">return</span> left == right;</div><div class="line">        <span class="keyword">if</span> (left.val != right.val) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">return</span> helper(left.left, right.right) &amp;&amp; helper(left.right, right.left);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-12"><a href="#思路-1-12" class="headerlink" title="思路 1"></a>思路 1</h2><p>第二种思路就是宽搜了，宽搜肯定要用到队列，Java 中可用 <code>LinkedList</code> 替代，也是要做到左子树的左节点和右子树的右节点，左子树的右节点和右子树的左节点做比较即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSymmetric</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        LinkedList&lt;TreeNode&gt; q = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        q.add(root.left);</div><div class="line">        q.add(root.right);</div><div class="line">        TreeNode left, right;</div><div class="line">        <span class="keyword">while</span> (q.size() &gt; <span class="number">1</span>) &#123;</div><div class="line">            left = q.pop();</div><div class="line">            right = q.pop();</div><div class="line">            <span class="keyword">if</span> (left == <span class="keyword">null</span> &amp;&amp; right == <span class="keyword">null</span>) <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">if</span> (left == <span class="keyword">null</span> || right == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            <span class="keyword">if</span> (left.val != right.val) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            q.add(left.left);</div><div class="line">            q.add(right.right);</div><div class="line">            q.add(left.right);</div><div class="line">            q.add(right.left);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="104-Maximum-Depth-of-Binary-Tree"><a href="#104-Maximum-Depth-of-Binary-Tree" class="headerlink" title="104 Maximum Depth of Binary Tree"></a><a href="#">104 Maximum Depth of Binary Tree</a></h1><h2 id="Description-49"><a href="#Description-49" class="headerlink" title="Description"></a>Description</h2><p>Given a binary tree, find its maximum depth.</p><p>The maximum depth is the number of nodes along the longest path from the root node down to the farthest leaf node.</p><p><strong>Tags:</strong> Tree, Depth-first Search</p><h2 id="思路-36"><a href="#思路-36" class="headerlink" title="思路"></a>思路</h2><p>题意是找到二叉树的最大深度，很明显，深搜即可，每深入一次节点加一即可，然后取左右子树的最大深度。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxDepth</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">         <span class="keyword">if</span> (root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">         <span class="keyword">return</span> <span class="number">1</span> + Math.max(maxDepth(root.left), maxDepth(root.right));</div><div class="line">     &#125;</div><div class="line"> &#125;</div></pre></td></tr></table></figure><h1 id="107-Binary-Tree-Level-Order-Traversal-II"><a href="#107-Binary-Tree-Level-Order-Traversal-II" class="headerlink" title="107 Binary Tree Level Order Traversal II"></a><a href="#">107 Binary Tree Level Order Traversal II</a></h1><h2 id="Description-50"><a href="#Description-50" class="headerlink" title="Description"></a>Description</h2><p>Given a binary tree, return the <em>bottom-up level order</em> traversal of its nodes’ values. (ie, from left to right, level by level from leaf to root).</p><p>For example:</p><p>Given binary tree <code>[3,9,20,null,null,15,7]</code>,</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">  3</div><div class="line"> / \</div><div class="line">9  20</div><div class="line">  /  \</div><div class="line"> 15   7</div></pre></td></tr></table></figure><p>return its bottom-up level order traversal as:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  [15,7],</div><div class="line">  [9,20],</div><div class="line">  [3]</div><div class="line">]</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Tree, Breadth-first Search</p><h2 id="思路-0-13"><a href="#思路-0-13" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是从下往上按层遍历二叉树，每一层是从左到右，按层遍历，很明显，宽搜第一时间符合，因为是从下往上，所以插入的时候每次插到链表头即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; levelOrderBottom(TreeNode root) &#123;</div><div class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) <span class="keyword">return</span> Collections.emptyList();</div><div class="line">        List&lt;List&lt;Integer&gt;&gt; list = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        LinkedList&lt;TreeNode&gt; q = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        q.add(root);</div><div class="line">        <span class="keyword">while</span>(!q.isEmpty()) &#123;</div><div class="line">            <span class="keyword">int</span> size = q.size();</div><div class="line">            List&lt;Integer&gt; sub = <span class="keyword">new</span> LinkedList();</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; ++i) &#123;</div><div class="line">                TreeNode node = q.remove();</div><div class="line">                sub.add(node.val);</div><div class="line">                <span class="keyword">if</span> (node.left != <span class="keyword">null</span>) q.add(node.left);</div><div class="line">                <span class="keyword">if</span> (node.right != <span class="keyword">null</span>) q.add(node.right);</div><div class="line">            &#125;</div><div class="line">            list.add(<span class="number">0</span>, sub);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-13"><a href="#思路-1-13" class="headerlink" title="思路 1"></a>思路 1</h2><p>另一种思路就是深搜，深搜的时候同时记录深度，然后在相应的层插入节点值即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; levelOrderBottom(TreeNode root) &#123;</div><div class="line">        List&lt;List&lt;Integer&gt;&gt; list = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        helper(list, root, <span class="number">0</span>);</div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">helper</span><span class="params">(List&lt;List&lt;Integer&gt;&gt; list, TreeNode root, <span class="keyword">int</span> level)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span> (level &gt;= list.size()) &#123;</div><div class="line">            list.add(<span class="number">0</span>, <span class="keyword">new</span> LinkedList&lt;&gt;());</div><div class="line">        &#125;</div><div class="line">        helper(list, root.left, level + <span class="number">1</span>);</div><div class="line">        helper(list, root.right, level + <span class="number">1</span>);</div><div class="line">        list.get(list.size() - level - <span class="number">1</span>).add(root.val);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="108-Convert-Sorted-Array-to-Binary-Search-Tree"><a href="#108-Convert-Sorted-Array-to-Binary-Search-Tree" class="headerlink" title="108 Convert Sorted Array to Binary Search Tree"></a><a href="#">108 Convert Sorted Array to Binary Search Tree</a></h1><h2 id="Description-51"><a href="#Description-51" class="headerlink" title="Description"></a>Description</h2><p>Given an array where elements are sorted in ascending order, convert it to a height balanced BST.</p><p>For this problem, a height-balanced binary tree is defined as a binary tree in which the depth of the two subtrees of <em>every</em> node never differ by more than 1.</p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Given the sorted array: [-10,-3,0,5,9],</div><div class="line"></div><div class="line">One possible answer is: [0,-3,9,-10,null,5], which represents the following height balanced BST:</div><div class="line"></div><div class="line">      0</div><div class="line">     / \</div><div class="line">   -3   9</div><div class="line">   /   /</div><div class="line"> -10  5</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Tree, Depth-first Search</p><h2 id="思路-37"><a href="#思路-37" class="headerlink" title="思路"></a>思路</h2><p>题意是把一个有序数组转化为一棵二叉搜索树，二叉搜索树具有以下性质：</p><ol><li><p>若任意节点的左子树不空，则左子树上所有节点的值均小于它的根节点的值；</p></li><li><p>若任意节点的右子树不空，则右子树上所有节点的值均大于它的根节点的值；</p></li><li><p>任意节点的左、右子树也分别为二叉查找树；</p></li><li><p>没有键值相等的节点。</p></li></ol><p>所以我们可以用递归来构建一棵二叉搜索树，每次把数组分为两半，把数组中间的值作为其父节点，然后把数组的左右两部分继续构造其左右子树。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> TreeNode <span class="title">sortedArrayToBST</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">return</span> helper(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> TreeNode <span class="title">helper</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (left &gt; right) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">int</span> mid = (left + right) &gt;&gt;&gt; <span class="number">1</span>;</div><div class="line">        TreeNode node = <span class="keyword">new</span> TreeNode(nums[mid]);</div><div class="line">        node.left = helper(nums, left, mid - <span class="number">1</span>);</div><div class="line">        node.right = helper(nums, mid + <span class="number">1</span>, right);</div><div class="line">        <span class="keyword">return</span> node;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="110-Balanced-Binary-Tree"><a href="#110-Balanced-Binary-Tree" class="headerlink" title="110 Balanced Binary Tree"></a><a href="#">110 Balanced Binary Tree</a></h1><h2 id="Description-52"><a href="#Description-52" class="headerlink" title="Description"></a>Description</h2><p>Given a binary tree, determine if it is height-balanced.</p><p>For this problem, a height-balanced binary tree is defined as a binary tree in which the depth of the two subtrees of every node never differ by more than 1.</p><p><strong>Tags:</strong> Tree, Depth-first Search</p><h2 id="思路-38"><a href="#思路-38" class="headerlink" title="思路"></a>思路</h2><p>题意是判断一棵二叉树是否是高度平衡的，所谓二叉树高度平衡指的是二叉树的每个节点的两棵子树的高度差都不超过 1，那么我们只需计算左右子树的高度，判断其高度差是否不超过 1 即可，如果超过 1，就代表其不是高度平衡的，立即返回不是即可，我这里用返回 <code>-1</code> 代表不是。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isBalanced</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> helper(root) != -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(TreeNode node)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (node == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> l = helper(node.left);</div><div class="line">        <span class="keyword">if</span> (l == -<span class="number">1</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> r = helper(node.right);</div><div class="line">        <span class="keyword">if</span> (r == -<span class="number">1</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (Math.abs(l - r) &gt; <span class="number">1</span>) <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span> + Math.max(l, r);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="111-Minimum-Depth-of-Binary-Tree"><a href="#111-Minimum-Depth-of-Binary-Tree" class="headerlink" title="111 Minimum Depth of Binary Tree"></a><a href="#">111 Minimum Depth of Binary Tree</a></h1><h2 id="Description-53"><a href="#Description-53" class="headerlink" title="Description"></a>Description</h2><p>Given a binary tree, find its minimum depth.</p><p>The minimum depth is the number of nodes along the shortest path from the root node down to the nearest leaf node.</p><p><strong>Tags:</strong> Tree, Depth-first Search, Breadth-first Search</p><h2 id="思路-0-14"><a href="#思路-0-14" class="headerlink" title="思路 0"></a>思路 0</h2><p>题意是查找二叉树的最小深度，也就是找到从根结点到叶子节点的最小深度，最容易想到的当然是深搜，如果节点的左右深度都不是 0 的话，说明该节点含有左右子树，所以它的最小高度就是 1 加上其左右子树高度较小者，否则如果左子树为空或者右子树为空或者两者都为空，那么就是 1 加上非空子树高度。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minDepth</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> l = minDepth(root.left);</div><div class="line">        <span class="keyword">int</span> r = minDepth(root.right);</div><div class="line">        <span class="keyword">if</span> (l != <span class="number">0</span> &amp;&amp; r != <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span> + Math.min(l, r);</div><div class="line">        <span class="keyword">return</span> l + r + <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="思路-1-14"><a href="#思路-1-14" class="headerlink" title="思路 1"></a>思路 1</h2><p>第二种思路就是利用宽搜了，搜索到该层有叶子节点，那就返回该层宽度即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minDepth</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        LinkedList&lt;TreeNode&gt; q = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        q.add(root);</div><div class="line">        <span class="keyword">int</span> ans = <span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (!q.isEmpty()) &#123;</div><div class="line">            <span class="keyword">int</span> size = q.size();</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; ++i) &#123;</div><div class="line">                TreeNode node = q.remove();</div><div class="line">                <span class="keyword">if</span> (node.left == <span class="keyword">null</span> &amp;&amp; node.right == <span class="keyword">null</span>) &#123;</div><div class="line">                    <span class="keyword">return</span> ans;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span> (node.left != <span class="keyword">null</span>) q.add(node.left);</div><div class="line">                <span class="keyword">if</span> (node.right != <span class="keyword">null</span>) q.add(node.right);</div><div class="line">            &#125;</div><div class="line">            ++ans;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">520</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="112-Path-Sum"><a href="#112-Path-Sum" class="headerlink" title="112 Path Sum"></a><a href="#">112 Path Sum</a></h1><h2 id="Description-54"><a href="#Description-54" class="headerlink" title="Description"></a>Description</h2><p>Given a binary tree and a sum, determine if the tree has a root-to-leaf path such that adding up all the values along the path equals the given sum.</p><p>For example:</p><p>Given the below binary tree and <code>sum = 22</code>,</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">      5</div><div class="line">     / \</div><div class="line">    4   8</div><div class="line">   /   / \</div><div class="line">  11  13  4</div><div class="line"> /  \      \</div><div class="line">7    2      1</div></pre></td></tr></table></figure><p>return true, as there exist a root-to-leaf path <code>5-&gt;4-&gt;11-&gt;2</code> which sum is 22.</p><p><strong>Tags:</strong> Tree, Depth-first Search</p><h2 id="思路-39"><a href="#思路-39" class="headerlink" title="思路"></a>思路</h2><p>题意是查找二叉树中是否存在从根结点到叶子的路径和为某一值，利用深搜在遇到叶子节点时判断是否满足即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPathSum</span><span class="params">(TreeNode root, <span class="keyword">int</span> sum)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">if</span> (root.left == <span class="keyword">null</span> &amp;&amp; root.right == <span class="keyword">null</span>) <span class="keyword">return</span> sum == root.val;</div><div class="line">        <span class="keyword">return</span> hasPathSum(root.left, sum - root.val) || hasPathSum(root.right, sum - root.val);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="118-Pascal’s-Triangle"><a href="#118-Pascal’s-Triangle" class="headerlink" title="118 Pascal’s Triangle"></a><a href="#">118 Pascal’s Triangle</a></h1><h2 id="Description-55"><a href="#Description-55" class="headerlink" title="Description"></a>Description</h2><p>Given <em>numRows</em>, generate the first <em>numRows</em> of Pascal’s triangle.</p><p>For example, given <em>numRows</em> = 5,</p><p>Return</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">     [1],</div><div class="line">    [1,1],</div><div class="line">   [1,2,1],</div><div class="line">  [1,3,3,1],</div><div class="line"> [1,4,6,4,1]</div><div class="line">]</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Array</p><h2 id="思路-40"><a href="#思路-40" class="headerlink" title="思路"></a>思路</h2><p>题意是给出行数，输出帕斯卡尔三角形，很简单的模拟，就不多说了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; generate(<span class="keyword">int</span> numRows) &#123;</div><div class="line">        <span class="keyword">if</span> (numRows == <span class="number">0</span>) <span class="keyword">return</span> Collections.emptyList();</div><div class="line">        List&lt;List&lt;Integer&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numRows; ++i) &#123;</div><div class="line">            List&lt;Integer&gt; sub = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; ++j) &#123;</div><div class="line">                <span class="keyword">if</span> (j == <span class="number">0</span> || j == i) &#123;</div><div class="line">                    sub.add(<span class="number">1</span>);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    List&lt;Integer&gt; upSub = list.get(i - <span class="number">1</span>);</div><div class="line">                    sub.add(upSub.get(j - <span class="number">1</span>) + upSub.get(j));</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            list.add(sub);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="119-Pascal’s-Triangle-II"><a href="#119-Pascal’s-Triangle-II" class="headerlink" title="119 Pascal’s Triangle II"></a><a href="#">119 Pascal’s Triangle II</a></h1><h2 id="Description-56"><a href="#Description-56" class="headerlink" title="Description"></a>Description</h2><p>Given an index <em>k</em>, return the <em>k</em><sup>th</sup> row of the Pascal’s triangle.</p><p>For example, given <em>k</em> = 3,</p><p>Return <code>[1,3,3,1]</code>.</p><p><strong>Note:</strong></p><p>Could you optimize your algorithm to use only <em>O</em>(<em>k</em>) extra space?</p><p><strong>Tags:</strong> Array</p><h2 id="思路-41"><a href="#思路-41" class="headerlink" title="思路"></a>思路</h2><p>题意是指定输出帕斯卡尔三角形的某一行，模拟即可，优化后的代码如下所示。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getRow</span><span class="params">(<span class="keyword">int</span> rowIndex)</span> </span>&#123;</div><div class="line">        List&lt;Integer&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= rowIndex; ++i) &#123;</div><div class="line">            res.add(<span class="number">1</span>);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt; <span class="number">0</span>; --j) &#123;</div><div class="line">                res.set(j, res.get(j - <span class="number">1</span>) + res.get(j));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="121-Best-Time-to-Buy-and-Sell-Stock"><a href="#121-Best-Time-to-Buy-and-Sell-Stock" class="headerlink" title="121 Best Time to Buy and Sell Stock"></a><a href="#">121 Best Time to Buy and Sell Stock</a></h1><h2 id="Description-57"><a href="#Description-57" class="headerlink" title="Description"></a>Description</h2><p>Say you have an array for which the <em>i</em><sup>th</sup> element is the price of a given stock on day <em>i</em>.</p><p>If you were only permitted to complete at most one transaction (ie, buy one and sell one share of the stock), design an algorithm to find the maximum profit.</p><p><strong>Example 1:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Input: [7, 1, 5, 3, 6, 4]</div><div class="line">Output: 5</div><div class="line"></div><div class="line">max. difference = 6-1 = 5 (not 7-1 = 6, as selling price needs to be larger than buying price)</div></pre></td></tr></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Input: [7, 6, 4, 3, 1]</div><div class="line">Output: 0</div><div class="line"></div><div class="line">In this case, no transaction is done, i.e. max profit = 0.</div></pre></td></tr></table></figure><p><strong>Tags:</strong> Array, Dynamic Programmin</p><h2 id="思路-42"><a href="#思路-42" class="headerlink" title="思路"></a>思路</h2><p>题意是给出一个数组代表每天的股票金额，让你在最多买卖一次的情况下算出最大的收益额，最简单的就是模拟即可，每次记录当前值减去最小值的差值，与上一次的进行比较然后更新最大值即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>, minPrice = Integer.MAX_VALUE;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; prices.length; ++i) &#123;</div><div class="line">            <span class="keyword">if</span> (prices[i] &lt; minPrice) minPrice = prices[i];</div><div class="line">            <span class="keyword">int</span> delta = prices[i] - minPrice;</div><div class="line">            <span class="keyword">if</span> (delta &gt; max) max = delta;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="122-Best-Time-to-Buy-and-Sell-Stock-II"><a href="#122-Best-Time-to-Buy-and-Sell-Stock-II" class="headerlink" title="122 Best Time to Buy and Sell Stock II"></a><a href="#">122 Best Time to Buy and Sell Stock II</a></h1><h2 id="Description-58"><a href="#Description-58" class="headerlink" title="Description"></a>Description</h2><p>Say you have an array for which the <em>i</em><sup>th</sup> element is the price of a given stock on day <em>i</em>.</p><p>Design an algorithm to find the maximum profit. You may complete as many transactions as you like (ie, buy one and sell one share of the stock multiple times). However, you may not engage in multiple transactions at the same time (ie, you must sell the stock before you buy again).</p><p><strong>Tags:</strong> Array, Greedy</p><h2 id="思路-43"><a href="#思路-43" class="headerlink" title="思路"></a>思路</h2><p>题意是给出一个数组代表每天的股票金额，在每天只能买或卖的情况下求出收益最高值，这…，这也太简单了吧，把所有相邻递增的值都加起来即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; prices.length; ++i) &#123;</div><div class="line">            <span class="keyword">if</span> (prices[i] &gt; prices[i - <span class="number">1</span>]) max += prices[i] - prices[i - <span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="543-Diameter-of-Binary-Tree"><a href="#543-Diameter-of-Binary-Tree" class="headerlink" title="543 Diameter of Binary Tree"></a><a href="#">543 Diameter of Binary Tree</a></h1><h2 id="Description-59"><a href="#Description-59" class="headerlink" title="Description"></a>Description</h2><p>Given a binary tree, you need to compute the length of the diameter of the tree. The diameter of a binary tree is the length of the <strong>longest</strong> path between any two nodes in a tree. This path may or may not pass through the root.</p><p><strong>Example:</strong></p><p>Given a binary tree</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">    1</div><div class="line">   / \</div><div class="line">  2   3</div><div class="line"> / \     </div><div class="line">4   5</div></pre></td></tr></table></figure><p>Return <strong>3</strong>, which is the length of the path [4,2,1,3] or [5,2,1,3].</p><p><strong>Note:</strong> The length of path between two nodes is represented by the number of edges between them.</p><p><strong>Tags:</strong> Tree</p><h2 id="思路-44"><a href="#思路-44" class="headerlink" title="思路"></a>思路</h2><p>题意是让你算出二叉树中最远的两个节点的距离，分别计算左右子树的最大高度，然后不断迭代出其和的最大值就是最终结果。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Definition for a binary tree node.</span></div><div class="line"><span class="comment"> * public class TreeNode &#123;</span></div><div class="line"><span class="comment"> *     int val;</span></div><div class="line"><span class="comment"> *     TreeNode left;</span></div><div class="line"><span class="comment"> *     TreeNode right;</span></div><div class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></div><div class="line"><span class="comment"> * &#125;</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> max = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">diameterOfBinaryTree</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        helper(root);</div><div class="line">        <span class="keyword">return</span> max;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">helper</span><span class="params">(TreeNode root)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (root == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> l = helper(root.left);</div><div class="line">        <span class="keyword">int</span> r = helper(root.right);</div><div class="line">        <span class="keyword">if</span> (l + r &gt; max) max = l + r;</div><div class="line">        <span class="keyword">return</span> Math.max(l, r) + <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h1 id="554-Brick-Wall"><a href="#554-Brick-Wall" class="headerlink" title="554 Brick Wall"></a><a href="#">554 Brick Wall</a></h1><h2 id="Description-60"><a href="#Description-60" class="headerlink" title="Description"></a>Description</h2><p>There is a brick wall in front of you. The wall is rectangular and has several rows of bricks. The bricks have the same height but different width. You want to draw a vertical line from the <strong>top</strong> to the <strong>bottom</strong> and cross the <strong>least</strong> bricks.</p><p>The brick wall is represented by a list of rows. Each row is a list of integers representing the width of each brick in this row from left to right.</p><p>If your line go through the edge of a brick, then the brick is not considered as crossed. You need to find out how to draw the line to cross the least bricks and return the number of crossed bricks.</p><p><strong>You cannot draw a line just along one of the two vertical edges of the wall, in which case the line will obviously cross no bricks.</strong></p><p><strong>Example:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Input:</div><div class="line">[[1,2,2,1],</div><div class="line"> [3,1,2],</div><div class="line"> [1,3,2],</div><div class="line"> [2,4],</div><div class="line"> [3,1,2],</div><div class="line"> [1,3,1,1]]</div><div class="line">Output: 2</div></pre></td></tr></table></figure><p>Explanation:<br><img src="https://leetcode.com/static/images/problemset/brick_wall.png" alt="img"></p><p><strong>Note:</strong></p><ol><li><p>The width sum of bricks in different rows are the same and won’t exceed INT_MAX.</p></li><li><p>The number of bricks in each row is in range [1,10,000]. The height of wall is in range [1,10,000]. Total number of bricks of the wall won’t exceed 20,000.</p></li></ol><p><strong>Tags:</strong> Hash Table</p><h2 id="思路-45"><a href="#思路-45" class="headerlink" title="思路"></a>思路</h2><p>题意根据图示已经描述得很清楚了，就是在从底部到顶部，求最少交叉的数量，我们可以把每堵墙可以穿过的地方保存到哈希表中，每次遇到哈希表中的值加一，代表就是这条路不用交叉的数量，最终我们可以算出不用交叉的最大值，让总墙数减去其值就是最少交叉的数量。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">leastBricks</span><span class="params">(List&lt;List&lt;Integer&gt;&gt; wall)</span> </span>&#123;</div><div class="line">        Map&lt;Integer, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="keyword">int</span> width = <span class="number">0</span>, max = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (List&lt;Integer&gt; sub : wall) &#123;</div><div class="line">            <span class="keyword">int</span> p = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, len = sub.size() - <span class="number">1</span>; i &lt; len; ++i) &#123;</div><div class="line">                p += sub.get(i);</div><div class="line">                Integer v = map.get(p);</div><div class="line">                map.put(p, (v == <span class="keyword">null</span> ? <span class="number">0</span> : v) + <span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (Integer integer : map.values()) &#123;</div><div class="line">            <span class="keyword">if</span> (integer &gt; max) max = integer;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> wall.size() - max;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Awesome-Java-Leetcode&quot;&gt;&lt;a href=&quot;#Awesome-Java-Leetcode&quot; class=&quot;headerlink&quot; title=&quot;Awesome Java Leetcode&quot;&gt;&lt;/a&gt;Awesome Java Leetcode&lt;/
      
    
    </summary>
    
      <category term="学习" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="求职" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/"/>
    
      <category term="算法" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="求职" scheme="http://shuaiyy.cn/tags/%E6%B1%82%E8%81%8C/"/>
    
      <category term="刷题" scheme="http://shuaiyy.cn/tags/%E5%88%B7%E9%A2%98/"/>
    
      <category term="LeetCode" scheme="http://shuaiyy.cn/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>Java开发复习资料</title>
    <link href="http://shuaiyy.cn/2018/05/01/%E5%AD%A6%E4%B9%A0/%E6%89%BE%E5%B7%A5%E4%BD%9C/Java%E5%BC%80%E5%8F%91%E5%A4%8D%E4%B9%A0%E8%B5%84%E6%96%99/"/>
    <id>http://shuaiyy.cn/2018/05/01/学习/找工作/Java开发复习资料/</id>
    <published>2018-04-30T16:00:00.000Z</published>
    <updated>2018-11-27T10:48:58.987Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h2 id="在被虐中成长，在面试中进步"><a href="#在被虐中成长，在面试中进步" class="headerlink" title="在被虐中成长，在面试中进步"></a>在被虐中成长，在面试中进步</h2><p>指缝很宽，时间太瘦，悄悄从指缝间溜走。转眼之间三年的研究生生活即将结束，即使很是不舍，也终将要走向社会，开始另一段新的旅程。此刻，看着下一届师弟师妹开始忙碌地准备找实习，便开始追忆起过去一年找实习和工作的历程，那是一段艰辛而又成长颇多的经历。</p><p>过去一年找实习和工作的经历还是那么清晰，每每想起，都彷如发生在昨日。面试官问的问题以及那些踩过的坑却都一一浮现眼前，久久不能忘怀。那无数日夜挑灯备战的艰辛，那焦虑不安等着面试电话的心情，那一次次被被拒后的失落和那收到一个个offer喜悦之情，<strong>那些我们经历的终将成为我们人生一笔宝贵的财富</strong>。而最重要的是，我们在面试过程中学会了成长，学会了改变。学习弥补那些我们不会的知识，加深理解那些我们浮于表面的原理，改变我们面试过程中出现的缺点和不足。那段时间，我们快速吸收了大量知识，又好像重新回到了当年的考研状态，但又感觉比考研还要艰辛，因为要准备的知识面太多、太广。亦如考研，朝看夕忘，每天沉浸在复习和备战中。书本和笔记一遍遍地翻看，算法一遍遍地刷，又一遍遍地准备那些自己不擅长的知识。闲暇时便又去收集各种招聘信息，看看招聘网站是否有新的找人消息，问问学长学姐还有没有内推的机会。就这样一步一步，<strong>我们在被虐中成长，在面试中进步</strong>。面试是一个非常好的学习机会，我们应当适当地利用好这次机会完成自己知识的一次飞跃。</p><h4 id="1-更加集中的学习"><a href="#1-更加集中的学习" class="headerlink" title="1. 更加集中的学习"></a>1. 更加集中的学习</h4><p>正如考研、期末考试一样，面试也是我们一次知识增长和爆发的时候。因为有了面试和找工作的压力，我们便能更加集中地将大把时间花在学习和复习上。将时间花在哪里，你的成就就在哪里，根据《刻意练习》中的刻意练习理论和《异类》中的10000小时定律，你在某个领域花的时间越多，你在该领域的成就越高。</p><p>我们在面试过程中加强了知识复习强度，而面试就是对这次知识准备的反馈过程，通过面试来找出自己的不足和了解自己知识的掌握程度。遇到不会的知识，我们便开始上网或翻阅书本，查缺补漏。通过反复的准备、面试、纠正的过程使得我们掌握了大量的面试技巧，同时也强化了对知识掌握程度。</p><h4 id="2-更加系统的知识体系"><a href="#2-更加系统的知识体系" class="headerlink" title="2. 更加系统的知识体系"></a>2. 更加系统的知识体系</h4><p>互联网面试不会问单一的知识（如：算法），而是一次综合性考察。因此我们在备战面试过程中各个知识点都需要准备，如计算机操作系统、计算机网络、数据库、算法、数据结构等。而知识之间不可能孤立存在，而是彼此存在联系。《高效学习》中提到，学习过程分为几个阶段：<strong>知识获取,理解,拓展(或者建立联系),纠错,应用,记忆,测试</strong>。我们根据面试要求从相关书籍中<strong>获取知识</strong>；<strong>理解</strong>一些知识和概念，及背后的原理(如什么是面向对象)；同时建立起与其他知识之间的<strong>联系</strong>，例如java虚拟机的垃圾回收算法是什么，性能如何？优缺点是什么？—java虚拟机和算法数据结构的联系。java虚拟机如何做到跨平台，与计算机系统之间是怎样的关系等。通过面试过程<strong>纠正</strong>我们对知识的错误认知。通过反复纠正、记忆便掌握更加牢固。</p><p>面试中的问题都会将一些知识联系起来，比如MySql索引的数据结构是什么？性能如何？不同索引之间的比较如何？这些都不是单纯的考察MySql知识，同时也在考察对数据库中B+树、hash的理解。</p><p>可以通过复习建立起各个知识之间的联系，并且我们能够花大量时间系统的学习各个方面的知识。通过这样一次复习后，我们拥有了更加系统的互联网知识体系，建立起各知识点之间的联系。</p><h4 id="3-弥补不足，提升自我"><a href="#3-弥补不足，提升自我" class="headerlink" title="3. 弥补不足，提升自我"></a>3. 弥补不足，提升自我</h4><p>面试一个非常好的地方就是能够帮助自己，找出自己的不足，这些不足包括知识和沟通等方面。面试中遇到不会的问题便是我们成长最大、最快的地方。这些问题之前学习的时候是否认真考虑过？是否做项目时，某些问题是否有深入地分析过？用的框架是否知其然而知其所以然？总结面试中回答不足的问题，我们在复习过程中重点攻克，查缺补漏，进一步巩固之前的基础知识。虽然面试过程中有时候会被虐的体无完肤，虐得心力憔悴。但是，这也帮助我们找到自己知识的不足，便于弥补和提高。面试过程中最怕的不是被拒绝，而是不知道为什么被拒绝。被拒绝后还不采取相应的措施去做出改变，那即便面再多也是徒然。</p><h4 id="4-更加深入地了解知识背后原理"><a href="#4-更加深入地了解知识背后原理" class="headerlink" title="4. 更加深入地了解知识背后原理"></a>4. 更加深入地了解知识背后原理</h4><p>通常我们掌握的知识，仅仅是这个知识，处于一种<strong>见树而不见森林</strong>的状态，对其别后的原理和联系都不甚了解。于是面试中一旦面试官深入问询时，自己便回答不上了。<strong>面试带来的好处就是让我们有更多的机会去反思和思考，让我们能够更加深入地去挖掘知识背后的原理，而不是简简单单地浮于表面的理解</strong>。面试中你会发现那些习以为常的知识背后隐藏着一个丰富多彩的知识世界，<strong>一花一世界，一叶一森林</strong>，这些知识背后总有那些需要了解的知识原理和知识间的联系。通过面试，我们加强对这些知识的理解和学习，通过深入分析背后的原理和建立起知识点的练习，使自己能够做到<strong>见树即见森林</strong>。</p><p>面试是一次知识提升的机会，面试中应该学会总结自己的不足，并针对不足之处深入研究、分析才能促进自己的成长。而不应该仅仅将面试准备当做应付考试一样准备，背背网上的一些所谓的”标准答案“。</p><h2 id="缘分与心态"><a href="#缘分与心态" class="headerlink" title="缘分与心态"></a>缘分与心态</h2><p>我们如此看重实习和工作，是因为进入BAT等互联网大型公司实习一方面能够给我们一个平台提高我们的实践能力、学习更多知识技能和拓展我们的视野，另一方面是能在未来找工作时为我们简历加分。而工作更不用说了，十几年的学习生涯也是为了毕业时找份好工作，为未来奠定一个好的开端。很多人常说第一份工作至关重要，往往决定了一个人未来的发展道路。是否决定一个人未来因个人而异，但是第一份工作还是非常关键，那是我们走入社会的第一步，会对自己个人的成长和视野的开拓产生重要影响。因为不同的公司的文化环境不同，组织结构不同和给个人提供的机会都有所不同。因此也很多人格外看重这份工作。</p><p>而不管是找实习还是找工作，我们都会面临一个问题，那就是面试。面试不仅是考验的是技术和知识，同时也是看缘分和心态。</p><p>找工作之前，有一点你必须清楚，就是找工作是一件看缘分的事情，不是你很牛逼，你就一定能进你想进的公司，都是有一个概率在那。比如相同的公司因为面试官不同问的知识点也可能不同，有时候问的刚好你都准备了，有时候偏偏问些你所不会的。如果你基础好，项目经验足，同时准备充分，那么你拿到offer的概率就会比较高；相反，如果你准备不充分，基础也不好，那么你拿到offer的概率就会比较低，但是你可以多投几家公司，这样拿到offer的几率就要大一点，因为你总有运气好的时候。所以，不要惧怕面试，刚开始失败了没什么的，多投多尝试，面多了你就自然能成面霸了。<strong>得失心也不要太重</strong>，应该放宽心态，应为最后每个人都会有offer的。</p><h2 id="基础备战"><a href="#基础备战" class="headerlink" title="基础备战"></a>基础备战</h2><p>基础这东西，各个公司都很看重，尤其是BAT这种大公司，他们看中人的潜力，他们舍得花精力去培养，所以基础是重中之重。当你的基础好的发指的时候，你的其他东西都不重要了。</p><p>基础无外乎几部分：语言（C/C++或java），操作系统，TCP/IP，数据结构与算法，再加上你所熟悉的领域。当面试多了，你便会发现有很多是常见的问题和知识点，因此本书对那些常见的面试题进行收集和整理，并对一些题目做深入分析，希望能够帮助大家。</p><hr><h1 id="第一章-操作系统"><a href="#第一章-操作系统" class="headerlink" title="第一章 操作系统"></a>第一章 操作系统</h1><h2 id="1-1-生产者与消费者"><a href="#1-1-生产者与消费者" class="headerlink" title="1.1 生产者与消费者"></a>1.1 生产者与消费者</h2><h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>生产者消费者模式是通过一个容器来解决生产者和消费者的强耦合问题。生产者和消费者彼此之间不直接通讯，而通过阻塞队列来进行通讯，所以生产者生产完数据之后不用等待消费者处理，直接扔给阻塞队列，消费者不找生产者要数据，而是直接从阻塞队列里取，阻塞队列就相当于一个缓冲区，平衡了生产者和消费者的处理能力。解决生产者/消费者问题的方法可分为两类： 1.采用某种机制保护生产者和消费者之间的同步； 2.在生产者和消费者之间建立一个管道。第一种方式有较高的效率，并且易于实现，代码的可控制性较好，属于常用的模式。第二种管道缓冲区不易控制，被传输数据对象不易于封装等，实用性不强。</p><h3 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a>实现方式</h3><p>同步方式实现生产者-消费者模型。在Java中一共有四种方法支持同步，其中前三个是同步方法，一个是管道方法。 </p><ul><li>wait() / notify()方法 </li><li>await() / signal()方法 </li><li>BlockingQueue阻塞队列方法 </li><li><p>PipedInputStream / PipedOutputStream</p><p>wait()/notify() 、blockingQueue方式</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProducerConsumer</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">    <span class="keyword">static</span>  <span class="class"><span class="keyword">class</span> <span class="title">MsgQueueManager</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 消息总队列</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        <span class="keyword">public</span> <span class="keyword">final</span> BlockingQueue&lt;T&gt; messageQueue;</div><div class="line">        MsgQueueManager(BlockingQueue&lt;T&gt; messageQueue) &#123;</div><div class="line">            <span class="keyword">this</span>.messageQueue = messageQueue;</div><div class="line">        &#125;</div><div class="line">        MsgQueueManager() &#123;</div><div class="line">            <span class="keyword">this</span>.messageQueue = <span class="keyword">new</span> LinkedBlockingQueue&lt;T&gt;();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(T msg)</span> </span>&#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                messageQueue.put(msg);</div><div class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">                Thread.currentThread().interrupt();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> T <span class="title">take</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                <span class="keyword">return</span> messageQueue.take();</div><div class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">                Thread.currentThread().interrupt();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">static</span>  <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</div><div class="line">        <span class="keyword">private</span> MsgQueueManager msgQueueManager;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Producer</span><span class="params">(MsgQueueManager msgQueueManager)</span> </span>&#123;</div><div class="line">            <span class="keyword">this</span>.msgQueueManager = msgQueueManager;</div><div class="line">        &#125;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">            msgQueueManager.put(<span class="keyword">new</span> Object());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</div><div class="line">        <span class="keyword">private</span> MsgQueueManager msgQueueManager;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Consumer</span><span class="params">(MsgQueueManager msgQueueManager)</span> </span>&#123;</div><div class="line">            <span class="keyword">this</span>.msgQueueManager = msgQueueManager;</div><div class="line">        &#125;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">            Object o = msgQueueManager.take();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        MsgQueueManager&lt;String&gt; msgQueueManager = <span class="keyword">new</span> MsgQueueManager&lt;String&gt;();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i ++) &#123;</div><div class="line">            <span class="keyword">new</span> Producer(msgQueueManager).start();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i ++) &#123;</div><div class="line">            <span class="keyword">new</span> Consumer(msgQueueManager).start();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="1-2-常见面试题"><a href="#1-2-常见面试题" class="headerlink" title="1.2 常见面试题"></a>1.2 常见面试题</h2><ul><li>进程和线程的区别。</li><li>死锁的必要条件，怎么处理死锁。</li><li>Window内存管理方式：段存储，页存储，段页存储。</li><li>进程的几种状态。</li><li>IPC几种通信方式。</li><li>什么是虚拟内存。</li><li>虚拟地址、逻辑地址、线性地址、物理地址的区别。</li></ul><h2 id="1-3进程和线程"><a href="#1-3进程和线程" class="headerlink" title="1.3进程和线程"></a>1.3进程和线程</h2><h4 id="1-1-线程"><a href="#1-1-线程" class="headerlink" title="1.1 线程"></a>1.1 线程</h4><p><strong>概念</strong>：线程是进程中执行运算的最小单位，是进程中的一个实体，是被系统独立调度和分派的基本单位，线程自己不拥有系统资源，只拥有一点在运行中必不可少的资源，但它可与同属一个进程的其它线程共享进程所拥有的全部资源。</p><p><strong>好处</strong>：<strong>1)</strong>易于调度。 <strong>2)</strong>提高并发性。通过线程可方便有效地实现并发性。进程可创建多个线程来执行同一程序的不同部分。 <strong>3)</strong>开销少。创建线程比创建进程要快，所需开销很少。。 <strong>4)</strong>利于充分发挥多处理器的功能。通过创建多线程进程，每个线程在一个处理器上运行，从而实现应用程序的并发性，使每个处理器都得到充分运行。</p><p> <strong>线程状态：</strong>联系java中线程的几种状态 ，java thread的运行周期中的几种状态,在 <code>java.lang.Thread.State</code> 中有详细定义和说明:</p><ol><li>NEW 状态是指线程刚创建, 尚未启动</li><li>RUNNABLE 状态是线程正在正常运行中,当然可能会有某种耗时计算/IO等待的操作/CPU时间片切换等,这个状态下发生的等待一般是其他系统资源, 而不是锁, Sleep等</li><li>BLOCKED 这个状态下, 是在多个线程有同步操作的场景,比如正在等待另一个线程的synchronized 块的执行释放, 或者可重入的 synchronized块里别人调用wait() 方法,也就是这里是线程在等待进入临界区</li><li>WAITING 这个状态下是指线程拥有了某个锁之后, 调用了他的wait方法, 等待其他线程/锁拥有者调用 notify / notifyAll 一遍该线程可以继续下一步操作, 这里要区分 BLOCKED 和 WATING 的区别, 一个是在临界点外面等待进入, 一个是在理解点里面wait等待别人notify, 线程调用了join方法 join了另外的线程的时候, 也会进入WAITING状态, 等待被他join的线程执行结束</li><li>TIMED_WAITING 这个状态就是有限的(时间限制)的WAITING, 一般出现在调用wait(long), join(long)等情况下, 另外一个线程sleep后, 也会进入TIMED_WAITING状态</li><li>TERMINATED 这个状态下表示该线程的run方法已经执行完毕了,基本上就等于死亡了(当时如果线程被持久持有, 可能不会被回收) </li></ol><h4 id="1-2-进程"><a href="#1-2-进程" class="headerlink" title="1.2 进程"></a>1.2 进程</h4><p><strong>概念：</strong>进程是操作系统的概念，每当我们执行一个程序时，对于操作系统来讲就创建了一个进程,在这个过程中，伴随着资源的分配和释放。可以认为进程是一个程序的一次执行过程。</p><ul><li><strong>进程与程序的区别</strong></li></ul><ol><li>进程是程序的一次运行活动，属于一种动态的概念。程序是一组有序的静态指令，是一种静态的概念。</li><li>一个进程可以执行一个或多个程序。</li><li>程序可以作为一种软件资源长期保持着,而进程则是一次执行过程,它是暂时的,是动态地产生和终止的。</li><li>进程更能真实地描述并发,而程序不能。</li><li>进程由程序和数据两部分组成，进程是竞争计算机系统有限资源的基本单位</li><li>进程具有创建其他进程的功能；而程序没有。</li><li>进程还具有并发性和交互性，这也与程序的封闭性不同</li></ol><ul><li><strong>进程的几种状态:</strong></li></ul><ol><li>创建状态(New)：进程正在创建过程中，还不能运行。操作系统在创建状态要进行的工作包括分配和建立进程控制块表项、建立资源表格(如打开文件表)并分配资源、加载程序并建立地址空间表等。</li><li>就绪状态(Ready)：进程已获得除处理器外的所需资源，等待分配处理器资源；只要分配了处理器进程就可执行。就绪进程可以按多个优先级来划分队列。例如，当一个进程由于时间片用完而进入就绪状态时，排人低优先级队列；当进程由I／O操作完成而进入就绪状态时，排入高优先级队列。</li><li>执行状态:进程已获得CPU，其程序正在执行。在单处理机系统中，只有一个进程处于执行状态； 在多处理机系统中，则有多个进程处于执行状态。</li><li>阻塞状态:正在执行的进程由于发生某事件而暂时无法继续执行时，便放弃处理机而处于暂停状态，亦即进程的执行受到阻塞，把这种暂停状态称为阻塞状态，有时也称为等待状态或封锁状态。致使进程阻塞的典型事件有：请求I/O，申请缓冲空间等。通常将这种处于阻塞状态的进程也排成一个队列。有的系统则根据阻塞原因的不同而把处于阻塞状态的进程排成多个队列。</li><li>退出状态(Exit)：进程已结束运行，回收除进程控制块之外的其他资源，并让其他进程从进程控制块中收集有关信息(如记帐和将退出代码传递给父进程)。</li></ol><ul><li><strong>作业(进程)调度算法</strong></li></ul><ol><li>先来先服务调度算法(FCFS) 每次调度都是从后备作业队列中选择一个或多个最先进入该队列的作业，将它们调入内存，为它们分配资源、创建进程，然后放入就绪队列。</li><li>短作业(进程)优先调度算法(SPF) 短作业优先(SJF)的调度算法是从后备队列中选择一个或若干个估计运行时间最短的作业，将它们调入内存运行。缺点:长作业的运行得不到保证</li><li>优先权调度算法(HPF) 当把该算法用于作业调度时，系统将从后备队列中选择若干个优先权最高的作业装入内存。当用于进程调度时，该算法是把处理机分配给就绪队列中优先权最高的进程，这时，又可进一步把该算法分成如下两种。 可以分为: 1.非抢占式优先权算法 2.抢占式优先权调度算法</li><li>高响应比优先调度算法(HRN) 每次选择高响应比最大的作业执行，响应比=(等待时间+要求服务时间)/要求服务时间。该算法同时考虑了短作业优先和先来先服务。<ul><li>如果作业的等待时间相同，则要求服务的时间愈短，其优先权愈高，因而该算法有利于短作业。</li><li>当要求服务的时间相同时，作业的优先权决定于其等待时间，等待时间愈长，其优先权愈高，因而它实现的是先来先服务。</li><li>对于长作业，作业的优先级可以随等待时间的增加而提高，当其等待时间足够长时，其优先级便可升到很高，从而也可获得处理机。简言之，该算法既照顾了短作业，又考虑了作业到达的先后次序，不会使长作业长期得不到服务。因此，该算法实现了一种较好的折衷。当然，在利用该算法时，每要进行调度之前，都须先做响应比的计算，这会增加系统开销。</li></ul></li><li>时间片轮转法（RR） 在早期的时间片轮转法中，系统将所有的就绪进程按先来先服务的原则排成一个队列，每次调度时，把CPU分配给队首进程，并令其执行一个时间片。时间片的大小从几ms到几百ms。当执行的时间片用完时，由一个计时器发出时钟中断请求，调度程序便据此信号来停止该进程的执行，并将它送往就绪队列的末尾；然后，再把处理机分配给就绪队列中新的队首进程，同时也让它执行一个时间片。这样就可以保证就绪队列中的所有进程在一给定的时间内均能获得一时间片的处理机执行时间。换言之，系统能在给定的时间内响应所有用户的请求。</li><li>多级反馈队列调度算法 它是目前被公认的一种较好的进程调度算法。<ul><li>应设置多个就绪队列，并为各个队列赋予不同的优先级。第一个队列的优先级最高，第二个队列次之，其余各队列的优先权逐个降低。该算法赋予各个队列中进程执行时间片的大小也各不相同，在优先权愈高的队列中，为每个进程所规定的执行时间片就愈小。例如，第二个队列的时间片要比第一个队列的时间片长一倍，……，第i+1个队列的时间片要比第i个队列的时间片长一倍。</li><li>当一个新进程进入内存后，首先将它放入第一队列的末尾，按FCFS原则排队等待调度。当轮到该进程执行时，如它能在该时间片内完成，便可准备撤离系统；如果它在一个时间片结束时尚未完成，调度程序便将该进程转入第二队列的末尾，再同样地按FCFS原则等待调度执行；如果它在第二队列中运行一个时间片后仍未完成，再依次将它放入第三队列，……，如此下去，当一个长作业(进程)从第一队列依次降到第n队列后，在第n 队列便采取按时间片轮转的方式运行。</li><li>仅当第一队列空闲时，调度程序才调度第二队列中的进程运行；仅当第1～(i-1)队列均空时，才会调度第i队列中的进程运行。如果处理机正在第i队列中为某进程服务时，又有新进程进入优先权较高的队列(第1～(i-1)中的任何一个队列)，则此时新进程将抢占正在运行进程的处理机，即由调度程序把正在运行的进程放回到第i队列的末尾，把处理机分配给新到的高优先权进程。</li></ul></li></ol><ul><li><p><strong>作业与进程的区别</strong></p><p>一个进程是一个程序对某个数据集的执行过程，是分配资源的基本单位。作业是用户需要计算机完成的某项任务，是要求计算机所做工作的集合。一个作业的完成要经过作业提交、作业收容、作业执行和作业完成4个阶段。而进程是对已提交完毕的程序所执行过程的描述，是资源分配的基本单位。</p><ul><li>作业是用户向计算机提交任务的任务实体。在用户向计算机提交作业后，系统将它放入外存中的作业等待队列中等待执行。而进程则是完成用户任务的执行实体，是向系统申请分配资源的基本单位。任一进程，只要它被创建，总有相应的部分存在于内存中。</li><li>一个作业可由多个进程组成，且必须至少由一个进程组成，反过来则不成立。</li><li>作业的概念主要用在批处理系统中，像UNIX这样的分时系统中就没有作业的概念。而进程的概念则用在几乎所有的多道程序系统中。</li></ul></li></ul><h4 id="1-3-进程和线程的关系："><a href="#1-3-进程和线程的关系：" class="headerlink" title="1.3 进程和线程的关系："></a>1.3 进程和线程的关系：</h4><ul><li>一个线程只能属于一个进程，而一个进程可以有多个线程，但至少有一个线程。</li><li>资源分配给进程，同一进程的所有线程共享该进程的所有资源。</li><li>处理机分给线程，即真正在处理机上运行的是线程。</li><li>线程在执行过程中，需要协作同步。不同进程的线程间要利用消息通信的办法实现同步。线程是指进程内的一个执行单元,也是进程内的可调度实体.</li></ul><h4 id="1-4-进程与线程的区别"><a href="#1-4-进程与线程的区别" class="headerlink" title="1.4 进程与线程的区别"></a>1.4 进程与线程的区别</h4><ul><li>调度：线程作为调度和分配的基本单位，进程作为拥有资源的基本单位</li><li>并发性:不仅进程之间可以并发执行，同一个进程的多个线程之间也可并发执行</li><li>拥有资源:进程是拥有资源的一个独立单位，线程不拥有系统资源，只拥有一点在运行中必不可少的资源，但它可与同属一个进程的其它线程共享进程所拥有的全部资源.</li><li>系统开销:由于创建或撤销进程时，系统都要为之分配或回收资源，如内存空间、I/O 设备等，因此操作系统所付出的开销远大于创建或撤销线程时的开销。类似地，在进行进程切换时，涉及当前执行进程 CPU 环境的保存及新调度进程 CPU 环境的设置。而线程切换时只需保存和设置少量寄存器内容，开销很小。此外，由于同一进程内的多个线程共享进程的地址空间，因此，这些线程之间的同步与通信非常容易实现，甚至无需操作系统的干预。</li><li>通信方面：进程间通讯有管道、信号量、信号消息队列、socket来维护，而线程间通过通道、共享内存、信号灯来进行通信。</li></ul><h3 id="2-IPC几种通信方式-进程间的通信方式"><a href="#2-IPC几种通信方式-进程间的通信方式" class="headerlink" title="2. IPC几种通信方式(进程间的通信方式)"></a>2. IPC几种通信方式(进程间的通信方式)</h3><ul><li><p><strong>管道( pipe )</strong>：只支持半双工通信方式，即只能单向传输；只能在父子进程之间使用。</p><p>管道是单向的、先进先出的、无结构的、固定大小的字节流，它把一个进程的标准输出和另一个进程的标准输入连接在一起。写进程在管道的尾端写入数据，读进程在管道的首端读出数据。数据读出后将从管道中移走，其它读进程都不能再读到这些数据。</p><p>流管道：去除第一个限制，支持双向传输；</p><p>命名管道：去除第二个限制，可以在不相关进程之间进行通信。</p></li><li><p>命名管道 (named pipe)： 命名管道也是半双工的通信方式，它克服了管道没有名字的限制，并且它允许无亲缘关系进程间的通信。命令管道在文件系统中有对应的文件名，命名管道通过命令mkfifo或系统调用mkfifo来创建。</p></li><li><p>信号量( semophore )： 信号量是一个计数器，可以用来控制多个进程对共享资源的访问。它常作为一种锁机制，防止某进程正在访问共享资源时，其他进程也访问该资源。因此，主要作为进程间以及同一进程内不同线程之间的同步手段。</p></li><li><p>消息队列( message queue )： 消息队列是由消息的链表结构实现，存放在内核中并由消息队列标识符标识。有足够权限的进程可以向队列中添加消息，被赋予读权限的进程则可以读走队列中的消息。消息队列克服了信号传递信息少、管道只能承载无格式字节流以及缓冲区大小受限等缺点。</p></li><li><p>信号 ( sinal )：信号是一种比较复杂的通信方式，用于通知接收进程某个事件已经发生。除了用于进程通信外，进程还可以发送信号给进程本身。</p></li><li><p>共享内存( shared memory )：共享内存就是映射一段能被其他进程所访问的内存，这段共享内存由一个进程创建，但多个进程都可以访问。共享内存是最快的IPC方式，它是针对其他进程间通信方式运行效率低而专门设计的。它往往与其他通信机制，如信号量配合使用，来实现进程间的同步和通信。</p></li><li><p>套接字( socket )： 也是一种进程间通信机制，与其他通信机制不同的是，它可用于不同机器间的进程通信。</p></li></ul><h3 id="3-死锁的必要条件和处理死锁。"><a href="#3-死锁的必要条件和处理死锁。" class="headerlink" title="3. 死锁的必要条件和处理死锁。"></a>3. 死锁的必要条件和处理死锁。</h3><p><strong>死锁概念</strong>：两个或两个以上的进程在执行过程中，由于竞争资源或者由于彼此通信而造成的一种阻塞的现象，若无外力作用，它们都将无法推进下去。</p><p><strong>活锁</strong> ：活锁指的是任务或者执行者没有被阻塞，由于某些条件没有满足，导致一直重复尝试，失败，尝试，失败</p><p><strong>死锁条件</strong> ：</p><ul><li>互斥条件:一个资源每次只能被一个进程使用</li><li>不可剥夺条件:进程已获得的资源，在末使用完之前，不能强行剥夺</li><li>请求与保持条件:一个进程因请求资源而阻塞时，对已获得的资源保持不放</li><li>循环等待条件:若干进程之间形成一种头尾相接的循环等待资源关系.</li></ul><p><strong>死锁预防</strong> ：</p><ul><li>破坏互斥条件。允许某些进程(线程)同时访问某些资源，但有的资源不允许同时被访问如打印机等。</li><li>破坏不可抢占条件:即允许进程强行从占有者那里夺取某些资源。实现起来困难，会降低系统性能。</li><li><p>破坏占有且申请条件。可以实行预先分配策略，即进程在运行前一次性地向系统申请它所需要的全部资源。如果当前进程所需的全部资源得不到满足，则不分配任何资源。只有当系统能够满足当前的全部资源得到满足时，才一次性将所有申请的资源全部分配给该进程。由于运行的进程已占有了它所需的全部资源，所以不会发生占有资源又重新申请资源的现象，因此不会发生死锁。但是有以下缺点：</p><ul><li><p>由于进程在执行时是动态的，不可预测的,进程在执行之前不可能知道它所需的全部资源。</p></li><li><p>资源利用率低。无论所分配资源何时用到，一个进程只有在占有所需的全部资源后才能执行。即使有些资源最后才被该进程用到一次，但该进程在生存期间一直占有它们，造成长期占有。</p></li><li><p>降低了进程的并发性。因为资源有限，又加上存在浪费，能分配到所需全部资源的进程个数必然少了。</p></li></ul></li><li>破坏循环等待条件。实行资源有序分配策略。采用这种策略即把资源事先分类编号，按号分配。所有进程对资源的请求必须严格按资源需要递增的顺序提出。进程先占用小号资源，才能申请大号资源，就不会产生环路。这种策略与前面的策略相比，资源的利用率和系统吞吐量都有很大提高，但是也存在缺点：限制了进程对资源的请求，同时系统给所有资源合理编号也是件困难事，并增加了系统开销。</li></ul><p><strong>死锁的避免:</strong></p><ul><li>银行家算法：该算法需要检查申请者对资源的最大需求量，如果系统现存的各类资源可以满足申请者的请求，就满足申请者的请求。这样申请者就可很快完成其计算，然后释放它占用的资源，从而保证了系统中的所有进程都能完成，所以可避免死锁的发生。</li></ul><p><strong>死锁的解除:</strong></p><ul><li>资源剥夺法。挂起某些死锁进程，并抢占它的资源，将这些资源分配给其他的死锁进程。</li><li>撤销进程法。强制撤销部分、甚至全部死锁进程并剥夺这些进程的资源。</li><li>进程回退法。让一（多）个进程回退到足以回避死锁的地步，进程回退时自愿释放资源而不是被剥夺。要求系统保持进程的历史信息，设置还原点。</li></ul><p><strong>死锁检测与死锁恢复</strong>：</p><p>​    如果一个进程所请求的资源能够被满足，那么就让它执行，否则释放它拥有的所有资源，然后让其它能满足条件的进程执行。</p><h2 id="1-4-Window内存管理方式：页存储、段存储、段页存储。"><a href="#1-4-Window内存管理方式：页存储、段存储、段页存储。" class="headerlink" title="1.4 Window内存管理方式：页存储、段存储、段页存储。"></a>1.4 Window内存管理方式：页存储、段存储、段页存储。</h2><h3 id="1-4-1-分页存储管理"><a href="#1-4-1-分页存储管理" class="headerlink" title="1.4.1 分页存储管理"></a>1.4.1 分页存储管理</h3><p><strong>原理</strong>：将程序的逻辑地址空间划分为固定大小的页(page)，而物理内存划分为同样大小的页框(page frame)或物理块，每个物理块的大小一般取2的整数幂。程序加载时，可将任意一页放人内存中任意一个页框，这些页框不必连续，从而实现了离散分配。该方法需要CPU的硬件支持，来实现逻辑地址和物理地址之间的映射。在页式存储管理方式中地址结构由两部构成，前一部分是页号，后一部分为页内地址w（位移量）。</p><p>逻辑地址-物理地址转换：CPU中的内存管理单元(MMU)按逻辑页号通过查进程页表得到物理页框号，将物理页框号与页内地址相加形成物理地址。</p><p><strong>优点</strong>  ：</p><p>1）没有外部碎片，提高内存的利用率。 2）一个程序不必连续存放。3）程序内存可以动态变化。</p><p><strong>缺点</strong> ： 1）页内部碎片，造成浪费。2）页长与程序的逻辑大小不相关。 3）不利于编程时的独立性，给换入换出、存储保护和存储共享等操作造成麻烦。</p><h3 id="1-4-2-分段存储"><a href="#1-4-2-分段存储" class="headerlink" title="1.4.2 分段存储"></a>1.4.2 分段存储</h3><p><strong>思想</strong> :将用户程序地址空间分成若干个大小不等的段，每段可以定义一组相对完整的逻辑信息。存储分配时，以段为单位，段与段在内存中可以不相邻接，也实现了离散分配。通常，程序员把子程序、操作数和常数等不同类型的数据划分到不同的段中（写c程序时会用到），并且每个程序可以有多个相同类型的段。</p><p>在为某个段分配物理内存时，可以采用首先适配法、下次适配法、最佳适配法等方法。在回收某个段所占用的空间时，要注意将收回的空间与其相邻的空间合并。</p><p><strong>地址映射</strong>：逻辑地址由段号和段内地址两部分组成。为了完成进程逻辑地址到物理地址的映射，处理器会查找内存中的段表，由段号得到段的首地址，加上段内地址，得到实际的物理地址。</p><p><strong>优点</strong>：(1)段的逻辑独立性使其易于编译、管理、修改和保护，也便于多道程序共享。 (2)段长可以根据需要动态改变，允许自由调度，以便有效利用主存空间。 (3)方便编程，分段共享，分段保护，动态链接，动态增长</p><p><strong>缺点</strong>： (1)主存空间分配比较麻烦。 (2)有外部碎片。 </p><h3 id="1-4-3-分页和分段的主要区别"><a href="#1-4-3-分页和分段的主要区别" class="headerlink" title="1.4.3 分页和分段的主要区别"></a>1.4.3 分页和分段的主要区别</h3><ul><li>页是信息的物理单位，分页是为实现离散分配方式，以消减内存的外零头，提高内存的利用率；段则是信息的逻辑单位，它含有一组其意义相对完整的信息，分段的目的是为了能更好地满足用户的需要。 </li><li>页的大小固定且由系统决定，由系统把逻辑地址划分为页号和页内地址两部分，是由机器硬件实现的；而段的长度却不固定，决定于用户所编写的程序和编译器。 </li><li>分页的作业地址空间是一维的，即单一的线性地址空间，程序员只需利用一个记忆符，即可表示一个地址；而分段的作业地址空间则是二维的，程序员在标识一个地址是，即需给出段名，又需给出段内地址。 </li><li>分页信息很难保护和共享、分段存储按逻辑存储所以容易实现对段的保存和共享。</li></ul><h3 id="1-4-4-段页存储"><a href="#1-4-4-段页存储" class="headerlink" title="1.4.4 段页存储"></a>1.4.4 段页存储</h3><p><strong>原理</strong>：程序员按照分段系统的地址结构将地址分为段号与段内位移量，地址变换机制将段内位移量分解为页号和页内位移量。</p><p><strong>实现</strong> ：为实现段页式存储管理，系统应为每个进程设置一个段表，包括每段的段号，该段的页表始址和页表长度。每个段有自己的页表，记录段中的每一页的页号和存放在主存中的物理块。</p><p>将程序按逻辑结构划分为若干个逻辑段，然后再将每个逻辑段划分为若干个大小相等的逻辑页。每个程序段对应一个段表，每页对应一个页表。主存空间也划分为若干个物理页。</p><p><strong>地址变换</strong> ：</p><p>1) 利用段表始址和段号来求出该段所对应的段表项在段表中的位置，从中得到该段的页表始址</p><p>2) 利用逻辑地址中的段内页号P来获得对应页的页表项位置，从中读出该页所在的物理块号b</p><p>3）再利用块号b和页内地址来构成物理地址。</p><p><strong>优缺点</strong> ： 段页存储管理方式综合了段式管理和页式管理的优点，但需要经过两级查表才能完成地址转换，消耗时间多。</p><ul><li>优点 (1) 它提供了大量的虚拟存储空间。 (2) 能有效地利用主存，为组织多道程序运行提供了方便。</li><li>缺点： (1) 增加了硬件成本、系统的复杂性和管理上的开消。 (2) 存在着系统发生抖动的危险。 (3) 每段最后一页可能有内部碎片。 </li></ul><h2 id="1-5-虚拟内存。"><a href="#1-5-虚拟内存。" class="headerlink" title="1.5 虚拟内存。"></a>1.5 虚拟内存。</h2><ul><li>物理内存: 真实硬件内存可用大小，CPU的地址线可以直接进行寻址的内存空间大小。</li><li>虚拟内存: 它使得应用程序认为它拥有连续的可用的内存(一个连续完整的地址空间),而实际上，它通常是被分隔成多个物理内存碎片，还有部分暂时存储在外部磁盘存储器上，在需要时进行数据交换。</li></ul><h2 id="1-6-操作系统如何进行分页调度"><a href="#1-6-操作系统如何进行分页调度" class="headerlink" title="1.6 操作系统如何进行分页调度"></a>1.6 操作系统如何进行分页调度</h2><ul><li>先进先出算法(FIFO):在主存中停留时间最长（即最老）的一页置换，即先进入内存的页，先退出内存。</li><li>最优置换算法（OPT）:所选择的老页应是将来不再被使用，或者是在最远的将来才被访问。采用这种页面置换算法，保证有最少的缺页率。 但是最优页面置换算法的实现是困难的，因为它需要人们预先就知道一个进程整个运行过程中页面走向的全部情况。</li><li>LRU（最近最少使用）：如果一个数据在最近一段时间内使用次数很少，那么在将来一段时间内被使用的可能性也很小。</li><li>时钟算法: 又称为最近未用(Not Recently Used, NRU)算法。</li></ul><h2 id="1-7-磁盘调度算法："><a href="#1-7-磁盘调度算法：" class="headerlink" title="1.7 磁盘调度算法："></a>1.7 磁盘调度算法：</h2><ul><li>先来先服务（FCFS），按访问请求到达的先后顺序服务。简单，公平，但是效率不高，相临两次请求可能会造成最内到最外柱面寻道，使磁头反复移动，增加了服务时间，对机器不利。</li><li>最短寻道时间优先(SSTF)，优先选择距当前磁头最近的访问请求进行服务，主要考虑寻道优先。改善了磁盘平均服务时间，但是造成某些访问请求长期等待得不到服务。</li><li>扫描算法（SCAN）当有访问请求时，磁头按一个方向移动，在移动过程中对遇到的访问请求进行服务.</li><li>循环扫描算法（CSCAN）：磁臂改为单项移动，由外向里。当前位置开始沿磁臂的移动方向去选择离当前磁臂最近的哪个柱面的访问者。如果沿磁臂的方向无请求访问时，再回到最外，访问柱面号最小的作业请求。</li></ul><hr><h1 id="第二章-计算机网络"><a href="#第二章-计算机网络" class="headerlink" title="第二章 计算机网络"></a>第二章 计算机网络</h1><h2 id="2-1-OSI（开放系统互联参考模型）标准模型"><a href="#2-1-OSI（开放系统互联参考模型）标准模型" class="headerlink" title="2.1 OSI（开放系统互联参考模型）标准模型"></a>2.1 OSI（开放系统互联参考模型）标准模型</h2><p><strong>物理层</strong> 负责为数据端设备透明地传输原始比特流，并且定义了数据终端设备和数据通信设备的物理和逻辑链接方法。传输单位是比特。 协议：RJ45、CLOCK、IEEE802.3 设备：（中继器，集线器） </p><p><strong>数据链路层</strong> 将网络层传下来的IP数据报组装成帧，并检测和矫正物理层产生的传输差错，使得链路对网络层显示一条无差错、可靠的数据传输线路。功能可以概括为成帧，差错控制、流量控制和传输管理 协议有：HDLC(高级数据链路控制协议),PPP,STP,SDLC,CSMA(载波监听多路访问) 设备:（网桥，交换机） </p><p><strong>网络层</strong> 负载在网络层上将数据封装成数据报，将数据报从源端传到目的端，同时进行路由选择，为分组交换网上的不同主机提供通信服务。关键问题是对分组进行选择，并实现流量控制、拥塞控制、差错控制和网际互联等功能。传输单位数据报。 协议: IP,ICMP(因特网控制报文协议),IGMP(因特网组管理协议),ARP,RARP,OSPF(开放最短路径优先),IPX 设备:路由器 </p><p><strong>传输层</strong> 负责主机中两个进程之间的通信，为端到端连接提供可靠的传输服务。为端到端连接提供流量控制、差错控制、服务质量、数据传输管理等服务。 协议：TCP,UDP </p><p><strong>会话层</strong> 会话层允许不同主机上各个进程之间的<strong>会话</strong>，会话层利用传输层提供的端到端的服务，向表示层提供它的增值服务。这种服务主要是为表示层实体或用户进程<strong>建立连接</strong>并在连接上提供<strong>有序</strong>地传输数据。 协议：SQL、RPC(远程调用协议) </p><p><strong>表示层</strong> 用于处理两个通信系统中交换信息的表示方式。如数据压缩，加密和解密等。 协议：JPEG、MPEG、ASII </p><p><strong>应用层</strong> 是TCP/IP的最高层，它是直接为应用进程服务的一层。当不同的应用进程数据通信或数据交换时，就去调用应用层的<strong>不同协议实体</strong>，让这些实体去调用TCP或者UDP层服务来进行网络传输。 协议：FTP(21) TELNET(23) SMTP(25) DNS(53) TFTP(69) HTTP(80) SNMP(161),DHCP(动态主机配置协议)</p><p><strong>TCP/IP 分层</strong>：</p><p>1）<strong>网络接口层（接收和发送数据报）</strong> 负责将数据报发送到<strong>网络介质</strong>上，以及从网络上接收TCP/IP数据报，相当于OSI的物理层和数据层。 2）<strong>网际层（数据报封装和路由寻址功能）</strong> 主要负责寻址和对数据报的封装以及重要的路由选择功能。 3)<strong>传输层</strong> <strong>负责在应用进程之间的“端到端”的通信</strong>，即从某个应用进程传输到另一个应用进程。 <strong>4)应用层</strong> 是TCP/IP的最高层，它是直接为应用进程服务的一层。当不同的应用进程数据通信或数据交换时，就去调用应用层的<strong>不同协议实体</strong>，让这些实体去调用TCP或者UDP层服务来进行网络传输。</p><p><strong>五层体系结构模型</strong>：物理层，数据链路层，网络层，传输层，应用层</p><h2 id="2-2-IP地址分类"><a href="#2-2-IP地址分类" class="headerlink" title="2.2 IP地址分类"></a>2.2 IP地址分类</h2><p>A类地址：以0开头， 第一个字节范围：1~126（1.0.0.0 - 126.255.255.255）； B类地址：以10开头， 第一个字节范围：128~191（128.0.0.0 - 191.255.255.255）； C类地址：以110开头， 第一个字节范围：192~223（192.0.0.0 - 223.255.255.255）； D类地址：1110开头， 224~239 E类地址：11110开头， 240~255 主机号全为0表示本网络本身 ，主机号全为1表示本网络广播地址 。</p><p>127.0.0.0 环路自检地址，32个0 表示本网络的本主机 32个1表示整个TCP/IP网络的广播地址,等效本网络的广播地址。 专用地址： 10.0.0.0—10.255.255.255， 172.16.0.0—172.31.255.255， 192.168.0.0—192.168.255.255。（Internet上保留地址用于内部） IP地址与子网掩码相与得到网络号</p><h2 id="2-3-ARP地址解析协议"><a href="#2-3-ARP地址解析协议" class="headerlink" title="2.3 ARP地址解析协议"></a>2.3 ARP地址解析协议</h2><p><strong>本局域网上</strong>各主机和路由器的<strong>IP地址到MAC地址的映射表</strong>，称为ARP表。使用ARP协议动态维护此表。 ARP工作在网络层中，其工作原理是：当主机A欲向本局域网上的某个主机B发送IP数据报时，就先在其ARP高速缓存中查看有无主机B的IP地址。如果有可以查出其对应的硬件地址，再将此硬件地址写入<strong>MAC帧</strong>，然后通过局域网将该MAC帧发往此硬件地址。如果没有，就通过使用目的MAC地址为本网络的广播地址即32个1的帧来封装并广播ARP请求分组，可以使同一个局域网里的所有主机收到ARP请求。当主机B收到该ARP请求后，就会向主机A发出响应ARP分组，分组中包含主机B的IP与MAC地址的映射关系，主机A在收到后将此映射写入ARP缓存中，然后按查询到的硬件地址发送MAC帧。</p><p><strong>ARP是解决同一个局域网上主机与路由器的IP地址和硬件地址的映射问题</strong>。如果所要找的主机和源主机不在同一个局域网上，那么通过ARP协议找到一个位于本局域网上的某个路由器硬件地址，然后把分组发送给这个路由器，让这个路由器把分组转发给下一个网络。</p><h2 id="2-4-交换机、路由器、网关"><a href="#2-4-交换机、路由器、网关" class="headerlink" title="2.4 交换机、路由器、网关"></a>2.4 交换机、路由器、网关</h2><p><strong>路由器</strong>是连接不同的网络并完成路由转发。</p><p><strong>交换机</strong>：是多个端口的网桥，工作在数据链路上，<strong>将两个或多个以太网连接起来成为更大的以太网。它能将网络分成小的冲突域，为每个工作站提供更高的带宽</strong>。其原理是，检测从以太端口来的数据帧的源和目的地的MAC地址，然后与系统内部的动态查找表进行比较。若数据帧的MAC地址不在查找表中，则将该地址加入查找表中，并将数据帧发送给相应的端口。</p><p>区别： <strong>路由器</strong>：工作在网络层，是能够连接不同的广域网形成更大的广域网。连接的是异构网络。根据IP地址转发。 <strong>交换机</strong>：工作在数据链路层，是将以太网连接形成更大的以太网，同一个网络。根据MAC地址进行转发。</p><p><strong>网关(Gateway)</strong> 仅用于两个高层协议不同的网络互连。网关既可以用于广域网互连，也可以用于局域网互连。 在不同的通信协议、数据格式或语言，甚至体系结构完全不同的两种系统之间，网关是一个翻译器。</p><h2 id="2-5-OSI-和TCP-IP的区别"><a href="#2-5-OSI-和TCP-IP的区别" class="headerlink" title="2.5 OSI 和TCP/IP的区别"></a>2.5 OSI 和TCP/IP的区别</h2><ol><li>OSI精确定义了服务、协议和接口，符合<strong>面向对象</strong>程序设计思想。而TCP/IP在这些概念上没有明确区分。</li><li>TCP/IP先有的协议，是事实标准。</li><li>TCP/IP考虑了异构网的互联问题，而OSI只考虑用一种标准的公用数据网将各种不同系统互连。</li></ol><h2 id="2-6-TCP与UDP的区别"><a href="#2-6-TCP与UDP的区别" class="headerlink" title="2.6 TCP与UDP的区别"></a>2.6 TCP与UDP的区别</h2><p>1、TCP<strong>面向连接</strong>;UDP是<strong>无连接的</strong>，即发送数据之前不需要建立连接 2、TCP提供可靠<strong>全双功</strong>的通信服务。UDP是半双功，只能单向传播。 3、通过TCP连接可靠传送的数据，<strong>可靠的</strong>、无差错，不丢失，不重复，且按序到达;UDP则是<strong>不可靠信道</strong>，尽最大努力交付，即不保证可靠交付. 4、TCP<strong>面向字节流</strong>，实际上是TCP把数据看成一连串无结构的字节流;UDP是<strong>面向报文</strong>的． 5、TCP具有<strong>拥塞控制</strong>，UDP<strong>没有拥塞控制</strong>，因此网络出现拥塞不会使源主机的发送速率降低（对实时应用很有用，如IP电话，实时视频会议等） 6、每一条TCP连接只能是<strong>点到点</strong>的;UDP比较灵活，支持一对一，一对多，多对一和多对多的交互通信 7、TCP首部开销20字节;UDP的首部开销小，只有8个字节.</p><p>TCP应用场景：效率要求相对低，但对准确性要求相对高的场景。如文件传输（准确高要求高、但是速度可以相对慢）、接受邮件、远程登录。</p><ul><li>FTP协议，21端口，文件传输</li><li>ssh： 22端口，远程登录及其他服务</li><li>Telnet：23端口，远程登录，明文传输，不安全。</li><li>SMTP： 25，发送邮件 POP3， 110，邮件接收。</li><li>HTTP：80，web文本传输协议， HTTPS， 443.</li></ul><p>UDP应用场景：效率要求相对高，对准确性要求相对低的场景。如：QQ聊天、在线视频、网络语音电话、广播通信。</p><ul><li>DNS(53)：用于域名解析服务，将域名地址转换为IP地址。 </li><li>RIP(520):路由信息协议 </li><li>SNMP(161)：简单网络管理协议，使用161号端口，是用来管理网络设备的。</li><li>TFTP(69)：简单文件传输协议。</li></ul><h2 id="2-7-常见的路由选择协议，以及它们的区别"><a href="#2-7-常见的路由选择协议，以及它们的区别" class="headerlink" title="2.7 常见的路由选择协议，以及它们的区别"></a>2.7 常见的路由选择协议，以及它们的区别</h2><p>常见的路由选择协议有：RIP协议、OSPF协议。 RIP协议（路由信息协议）：底层是贝尔曼福特算法(Bellman-Ford)，<strong>基于距离向量的路由选择协议</strong>，它选择路由的度量标准（metric)是<strong>跳数</strong>，最大跳数是15跳，如果大于15跳，它就会丢弃数据包。仅和相邻路由器交换当前路由器所知道的全部信息。是应用层协议,使用UDP传输数据,端口520</p><p>OSPF协议（开放最短路由优先）：底层是迪杰斯特拉(Dijkstra)算法，<strong>是链路状态路由选择协议</strong>，它选择路由的度量标准是<strong>带宽</strong>，延迟。向本自治系统中所有路由器发送与本路由器相邻的所有路由器的链路状态，但这只是路由器知道的部分信息。网络层协议,直接IP数据报传输． 端口89</p><h2 id="2-8-TCP的三次握手与四次挥手过程"><a href="#2-8-TCP的三次握手与四次挥手过程" class="headerlink" title="2.8 TCP的三次握手与四次挥手过程"></a>2.8 TCP的三次握手与四次挥手过程</h2><p><strong>第一次握手</strong>：A向B发送一个连接请求报文段，其首部中同步位SYN被设置为1，序号seq=x，x为A随机生成的序号；</p><p><strong>第二次握手</strong>：B如果同意建立连接，就向A发回确认，并为该TCP连接分配缓存和变量。在确认报文段中，SYN和ACK位都被设置为1，确认号字段值为ack=x+1,并且服务器随机产生起始序号seq=y。</p><p><strong>第三次握手</strong>：当客户机A收到确认报文段后，还要向服务器给出确认，并且也要给该连接<strong>分配缓存和变量</strong>。这个报文段的确认位ACK被设置为1，序号段被设置为seq=x+1,确认号字段ack=y+1. 该报文段可以携带数据，如果不携带数据则不消耗序号。</p><p><strong>第一次挥手</strong>：A向B发送连接释放报文，并停止再发送数据，主动关闭TCP连接。结束标志位FIN被设置为1，seq=u,它等于前面已经发送过的数据的最后一个字节的序号加1。</p><p><strong>第二次挥手</strong>：B向A发出确认报文，确认号是ack=u+1,序号为v,等于它前面已经发送过的数据的最后一个字节序号加1.此时客户机到服务器这个方向的连接就释放了，TCP处于半关闭状态。ACK=1，seq=v,ack=u+1</p><p><strong>第三次挥手</strong>：若服务器B已经没有要向客户机A发送的数据，就通知TCP释放连接，此时发出FIN=1，确认号ack=u+1,序号seq=w,已经发送过的数据最后一个字节加1。确认为ACK=1. (FIN=1, ACK=1, seq=w, ack=u+1)</p><p><strong>第四次挥手</strong>：A客户机收到连接释放报文段后，必须向B发出确认。在确认报文段中，确认位ACK=1，序号seq=u+1,确认号ack=w+1. 此时连接还没有释放掉，必须经过时间等待计时器设置的时间2MSL(Max Segment Lifetime),后，客户机才进入连接关闭状态。 (ACK=1,seq=u+1,ack=w+1)</p><p>不使用二次握手？防止因为网络延迟，导致服务端响应客户端的多个请求，并为其建立多个连接，浪费服务器资源。</p><p>为什么四次挥手，主动方要等待２MSL后才关闭连接？ 保证TCP协议的全双工连接能够可靠关闭．</p><h2 id="2-9-TCP拥塞控制"><a href="#2-9-TCP拥塞控制" class="headerlink" title="2.9 TCP拥塞控制"></a>2.9 TCP拥塞控制</h2><p><strong>拥塞控制</strong> ：使用四种算法：慢开始，拥塞避免，快重传，快恢复。 TCP要求发送端维护两个窗口： 1） 接收窗口rwnd，接收方根据当前缓存大小所许诺的最新窗口值。 2) 拥塞窗口 cwnd ,发送方根据自己估算的网络拥塞程度而设置的窗口值。 发送窗口的上限是取这两者的最小值。</p><ul><li><strong>慢开始</strong>： TCP刚连接好时，先令拥塞窗口cwnd =1 ,在每次收到一个对新报文段的确认时将cwnd加倍（因此是成倍增长2的n次方). cwnd的大小呈指数增长。</li><li><strong>拥塞避免算法</strong>： 当cwnd大于等于慢开始门限ssthresh时，cwnd窗口每次加1而不是加倍。当发送方检测到<strong>超时事件</strong>的发生时，就将慢开始门限设置为当前cwnd的一半，同时将cwnd设置为1. 这样的目的是迅速减少主机发送到网络的分组数，使得发生拥塞的路由器有足够的时间吧队列中积压的分组处理完毕。 </li><li><strong>快重传</strong>：当发送方连续收到三个重复的ACK报文时，直接重传对方尚未收到的报文段，而不必等待那个报文段设置的重传计时器超时。 </li><li><strong>快恢复</strong>：当发送端收到连续三个冗余的ACK时，就执行“乘法减小”算法，把慢开始门限ssthresh减半，cwnd设置为慢开始门限减半后的数值（与慢开始不同）。</li></ul><p>T<strong>CP滑动窗口与回退N针协议</strong></p><p><strong>滑动窗口</strong>： 发送方都维持一组连续的允许发送的帧的序号称为发送窗口。同时接收方也维持一组连续的允许接收的帧序号，称为接收窗口。发送窗口是用来对发送方进行流量控制，接收窗口是用来控制接收那些数据帧不可以接收那些帧。 在发送端，收到一个确认帧，发送窗口就向前滑动一个帧位置，当发送窗口没有可以发送的帧时，发送方就停止发送。直到接收方发送的确认帧使发送窗口向前移动。 在接收端，只有收到数据帧的序号落在接收窗口内才将该帧收下，否则一律丢弃。每收到一个帧后就发送回确认帧。</p><p><strong>后退N帧协议</strong> :发送窗口大于1，接收窗口等于1.在后退N帧中，发送方不需要收到上一帧的ACK后才能发送下一帧，而是可以连续发送帧。当接收方检测出失序信息帧后，要求发送方重发最后一个正确接收的帧之后的所有未被确认的帧。源站每发完一帧就要为该帧设置超时计时器，如果在超时时间内没有收到确认帧则进行重发。服务端会采用累积确认的方式，不是每个帧都发确认，可以连续收到好几个正确帧后发回一个确认信息。接收方因为窗口为1，所以必须按序接收数据帧，如果某个序大于当前所期望的序号时就会连续发送3个ACK确认帧，要求客户端重传失序帧。</p><p><strong>TCP的可靠性</strong></p><p>TCP的可靠性是通过顺序编号和确认（ACK）来实现的。握手与断开都需要通讯双方确认，数据传输也需要双方确认成功，在协议中还规定了：分包、重组、重传等规则。</p><h2 id="2-10-HTTP"><a href="#2-10-HTTP" class="headerlink" title="2.10 HTTP"></a>2.10 HTTP</h2><p><strong>Http request类型</strong>：HTTP协议中共定义了八种方法或者叫“动作”来表明对Request-URI指定的资源的不同操作方式。GET， 向特定的资源发出请求。 POST：向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST请求可能会导致新的资源的创建和/或已有资源的修改。 PUT：向指定资源位置上传其最新内容。 DELETE：请求服务器删除Request-URI所标识的资源。 HEAD：请求读取由URL所标志的信息的首部。 OPTIONS：返回服务器针对特定资源所支持的HTTP请求方法。 TRACE：回显服务器收到的请求，主要用于测试或诊断。 CONNECT：HTTP/1.1协议中预留给能够将连接改为管道方式的代理服务器。</p><p><strong>Http1.1和Http1.0的区别</strong>： </p><ol><li>HTTP1.0 是短连接，HTTP1.1是长连接，在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟。一个包含有许多图像的网页文件的多个请求和应答可以在一个连接中传输。头部字段<code>Connection: keep-alive</code>。</li><li>HTTP 1.1中增加Host请求头字段后，实现了在IP端口上创建多个虚拟WEB站点。 </li><li>HTTP 1.1还提供了与身份认证、状态管理和Cache缓存等机制相关的请求头和响应头 </li><li>带宽优化。HTTP/1.1中在请求消息中引入了range头域，它允许只请求资源的某个部分。</li><li>HTTP/1.1增加了OPTIONS方法，它允许客户端获取一个服务器支持的方法列表。</li></ol><p><strong>Cookie与Session</strong>： </p><p>Cookie通过在客户端记录信息确定用户身份，Session通过在服务器端记录信息确定用户身份。</p><p>Cookie实际上是一小段的文本信息。客户端请求服务器，如果服务器需要记录该用户状态，就产生一个用户身份标识，然后在响应消息中将该标识号以Cookie的形式传递给浏览器.客户端浏览器会把Cookie保存起来。浏览器在以后每次访问该web服务器时，浏览器把请求的网址连同该Cookie一同提交给服务器。服务器检查该Cookie，以此来辨认用户状态。服务器还可以根据需要修改Cookie的内容. Cookie不能被浏览器共享 Cookie具有不可跨域名性，Cookie的maxAge决定着Cookie的有效期，单位为秒（Second） ，默认情况下用户退出浏览器后被删除。</p><p>Session是另一种记录客户状态的机制，保存在服务器上。客户端浏览器访问服务器的时候，服务器把客户端信息以某种形式记录在服务器上，为了提高存取速度，服务器一般把Session放在内存里，每个用户都会有一个独立的Session ID， session也存在过期时间,通过cookie会刷新session的访问。</p><p><strong>访问一个网页的过程</strong>，协议：DNS、HTTP、TCP、OSPF、IP、ARP</p><p>1 浏览器向DNS请求url的服务器IP地址, 2) 域名系统DNS解析出IP地址 3) 浏览器与该服务器建立TCP连接 4) 通过HTTP获取内容</p><p><strong>DNS域名解析协议</strong>，简单描述其工作原理。</p><p>域名解析是把域名映射成IP地址或者把IP地址映射成域名的过程。</p><p>域名解析有两种方式：递归查询和迭代查询。 递归查询时，DNS请求客户身份有变化，迭代查询时，请求客户一直是本地主机。</p><h2 id="2-11-各种协议"><a href="#2-11-各种协议" class="headerlink" title="2.11 各种协议"></a>2.11 各种协议</h2><p><strong>ICMP协议</strong>： 因特网控制报文协议。它是TCP/IP协议族的一个子协议，用于在IP主机、路由器之间传递控制消息。 </p><p><strong>NAT协议</strong>：内网地址转换协议，是一种将私有（保留）地址转化为合法IP地址的转换技术。</p><p><strong>DHCP协议</strong>：一个局域网的网络协议，使用UDP协议工作，用途：给内部网络或网络服务供应商自动分配IP地址，给用户或者内部网络管理员作为对所有计算机作中央管理的手段。</p><hr><h1 id="第三章-算法与数据结构"><a href="#第三章-算法与数据结构" class="headerlink" title="第三章 算法与数据结构"></a>第三章 算法与数据结构</h1><h2 id="3-0-知识点汇总"><a href="#3-0-知识点汇总" class="headerlink" title="3.0 知识点汇总"></a>3.0 知识点汇总</h2><ol><li>链表与数组。</li><li>队列和栈，出栈与入栈。</li><li>链表的删除、插入、反向。</li><li>字符串操作。</li><li>Hash表的hash函数，冲突解决方法有哪些。</li><li>各种排序：冒泡、选择、插入、希尔、归并、快排、堆排、桶排、基数的原理、平均时间复杂度、最坏时间复杂度、空间复杂度、是否稳定。</li><li>快排的partition函数与归并的Merge函数。</li><li>对冒泡与快排的改进。</li><li>二分查找</li><li>二叉树、B+树、AVL树、红黑树、哈夫曼树。</li><li>二叉树的前中后续遍历：递归与非递归写法，层序遍历算法。</li><li>图的BFS与DFS算法，最小生成树prim算法与最短路径Dijkstra算法。</li><li>KMP算法。</li><li>排列组合问题。</li><li>动态规划、贪心算法、分治算法。</li><li>大数据处理：类似10亿条数据找出最大的1000个数………等等</li></ol><h2 id="3-1-排序算法"><a href="#3-1-排序算法" class="headerlink" title="3.1 排序算法"></a>3.1 排序算法</h2><h3 id="1-直接插入排序"><a href="#1-直接插入排序" class="headerlink" title="1.直接插入排序"></a>1.直接插入排序</h3><p><strong>思想</strong>：每次将一个待排序的数据按照其关键字的大小插入到前面已经排序好的数据中的适当位置，直到全部数据排序完成。<strong>时间复杂度</strong>：O(n^2) O(n) O(n^2) （最坏 最好 平均） <strong>空间复杂度</strong>：O(1) <strong>稳定性</strong>： 稳定 每次都是在前面已排好序的序列中找到适当的位置，只有小的数字会往前插入，所以原来相同的两个数字在排序后相对位置不变。 <strong>代码</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * 插入排序</span></div><div class="line"><span class="comment"> * <span class="doctag">@param</span> array</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; array.length; i++ ) &#123;</div><div class="line">        <span class="keyword">int</span> val = array[i];</div><div class="line">        <span class="keyword">int</span> j = i -<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span> (j &gt;= <span class="number">0</span> &amp;&amp; array[j] &gt; val) &#123;  <span class="comment">// array[j] &gt; val</span></div><div class="line">            array[j+<span class="number">1</span>] = array[j];</div><div class="line">            j--;</div><div class="line">        &#125;</div><div class="line">        array[j+<span class="number">1</span>] = val; <span class="comment">//  array[j+1] 不是array[j]</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="2-希尔排序"><a href="#2-希尔排序" class="headerlink" title="2.希尔排序"></a>2.希尔排序</h3><p><strong>思想</strong>：希尔排序根据增量值对数据按下标进行分组，对每组使用直接插入排序算法排序；随着增量逐渐减少，每组包含的关键词越来越多，当增量减至1时，整体采用直接插入排序得到有序数组，算法终止。 <strong>时间复杂度</strong>：O(n2) O(n) O(n1.5) （最坏，最好，平均） <strong>空间复杂度</strong>：O(1) <strong>稳定性</strong>：不稳定 因为是分组进行直接插入排序，原来相同的两个数字可能会被分到不同的组去，可能会使得后面的数字会排到前面，使得两个相同的数字排序前后位置发生变化。 <strong>不稳定举例</strong>: 4 3 3 2 按2为增量分组，则第二个3会跑到前面 </p><p><strong>代码</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">shellSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> len;</div><div class="line">    len = array.length / <span class="number">2</span>; <span class="comment">// 分成n/2组</span></div><div class="line">    <span class="keyword">while</span> (len &gt;= <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; array.length; ++i) &#123; <span class="comment">//对每组进行直接插入排序</span></div><div class="line">            <span class="keyword">int</span> temp = array[i];</div><div class="line">            <span class="keyword">int</span> j = i - len;</div><div class="line">            <span class="keyword">while</span> (j &gt;= <span class="number">0</span> &amp;&amp; array[j] &gt; temp) &#123;</div><div class="line">                array[j + len] = array[j];</div><div class="line">                j -= len;</div><div class="line">            &#125;</div><div class="line">            array[j + len] = temp;</div><div class="line">        &#125;</div><div class="line">        len /= <span class="number">2</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>交换排序</strong></p><h3 id="3-冒泡排序"><a href="#3-冒泡排序" class="headerlink" title="3.冒泡排序"></a>3.冒泡排序</h3><p><strong>思想</strong>：对待排序元素的关键字从后往前进行多遍扫描，遇到相邻两个关键字次序与排序规则不符时，就将这两个元素进行交换。这样关键字较小的那个元素就像一个泡泡一样，从最后面冒到最前面来。 <strong>时间复杂度</strong>：最坏：O(n2) 最好: O(n) 平均: O(n2) <strong>空间复杂度</strong>：O(1) <strong>稳定性</strong>：稳定，相邻的关键字两两比较，如果相等则不交换。所以排序前后的相等数字相对位置不变。 </p><p><strong>代码</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</div><div class="line">    <span class="keyword">boolean</span> flag; <span class="comment">// 用来判断当前这一轮是否有交换数值,若没有则表示已经排好许了</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</div><div class="line">        flag = <span class="keyword">false</span>;</div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 这边要注意 for (int j = array.length -1; j &gt;= i + 1; j--)。 不要写成</span></div><div class="line"><span class="comment">         * for (int j =  i + 1; j &lt; array.length ; j++)</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = array.length -<span class="number">1</span>; j &gt;= i + <span class="number">1</span>; j--) &#123;</div><div class="line">            <span class="keyword">if</span> (array[j -<span class="number">1</span> ] &gt; array[j]) &#123;</div><div class="line">                <span class="comment">//数据交换</span></div><div class="line">                <span class="keyword">int</span> temp = array[j - <span class="number">1</span>];</div><div class="line">                array[j - <span class="number">1</span>] = array[j];</div><div class="line">                array[j] = temp;</div><div class="line">                <span class="comment">//设置标志位</span></div><div class="line">                flag = <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!flag) &#123;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="4-快速排序"><a href="#4-快速排序" class="headerlink" title="4.快速排序"></a>4.快速排序</h3><p><strong>思想</strong>：该算法是分治算法，首先选择一个基准元素,根据基准元素将待排序列分成两部分,一部分比基准元素小,一部分大于等于基准元素,此时基准元素在其排好序后的正确位置,然后再用同样的方法递归地排序划分的两部分。基准元素的选择对快速排序的性能影响很大，所有一般会想打乱排序数组选择第一个元素或则随机地从后面选择一个元素替换第一个元素作为基准元素。 <strong>时间复杂度</strong>：最坏:O(n2) 最好: O(nlogn) 平均: O(nlogn) <strong>空间复杂度</strong>：O(nlogn)用于方法栈 <strong>稳定性</strong>：不稳定 快排会将大于等于基准元素的关键词放在基准元素右边，加入数组 1 2 2 3 4 5 选择第二个2 作为基准元素，那么排序后 第一个2跑到了后面，相对位置发生变化。 </p><p><strong>代码</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</div><div class="line">    partition(array, <span class="number">0</span>, array.length - <span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>选择排序</strong></p><h3 id="5-直接选择排序"><a href="#5-直接选择排序" class="headerlink" title="5.直接选择排序"></a>5.直接选择排序</h3><p><strong>思想</strong>：首先在未排序序列中找到最小（大）元素，存放到排序序列的起始位置，然后每次从剩余未排序元素中继续寻找最小（大）元素放到已排序序列的末尾。以此类推，直到所有元素均排序完毕 <strong>时间复杂度</strong>：最坏:O(n^2) 最好: O(n^2) 平均: O(n^2) <strong>空间复杂度</strong>：O(1) <strong>稳定性</strong>：不稳定 例如数组 2 2 1 3 第一次选择的时候把第一个2与1交换使得两个2的相对次序发生了改变。</p><p><strong>代码</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">selectSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</div><div class="line">        <span class="keyword">int</span> minIdx = i;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; array.length; j++) &#123;</div><div class="line">            <span class="keyword">if</span> (array[j] &lt; array[minIdx]) &#123;</div><div class="line">                minIdx = j;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        exch(array, i, minIdx);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="6-堆排序"><a href="#6-堆排序" class="headerlink" title="6.堆排序"></a>6.堆排序</h3><p><strong>思想</strong>：堆排序是利用堆的性质进行的一种选择排序，先将排序元素构建一个最大堆,每次堆中取出最大的元素并调整堆。将该取出的最大元素放到已排好序的序列前面。这种方法相对选择排序，时间复杂度更低，效率更高。 <strong>时间复杂度</strong>：最坏:O(nlog2n) 最好: O(nlog2n) 平均: O(nlog2n) <strong>空间复杂度</strong>：O(1) <strong>稳定性</strong>：不稳定 例如 5 10 15 10。 如果堆顶5先输出，则第三层的10(最后一个10)的跑到堆顶，然后堆稳定，继续输出堆顶，则刚才那个10跑到前面了，所以两个10排序前后的次序发生改变。 </p><p><strong>代码</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 第一个元素没有利用</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">heapSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> N = array.length -<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = N / <span class="number">2</span>; k &gt;= <span class="number">1</span>; k--) &#123; <span class="comment">// k &gt;= 1</span></div><div class="line">        sink(array, k, N);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span> (N &gt; <span class="number">1</span>) &#123;</div><div class="line">        <span class="comment">// 最大堆, 选择最大值放在最后</span></div><div class="line">        exch(array, <span class="number">1</span>, N --);</div><div class="line">        sink(array, <span class="number">1</span>, N);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sink</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> k, <span class="keyword">int</span> N)</span></span>&#123;</div><div class="line">    <span class="keyword">while</span> (<span class="number">2</span> * k &lt;= N) &#123;</div><div class="line">        <span class="keyword">int</span> j = <span class="number">2</span> * k;</div><div class="line">        <span class="keyword">if</span> (j &lt; N &amp;&amp; array[j] &lt; array[j+<span class="number">1</span>]) &#123; <span class="comment">// &lt;</span></div><div class="line">            j++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (array[j] &lt; array[k]) <span class="keyword">break</span>;  <span class="comment">// &lt;</span></div><div class="line">        exch(array, k, j);</div><div class="line">        k = j;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="7-归并排序"><a href="#7-归并排序" class="headerlink" title="7.归并排序"></a>7.归并排序</h3><p><strong>思想</strong>：归并排序采用了分治算法，首先递归将原始数组划分为若干子数组，对每个子数组进行排序。然后将排好序的子数组递归合并成一个有序的数组。 <strong>时间复杂度</strong>：最坏:O(nlog2n) 最好: O(nlog2n) 平均: O(nlog2n) <strong>空间复杂度</strong>：O(n) <strong>稳定性</strong>：稳定 </p><p><strong>代码</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">mergeSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</div><div class="line">    sort(array, <span class="number">0</span>, array.length - <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (left &lt; right) &#123;</div><div class="line">        <span class="keyword">int</span> middle = (left + right) &gt;&gt; <span class="number">1</span>;</div><div class="line">        <span class="comment">//递归处理相关的合并事项</span></div><div class="line">        sort(array, left, middle);</div><div class="line">        sort(array, middle + <span class="number">1</span>, right);</div><div class="line">        merge(array, left, middle, right);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> lo, <span class="keyword">int</span> mid, <span class="keyword">int</span> hi)</span> </span>&#123;</div><div class="line">    <span class="comment">//创建一个临时数组用来存储合并后的数据</span></div><div class="line">    <span class="keyword">int</span>[] temp = <span class="keyword">new</span> <span class="keyword">int</span>[array.length];</div><div class="line">    <span class="keyword">int</span> left = lo;</div><div class="line">    <span class="keyword">int</span> right = mid + <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> k = lo;</div><div class="line">    <span class="keyword">while</span> (left &lt;= mid &amp;&amp; right &lt;= hi) &#123;</div><div class="line">        <span class="keyword">if</span> (array[left] &lt; array[right])</div><div class="line">            temp[k++] = array[left++];</div><div class="line">        <span class="keyword">else</span></div><div class="line">            temp[k++] = array[right++];</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//处理剩余未合并的部分</span></div><div class="line">    <span class="keyword">while</span> (left &lt;= mid)  temp[k++] = array[left++];</div><div class="line">    <span class="keyword">while</span> (right &lt;= hi)  temp[k++] = array[right++];</div><div class="line">    <span class="comment">//将临时数组中的内容存储到原数组中</span></div><div class="line">    <span class="keyword">while</span> (lo &lt;= hi) array[lo] = temp[lo++];</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="3-2-查找"><a href="#3-2-查找" class="headerlink" title="3.2 查找"></a>3.2 查找</h2><h3 id="1-顺序查找"><a href="#1-顺序查找" class="headerlink" title="1. 顺序查找"></a>1. 顺序查找</h3><p><strong>思路</strong>：这是最简单的算法，从头开始遍历每个元素，并将每个元素与查找元素比较，如果一致则返回。 <strong>时间复杂度</strong>: O(N) <strong>空间复杂度</strong>: O(1) </p><p><strong>代码</strong>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> num)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(array == <span class="keyword">null</span> || array.length == <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (array[i] == num) &#123;</div><div class="line">            <span class="keyword">return</span> i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="2-二分查找"><a href="#2-二分查找" class="headerlink" title="2. 二分查找"></a>2. 二分查找</h3><p><strong>思路</strong>：二分查找前提是查找的数组是有序的，利用数据有序的特性提高查找性能。首先与数组中间位置的值比较，如果查找值大于中间位置值，则对数组右边以相同的思路查找，否则在左边以相同方式查找。这种方式使得每次查找范围变为原来的1/2. <strong>时间复杂度</strong>: O(log2n) <strong>空间复杂度</strong>: O(1)</p><p><strong>代码：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">halfSearch</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> num)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(array == <span class="keyword">null</span> || array.length == <span class="number">0</span>) &#123;</div><div class="line">         <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> lo = <span class="number">0</span>, hi = array.length-<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>(lo &lt;= hi) &#123;</div><div class="line">        <span class="keyword">int</span> mid = (lo + hi) &gt;&gt; <span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span> (array[mid] == num) &#123;</div><div class="line">            <span class="keyword">return</span> mid;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (array[mid] &lt; num) &#123;</div><div class="line">            hi = mid -<span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            lo = mid + <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="3-hash-算法"><a href="#3-hash-算法" class="headerlink" title="3. hash 算法"></a>3. hash 算法</h3><p><strong>思想</strong>：哈希表是根据设定的<strong>哈希函数H(key)</strong>和<strong>处理冲突方法</strong>将一组关键字映射到一个有限的地址区间上，并将关键字对应的值存储在该地址空间，可以通过关键字快速获取对应的值，这种表称为哈希表或散列，所得存储位置称为哈希地址或散列地址。作为线性数据结构与表格和队列等相比，哈希表无疑是查找速度比较快的一种。 <strong>查找复杂度:</strong> O(1) </p><p><strong>哈希函数寻址</strong>：</p><ol><li><strong>直接寻址法</strong>：取关键字或关键字的某个线性函数值为散列地址。即H(key)=key或H(key) = a?key + b，其中a和b为常数（这种散列函数叫做自身函数）</li><li><strong>数字分析法</strong>：因此数字分析法就是找出数字的规律，尽可能利用这些数据来构造冲突几率较低的散列地址。比如一组员工的出生年月日，这时我们发现出生年月日的前几位数字大体相同，这样的话，出现冲突的几率就会很大，但是我们发现年月日的后几位表示月份和具体日期的数字差别很大，如果用后面的数字来构成散列地址，则冲突的几率会明显降低。</li><li><strong>平方取中法</strong>：取关键字平方后的中间几位作为散列地址</li><li><strong>折叠法</strong>：将关键字分割成位数相同的几部分，最后一部分位数可以不同，然后取这几部分的叠加和（去除进位）作为散列地址。</li><li><strong>除留余数法</strong>：取关键字被某个不大于散列表表长m的数p除后所得的余数为散列地址。即 H(key) = key MOD p, p&lt;=m。不仅可以对关键字直接取模，也可在折叠、平方取中等运算之后取模。对p的选择很重要，一般取素数或m，若p选的不好，容易产生同义词。</li></ol><p><strong>hash冲突及解决</strong> ：</p><p>hash冲突在所难免，解决冲突是一个复杂问题。冲突主要取决于： （1）与散列函数有关，一个好的散列函数的值应尽可能平均分布。 （2）与解决冲突的哈希冲突函数有关。 （3）与负载因子的大小。太大不一定就好，而且浪费空间严重，负载因子和散列函数是联动的。 解决冲突的办法： （1）<strong>开放定址法</strong>：线性探查法、平方探查法、伪随机序列法、双哈希函数法。 （2) <strong>链地址法</strong>：把所有同义词，即hash值相同的记录，用单链表连接起来。</p><p><strong>应用：</strong> 1.字符串哈希 2.加密哈希 3.几何哈希 4.布隆过滤器</p><p><strong>不足：</strong>获取有序序列复杂度高</p><h3 id="4-二叉树搜索树"><a href="#4-二叉树搜索树" class="headerlink" title="4. 二叉树搜索树"></a>4. 二叉树搜索树</h3><p><strong>思想</strong> ：</p><p>二叉查找树（Binary Search Tree），也称有序二叉树（ordered binary tree）,排序二叉树（sorted binary tree），是指一棵空树或者具有下列性质的二叉树： 1.若任意节点的左子树不空，则左子树上所有结点的值均小于它的根结点的值； 2.若任意节点的右子树不空，则右子树上所有结点的值均大于它的根结点的值； 3.任意节点的左、右子树也分别为二叉查找树。 4.没有键值相等的节点（no duplicate nodes）。 复杂度: 插入和查找的时间复杂度均为O(logN), 最坏为O(N)</p><p><strong>插入</strong> :</p><ol><li><p>如果当前结点是null，则创建新结点返回。</p></li><li><p>如果插入结点比当前结点值大，则插入其右孩子结点中。</p></li><li><p>如果插入结点比当前结点值小，则插入其左孩子结点中。 <strong>复杂度</strong>: 平均 O(logn) 最坏O(n) <strong>代码:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> Tree <span class="title">insert</span><span class="params">(Tree root, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Tree(val);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (val == root.val) &#123;</div><div class="line">        <span class="keyword">return</span> root;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (val &gt; root.val) &#123;</div><div class="line">        root.right = insert(root.right, val);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        root.left = insert(root.left, val);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> root;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ol><p><strong>查找</strong> :</p><p>类似于二分查找，小于当前值，则去左子树查找，大于当前节点值，则去右子树查找。 <strong>时间复杂度</strong>: 平均O(logn) 最坏O(n)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> Tree <span class="title">search</span><span class="params">(Tree root, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line"><span class="keyword">if</span>(root == <span class="keyword">null</span>) &#123;</div><div class="line">     <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line"> &#125;</div><div class="line"> <span class="keyword">if</span>(root.val == val) &#123;</div><div class="line">    <span class="keyword">return</span> root;</div><div class="line"> &#125; <span class="keyword">else</span> <span class="keyword">if</span>(root.val &gt; val) &#123;</div><div class="line">     <span class="keyword">return</span> search(root.left, val);</div><div class="line"> &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> search(root.right, val);</div><div class="line"> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>查找最小值、最大值</strong> ：</p><p>根据二叉搜索树的特点，最小结点都是在最左结点上，或无左子树的根节点。最大值为最右节点或根。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> Tree <span class="title">min</span><span class="params">(Tree root)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(root == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (root.left != <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> min(root.left);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> root;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Tree <span class="title">max</span><span class="params">(Tree root)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(root == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (root.right != <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> max(root.right);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> root;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>删除</strong> ：</p><ol><li><p>删除最小结点</p><p>找到根结点最左结点，如果其不存在右孩子则直接删除，否则用右孩子替换最左结点。需要考虑根结点为null和根为最小值的情况。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> Tree <span class="title">deleteMin</span><span class="params">(Tree root)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(root == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(root.left != <span class="keyword">null</span>) &#123;</div><div class="line">        root.left = deleteMin(root.left);</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (root.right != <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> root.right;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>删除最大结点</p><p>找到最右孩子结点，其存在左结点的话就用左结点替换否则直接删除.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> Tree <span class="title">deleteMax</span><span class="params">(Tree root)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(root == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(root.right != <span class="keyword">null</span>) &#123;</div><div class="line">        root.right = deleteMax(root.right);</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(root.left != <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> root.left;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>删除某个结点</p><p>首先通过查找方法找到该节点，然后删除策略：</p><ul><li><p>如果该节点无左右子树，直接删除</p></li><li><p>如果只存在一个子树，用孩子结点替换该节点。</p></li><li><p>如果存在两个子树，那么可以用左子树中最大的结点或右子树中最小结点替换，并删除子树中的节点.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">public</span> Tree <span class="title">delete</span><span class="params">(Tree root, <span class="keyword">int</span> val)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(root == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(root.val == val) &#123;</div><div class="line">        <span class="keyword">if</span>(root.left == <span class="keyword">null</span> &amp;&amp; root.right == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(root.left!= <span class="keyword">null</span> &amp;&amp; root.right != <span class="keyword">null</span>) &#123;</div><div class="line">            Tree leftBig = max(root.left);</div><div class="line">            root.val = leftBig.val;</div><div class="line">            root.left = delete(root.left, leftBig.val);</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(root.left != <span class="keyword">null</span>)&#123;</div><div class="line">            <span class="keyword">return</span> root.left;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> root.right;</div><div class="line">        &#125;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(root.val &lt; val) &#123;</div><div class="line">        root.right = delete(root.right, val);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        root.left = delete(root.left, val);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> root;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ul></li></ol><h3 id="5-AVL查找树"><a href="#5-AVL查找树" class="headerlink" title="5. AVL查找树"></a>5. AVL查找树</h3><p>6.1 思想</p><p>二叉树查找树在插入时没有对二叉树的深度和结构做一个调整，使得叶子结点深度不一，在查找时深度越深的结点时间复杂度越高。为了改进查找的时间时间复杂度，于是出现了平衡二叉树(AVL).<strong>平衡二叉树使得每个结点的左结点和右结点的深度差不超过1.</strong></p><p>6.2 查找</p><p>查找与二叉查找树一样。</p><p>6.3 插入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">当在AVL中插入新的结点时，需要根据实际情况对AVL中的某些结点做单旋转或双旋转操作，单旋转表示做一次顺时针或逆时针的旋转操作，而双旋转则做两次单旋转操作（先顺时针后逆时针，或者先逆时针后顺时针），单旋转发生在LL型插入和RR型插入，而双旋转则发生在LR型插入和RL型插入。以下的失去平衡点都指的是离插入点最近的那个失去平衡的结点。</div></pre></td></tr></table></figure><p>LL型：插入点位于失去平衡点的左孩子的左子树上； RR型：插入点位于失去平衡点的右孩子的右子树上； LR型：插入点位于失去平衡点的左孩子的右子树上； RR型：插入点位于失去平衡点的右孩子的左子树上。</p><p><strong>插入思路</strong> 和二叉搜索树的插入一样，首先在树中找到对应的位置然后插入，接着自底向上向根节点折回，于在插入期间成为不平衡的所有节点上进行旋转来完成。因为折回到根节点的路途上最多有 1.5 乘 log n 个节点，而每次AVL 旋转都耗费恒定的时间，插入处理在整体上耗费 O(log n) 时间。　 具体插入过程如下:</p><ol><li>如果当前结点为空，创建新结点返回.</li><li>如果当前结点值和插入值相同，不做处理返回。</li><li>如果插入值大于当前结点则插入到右其右孩子结点中。插入完成后比较左右孩子结点进行判断树是否失去平衡。如果是判断属于那种类型(RR, RL),并响应的旋转。最后更新当前结点的深度(孩子结点的最大深度加1，默认null深度为-1)。</li><li>否则插入到其做孩子上。 同样比较左右孩子的深度判断是否平衡，对于失去平衡的情况下做出调整。</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">private AvlNode&lt;AnyType&gt; insert(AnyType x, AvlNode&lt;AnyType&gt; t) &#123;</div><div class="line">    if (t == null)</div><div class="line">        return new AvlNode&lt;AnyType&gt;(x, null, null);</div><div class="line">    int compareResult = myCompare(x, t.element);</div><div class="line">    if (compareResult &lt; 0) &#123;</div><div class="line">        t.left = insert(x, t.left);</div><div class="line">        if (height(t.left) - height(t.right) == 2) &#123;</div><div class="line">            if (myCompare(x, t.left.element) &lt; 0)     //左左情况</div><div class="line">                t = rotateWithLeftChild(t);</div><div class="line">            else                                    //左右情况</div><div class="line">                t = doubleWithLeftChild(t);</div><div class="line">        &#125;</div><div class="line">    &#125; else if (compareResult &gt; 0) &#123;</div><div class="line">        t.right = insert(x, t.right);</div><div class="line">        if (height(t.right) - height(t.left) == 2) &#123;</div><div class="line">            if (myCompare(x, t.right.element) &lt; 0)        //右左情况</div><div class="line">                t = doubleWithRightChild(t);</div><div class="line">            else                                        //右右情况</div><div class="line">                t = rotateWithRightChild(t);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    //完了之后更新height值</div><div class="line">    t.height = Math.max(height(t.left), height(t.right)) + 1;</div><div class="line">    return t;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>6.4 删除</p><p>从AVL树中删除可以通过把要删除的节点向下旋转成一个叶子节点，接着直接剪除这个叶子节点来完成。因为在旋转成叶子节点期间最多有 log n个节点被旋转，而每次 AVL 旋转耗费恒定的时间，删除处理在整体上耗费 O(log n) 时间。 a.当被删除节点n是叶子节点，直接删除 b.当被删除节点n只有一个孩子，删除n，用孩子替代该节点的位置 c.当被删除结点n存在左右孩子时，真正的删除点应该是n的中序遍在前驱，或者说是左子树最大的节点，之后n的值替换为真正删除点的值。这就把c归结为a，b的问题。</p><p>从删除的结点处自低向上向根结点折回，根据当前结点的左右孩子深度判断是否平衡，如果不平衡则按选择规则进行旋转。最后更新当前结点深度，如此递归折回到根结点。</p><h3 id="6-B-树（B树）"><a href="#6-B-树（B树）" class="headerlink" title="6. B-树（B树）"></a>6. B-树（B树）</h3><p>7.1 定义</p><p>B-树是一种平衡的多路查找树，它在文件系统中很有用。 定义：一棵m 阶的B-树，或者为空树，或为满足下列特性的m 叉树： ⑴树中每个结点至多有m 棵子树； ⑵若根结点不是叶子结点，则至少有两棵子树； ⑶除根结点之外的所有非终端结点至少有⎡m/2⎤ 棵子树； ⑷所有的非终端结点中包含以下信息数据：（n，A0，K1，A1，K2，…，Kn，An） 其中：Ki（i=1,2,…,n）为关键码，且Ki&lt; Ki+1，Ai 为指向子树根结点的指针(i=0,1,…,n)，且指针Ai-1 所指子树中所有结点的关键码均小于Ki (i=1,2,…,n)，An 所指子树中所有结点的关键码均大于Kn， ⎡m/2⎤ −1 ≤ n ≤m −1 ，n 为关键码的个数。 ⑸所有的叶子结点都出现在同一层次上，并且不带信息（可以看作是外部结点或查找失败的结点，实际上这些结点不存在，指向这些结点的指针为空</p><p>7.2 查找</p><p>B-树的查找是由两个基本操作交叉进行的过程，即 ⑴在B-树上找结点； ⑵在结点中找关键码。 由于，通常B-树是存储在外存上的，操作⑴就是通过指针在磁盘相对定位，将结点信息读入内存，之后，再对结点中的关键码有序表进行顺序查找或折半查找。因为，在磁盘上读取结点信息比在内存中进行关键码查找耗时多，每次向下搜索一层都需要从内存中加载磁盘信息，B-树的层次树是决定B-树查找效率的首要因素。</p><p>7.2 插入</p><p>1.插入 在B-树上插入关键码与在二叉排序树上插入结点不同，关键码的插入不是在叶结点上 进行的，而是在最底层的某个非终端结点中添加一个关键码，若该结点上关键码个数不超过m-1 个，则可直接插入到该结点上；否则，该结点上关键码个数至少达到m 个，因而使该结点的子树超过了m棵，这与B-树定义不符。所以要进行调整，即结点的“分裂”。方法为：关键码加入结点后，将结点中的关键码分成三部分，使得前后两部分关键码个数个结点将其插入到父结点中。若插入父结点而使父结点中关键码个数超过m-1，则父结点继续分裂，直到插入某个父结点，其关键码个数小于m。可见，B-树是从底向上生长的。</p><p>7.3 删除</p><p>分两种情况： (1)删除最底层结点中关键码 a)若结点中关键码个数大于⎡m / 2⎤ -1，直接删去。 b)否则除余项与左兄弟(无左兄弟，则找左兄弟)项数之和大于等于2( -1) 就与它 们父结点中的有关项一起重新分配 (2)删除为非底层结点中关键码 若所删除关键码非底层结点中的Ki，则可以指针Ai 所指子树中的最小关键码X 替代 Ki，然后，再删除关键码X，直到这个X 在最底层结点上，即转为(1)的情形</p><p>7.2 B-树的特性：</p><p>1.关键字集合分布在整颗树中； 2.任何一个关键字出现且只出现在一个结点中； 3.搜索有可能在非叶子结点结束； 4.其搜索性能等价于在关键字全集内做一次二分查找； 5.自动层次控制；</p><p><a href="http://c.biancheng.net/cpp/html/1028.html" target="_blank" rel="external">http://c.biancheng.net/cpp/html/1028.html</a></p><h3 id="7-B-树"><a href="#7-B-树" class="headerlink" title="7. B+树"></a>7. B+树</h3><p>8.1 定义</p><p>⑴有n 棵子树的结点中含有n 个关键码； ⑵所有的叶子结点中包含了全部关键码的信息，及指向含有这些关键码记录的指针，且 叶子结点本身依关键码的大小自小而大的顺序链接。 ⑶所有的非终端结点可以看成是索引部分，结点中仅含有其子树根结点中最大（或最小）关键码。</p><p>8.2 B+的特性</p><p>1.所有关键字都出现在叶子结点的链表中（稠密索引），且链表中的关键字恰好是有序的； 2.不可能在非叶子结点命中； 3.非叶子结点相当于是叶子结点的索引（稀疏索引），叶子结点相当于是存储（关键字）数据的数据层； 4.更适合文件索引系统；</p><p>8.3 操作</p><p>1)查找操作 对B+树可以进行两种查找运算： a.从最小关键字起顺序查找； b.从根结点开始，进行随机查找。 在查找时，若非终端结点上的剧组机等于给定值，并不终止，而是继续向下直到叶子结点。因此，在B+树中，不管查找成功与否，每次查找都是走了一条从根到叶子结点的路径。其余同B-树的查找类似。 2).插入操作 B+树的插入与B树的插入过程类似。不同的是B+树在叶结点上进行，如果叶结点中的关键码个数超过m，就必须分裂成关键码数目大致相同的两个结点，并保证上层结点中有这两个结点的最大关键码。(算法见百度百科) 3)删除操作 B+树的删除也仅在叶子结点进行，当叶子结点中的最大关键字被删除时，其在非终端结点中的值可以作为一个“分界关键字”存在。若因删除而使结点中关键字的个数少于m/2 （m/2结果取上界，如5/2结果为3）时，其和兄弟结点的合并过程亦和B-树类似。</p><p> B+树和B-树最大的不同点：</p><p>1).B-树的关键字和记录是放在一起的，叶子节点可以看作外部节点，不包含任何信息；B+树的非叶子节点中只有关键字和指向下一个节点的索引，记录只放在叶子节点中。</p><p>2).在B-树中，越靠近根节点的记录查找时间越快，只要找到关键字即可确定记录的存在；而B+树中每个记录的查找时间基本是一样的，都需要从根节点走到叶子节点，而且在叶子节点中还要再比较关键字。从这个角度看B-树的性能好像要比B+树好，而在实际应用中却是B+树的性能要好些。因为B+树的非叶子节点不存放实际的数据，这样每个节点可容纳的元素个数比B-树多，树高比B-树小，这样带来的好处是减少磁盘访问次数。尽管B+树找到一个记录所需的比较次数要比B-树多，但是一次磁盘访问的时间相当于成百上千次内存比较的时间，因此实际中B+树的性能可能还会好些，而且B+树的叶子节点使用指针连接在一起，方便顺序遍历(例如查看一个目录下的所有文件，一个表中的所有记录等)，这也是很多数据库和文件系统使用B+树的缘故。 3）B+树支持range-query非常方便，而B树不支持。这是数据库选用B+树的最主要原因<a href="http://www.cnblogs.com/biyeymyhjob/archive/2012/07/25/2608880.html" target="_blank" rel="external">http://www.cnblogs.com/biyeymyhjob/archive/2012/07/25/2608880.html</a><a href="http://blog.csdn.net/v_JULY_v/article/details/6530142/" target="_blank" rel="external">http://blog.csdn.net/v_JULY_v/article/details/6530142/</a></p><h3 id="8-红黑树"><a href="#8-红黑树" class="headerlink" title="8 . 红黑树"></a>8 . 红黑树</h3><p>思想</p><p>红黑树，一种二叉查找树，但在每个结点上增加一个存储位表示结点的颜色，可以是Red或Black。通过对任何一条从根到叶子的路径上各个结点着色方式的限制，红黑树确保没有一条路径会比其他路径长出俩倍，因而是接近平衡的。</p><p>特性</p><p>性质1. 节点是红色或黑色。 性质2. 根是黑色。 性质3. 所有叶子都是黑色（叶子是NIL节点）。 性质4. 每个红色节点的两个子节点都是黑色。(从每个叶子到根的所有路径上不能有两个连续的红色节点) 性质5. 从任一节点到其每个叶子的所有简单路径 都包含相同数目的黑色节点。</p><p>插入</p><p>II、红黑树插入的几种情况： 情况1，z的叔叔y是红色的。 情况2：z的叔叔y是黑色的，且z是右孩子 情况3：z的叔叔y是黑色的，且z是左孩子</p><p>删除</p><p>III、红黑树删除的几种情况。 情况1：x的兄弟w是红色的。 情况2：x的兄弟w是黑色的，且w的俩个孩子都是黑色的。 情况3：x的兄弟w是黑色的，且w的左孩子是红色，w的右孩子是黑色。 情况4：x的兄弟w是黑色的，且w的右孩子是红色的。</p><p><a href="http://www.cnblogs.com/daoluanxiaozi/p/3340382.html" target="_blank" rel="external">http://www.cnblogs.com/daoluanxiaozi/p/3340382.html</a></p><p>红黑树和AVL树的比较：</p><p>红黑树： (1)并不追求“完全平衡”——它只要求部分地达到平衡要求，降低了对旋转的要求，从而提高了性能。红黑树能够以O(log2 n) 的时间复杂度进行搜索、插入、删除操作。 (2)此外，由于它的设计，任何不平衡都会在三次旋转之内解决。红黑树能够给我们一个比较“便宜”的解决方案。红黑树的算法时间复杂度和AVL相同，但统计性能比AVL树更高。 AVL树： (1)它的左子树和右子树都是AVL树，左子树和右子树的高度差不能超过; (2) 查找、插入和删除在平均和最坏情况下都是O(log n),增加和删除可能需要通过一次或多次树旋转来重新平衡这个树; (3)一棵n个结点的AVL树的其高度保持在0(log2(n)),不会超过3/2log2(n+1) 一棵n个结点的AVL树的平均搜索长度保持在0(log2(n)). 一棵n个结点的AVL树删除一个结点做平衡化旋转所需要的时间为0(log2(n)).</p><h3 id="9-哈夫曼树"><a href="#9-哈夫曼树" class="headerlink" title="9.  哈夫曼树"></a>9.  哈夫曼树</h3><h2 id="3-3-字符串"><a href="#3-3-字符串" class="headerlink" title="3.3 字符串"></a>3.3 字符串</h2><h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><blockquote><p>键索引计数法：</p><ul><li>频率统计：使用int数组count[]计算每个建出现的频率</li><li>将频率转化为索引：使用count来计算每个键在排序结果中的起始索引位置</li><li>数据分类：将所有元素转移到一个辅助数组aux中以进行排序。</li><li>回写：将元素排序后的结果复制回原数组。</li></ul></blockquote><p>低优先字符排序</p><p><strong>思路</strong>：从右到左以每个位置的字符为键，用键索引计数法将字符串排序W遍（字符串长度） <strong>复杂度</strong>: O(NW) W为字符串长度，N为元素选择空间 实现：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">public static void sort(String[] a, int w) &#123;</div><div class="line">    // 通过前w个字符将a[] 排序</div><div class="line">    int N = a.length;</div><div class="line">    int R = 256;</div><div class="line">    String[] aux = new String[N];</div><div class="line">    for (int d = w - 1; d &gt;= 0; d--) &#123;</div><div class="line">        int[] count = new int[R + 1];</div><div class="line">        // 计算出频率</div><div class="line">        for (int i = 0; i &lt; N; i++) &#123;</div><div class="line">            count[a[i].charAt(d) + 1]++;</div><div class="line">        &#125;</div><div class="line">        // 将频率转换为索引</div><div class="line">        for (int r = 0; r &lt; R; r++) &#123;</div><div class="line">            count[r + 1] += count[r];</div><div class="line">        &#125;</div><div class="line">        // 将元素分类</div><div class="line">        for (int i = 0; i &lt; N; i++ ) &#123;</div><div class="line">            aux[count[a[i].charAt(d)] ++] =  a[i];</div><div class="line">        &#125;</div><div class="line">        for (int i = 0; i &lt; N; i ++ ) &#123;</div><div class="line">            a[i] = aux[i];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>高位优先字符串排序</p><p><strong>思路</strong>：解决字符串长度不一致的情况，采用从左到右的次序进行排序。 在高位优先排序时需要注意的字符串末尾的情况，因为字符串长度不一，合理的做法是将所有字符都已被检查的字符串所在的子数组排在所有子数组的前面，这样不需要对这些检查完成的字符串再次递归排序，也避免了IndexOutOfBound。 高位优先排序在已排号序的位置，根据字符进行分组，将数组分为更小的数组进行排序，利用了分治算法提高了算法的性能。 <strong>复杂度</strong>:O(N) 到O(Nw)之间 实现：</p><p><strong>三向字符串快速排序</strong> <strong>思路</strong>:结合了快速排序和高位优先字符串排序算法，采用高位优先字符串排序算法的思路，根据字符串从左到右的字符对字符串进行排序。排序时使用快速排序的思想，使用首字符进行三向切分为首字母小余、等于，大于切分字符的字符串数组，然后递归地将得到的三个字数组排序： <strong>优势</strong>：高位优先字符串排序算法会产生大量的子数组，而三向字符串快速排序切分总只有三个。因此该算法能够很好处理等值键、有较长公告前缀的键、取值范围娇小的键和小数组。 相对于高位优先字符串排序需要的空间更少。 复杂度： <strong>实现：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">public static void sort(String[] strArr) &#123;</div><div class="line">    sort(strArr, 0, strArr.length - 1, 0);</div><div class="line">&#125;</div><div class="line"></div><div class="line">/**</div><div class="line"> * 对字符串串数组strArr的 strArr[lo]到strArr[hi]的字符串根据d为的字符进行排序</div><div class="line"> * @param strArr</div><div class="line"> * @param lo</div><div class="line"> * @param hi</div><div class="line"> * @param d</div><div class="line"> */</div><div class="line">private static void sort(String[] strArr, int lo, int hi , int d) &#123;</div><div class="line">    if (hi &lt;= lo) &#123;</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    int lt = lo, gt = hi;</div><div class="line">    int val = strArr[lo].charAt(d);</div><div class="line">    int i = lo + 1;</div><div class="line">    while(i &lt;= gt) &#123;</div><div class="line">        int tmp = strArr[i].charAt(d);</div><div class="line">        if ( tmp &lt; val) &#123;</div><div class="line">            exch(strArr, lt++, i++);</div><div class="line">        &#125; else if( tmp &gt; val) &#123;</div><div class="line">            exch(strArr, i, gt--);</div><div class="line">        &#125; else &#123;</div><div class="line">            i ++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    sort(strArr, lo, lt-1, d);</div><div class="line">    if (val &gt;= 0 )  &#123;</div><div class="line">        sort(strArr, lt, gt, d+1);</div><div class="line">    &#125;</div><div class="line">    sort(strArr, gt+1, hi, d);</div><div class="line">&#125;</div><div class="line">private static void exch(String[] a, int i ,int j) &#123;</div><div class="line">    String tmp = a[i];</div><div class="line">    a[i] = a[j];</div><div class="line">    a[j] = tmp;</div><div class="line">&#125;</div></pre></td></tr></table></figure><blockquote><p>注意：和快速排序一样，最好在排序之前将数组打乱或将第一个元素和一个随机位置的元素交换以得到一个随机的切分元素，避免快速排序算法接近最坏情况</p></blockquote><p>总结：</p><table><thead><tr><th>算法</th><th>稳定性</th><th>原地排序</th><th>时间复杂度</th><th>空间复杂度</th><th>优势领域</th></tr></thead><tbody><tr><td>字符串的插入排序</td><td>是</td><td>是</td><td>N到N2之间</td><td>1</td><td>小数组或已经有序的数组</td></tr><tr><td>快速排序</td><td>否</td><td>是</td><td>N(log2N)</td><td>logN</td><td>通用排序算法，特别适合空间不足的情况</td></tr><tr><td>归并排序</td><td>是</td><td>否</td><td>N(log2N)</td><td>N</td><td>稳定的通用排序算法</td></tr><tr><td>三向快速排序</td><td>否</td><td>是</td><td>N到NlogN之间</td><td>logN</td><td>大量重复建</td></tr><tr><td>低位优先的字符串排序</td><td>是</td><td>否</td><td>NW</td><td>N</td><td>较长的定长字符串</td></tr><tr><td>高位优先的字符串排序</td><td>是</td><td>否</td><td>N到Nw之间</td><td>N+WR</td><td>随机字符串</td></tr><tr><td>三向字符串快速排序</td><td>否</td><td>是</td><td>N到Nw之间</td><td>W+logN</td><td>通用排序算法，特别适合用于含有较长公共前缀的字符串</td></tr></tbody></table><h3 id="查找树"><a href="#查找树" class="headerlink" title="查找树"></a>查找树</h3><ul><li><p>单词查找树（trie）</p><p>基本性质： 是由连接结点组成的数据结构，除了根结点，每个结点有且只有一条从父结点指向它的链接。每条链接都对应着一个字符，也可以用链接所对应的字符标记被指向的结点。值为空的结点在符号表中没有对应的键，它们的存在是为了简化单词查找树的查找操作。 查找过程：从根结点开始，首先经过的键是首字母所对应的链接。在下一个结点中沿着第二个字符所对应的链接继续前进。依此类推，直到键的最后一个字符所指向的结点或者遇到一条空链接。此时有三种情况：</p><ul><li><p>键的尾字符所对应的结点中的值非空，这是一次命中查找，则返回尾字符所对应的结点中保存的值。</p></li><li><p>键的尾字符所对应的结点中的值为空，表示未命中。</p></li><li><p>查找结束于一条空链接，表示未命中。</p><p>插入过程：进行插入的时候和二叉查找树一样，需要先进行查找，会遇到以下两个情况：</p></li><li><p>到达键尾部之前就遇到空链接，则创建对应的结点并将键值保存到最后一个字符的结点中。</p></li><li><p>在遇到空链接之前就到达了键的尾字符，在这种情况下，和关联性数组一样，将该结点的值设置为键所对应的值。</p><p>删除过程：首先找到对应的结点并将它的值设置为空，如果该结点含有一个非空的链接指向某个子结点那么就不需要进行其他操作。如果它所有链接均为空，那么就需要从数据结构中删去这个结点，如果删去它使得它的父节点的所有链接也均为空，就需要继续删除它的父结点，依此类推。 性质：</p></li><li><p>单词查找树的链表结构和键的插入或删除顺序无关：对于给定任意一组键，其单词查找树都是唯一的。</p></li><li><p>在单词查找树中查找一个键或插入一个键时，访问数组的次数最多的键的长度加1.</p></li><li><p>未命中查找平均所需检查的结点的数量为 logRN</p></li><li><p>一棵单词查找树的链接总数在RN到RNw之间，其中w为建的平均长度。 ？？？</p><p>应用：</p></li><li><p>数字帐号</p></li><li><p>URL</p></li><li><p>文本处理</p></li><li><p>基因组数据中的蛋白质</p><p>代码实现：</p></li></ul></li><li><p>三向单词查找树</p><p>思想：为了避免R向单词查找树过度的浪费空间，三向单词查找树每个结点都含有一个字符、三条链接和一个值。这三条链接分别对应着当前字母小于、等于和大于结点字母的所有键。 查找：查找时比较键的首字母和根结点的字母，如果键的首字母较小，就选择左链接。如果较大，就选择右链接；如果相等，则选择中链接。然后递归的使用相同的算法，如果遇到一个空链接或则当前键结束时结点的值为空，那么查找未命中;如果键结束时结点的值非空则查找命中。 优势：节省大量空间。 性质：</p><ul><li><p>每个结点只有三个链接，链接总数在3N到3Nw之间</p></li><li><p>平均查找时间复杂度为lnN 次</p><p>代码实现：</p></li></ul></li></ul><h3 id="子字符串查找"><a href="#子字符串查找" class="headerlink" title="子字符串查找"></a>子字符串查找</h3><ul><li><p>暴力字符串查找算法</p></li><li><p>KMP算法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">思想：KMP算法的想法是，设法利用这个已知信息，不要把&quot;搜索位置&quot;移回已经比较过的位置，只要继续把它向后移和移动匹配词就可以，这样就提高了效率。可以针对搜索词，算出一张部分匹配表。通过查表查到最后一个匹配字符对应的部分匹配值，并利用以下公式计算匹配词向后移动的位数：</div><div class="line">    移动位数 = 已匹配的字符数 - 对应的部分匹配值</div><div class="line"></div><div class="line">&quot;部分匹配值&quot;就是&quot;前缀&quot;和&quot;后缀&quot;的最长的共有元素的长度。以&quot;ABCDABD&quot;为例，</div></pre></td></tr></table></figure><ul><li>“A”的前缀和后缀都为空集，共有元素的长度为0；</li><li>“AB”的前缀为[A]，后缀为[B]，共有元素的长度为0；</li><li>“ABC”的前缀为[A, AB]，后缀为[BC, C]，共有元素的长度0；</li><li>“ABCD”的前缀为[A, AB, ABC]，后缀为[BCD, CD, D]，共有元素的长度为0；</li><li>“ABCDA”的前缀为[A, AB, ABC, ABCD]，后缀为[BCDA, CDA, DA, A]，共有元素为”A”，长度为1；</li><li>“ABCDAB”的前缀为[A, AB, ABC, ABCD, ABCDA]，后缀为[BCDAB, CDAB, DAB, AB, B]，共有元素为”AB”，长度为2；</li><li>“ABCDABD”的前缀为[A, AB, ABC, ABCD, ABCDA, ABCDAB]，后缀为[BCDABD, CDABD, DABD, ABD, BD, D]，共有元素的长度为0。</li></ul></li></ul><p>实现：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * 计算部分匹配表</div><div class="line"> *</div><div class="line"> * @param pattern</div><div class="line"> * @param next</div><div class="line"> */</div><div class="line">public void makeNext(char[] pattern, int next[]) &#123;</div><div class="line">    int pIdx, maxSuffixLen; // pIdx:模版字符串下标；maxSuffixLen:最大前后缀长度</div><div class="line">    int m = pattern.length;  // 模版字符串长度</div><div class="line">    next[0] = 0; //模版字符串的第一个字符的最大前后缀长度为0</div><div class="line">    for (pIdx = 1, maxSuffixLen = 0; pIdx &lt; m; ++pIdx) //for循环，从第二个字符开始，依次计算每一个字符对应的next值</div><div class="line">    &#123;</div><div class="line">        /**</div><div class="line">         * maxSuffixLen 大于0 表示前一个字符已经存在匹配</div><div class="line">         */</div><div class="line">        while (maxSuffixLen &gt; 0 &amp;&amp; pattern[pIdx] != pattern[maxSuffixLen]) &#123; //递归的求出P[0]···P[q]的最大的相同的前后缀长度k</div><div class="line">            maxSuffixLen = next[maxSuffixLen - 1];          //不理解没关系看下面的分析，这个while循环是整段代码的精髓所在，确实不好理解</div><div class="line">        &#125;</div><div class="line">        if (pattern[pIdx] == pattern[maxSuffixLen]) //如果相等，那么最大相同前后缀长度加1</div><div class="line">        &#123;</div><div class="line">            maxSuffixLen++;</div><div class="line">        &#125;</div><div class="line">        next[pIdx] = maxSuffixLen;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">public int kmp(String str, String pattern) &#123;</div><div class="line">    int[] next = new int[str.length()];</div><div class="line">    int strIdx, pIdx;</div><div class="line">    makeNext(pattern.toCharArray(), next);</div><div class="line"></div><div class="line">    for (strIdx = 0, pIdx = 0; strIdx &lt; str.length(); ++strIdx) &#123;</div><div class="line">        while (pIdx &gt; 0 &amp;&amp; pattern.charAt(pIdx) != str.charAt(strIdx)) &#123;</div><div class="line">            /**</div><div class="line">             * 移动匹配字符串位置</div><div class="line">             */</div><div class="line">            pIdx = next[pIdx - 1];</div><div class="line">        &#125;</div><div class="line">        if (pattern.charAt(pIdx) == str.charAt(strIdx)) &#123;</div><div class="line">            pIdx++;</div><div class="line">        &#125;</div><div class="line">        if (pIdx == pattern.length()) &#123;</div><div class="line">            return strIdx - pattern.length() + 1;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return -1;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>复杂度：时间复杂度最坏（3N） 空间复杂度 O(M）</p><h2 id="3-4-图"><a href="#3-4-图" class="headerlink" title="3.4 图"></a>3.4 图</h2><h2 id="3-5剑指offer"><a href="#3-5剑指offer" class="headerlink" title="3.5剑指offer"></a>3.5剑指offer</h2><p>01-二维数组中的查找</p><blockquote><p>在一个二维数组中，每一行都按照从左到右递增的顺序排序，每一列都按照从上到下递增的顺序排序。请完成一个函数，输入这样的一个二维数组和一个整数，判断数组中是否含有该整数。</p></blockquote><p>思路</p><p>坑：不要从中间去，采用二分查找。如果中间查找会有两个区域需要查找，增加复杂度。 真确思路：<strong>从右上角开始遍历</strong>，有三种情况:</p><ol><li>如果相等，则直接返回。</li><li>如果值大于目标值，列减小。(因为从坐到右增大，因此右边的值不可能存在目标值)</li><li>如果值小于目标值，增大行。（从上往下增大，该值在最右上角为当前行最大，因此当前行没有更大的，可以往下一行找）</li></ol><p>思考，是否可以从左上角开始、右下角、左下角开始？ 左上角不可以，右下角不可以。因为这这两个移动后还是会形成两个区域需要查找。 左下角可以。</p><p>实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">public boolean Find(int [][] array,int target) &#123;</div><div class="line">    if (array == null || array[0].length == 0 ) &#123;</div><div class="line">        return false;</div><div class="line">    &#125;</div><div class="line">    int row = 0;</div><div class="line">    int col = array.length - 1;</div><div class="line">    while ( row &lt; array.length &amp;&amp; col &gt;=0 ) &#123;</div><div class="line">        if ( target &gt; array[row][col]) &#123;</div><div class="line">            row ++;</div><div class="line">        &#125; else if (target &lt; array[row][col]) &#123;</div><div class="line">            col --;</div><div class="line">        &#125; else &#123;</div><div class="line">            return true;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    return false;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>02-替换空格</p><blockquote><p>请实现一个函数，将一个字符串中的空格替换成“%20”。例如，当字符串为We Are Happy.则经过替换之后的字符串为We%20Are%20Happy。</p></blockquote><p>思路</p><ol><li>先计算空格数目</li><li>计算新的字符串长度，并构建新字符数组</li><li>逐个遍历和copy, 遇到空格用户“%20”替换</li></ol><p>实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">public String replaceSpace(StringBuffer str) &#123;</div><div class="line">    // 第一件重要的事</div><div class="line">    if( str == null || str.length() == 0)</div><div class="line">        return str.toString();</div><div class="line">    // 长度计算</div><div class="line">    int newlength = newLength(str);</div><div class="line">    char[] newChar = new char[newlength];</div><div class="line">    int idx = 0;</div><div class="line">    for (int i = 0; i &lt; str.length(); i++) &#123;</div><div class="line">        if (str.charAt(i) == &apos; &apos;) &#123;</div><div class="line">            newChar[idx++] = &apos;%&apos;;</div><div class="line">            newChar[idx++] = &apos;2&apos;;</div><div class="line">            newChar[idx++] = &apos;0&apos;;</div><div class="line">        &#125; else &#123;</div><div class="line">            newChar[idx++] = str.charAt(i);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return new String(newChar);</div><div class="line">&#125;</div><div class="line">private int newLength(StringBuffer str) &#123;</div><div class="line">    int spaceNum = 0; </div><div class="line">    for (int i = 0; i &lt; str.length(); i ++) &#123;</div><div class="line">        if (str.charAt(i) == &apos; &apos;) &#123;</div><div class="line">            spaceNum++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 或者  str.length() + spaceNum * 2</div><div class="line">    return (str.length() - spaceNum) + spaceNum * 3;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>03-从尾到头打印链表</p><blockquote><p>输入一个链表，从尾到头打印链表每个节点的值。</p></blockquote><p>思路</p><p>利用栈，先进后出的思路。</p><p>实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">public ArrayList&lt;Integer&gt; printListFromTailToHead(ListNode listNode) &#123;</div><div class="line">    ArrayList&lt;Integer&gt; result = new ArrayList&lt;Integer&gt;();</div><div class="line">    if (null == listNode) &#123;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    Stack&lt;ListNode&gt; stack = new Stack&lt;ListNode&gt;();</div><div class="line">    ListNode next = listNode;</div><div class="line">    while(null != next) &#123;</div><div class="line">        stack.push(next);</div><div class="line">        next = next.next;</div><div class="line">    &#125;</div><div class="line">    while(!stack.isEmpty()) &#123;</div><div class="line">        result.add(stack.pop().val);</div><div class="line">    &#125;</div><div class="line">    return result;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>04-旋转数组的最小数字</p><blockquote><p>把一个数组最开始的若干个元素搬到数组的末尾，我们称之为数组的旋转。 输入一个非递减排序的数组的一个旋转，输出旋转数组的最小元素。 例如数组{3,4,5,1,2}为{1,2,3,4,5}的一个旋转，该数组的最小值为1。 NOTE：给出的所有元素都大于0，若数组大小为0，请返回0。</p></blockquote><p>思路</p><p>二分查找，不断缩短查找范围。</p><ol><li>mid值与左右两端比较，如果小于右边，high=mid.</li><li>mid大于左边，low=mid</li><li>如果左值=mid值=右值，顺序遍历</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">public int minNumberInRotateArray(int [] array) &#123;</div><div class="line">    if ( array == null || array.length == 0 ) &#123;</div><div class="line">        return 0;</div><div class="line">    &#125;</div><div class="line">    int low = 0, high = array.length - 1;</div><div class="line">    int mid;</div><div class="line">    while ( low &lt; high &amp;&amp; array[low] &gt;= array[high]) &#123;</div><div class="line">        // array[low] 需要大于等于 array[high] 在内部进行 遍历</div><div class="line">        if ( (low +1 )== high) &#123; //这个很关键，说明只有两个元素</div><div class="line">            return array[high];</div><div class="line">        &#125;</div><div class="line">        if (array[low] == array[high]) &#123;</div><div class="line">            int min = array[low];</div><div class="line">            for ( int i = low +1; i &lt;= high; i++) &#123;</div><div class="line">                if(array[i] &lt; min)&#123;</div><div class="line">                    min = array[i];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            return min;</div><div class="line">        &#125; else &#123;</div><div class="line">            mid = (low + high) &gt;&gt; 1;</div><div class="line">            if (array[mid] &lt; array[high])&#123;</div><div class="line">                high = mid;</div><div class="line">            &#125; else &#123;</div><div class="line">                low = mid;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 只有一个元素 或者 array[low] &lt; array[high]</div><div class="line">    return array[low];</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>05-斐波那契数列</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">public int Fibonacci(int n) &#123;</div><div class="line">    if(n &lt;= 0) &#123;</div><div class="line">        return 0;</div><div class="line">    &#125;</div><div class="line">    if (n == 1 || n == 2) &#123;</div><div class="line">        return 1;</div><div class="line">    &#125;</div><div class="line">    int preOne = 1;</div><div class="line">    int preTwo = 1;</div><div class="line">    int temp;</div><div class="line">    for ( int i = 3; i &lt;= n; i++ )&#123;</div><div class="line">        temp = preOne;</div><div class="line">        preOne = preOne + preTwo;</div><div class="line">        preTwo = temp;</div><div class="line">    &#125;</div><div class="line">    return preOne;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>06-青蛙跳</p><blockquote><p>一只青蛙一次可以跳上1级台阶，也可以跳上2级。求该青蛙跳上一个n级的台阶总共有多少种跳法。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">public int JumpFloor(int target) &#123;</div><div class="line">    if(target &lt;= 0) return 0;</div><div class="line">    if(target == 1) return 1;</div><div class="line">    if(target == 2) return 2;</div><div class="line">    int preOne = 2, preTwo = 1;</div><div class="line">    for(int i = 3; i &lt;= target; i++)&#123;</div><div class="line">        int temp = preOne + preTwo;</div><div class="line">        preTwo = preOne;</div><div class="line">        preOne = temp;</div><div class="line">    &#125;</div><div class="line">    return preOne;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>07-变态青蛙跳</p><blockquote><p>一只青蛙一次可以跳上1级台阶，也可以跳上2级……它也可以跳上n级。求该青蛙跳上一个n级的台阶总共有多少种跳法。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">public int JumpFloorII(int target) &#123;</div><div class="line">    if(target &lt;= 0) return 0;</div><div class="line">    int result = 1;</div><div class="line">    target --;</div><div class="line">    while(target !=0)&#123;</div><div class="line">        result = result &lt;&lt; 1;</div><div class="line">        target --;</div><div class="line">    &#125;</div><div class="line">    return result;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>08-矩阵覆盖</p><blockquote><p>我们可以用2<em>1的小矩形横着或者竖着去覆盖更大的矩形。请问用n个2</em>1的小矩形无重叠地覆盖一个2*n的大矩形，总共有多少种方法？</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> public int RectCover(int target) &#123;</div><div class="line">    if (target &lt;= 0) return 0;</div><div class="line">    if(target == 1) return 1;</div><div class="line">    if(target == 2) return 2;</div><div class="line">    int preOne = 2, preTwo =1;</div><div class="line">    for(int i = 3; i &lt;= target; i++)&#123;</div><div class="line">        int temp = preOne + preTwo;</div><div class="line">        preTwo = preOne;</div><div class="line">        preOne = temp;</div><div class="line">    &#125;</div><div class="line">    return preOne;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>09-二进制中1的个数</p><blockquote><p>输入一个整数，输出该数二进制表示中1的个数。其中负数用补码表示。</p></blockquote><p>思路</p><p>如果一个整数不为0，那么这个整数至少有一位是1。如果我们把这个整数减1，那么原来处在整数最右边的1就会变为0，原来在1后面的所有的0都会变成1(如果最右边的1后面还有0的话)。其余所有位将不会受到影响。 举个例子：一个二进制数1100，从右边数起第三位是处于最右边的一个1。减去1后，第三位变成0，它后面的两位0变成了1，而前面的1保持不变，因此得到的结果是1011.我们发现减1的结果是把最右边的一个1开始的所有位都取反了。这个时候如果我们再把原来的整数和减去1之后的结果做与运算，从原来整数最右边一个1那一位开始所有位都会变成0。如1100&amp;1011=1000.也就是说，把一个整数减去1，再和原整数做与运算，会把该整数最右边一个1变成0.那么一个整数的二进制有多少个1，就可以进行多少次这样的操作。</p><p>实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public int NumberOf1(int n) &#123;</div><div class="line">    int count = 0;</div><div class="line">    while(n!= 0)&#123;</div><div class="line">        count++;</div><div class="line">        n = n &amp; (n - 1);</div><div class="line">     &#125;</div><div class="line">    return count;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>10-数值的整数次方</p><blockquote><p>给定一个double类型的浮点数base和int类型的整数exponent。求base的exponent次方。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">public double Power(double base, int exponent) &#123;</div><div class="line">    if (base == 0) &#123;</div><div class="line">        return 0;</div><div class="line">    &#125;</div><div class="line">    boolean flag = false; // 是否exponent是负数</div><div class="line">    if (exponent &lt;= 0) &#123;</div><div class="line">        exponent =  -1 * exponent;</div><div class="line">        flag = true;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    double result = 1.0;</div><div class="line">    while (exponent &gt; 0) &#123;</div><div class="line">        result = result * base;</div><div class="line">        exponent--;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (flag) &#123;</div><div class="line">        return 1.0 / result; </div><div class="line">    &#125; else &#123;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>11-调整数组顺序奇数在偶数前面</p><blockquote><p>输入一个整数数组，实现一个函数来调整该数组中数字的顺序，使得所有的奇数位于数组的前半部分，所有的偶数位于位于数组的后半部分，并保证奇数和奇数，偶数和偶数之间的相对位置不变。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure><p>二叉搜索树的后序遍历序列</p><blockquote><p>输入一个整数数组，判断该数组是不是某二叉搜索树的后序遍历的结果。如果是则输出Yes,否则输出No。假设输入的数组的任意两个数字都互不相同。</p></blockquote><p>实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">public boolean VerifySquenceOfBST(int [] sequence) &#123;</div><div class="line">   if (sequence == null || sequence.length ==0) &#123;</div><div class="line">       return false;</div><div class="line">   &#125;</div><div class="line">    return verifySequenceOfBST(sequence, 0, sequence.length-1);</div><div class="line"></div><div class="line">&#125;</div><div class="line">private boolean verifySequenceOfBST(int[] sequence,int begin,int end)&#123;</div><div class="line">   if (begin == end) &#123;</div><div class="line">       return true;</div><div class="line">   &#125;</div><div class="line">    int rightBegin = begin;</div><div class="line">    int root = sequence[end];</div><div class="line">    for (;rightBegin &lt; end; rightBegin++ ) &#123;</div><div class="line">        if (sequence[rightBegin] &gt; root ) &#123;</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    int i = rightBegin;</div><div class="line">    for (; i &lt; end; i ++ ) &#123;</div><div class="line">        if (sequence[i] &lt; root) &#123;</div><div class="line">            return false;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    boolean left = (rightBegin == begin )? true : verifySequenceOfBST(sequence, begin, rightBegin -1);</div><div class="line">    boolean right = (rightBegin == end) ? true : verifySequenceOfBST(sequence, rightBegin+1, end);</div><div class="line">    return left &amp; right;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>复杂链表的复制</p><blockquote><p>输入一个复杂链表（每个节点中有节点值，以及两个指针，一个指向下一个节点，另一个特殊指针指向任意一个节点），返回结果为复制后复杂链表的head。（注意，输出结果中请不要返回参数中的节点引用，否则判题程序会直接返回空）</p></blockquote><p>思路</p><p>三步走:</p><ol><li>在原来链中插入克隆节点，是的克隆节点和源节点相间出现。</li><li>复制random指针</li><li>从原链从剥离clone链。</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">public RandomListNode Clone(RandomListNode pHead)</div><div class="line">&#123;</div><div class="line">    cloneNodes(pHead);</div><div class="line">    connectRandomNodes(pHead); </div><div class="line">    return reconnectNodes(pHead);</div><div class="line">&#125;</div><div class="line">private void cloneNodes(RandomListNode pHead)&#123;</div><div class="line">    RandomListNode node = pHead;</div><div class="line">    while(node != null)&#123;</div><div class="line">        RandomListNode clone = new RandomListNode(node.label);</div><div class="line">        RandomListNode temp = node.next;</div><div class="line">        clone.next = temp;</div><div class="line">        node.next = clone;</div><div class="line">        node = temp;           </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">private void connectRandomNodes(RandomListNode pHead)&#123;</div><div class="line">    RandomListNode node = pHead;</div><div class="line">    while(node != null)&#123;</div><div class="line">         RandomListNode clone = node.next;</div><div class="line">         if(node.random != null)//这里一定要判断</div><div class="line">            clone.random = node.random.next;</div><div class="line">         node = clone.next;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">private  RandomListNode reconnectNodes(RandomListNode pHead)&#123;</div><div class="line">    RandomListNode node = pHead;</div><div class="line">    RandomListNode cloneHead = null;</div><div class="line">    RandomListNode cloneNode = null;</div><div class="line">    if(node != null)&#123;</div><div class="line">        cloneHead = cloneNode = node.next;</div><div class="line">        node.next = cloneNode.next;</div><div class="line">        node = node.next;</div><div class="line">    &#125;</div><div class="line">    while(node != null)&#123;</div><div class="line">        cloneNode.next = node.next;</div><div class="line">        cloneNode = cloneNode.next;</div><div class="line">        node.next = cloneNode.next;</div><div class="line">        node = cloneNode.next;</div><div class="line">    &#125;</div><div class="line">    return cloneHead;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>二叉搜索树与双向链表</p><blockquote><p>输入一棵二叉搜索树，将该二叉搜索树转换成一个排序的双向链表。要求不能创建任何新的结点，只能调整树中结点指针的指向。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> TreeNode <span class="title">Convert</span><span class="params">(TreeNode root)</span></span>&#123;</div><div class="line">        TreeNode lastNode = <span class="keyword">null</span>;</div><div class="line">        lastNode = doConvert(root, lastNode);</div><div class="line">        <span class="keyword">while</span>(lastNode != <span class="keyword">null</span> &amp;&amp; lastNode.left != <span class="keyword">null</span>) &#123;</div><div class="line">            lastNode = lastNode.left;</div><div class="line">        &#125;</div><div class="line">       <span class="keyword">return</span> lastNode;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="comment">/* 转换并返回链表最后一个结点</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">private</span> TreeNode <span class="title">doConvert</span><span class="params">(TreeNode root, TreeNode lastNode)</span></span>&#123;</div><div class="line">         <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</div><div class="line">             <span class="keyword">return</span> lastNode;</div><div class="line">         &#125;</div><div class="line">         <span class="keyword">if</span> (root.left != <span class="keyword">null</span>) &#123;</div><div class="line">             lastNode = doConvert(root.left, lastNode);</div><div class="line">         &#125;</div><div class="line">         <span class="keyword">if</span>(lastNode != <span class="keyword">null</span>) &#123;</div><div class="line">             lastNode.right = root;</div><div class="line">         &#125;</div><div class="line">         root.left = lastNode;</div><div class="line">         lastNode = root;</div><div class="line">         <span class="keyword">if</span> (root.right != <span class="keyword">null</span>) &#123;</div><div class="line">             lastNode = doConvert(root.right, lastNode);</div><div class="line">         &#125;</div><div class="line">        <span class="keyword">return</span> lastNode;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>字符串的排列</p><blockquote><p>输入一个字符串,按字典序打印出该字符串中字符的所有排列。例如输入字符串abc,则打印出由字符a,b,c所能排列出来的所有字符串abc,acb,bac,bca,cab和cba。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.Collections;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;String&gt; <span class="title">Permutation</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">       ArrayList&lt;String&gt; result = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">        <span class="keyword">if</span>(str == <span class="keyword">null</span> || str.length() == <span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> result;</div><div class="line">        doPermutation(str.toCharArray(),<span class="number">0</span>,result);</div><div class="line">        <span class="comment">// 实际中不需要排序</span></div><div class="line">        Collections.sort(result);</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doPermutation</span><span class="params">(<span class="keyword">char</span>[] array,<span class="keyword">int</span> idx,ArrayList&lt;String&gt; result)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(idx &gt;= array.length)&#123;</div><div class="line">            String str = <span class="keyword">new</span> String(array);</div><div class="line">            result.add(str);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=idx; i &lt; array.length; i++)&#123; <span class="comment">//i得从 idx开始</span></div><div class="line">            <span class="keyword">if</span>(i != idx &amp;&amp; array[i] == array[idx] )</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line"></div><div class="line">            swap(array,idx,i);</div><div class="line">            doPermutation(array,idx+<span class="number">1</span>,result);</div><div class="line">            swap(array,idx,i);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">char</span>[] array,<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">        <span class="keyword">char</span> temp = array[i];</div><div class="line">        array[i] = array[j];</div><div class="line">        array[j] = temp;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="3-6-Leetcode"><a href="#3-6-Leetcode" class="headerlink" title="3.6 Leetcode"></a>3.6 Leetcode</h2><hr><h1 id="第四章-JAVA基础"><a href="#第四章-JAVA基础" class="headerlink" title="第四章 JAVA基础"></a>第四章 JAVA基础</h1><h2 id="4-1-j2se基础"><a href="#4-1-j2se基础" class="headerlink" title="4.1 j2se基础"></a>4.1 j2se基础</h2><ul><li><p>值传递和引用传递</p><p> java本质上还是值传递，即传入一个变量的副本。如果这个变量是一个对象引用，则方法栈内会创建一个副本指向相同的引用对象，此时对该对象的内容操作会改变该对象，但是无法修改对象引用的值。</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">(Item m)</span></span>&#123;</div><div class="line">   m.name = <span class="string">"new name"</span>; <span class="comment">// m是引用对象n的一个副本，指向n的内存，因此n的值发生变化</span></div><div class="line">   m = <span class="keyword">new</span> Item(); <span class="comment">// 更改副本m的引用指向新的内存，传入对象n指向的内存地址不改变</span></div><div class="line"> &#125;</div><div class="line"> Item n = <span class="keyword">new</span> Item(<span class="string">"name"</span>);</div><div class="line"> change(n);</div></pre></td></tr></table></figure></li><li><p>静态变量和实例变量的区别</p><p>静态变量前要加 static 关键字，静态变量属于类，只要程序加载了类的字节码，不用创建任何实例对象，静态变量就会被分配空间，直接使用类名来访问。实例变量属于某个对象的属性，必须创建了实例对象，其中的实例变量才会被分配空间，才能使用。</p></li><li><p>JDK 常见的package</p><ul><li><strong>java.lang</strong>：这个是系统的基础类，比如 String 等都是这里面的，唯一一个可以不用 import 就可以使用。</li><li><strong>java.io</strong>: 这里面是所有输入输出有关的类，比如文件操作等 </li><li><strong>java.net</strong>: 这里面是与网络有关的类，比如 URL,URLConnection 等。</li><li><strong>java.util</strong>: 这个是系统辅助类，特别是集合类 Collection,List,Map 等。</li><li><strong>java.sql</strong>: 这个是数据库操作的类，Connection, Statememt，ResultSet 等</li></ul></li><li><p>JDK, JRE 和 JVM 的区别</p><p><strong>JDK, JRE 和 JVM 的区别</strong> JDK 可以编译调试运行java程序， JRE 只能运行 Java 程序。 JDK 和 JRE 都包含了 JVM，JVM是跨平台的。 <strong>即时编译器(JIT)</strong> 是 JVM 的一部分，Java编译器将代码编译成JVM可识别的字节码，而不是机器二进制指令，然后由JIT将字节码转换成与平台相关的机器码指令。</p></li><li><p>final, finally, finalize 的区别?</p><p><strong>final</strong>：(1)修饰类：表示该类不能被继承； (2)修饰方法：表示方法不能被覆盖； (3)修饰变量：表示变量只能一次赋值以后值不能被修改（常量）。</p><p><strong>finally</strong>：通常放在 try…catch 的后面构造总是执行代码块，这就意味着程序无论正常执行还是发生异常，这里的代码都能执行，可以将释放外部资源的代码写在 finally 块中。</p><p> <strong>finalize</strong>：Object 类中定义的方法finalize()，用于对象被GC回收前执行一些清理工作。GC在销毁对象时调用，通过重写finalize() 方法可以实现整理系统资源或者执行其他清理工作。</p></li><li><p>assert关键字</p><p>assertion(断言)在软件开发中是一种常用的调试方式，assertion <strong>用于保证程序最基本、关键的正确性</strong>。assertion 检查通常在开发和测试时开启。为了提高性能，在软件发布后， assertion 检查通常是关闭的。在实现中，断言是一个包含布尔表达式的语句，在执行这个语句时假定该表达式为 true；如果表达式计算为 false，那么系统会报告一个 AssertionError。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">assert</span> Expression1;</div><div class="line"><span class="keyword">assert</span> Expression1 : Expression2 ;<span class="comment">// 表达式2用于输出相关的调试信息</span></div></pre></td></tr></table></figure><p>断言在默认情况下是禁用的，要在编译时启用断言，需使用 source 1.4 标记：<code>javac -source 1.4 Test.java</code></p><p>要在运行时启用断言，可使用 -enableassertions 或者 -ea 标记。 要在运行时选择禁用断言，可使用 -da 或者 -disableassertions 标记。</p></li><li><p>char 型变量</p><p>char 类型可以存储一个中文汉字，因为 Java 中使用的编码是 Unicode，一个 char 类型占 2 个字节（16bit），所以放一个中文是没问题的。在 JVM 内部都是 Unicode，当这个字符被从 JVM 内部转移到外部时（例如存入文件系统中），需要进行编码转换，因此Java 中提供了字节流和字符流，以及在字符流和字节流之间进行转换的转换流，如 InputStreamReader 和 OutputStreamReader.</p></li><li><p>String 和StringBuilder、StringBuffer 的区别</p><p>String是只读字符串，不可改变对象。 StringBuffer 和 StringBuilder 类表示的字符串对象可以直接进行修改。StringBuilder 是线程不安全的，因此它的效率也比 StringBuffer 略高。  </p></li><li><p>不可变对象</p><p>不能改变对象内的成员变量，包括基本数据类型的值不能改变，引用类型的变量不能指向其他的对象，引用类型指向的对象的状态也不能改变。</p><ul><li>将类声明为final，所以它不能被继承</li><li>将所有的成员声明为私有的，这样就不允许直接访问这些成员,将所有可变的成员声明为final，这样只能对它们赋值一次</li><li>通过构造器初始化所有成员，进行深拷贝(deep copy):如果某一个类成员不是原始变量(primitive)或者不可变类，必须通过在成员初始化(in)或者get方法(out)时通过深度clone方法，来确保类的不可变。</li><li>在getter方法中，不要直接返回对象本身，而是克隆对象，并返回对象的拷贝</li></ul></li><li><p>为什么String要设计成不可变的</p><ol><li>字符串常量池的需要,节约内存空间。</li><li>线程安全考虑。 同一个字符串实例可以被多个线程共享。</li><li>类加载器要用到字符串，不可变性提供了安全性，以便正确的类被加载。</li><li>支持hash映射和缓存。 </li></ol><p>Javac 编译可以对字符串常量直接相加的表达式进行优化，不必要等到运行期去进行加法运算处理，而是在<strong>编译时去掉其中的加号</strong>，直接将其编译成一个这些常量相连的结果。所以 String s=“a”+”b”+”c”+”d”;只生成一个对象.</p></li><li><p>Java 序列化</p><p>序列化就是一种用来处理对象流的机制，用于处理对象流的读写。对象流可以在网络中进行对象传输。</p><p>序列化的<strong>实现</strong>：将需要被序列化的类实现 Serializable 接口，该接口没有需要实现的方法， implements Serializable 只是为了标注该对象是可被序列化的，然后使用一个输出流(如：FileOutputStream)来写流对象，恢复的话则用输入流。</p></li><li><p>Java持久化</p><p>通常将对象由内存保存到硬盘上，使其在程序生命周期之外也可以使用。必须提供Save， Load，boolExist（判断外存是否已有该对象）。</p></li><li><p>错误和异常(Error vs Exception)</p><ol><li><strong>java.lang.Error</strong> ，表示系统级的错误和程序不必处理的异常，如内存溢出。<strong>java.lang.Exception</strong> ，表示需要捕捉或者需要程序进行处理的异常，是一种设计或实现问题；二者都是Throwable的子类。</li><li>Error 和 RuntimeException 及其子类都是未检查的异常（unchecked exceptions），而所有其他的 Exception 类都是检查了的异常（checked exceptions） 与上下文环境有关，即使程序设计无误，仍然可能因使用的问题而引发．发生在编译阶段，必须要使用 try…catch（或者 throws ）否则编译不通过。 unchecked exceptions发生在运行期，具有不确定性，主要是由于程序的逻辑问题所引起的。比如 类型转换、数组越界访问和试图访问空指针等等。</li></ol></li><li><p>try{} 里的 return 语句</p><p>Java 允许在 finally 中改变返回值，因为try 中的 return 语句立即执行，而是记录下返回点，等 finally 代码块执行完毕之后再执行return语句。如果在 finally 中修改了返回值，return的结果也会有相应的改变。</p></li><li><p>throws、throw、try、catch、finally</p><p>try 用来运行一段可能“异常”的代码，catch 子句用来指定想要捕捉的“异常”的类型，并处理；finally，保证无论是否发生“异常”，都会执行finally代码块；throw 语句可以在程序的任意位置主动抛出一个“异常”对象；throws用来标明一个成员函数可能抛出的各种“异常”；</p></li><li><p>常见的runtime exception</p><p>1、<code>NullPointerException</code>空指针引用异常 2、<code>ClassCastException</code>- 类型强制转换异常。 3、<code>IllegalArgumentException</code>- 传递非法参数异常。 4、<code>IndexOutOfBoundsException</code>- 下标越界异常 5、<code>UnsupportedOperationException</code> - 不支持的操作异常 6、<code>ArithmeticException</code> - 算术运算异常 7、<code>ArrayStoreException</code> - 向数组中存放与声明类型不兼容对象异常 8、<code>NegativeArraySizeException</code> - 创建一个大小为负数的数组错误异常 9、<code>NumberFormatException</code> - 数字格式异常 10、<code>SecurityException</code> - 安全异常</p></li><li><p>equals与==的区别</p><ul><li>== 是一个运算符,可以用于基本类型的值比较，对象比较则是判断两个引用是否是同一对象。 </li><li>equals则是Object提供的对象比较方法，用于判断两个对象引用是否为同一对象（对象大小的比较，是实现Comparable接口）。重写equals方法需要注意：<ol><li>使用 instanceof 操作符检查“参数是否为正确的类型”</li><li>对于类中的关键属性，检查传入对象的属性是否与之相匹配；</li><li>编写完 equals 方法后，问自己它是否满足对称性、传递性、一致性；</li><li>重写 equals 时总是要重写 hashCode</li><li>不要将 equals 方法参数中的 Object 对象替换为其他的类型，在重写时不要忘掉 @Override 注解。</li></ol></li></ul></li><li><p>Object对象提供的方法</p><ol><li>protected Object clone()创建并返回此对象的一个副本。 </li><li>public boolean equals(Object obj)指示其他某个对象是否与此对象“相等”。 </li><li>protected void finalize()当垃圾回收器确定不存在对该对象的更多引用时，由对象的垃圾回收器调用此方法。 </li><li>public final native Class&lt; ? &gt; getClass() 返回此 Object 的运行时类。 </li><li>public int hashCode()返回该对象的哈希码值。 </li><li>public String toString()返回该对象的字符串表示。 </li><li>public void notify()唤醒在此对象监视器上等待的单个线程。 public void notifyAll()唤醒在此对象监视器上等待的所有线程。 </li><li>public void wait()在其他线程调用此对象的 notify() 方法或 notifyAll() 方法前，阻塞当前线程等待。</li></ol><p>注意： 对象必须实现Cloneable标示性接口，才能调用Clone方法，否则会有<code>CloneNotSupportedException</code> 异常。</p><p>在每个覆盖equals方法的类中也必须覆盖hashCode方法，由于hashCode的通用约定—相等的对象散列码相等，可以保证所有基于散列集合的操作运行正常，如HashMap,HashSet和HashTable。hashMap根据hashCode去定位散列桶位置。</p></li><li><p>修饰符顺序</p><p>public protected private abstract static final transient volatile synchronized native strictfp</p></li></ul><h2 id="4-2-面向对象"><a href="#4-2-面向对象" class="headerlink" title="4.2 面向对象"></a>4.2 面向对象</h2><p>面向对象软件开发的优点： (1) 代码开发模块化，更易维护和修改。 (2) 代码复用。 (3) 增强代码的可靠性和灵活性。 (4) 增加代码的可理解性。 面向对象编程有很多重要的特性如：封装，继承，多态和抽象。</p><ul><li><p>Overload 和 Override</p><p><strong>重载 Overload</strong> 表示<strong>同一个类</strong>中可以有多个名称相同的方法，但这些方法的参数类型、数量不同。 不能通过访问权限、返回类型、抛出异常实现重载。</p><p><strong>重写 Override</strong> 表示<strong>子类</strong>中的方法可以与<strong>父类</strong>中的某个<strong>方法的名称和参数完全相同</strong>，通过子类创建的实例对象调用这个方法时，将调用子类中的定义方法，这相当于把父类中定义的那个完全相同的方法给覆盖了，这也是面向对象编程的多态性的一种表现。<strong>子类覆盖父类的方法时，只能比父类抛出更少的异常，或者是抛出父类抛出的异常的子异常</strong>，因为子类可以解决父类的一些问题，不能比父类有更多的问题。<strong>子类方法的访问权限只能比父类的更大，不能更小</strong>。如果<strong>父类的方法是 private 类型，那么，子类则不存在覆盖的限制</strong>，相当于子类中增加了一个全新的方法。 </p></li><li><p>接口和抽象类的区别</p><ol><li>接口中所有的<strong>方法</strong>隐含的都是抽象的。而抽象类则可以同时包含抽象和非抽象的方法。 </li><li>类可以实现很多个接口，但是只能<strong>继承</strong>一个抽象类 </li><li>类如果要<strong>实现</strong>一个接口，它必须要实现接口声明的所有方法。类在声明成是抽象的情况下，可以不实现抽象类声明的所有方法。  </li><li>Java 接口中声明的<strong>变量</strong>默认都是 final 的.抽象类可以包含非 final 的变量。 </li><li>Java 接口中的<strong>成员函数</strong>默认是 public 的。抽象类的成员函数可以是 private，protected 或者是 public 。 </li><li>接口是绝对抽象的，不可以被实例化。抽象类也无法实例化，但是可以调用main方法。</li></ol></li><li><p>接口</p><ol><li>接口的变量都是 <code>public static final</code> ,相当于常量，是所有实现类的共有变量。 方法都是<code>public abstract</code> </li><li>没有构造函数和实例变量，没法被实例化。</li></ol></li><li><p>AOP 和 OOP，IOC 和 DI</p><ol><li><p>面向对象编程（Object Oriented Programming，OOP，面向对象程序设计）是一种计算机编程架构。</p></li><li><p>AOP 是 OOP 的延续，是 Aspect Oriented Programming 的缩写，意思是面向方面编程。 将通用需求功能从不相关类之中分离出来；同时，能够使得很多类共享一个行为，一旦行为发生变化，不必修改很多类，只要修改这个行为就可以。AOP 就是这种实现分散关注的编程方法，它将“关注”封装在“方面”中。</p><p>类比Python的装饰器语法，可以在函数运行时，改变函数的运行。</p></li><li><p>控制反转 IOC(Inversion of Control) 控制指的就是程序相关类之间的依赖关系.传统观念设计中, 通常由调用者来创建被调用者的实例, <strong>在 Spring 里,创建被调用者的工作不再由调用者来完成,而是由 Spring 容器完成，依赖关系被反转了，称为控制反转，目的是为了获得更好的扩展性和良好的可维护性</strong>。依赖注入(Dependency injection)创建被调用者的工作由 Spring 容器完成，然后注入调用者，因此也称依赖注入。控制反转和依赖注入是<strong>同一个概念</strong>。</p></li></ol></li></ul><h2 id="4-3-集合"><a href="#4-3-集合" class="headerlink" title="4.3 集合"></a>4.3 集合</h2><p>Collection：List列表，Set集合， Map：Hashtable，HashMap，TreeMap</p><ul><li><p><strong>List</strong> 列表，元素有序，可重复，能够使用索引访问元素。List接口的常用实现类： Vector，线程安全但速度慢，底层数据结构是数组；ArrayList，线程不安全但查询速度快，底层数据结构是数组； LinkedList，线程不安全，增删速度快，底层数据结构是链表。</p></li><li><p><strong>Set</strong>(集) 元素不可重复，无序。 取出元素的方法只有迭代器。 Set接口中常用的类 HashSet：线程不安全，内部是基于散列函数实现,存取速度快。依赖元素的hashCode方法和euqals方法确保唯一性； LinkedHashSet，具有HashSet的查询速度，且内部采用双向链表<strong>维护元素的顺序</strong> ，内部是由链表实现；TreeSet，线程不安全，可以对Set集合中的元素进行排序,内部采用了红黑树。通过元素的compareTo或者compare方法来保证元素的唯一性。元素是以二叉树的形式存放的。TreeSet中的元素要实现Comparable接口，或者有一个自定义的比较器。</p></li><li><p><strong>Map</strong>，key-value的形式保存索引和数据。Hashtable，线程安全，速度快。底层是<strong>哈希表数据</strong>结构，不允许null作为key和值；Properties:用于配置文件的定义和操作，使用频率非常高，同时键和值都是字符串；HashMap，线程不安全，速度慢。底层也是哈希表数据结构，但是允许null作为键和值；LinkedHashMap，可以保证HashMap集合有序。存入的顺序和取出的顺序一致；TreeMap，可以对Map中的键进行排序，底层是采用红黑树． </p></li><li><p>Collection 和 Collections的区别： Collection是集合类的上级接口，子接口主要有Set 和List、Map。 Collections是针对集合类的实现的工具类，提供了操作集合的工具方法：一系列静态方法实现对各种集合的搜索、排序、线程安全化等操作。</p></li><li><p>ArrayList 和 LinkedList</p><p>底层实现不同，ArrayList使用数组，查询快；LinkedList使用链表，插入删除速度快；</p></li><li><p>遍历List</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">List&lt;String&gt; strList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"><span class="comment">//使用for-each循环</span></div><div class="line"><span class="keyword">for</span>(String obj : strList)&#123;</div><div class="line">  System.out.println(obj);</div><div class="line">&#125;</div><div class="line"><span class="comment">//using iterator</span></div><div class="line">Iterator&lt;String&gt; it = strList.iterator();</div><div class="line"><span class="keyword">while</span>(it.hasNext())&#123;</div><div class="line">  String obj = it.next();</div><div class="line">  System.out.println(obj);</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>LinkedList 和PriorityQueue 的区别</p><p><strong>Queue中只有两个实现类LinkedList 和PriorityQueue</strong>。他们都是属于队列，即拥有先进先出（FIFO）的特点。LinkedList 支持双向列表操作， PriorityQueue 按优先权控制队列元素的出队次序（Comparable接口）。</p></li><li><p>HashMap实现原理</p><p><strong>数据结构</strong>： HashMap基于哈希算法，采用链地址法来避免hash冲突，所以其内部采用链表数组数据结构。我们通过put()和get()方法储存和获取对象。HashMap里面实现一个静态内部类Entry, Entry用于保存key、value, next为链表指针.</p><p><strong>存取实现</strong>:  <strong>put</strong> ，根据对象的hashCode计算得到<strong>散列桶坐标</strong>（数组下表），由于数组中存放的是<strong>Entry链表结构</strong>，然后遍历Entry链表，如果存在key则更新其Value，如果不存在则<strong>采用头插入</strong>的方式在链表头部插入一个新的Entry节点存储key-value。 <strong>null key</strong>总是存放在Entry[]数组的第一个元素。 </p><p><strong>get</strong>, 根据hashCode的值定位到散列桶，并遍历存放在改桶中的链表。如果存在的该key则返回对应的value，如果不存在则返回null。</p><p><strong>解决hash冲突</strong>：1.开放定址法（线性探测再散列，二次探测再散列，伪随机探测再散列） 2.再哈希法 3.链地址法 4.建立一个公共溢出区。 Java的HashMap使用的是链地址法。</p></li><li><p>Enumeration 接口和 Iterator 接口的区别</p><p>Enumeration 速度是 Iterator 的2倍，<strong>同时占用更少的内存</strong>。 但是，Iterator远远比 Enumeration 安全，因为其他线程不能够修改正在被 iterator 遍历的集合里面的对象。 同时，Iterator 允许调用者删除底层集合里面的元素。</p></li><li><p>迭代器fail-fast属性</p><p>每次尝试获取下一个元素的时候，Iterator fail-fast属性检查当前集合结构里的任何改动。如果发现任何改动，它抛出ConcurrentModificationException。Collection中所有Iterator的实现都是按fail-fast来设计。在遍历一个集合的时候，我们可以使用并发集合类来避免ConcurrentModificationException，比如使用CopyOnWriteArrayList，而不是ArrayList</p></li><li><p>快速失败(fail-fast)和安全失败(fail-safe)的区别</p><p>Iterator的fail-fast属性与当前的集合共同起作用，因此它不会受到集合中任何改动的影响。java.util包下面的所有的集合类都是快速失败的，而java.util.concurrent包下面的所有的类都是安全失败的。快速失败的迭代器会抛出ConcurrentModificationException异常，而安全失败的迭代器永远不会抛出这样的异常。</p></li><li><p>Map接口提供的集合视图</p><ol><li><strong>Set keyset()</strong>：返回map中包含的所有key的一个Set视图。</li><li><strong>Collection values()</strong>：返回一个map中包含的所有value的一个Collection视图。 </li><li>Set&lt; Map.Entry &lt; K,V &gt; &gt; entrySet()：返回一个map钟包含的所有映射的一个集合视图。</li></ol><p>注意： 上面三个方法得到的集合对象是Map里的引用对象，都不支持add添加元素，但是支持移除和修改，相应的Map对象元素内容也会发生改变。</p></li><li><p>EnumSet</p><p>java.util.EnumSet是使用<strong>枚举类型</strong>的集合实现。当集合创建时，枚举集合中的所有元素必须来自单个指定的枚举类型，可以是显示的或隐示的。</p></li><li><p>集合对象排序</p><p>可以使用Arrays.sort()或Collections.sort()方法。</p></li><li><p>Comparable和Comparator接口</p><p> 都是用来实现集合中元素的比较、排序的。只是 Comparable 用于实现对象自比较。Comparator 实现两个对象的比较。</p><p>Comparator里有compare(T o1,T o2)和equals(Object obj)，Comparable接口只有int compareTo(T o)方法。</p></li></ul><h2 id="4-4-多线程"><a href="#4-4-多线程" class="headerlink" title="4.4 多线程"></a>4.4 多线程</h2><p>并发编程常见的3个问题：原子性，可见性(共享变量修改对其他线程立即可用)，有序性。</p><ul><li><p>volatile的理解</p><ol><li>Volatile 是轻量级的synchronized，它在多处理器开发过程中保证了共享变量的“可见性”，可见性是指当一个线程的某个共享变量发生改变时，另一个线程能够读取到这个修改的值。</li></ol></li></ul><ol><li>Volatile 可以禁止指令重排序。</li><li>Volatile 能保持单个简单volatile变量的读/写操作的具有原子性。但不能保证自增自减的原子性。</li></ol><ul><li><p>死锁的必要条件？怎么克服？</p><p>答：产生死锁的四个必要条件： <strong>互斥条件</strong>：一个资源每次只能被一个进程使用。 <strong>请求与保持条件</strong>：一个进程因请求资源而阻塞时，对已获得的资源保持不放。 <strong>不剥夺条件</strong>:进程已获得的资源，在末使用完之前，不能被强行剥夺。 <strong>循环等待条件</strong>。 只要上述条件之一不满足，就不会发生死锁。</p></li><li><p>ThreadPool</p><p>创建和销毁线程需要代价，线程执行完毕不销毁而是存入线程池中。</p><ol><li><p>execute 和submit的区别</p><p>Execute()用于提交不需要返回值得任务，submit()用于提交需要返回值的任务，发挥Future类型的对象。</p></li><li><p>Shutdown和shutdownNow的区别</p><p>都是遍历线程池中的工作线程，然后逐个调用线程的Internet方法来中断线程，所以无法响应中断的任务可能永远无法终止。 ShutdownNow首先将线程池的状态设置成STOP,然后尝试停止所有正在执行或暂停的任务，并返回等待执行任务的列表。而shutdown只是将线程池设置成SHUTDOWN状态，然后中断没有正在执行任务的线程。</p></li></ol></li><li><p>ThreadLocal</p><p>ThreadLocal并不是一个Thread，而是Thread的局部变量,当使用ThreadLocal维护变量时，ThreadLocal为每个使用该变量的线程提供独立的变量副本，一个线程不会影响其它线程所对应的变量副本</p></li><li><p>同步</p><ol><li><p>sleep() 和 wait() 区别</p><p>sleep()是Tread的方法，可以让线程暂停执行指定时间，将执行机会给其他线程，但是依然保持监控状态，到时后线程变为ready状态，因此调用 sleep后线程 不会释放对象锁。wait() 是 Object 类的方法，调用 wait()方法导致本线程放弃对象锁(线程暂停执行)，然后等待针对此对象发出 notify 方法（或 notifyAll），本线程才能获得对象锁，进入就绪状态。</p></li><li><p>sleep() 和 yield() 区别</p><p>sleep方法给其他线程运行机会时<strong>不考虑线程的优先级</strong>，因此低优先级的线程也有运行的机会；yield方法<strong>只会给相同优先级或更高优先级</strong>的线程以运行的机会；</p><p>sleep() 方法后线程转入<strong>阻塞</strong>（blocked）状态，而执行 yield方法后线程转入<strong>就绪（ready）</strong>状态；</p><p>sleep() 方法声明需要抛出InterruptedException，而 yield() 方法没有声明任何异常；</p></li></ol></li><li><p>实现多线程的3种方法：Thread与Runable。 <strong>1)继承Tread类，重写run函数</strong> <strong>2)实现Runnable接口</strong> <strong>3)实现Callable接口</strong></p><ul><li>Callable和Runnable的区别</li></ul></li></ul><h2 id="4-5-IO"><a href="#4-5-IO" class="headerlink" title="4.5 IO"></a>4.5 IO</h2><h2 id="4-6-设计模式"><a href="#4-6-设计模式" class="headerlink" title="4.6 设计模式"></a>4.6 设计模式</h2><p>设计模式：单例、工厂、适配器、责任链、观察者等等。</p><h2 id="4-7-JVM"><a href="#4-7-JVM" class="headerlink" title="4.7 JVM"></a>4.7 JVM</h2><p>根据 JVM 规范，JVM 内存共分为虚拟机栈、堆、方法区、程序计数器、本地方法栈五个部分。</p><p><img src="http://img.shuaiyy.cn/blog/180314/2KB71gC0j2.png?imageslim" alt="mark"></p><ul><li><strong>程序计数器</strong>：看做当前线程所执行的<strong>字节码行号指示器</strong>。是线程<strong>私有</strong>的内存，且唯一一块不报OutOfMemoryError异常。</li><li><strong>Java虚拟机栈</strong>：用于描述java方法的<strong>内存模型</strong>：每个方法被执行时都会同时创建一个<strong>栈帧</strong>用于存储<strong>局部变量表，操作数栈，动态链接，方法出口</strong>等信息。每一个方法被调用直至执行完成的过程就对应着一个栈帧在虚拟机中从入栈到出栈的过程。如果线程请求的<strong>栈深度</strong>大于虚拟机所允许的深度就报StackOverflowError, 如果虚拟机栈可以动态<strong>扩展</strong>，当拓展时无法申请到足够的内存会抛出OutOfMemoryError. 是线程<strong>私有</strong>的。</li><li><strong>本地方法栈</strong>：与虚拟机栈相似，不同的在于它是为虚拟机使用到的<strong>Native</strong>方法服务的。会抛出StackOverflowError和OutOfMemoryError。是线程<strong>私有</strong>的。</li><li><strong>Java堆</strong>:是所有线程共享的一块内存，在虚拟机启动时创建。此内存区域的唯一目的就是存放对象实例，几乎所有的对象实例都在这里分配内存。如果堆上没有内存完成实例的分配就会报OutOfMemoryError.</li><li><strong>方法区（永久代）</strong>：用于存储已被虚拟机加载的<strong>类信息、常量、静态变量、即时编译器编译后的代码</strong>等数据。当方法区无法满足内存分配需求时，会抛出OutOfMemoryError。是共享内存。</li><li><strong>运行时常量池</strong>：用于存放编译器生成的各种字面量和符号引用，是方法区的一部分。无法申请内存时抛出OutOfMemoryError。</li><li><strong>直接内存</strong>：不是虚拟机运行时数据的一部分，也不是java虚拟机规范中定义的区域，是计算机直接的内存空间。这部分也被频繁使用，如JAVA NIO的引入基于通道和缓存区的I/O使用native函数直接分配堆外内存。如果内存不足会报OutOfMemoryError。</li></ul><p>GC的两种判定方法：引用计数与根搜索算法。 </p><ul><li><strong>引用计数</strong>： 给对象添加一个引用计数器，每当有一个地方引用该对象时，计数器值加1，当引用失效时，计数器值减1。任何时候计数器都为0的对象就是不可能再被使用的。它很难解决对象之间相互<strong>循环引用</strong>问题。</li><li><strong>根搜索算法（GC Roots Traceing）:</strong> 通过一系列名为“GC Roots”的对象作为起点，从这些节点开始向下搜索，搜索走过的路径成为<strong>引用链</strong>，当一个对象到GC Roots没有任何引用链相连时，则证明此对象不可用。 GC Roots对象一般是：虚拟机栈中的引用对象，方法区中类静态属性引用的对象，方法区常量引用的对象等。</li></ul><p>Java中的四种对象引用，可以通过代码决定某些对象的生命周期，同时利于JVM进行垃圾回收。</p><ol><li><strong>强引用</strong>：程序代码中的普通引用。如Object obj = new Object(),只要强引用存在，垃圾回收器就不会回收。在不使用对象时应及时将引用设置为null，便于垃圾回收。 </li><li><strong>软引用</strong>：描述一些有用但并非必须的对象。对于软引用关联的对象在系统将要<strong>发生内存溢出异常之前</strong>，将会把这些对象列进回收范围之中进行第二次回收。</li><li><strong>弱引用</strong>：描述非必须对象，比软引用弱一些。被弱引用关联的对象只能<strong>生存到下一次垃圾收集发生之前</strong>。无论当前内存是否足够，都会回收掉只被弱引用关联的对象。 </li><li><strong>虚引用</strong>：最弱的引用，不管是否有虚引用存在，完全不会对对象生存时间构成影响，也无法通过虚引用来取得一个对象实例。唯一目的是希望能够在这个对象被垃圾回收器之前收到系统通知。</li></ol><p>内存溢出和内存泄漏</p><ol><li><strong>内存溢出</strong>：通俗理解就是<strong>内存不够</strong>，程序所需要的内存远远超出了你虚拟机分配的内存大小</li><li><strong>内存泄露</strong>：动态分配的内存空间使用完毕之后未回收</li></ol><p>内存溢出了怎么办？</p><p>​    通过内存映像工具如jhat,jconsole等对dump出来的堆转存储快照进行分析，确认内存是出现内存泄露还是内存溢出。</p><ul><li>如果是<strong>内存泄露</strong>进一步使用工具查看泄露的对象到GC Roots的引用链。于是就能找到泄露对象是通过怎样的路径与GC Roots相关联并导致垃圾收集器无法自动回收它们。掌握泄露对象的信息，以及GC Roots引用链的信息，就可以比较准确定位泄露代码的位置。 </li><li>如果是<strong>内存溢出</strong>，那就需要通过jinfo，Jconsole等工具分析java堆参数与机器物理内存对比是否还可以调大，从代码上检查是否存在某些对象生命周期过长，持有状态过长的情况，尝试减少程序的运行消耗。</li></ul><p>Java 中有内存泄露吗？</p><ol><li><strong>长生命周期</strong>的对象持有<strong>短生命周期对象</strong>的引用就很可能发生内存泄露，尽管短生命周期对象已经不再需要，但是因为长生命周期对象持有它的引用而导致不能被回收，例如缓存系统中，加载了一个对象放在缓存中，然后一直不再使用它，造成内存泄露。</li><li>如果一个外部类的实例对象的方法返回了一个内部类的实例对象，这个内部类对象被长期引用了，即使那个外部类实例对象不再被使用，也不会被垃圾回收，造成内存泄露。 </li></ol><p>GC的三种收集方法</p><ol><li><strong>标记清理</strong>：首先标记所有需要回收的对象，在标记完成后<strong>统一回收掉</strong>所有被标记的对象，它的标记的对象。缺点是<strong>效率低</strong>，且存在<strong>内存碎片</strong>。主要用于老生代垃圾回收。 </li><li><strong>复制算法</strong>：将内存按容量划分为大小相等的一块，每次只用其中一块。当内存用完了，将还存活的对象复制到另一块内存，然后把已使用过的内存空间一次清理掉。实现简单，高效。一般用于新生代。一般是将内存分为一块较大的Eden空间和两块较小的Survivor空间。HotSpot虚拟机默认比例是8:1,。每次使用Eden和一块Survivor，当回收时将这两块内存中还存活的对象复制到Survivor然后清理掉刚才Eden和Survivor的空间。如果复制过程内存不够使用则向老年代分配担保。</li><li><strong>标记整理</strong>：首先标记所有需要回收的对象，在标记完成后让所有存活的对象都向一端移动，然后直接清理掉端边界意外的内存。用于老年代。 </li></ol><p>JVM 加载 class 文件的原理机制</p><ul><li>类加载的五个过程：加载、验证、准备、解析、初始化。</li><li>类加载器把类的 .class 文件中的数据读入到内存中，然后进入连接阶段，这一阶段包括验证(确保class文件对JVM合法)、准备(为静态变量分配内存并设置默认的初始值)和解析(将常量池的符号引用替换为直接引用)三个步骤。最后 JVM 对类进行初始化，包括：初始化直接父类，执行类中的构造方法。</li></ul><p>Student s= new Student(),在内存中做了那些事情</p><ol><li>加载Student.class 文件进内存</li><li>在栈内存为s开辟空间</li><li>在堆内存为Student对象开辟空间</li><li>学生对象的成员变量进行显示初始化</li><li>通过构造方法对学生对象变量赋值</li><li>学生对象初始完毕，把对象地址赋值给s变量</li></ol><h2 id="JVM常用参数配置"><a href="#JVM常用参数配置" class="headerlink" title="JVM常用参数配置"></a>JVM常用参数配置</h2><ul><li>-Xms ：表示初始堆大小,默认为物理内存的1/64(&lt;1GB)，默认空余堆内存小于40%时，JVM就会增大堆直到-Xmx的最大限制.</li><li>-Xmx :最大堆大小,物理内存的1/4(&lt;1GB),(MaxHeapFreeRatio参数可以调整)空余堆内存大于70%时，JVM会减少堆直到 -Xms的最小限制</li><li>-Xmn ：年轻代大小(1.4or lator),注意：此处的大小是（eden+ 2 survivor space).与jmap -heap中显示的New gen是不同的整个堆大小=年轻代大小 + 年老代大小 + 持久代大小.增大年轻代后,将会减小年老代大小.此值对系统性能影响较大,Sun官方推荐配置为整个堆的3/8</li><li>-XX:NewSize :设置年轻代大小(for 1.3/1.4)</li><li>-XX:MaxNewSize :年轻代最大值(for 1.3/1.4)</li><li>-XX:PermSize 设置持久代(perm gen)初始值，物理内存的1/64</li><li>-XX:MaxPermSize ：设置持久代最大值，物理内存的1/4 </li></ul><hr><h1 id="第五章-数据库"><a href="#第五章-数据库" class="headerlink" title="第五章 数据库"></a>第五章 数据库</h1><h2 id="存储引擎的区别"><a href="#存储引擎的区别" class="headerlink" title="存储引擎的区别"></a>存储引擎的区别</h2><p><strong>InnoDB</strong>: 支持事务，是面向在线事务处理(OLTP)的应用,特点是<strong>行锁设计</strong>，支持外键，并支持一致性非锁定读，即默认情况下读取操作不会产生锁．是默认的<strong>存储引擎</strong>:．还提供了插入缓冲，二次写，自适应哈希索引，预读等高性能和高可用的功能． </p><p><strong>MyISAM</strong>: 不支持事务，是表锁设计和支持全文索引，主要面向一些OLAP的数据库应用.它的缓冲池只缓冲索引文件，而不缓冲数据文件．该存储引擎表由MYD和MYI组成，MYD用来存放数据文件，MYI用来存放索引文件.</p><p> <strong>NDB</strong>:是一个集群存储引擎，其特点是数据全部放在内存中，因此主键查找速度极快，并通过添加NDB数据库存储节点可以线性提高数据库性能，是高可用，高性能的集群系统． </p><p><strong>Memory</strong>: 将表中的数据存放在内存中，如果数据库重启或发生崩溃，表中的数据库都将消失，它非常适合存储临时数据的临时表．默认采用哈希索引． </p><p><strong>Archive</strong>: 只支持INSERT和SELECT操作，使用zlib算法将数据行进行压缩，压缩比可以达到1:10，非常适合存储归档数据.但其本身不是事务安全的存储引擎，其设计目标是提供高速的插入和压缩功能． </p><p><strong>Federated</strong>: 并不存放数据，它只是指向一台远程MySQL数据库服务器上的表. </p><p><strong>Maria存储引擎</strong>:　设计目标主要是用来取代原有的MyISAM存储引擎．</p><h2 id="MyISAM和InnoDB的区别"><a href="#MyISAM和InnoDB的区别" class="headerlink" title="MyISAM和InnoDB的区别"></a>MyISAM和InnoDB的区别</h2><ol><li>MyISAM是非事务安全型的，而InnoDB是事务安全型的。</li><li>MyISAM锁的粒度是表级，而InnoDB支持行级锁定。</li><li>MyISAM支持全文索引，而Innodb不支持全文索引</li><li>MyISAM表是保存成文件形式的，在跨平台的数据转移中使用MyISAM存储会省去不少的麻烦。</li><li>InnoDB表比MyISAM表更安全，可以保证数据不丢失的情况下，切换非事务表到事务表</li></ol><h3 id="sql注入原理"><a href="#sql注入原理" class="headerlink" title="sql注入原理"></a>sql注入原理</h3><ul><li>在用户传递的参数中插入SQL命令，最终达到欺骗服务器执行恶意的SQL命令。</li><li>防注入：限制字符长度，对特殊字符转义。 后台不要使用动态拼装SQL，可以使用参数化的SQL或者直接使用存储过程进行数据查询存取。 不要使用root权限建立数据库连接。重要信息加密存储。 数据库异常信息不应暴露给用户。</li></ul><h2 id="数据库索引"><a href="#数据库索引" class="headerlink" title="数据库索引"></a>数据库索引</h2><p>索引是一个单独存储在磁盘上的数据库结构，它们包含着对数据表里所有记录的引用指针，使用索引可以提高数据库特定数据的查询速度.索引时在存储引擎中实现的，因此每种存储引擎的索引不一定完全相同,并且每种存储引擎也不一定支持所有索引类型．</p><p>索引的存储类型有两种：BTREE和HASH,具体和表的存储引擎有关．MyISAM和InnoDB存储引擎只支持BTREE;MEMORY/HEAD存储索引可以支持HASH和BTREE索引． <strong>索引的优点</strong>:</p><ol><li>通过创建唯一索引，可以保证数据库表中每行数据的唯一性.</li><li>可以加快数据的查询速度．</li><li>在实现数据的参考完整性方面，可以加速表和表之间的连接．</li><li>再使用分组和排序子句进行数据检索时，同样可以显著减少查询中分组和排序的时间</li><li>通过使用索引，可以在查询中使用优化隐藏器，提高系统的性能。</li></ol><p><strong>索引的缺点</strong>：</p><ol><li>创建索引和维护索引要耗费时间，并且随着数据量的增加耗费时间也增加．</li><li>索引需要占空间内存．</li><li>在对表中数据进行增加,删除和修改的时候，索引也需要动态维护，这样降低了数据维护速度．</li></ol><p><strong>索引分类</strong></p><ol><li>普通索引和唯一索引</li><li>直接创建索引和间接创建索引</li><li>普通索引和唯一性索引</li><li>单个索引和符合索引</li><li>聚簇索引和非聚簇索引</li></ol><p><strong>索引失效</strong>？？</p><ol><li>WHERE字句的查询条件里有不等于号（WHERE column!=…），MYSQL将无法使用索引</li><li>如果WHERE字句的查询条件里使用了函数（如：WHERE DAY(column)=…），MYSQL将无法使用索引</li><li>在JOIN操作中（需要从多个数据表提取数据时），MYSQL只有在主键和外键的数据类型相同时才能使用索引，否则即使建立了索引也不会使用。</li><li>如果WHERE子句的查询条件里使用了比较操作符LIKE和REGEXP，MYSQL只有在搜索模板的第一个字符不是通配符的情况下才能使用索引。比如说，如果查询条件是LIKE ‘abc%’,MYSQL将使用索引；如果条件是LIKE ‘%abc’，MYSQL将不使用索引。</li><li>在ORDER BY操作中，MYSQL只有在排序条件不是一个查询条件表达式的情况下才使用索引。尽管如此，在涉及多个数据表的查询里，即使有索引可用，那些索引在加快ORDER BY操作方面也没什么作用。</li><li>如果某个数据列里包含着许多重复的值，就算为它建立了索引也不会有很好的效果。比如说，如果某个数据列里包含了净是些诸如“0/1”或“Y/N”等值，就没有必要为它创建一个索引。</li><li>如果条件中有or(并且其中有or的条件是不带索引的)，即使其中有条件带索引也不会使用(这也是为什么尽量少用or的原因)。注意：要想使用or，又想让索引生效，只能将or条件中的每个列都加上索引。</li><li>如果列类型是字符串，那一定要在条件中将数据使用引号引用起来,否则不使用索引。</li><li>如果mysql估计使用全表扫描要比使用索引快,则不使用索引。</li></ol><h2 id="数据库锁机制"><a href="#数据库锁机制" class="headerlink" title="数据库锁机制"></a>数据库锁机制</h2><p>数据库锁定机制简单来说就是数据库为了保证数据的一致性而使各种共享资源在被并发访问，访问变得有序所设计的一种规则。MySQL各存储引擎使用了三种类型（级别）的锁定机制：行级锁定，页级锁定和表级锁定。MySQL数据库中，使用表级锁定的主要是MyISAM，Memory，CSV等一些非事务性存储引擎，而使用行级锁定的主要是Innodb存储引擎和NDBCluster存储引擎，页级锁定主要是BerkeleyDB存储引擎的锁定方式。</p><ul><li>表级锁定（table-level）：表级别的锁定是MySQL各存储引擎中最大颗粒度的锁定机制。该锁定机制最大的特点是实现逻辑非常简单，带来的系统负面影响最小。所以获取锁和释放锁的速度很快。由于表级锁一次会将整个表锁定，所以可以很好的避免困扰我们的死锁问题。当然，锁定颗粒度大所带来最大的负面影响就是出现锁定资源争用的概率也会最高，致使并大度大打折扣。表级锁分为读锁和写锁。</li><li>页级锁定（page-level）：页级锁定的特点是锁定颗粒度介于行级锁定与表级锁之间，所以获取锁定所需要的资源开销，以及所能提供的并发处理能力也同样是介于上面二者之间。另外，页级锁定和行级锁定一样，会发生死锁。</li><li>行级锁定（row-level）：行级锁定最大的特点就是锁定对象的颗粒度很小，也是目前各大数据库管理软件所实现的锁定颗粒度最小的。由于锁定颗粒度很小，所以发生锁定资源争用的概率也最小，能够给予应用程序尽可能大的并发处理能力而提高一些需要高并发应用系统的整体性能。虽然能够在并发处理能力上面有较大的优势，但是行级锁定也因此带来了不少弊端。由于锁定资源的颗粒度很小，所以每次获取锁和释放锁需要做的事情也更多，带来的消耗自然也就更大了。此外，行级锁定也最容易发生死锁。InnoDB的行级锁同样分为两种，共享锁和排他锁，同样InnoDB也引入了意向锁（表级锁）的概念，所以也就有了意向共享锁和意向排他锁，所以InnoDB实际上有四种锁，即共享锁（S）、排他锁（X）、意向共享锁（IS）、意向排他锁（IX）；</li><li>MyISAM 表锁优化建议： 1、缩短锁定时间 2、分离能并行的操作 3、合理利用读写优先级</li></ul><p><strong>悲观锁</strong>:它指的是对数据被外界（包括本系统当前的其他事务，以及来自外部系统的事务处理）修改持保守态度，因此，在整个数据处理过程中，将数据处于锁定状态。悲观锁的实现，往往依靠数据库提供的锁机制。悲观的缺陷是不论是页锁还是行锁，加锁的时间可能会很长，这样可能会长时间的限制其他用户的访问，也就是说悲观锁的并发访问性不好。</p><p> <strong>乐观锁（ Optimistic Locking ）</strong> :相对悲观锁而言，乐观锁假设认为数据一般情况下不会造成冲突，所以在数据进行提交更新的时候，才会正式对数据的冲突与否进行检测，如果发现冲突了，则则拒绝更新并返回用户错误的信息，让用户决定如何去做。乐观锁由程序实现，不会存在死锁问题。它适用的场景也相对乐观。但乐观锁不能解决脏读的问题</p><p>悲观锁：假定会发生并发冲突，屏蔽一切可能违反数据完整性的操作。 乐观锁：假设不会发生并发冲突，只在提交操作时检查是否违反数据完整性。 乐观锁不能解决脏读的问题。</p><h2 id="数据库连接池原理"><a href="#数据库连接池原理" class="headerlink" title="数据库连接池原理"></a>数据库连接池原理</h2><p><strong>背景</strong></p><p>数据库连接的创建和关闭需要一定的开销，频繁的建立、关闭数据库，增大系统开销，另外还必须管理每一个连接，以确保他们能正确关闭，否则会导致内存溢出。</p><p><strong>原理</strong></p><p>数据库连接池的基本思想就是为数据库连接建立一个“缓冲池”。预先在缓冲池中放入一定数量的连接，当需要建立数据库连接时，只需从“缓冲池”中取出一个，使用完毕之后再放回去。以及一套连接使用、分配、管理策略，使得该连接池中的连接可以得到高效、安全的复用，避免了数据库连接频繁建立、关闭的开销。我</p><hr><h1 id="第六章-框架和组件"><a href="#第六章-框架和组件" class="headerlink" title="第六章 框架和组件"></a>第六章 框架和组件</h1><h2 id="6-1-spring"><a href="#6-1-spring" class="headerlink" title="6.1 spring"></a>6.1 spring</h2><p><strong>Spring优点</strong></p><ul><li><strong>轻量级</strong>：Spring在大小和透明性方面绝对属于轻量级的，基础版本的Spring框架大约只有2MB。</li><li><strong>控制反转(IOC)</strong>：Spring使用控制反转技术实现了松耦合。依赖被注入到对象，而不是创建或寻找依赖对象。 </li><li><strong>面向切面编程(AOP)</strong>： Spring支持面向切面编程，同时把应用的<strong>业务逻辑与系统的服务分离开来</strong>。</li><li><strong>容器</strong>：Spring包含并管理应用程序对象的配置及生命周期。</li><li><strong>MVC框架</strong>：Spring的web框架是一个设计优良的web MVC框架，很好的取代了一些web框架。</li><li><strong>事务管理</strong>：Spring对下至本地业务上至全局业务(JAT)提供了统一的事务管理接口。</li><li><strong>异常处理</strong>：Spring提供一个方便的API将特定技术的异常(由JDBC, Hibernate, 或JDO抛出)转化为一致的、Unchecked异常。</li></ul><p><strong>Spring框架模块</strong></p><p> <strong>核心容器模块</strong>：是spring中最核心的模块。负责Bean的创建，配置和管理。主要包括：beans, core, context, expression等模块。 <strong>AOP模块</strong>：主要负责对面向切面编程的支持，帮助应用对象解耦。 <strong>数据访问和集成模块</strong>：包括JDBC，ORM，OXM，JMS和事务处理模块。<strong>Web和远程调用</strong>：包括web,servlet,struts,portlet模块。 <strong>测试模块</strong>, <strong>工具模块</strong> <strong>消息模块</strong></p><ul><li><p>什么是控制反转(IOC)？什么是依赖注入？</p><p>传统模式中对象的调用者需要创建被调用对象，两个对象过于耦合，不利于变化和拓展．在spring中，直接操控的对象的调用权交给容器，通过容器来实现对象组件的装配和管理，从而实现对象之间的松耦合。所谓的“控制反转”概念就是对组件对象控制权的转移，从程序代码本身转移到了外部容器。 <strong>依赖注入</strong>：对象无需自行创建或管理它们的依赖关系，IoC容器在运行期间，动态地将某种依赖关系注入到对象之中。依赖注入能让相互协作的软件组件保持松散耦合。</p></li><li><p>BeanFactory和ApplicationContext有什么区别？</p><p>Bean工厂(BeanFactory)是Spring框架最核心的接口，提供了高级Ioc的配置机制．应用上下文(ApplicationContext)建立在BeanFacotry基础之上，提供了更多面向应用的功能，如果国际化，属性编辑器，事件等等．beanFactory是spring框架的基础设施，是面向spring本身，ApplicationContext是面向使用Spring框架的开发者，几乎所有场合都会用到ApplicationContext.</p></li><li><p>Spring有几种配置方式？</p><ol><li>基于XML的配置</li><li>基于注解的配置，可以用注解的方式来替代XML方式对bean描述，可以将bean描述转移到组件类的内部，只需要在相关类上、方法上或者字段声明上使用注解即可。</li><li>基于Java的配置：由@Configuration注解和@Bean注解来实现的。由@Bean注解的方法将会实例化、配置和初始化一个新对象，这个对象将由Spring的IoC容器来管理。@Bean声明所起到的作用与 元素类似。被@Configuration所注解的类则表示这个类的主要目的是作为bean定义的资源。被@Configuration声明的类可以通过在同一个类的内部调用@bean方法来设置嵌入bean的依赖关系。</li></ol></li></ul><ul><li><p>Spring Bean的作用域之间有什么区别</p><p>singleton：这种bean范围是默认的，这种范围确保不管接受到多少个请求，每个容器中只有一个bean的实例，单例的模式由bean factory自身来维护。</p><p> prototype：原形范围与单例范围相反，为每一个bean请求提供一个实例。 </p><p>request：在请求bean范围内会每一个来自客户端的网络请求创建一个实例，在请求完成以后，bean会失效并被垃圾回收器回收。 </p><p>Session：与请求范围类似，确保每个session中有一个bean的实例，在session过期后，bean会随之失效。 global-session：global-session和Portlet应用相关。当你的应用部署在Portlet容器中工作时，它包含很多portlet。如果你想要声明让所有的portlet共用全局的存储变量的话，那么这全局变量需要存储在global-session中。</p></li></ul><ul><li><p>Spring 框架中都用到了哪些设计模式</p><ol><li><strong>代理模式</strong>—在AOP和remoting中被用的比较多。</li><li><strong>单例模式</strong>—在spring配置文件中定义的bean默认为单例模式。 </li><li><strong>模板方法</strong>—用来解决代码重复的问题 比如. RestTemplate, JmsTemplate, JpaTemplate。 前端控制器—Srping提供了DispatcherServlet来对请求进行分发。 视图帮助(View Helper )—Spring提供了一系列的JSP标签，高效宏来辅助将分散的代码整合在视图里。 依赖注入—贯穿于BeanFactory  /  ApplicationContext 接口的核心理念。 </li><li><strong>工厂模式</strong>—BeanFactory用来创建对象的实例。 </li><li><strong>Builder模式</strong> - 自定义配置文件的解析bean是时采用builder模式，一步一步地构建一个beanDefinition </li><li><strong>策略模式</strong> ：Spring 中策略模式使用有多个地方，如 Bean 定义对象的创建以及代理对象的创建等。这里主要看一下代理对象创建的策略模式的实现。 </li></ol></li><li><p>AOP是怎么实现的</p><p>实现AOP的技术，主要分为两大类：</p><ol><li>动态代理技术，利用截取消息的方式，对该消息进行装饰，以取代原有对象行为的执行；</li><li>静态织入的方式，引入特定的语法创建“方面”，从而使得编译器可以在编译期间织入有关“方面”的代码。</li></ol></li></ul><ul><li>springMVC流程具体叙述下<ol><li>应用启动时,容器会加载servlet类并调用init方法. 在这个阶段，DispatcherServlet在init()完成初始化参数init-param的解析和封装,相关配置,spring的WebApplicationContext的初始化即完成xml文件的加载,bean的解析和注册等工作,另外为servlet功能所用的变量进行初始化,如:handlerMapping,viewResolvers等.</li><li>收到一个请求时，首先根据请求的类型调用DispatcherServlet不同的方法，这些方法都会转发到doService()中执行．根据request信息获取对应的Handler. 首先根据request获取访问路径,然后根据该路径URL匹配对应规则的Handler,调用Handler处理。</li></ol></li></ul><ul><li>ioc注入的方式</li></ul><p>1)setter方法注入 2)构造器注入3)静态工厂注入 factory-method参数 4)实例工厂 &lt;&gt;</p><ul><li>AOP相关概念<ol><li><strong>方面（Aspect）</strong>：一个关注点的模块化，这个关注点实现可能另外横切多个对象。事务管理是J2EE应用中一个很好的横切关注点例子。方面用Spring的 Advisor或拦截器实现。</li><li><strong>连接点（Joinpoint）</strong>: 程序执行过程中明确的点，如方法的调用或特定的异常被抛出。</li><li><strong>通知（Advice）:</strong> 在特定的连接点，AOP框架执行的动作。各种类型的通知包括“around”、“before”和“throws”通知。许多AOP框架包括Spring都是以拦截器做通知模型，维护一个“围绕”连接点的拦截器链。</li><li><strong>切入点（Pointcut）</strong>: 一系列连接点的集合。</li><li><strong>引入（Introduction）</strong>: 添加方法或字段到被通知的类。 Spring允许引入新的接口到任何被通知的对象。例如，你可以使用一个引入使任何对象实现 IsModified接口，来简化缓存。Spring中要使用Introduction, 可有通过DelegatingIntroductionInterceptor来实现通知，通过DefaultIntroductionAdvisor 来配置Advice和代理类要实现的接口 </li><li><strong>目标对象（Target Object）</strong>: 包含连接点的对象。也被称作被通知或被代理对象。POJO</li><li><strong>AOP代理（AOP Proxy）</strong>: AOP框架创建的对象，包含通知。 在Spring中，AOP代理可以是JDK动态代理或者CGLIB代理。</li><li><strong>织入（Weaving）</strong>: 组装方面来创建一个被通知对象。这可以在编译时完成（例如使用AspectJ编译器），也可以在运行时完成。Spring和其他纯Java AOP框架一样，在运行时完成织入。</li></ol></li></ul><ul><li><p>过滤器与监听器的区别</p><p>过滤器Filter，是一个变种servlet，无法直接返回给用户response，但是可以链式处理request、response。</p></li></ul><ul><li><p>Spring Beans</p><p>Spring Beans是构成Spring应用核心的Java对象。这些对象由Spring IOC容器实例化、组装、管理。这些对象通过容器中配置的元数据创建，例如，使用XML文件中定义的创建。 在Spring中创建的beans都是单例的beans。在bean标签中有一个属性为”singleton”,如果设为true，该bean是单例的，如果设为false，该bean是原型bean。Singleton属性默认设置为true。因此，spring框架中所有的bean都默认为单例bean。</p></li><li><p>Spring Bean中定义了什么内容？</p><p>Spring Bean中定义了所有的配置元数据，这些配置信息告知容器如何创建它，它的生命周期是什么以及它的依赖关系。</p></li></ul><h2 id="6-2-spring-MVC"><a href="#6-2-spring-MVC" class="headerlink" title="6.2 spring-MVC"></a>6.2 spring-MVC</h2><h2 id="6-3-Mybatis"><a href="#6-3-Mybatis" class="headerlink" title="6.3 Mybatis"></a>6.3 Mybatis</h2><h1 id="第七章-面试"><a href="#第七章-面试" class="headerlink" title="第七章 面试"></a>第七章 面试</h1><h2 id="7-1-语言基础"><a href="#7-1-语言基础" class="headerlink" title="7.1 语言基础"></a>7.1 语言基础</h2><h2 id="7-2-算法"><a href="#7-2-算法" class="headerlink" title="7.2 算法"></a>7.2 算法</h2><h2 id="7-3-项目"><a href="#7-3-项目" class="headerlink" title="7.3 项目"></a>7.3 项目</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;h2 id=&quot;在被虐中成长，在面试中进步&quot;&gt;&lt;a href=&quot;#在被虐中成长，在面试中进步&quot; class=&quot;headerlink&quot; title=
      
    
    </summary>
    
      <category term="学习" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="求职" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/"/>
    
      <category term="基础知识" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="Java" scheme="http://shuaiyy.cn/tags/Java/"/>
    
      <category term="求职" scheme="http://shuaiyy.cn/tags/%E6%B1%82%E8%81%8C/"/>
    
  </entry>
  
  <entry>
    <title>Python开发复习资料</title>
    <link href="http://shuaiyy.cn/2018/04/01/%E5%AD%A6%E4%B9%A0/%E6%89%BE%E5%B7%A5%E4%BD%9C/Python%E5%BC%80%E5%8F%91%E5%A4%8D%E4%B9%A0%E8%B5%84%E6%96%99/"/>
    <id>http://shuaiyy.cn/2018/04/01/学习/找工作/Python开发复习资料/</id>
    <published>2018-03-31T16:00:00.000Z</published>
    <updated>2018-11-27T10:25:01.651Z</updated>
    
    <content type="html"><![CDATA[<!-- markdown-toc start - Don't edit this section. Run M-x markdown-toc-generate-toc again --><p><strong>Table of Contents</strong></p><ul><li><a href="#python语言特性">Python语言特性</a><ul><li><a href="#1-python的函数参数传递">1 Python的函数参数传递</a></li><li><a href="#2-python中的元类metaclass">2 Python中的元类(metaclass)</a></li><li><a href="#3-staticmethod和classmethod">3 @staticmethod和@classmethod</a></li><li><a href="#4-类变量和实例变量">4 类变量和实例变量</a></li><li><a href="#5-python自省">5 Python自省</a></li><li><a href="#6-字典推导式">6 字典推导式</a></li><li><a href="#7-python中单下划线和双下划线">7 Python中单下划线和双下划线</a></li><li><a href="#8-字符串格式化和format">8 字符串格式化:\x和.format</a></li><li><a href="#9-迭代器和生成器">9 迭代器和生成器</a></li><li><a href="#10-args-and-kwargs">10 <em>args and <code>*</code></em>kwargs</a></li><li><a href="#11-面向切面编程aop和装饰器">11 面向切面编程AOP和装饰器</a></li><li><a href="#12-鸭子类型">12 鸭子类型</a></li><li><a href="#13-python中重载">13 Python中重载</a></li><li><a href="#14-新式类和旧式类">14 新式类和旧式类</a></li><li><a href="#15-__new__和__init__的区别">15 <strong>new</strong>和<code><strong>init</strong></code>的区别</a></li><li><a href="#16-单例模式">16 单例模式</a><ul><li><a href="#1-使用__new__方法">1 使用<strong>new</strong>方法</a></li><li><a href="#2-共享属性">2 共享属性</a></li><li><a href="#3-装饰器版本">3 装饰器版本</a></li><li><a href="#4-import方法">4 import方法</a></li></ul></li><li><a href="#17-python中的作用域">17 Python中的作用域</a></li><li><a href="#18-gil线程全局锁">18 GIL线程全局锁</a></li><li><a href="#19-协程">19 协程</a></li><li><a href="#20-闭包">20 闭包</a></li><li><a href="#21-lambda函数">21 lambda函数</a></li><li><a href="#22-python函数式编程">22 Python函数式编程</a></li><li><a href="#23-python里的拷贝">23 Python里的拷贝</a></li><li><a href="#24-python垃圾回收机制">24 Python垃圾回收机制</a><ul><li><a href="#1-引用计数">1 引用计数</a></li><li><a href="#2-标记-清除机制">2 标记-清除机制</a></li><li><a href="#3-分代技术">3 分代技术</a></li></ul></li><li><a href="#25-python的list">25 Python的List</a></li><li><a href="#26-python的is">26 Python的is</a></li><li><a href="#27-readreadline和readlines">27 read,readline和readlines</a></li><li><a href="#28-python2和3的区别">28 Python2和3的区别</a></li><li><a href="#29-super-init">29 super init</a></li><li><a href="#30-range-and-xrange">30 range and xrange</a></li></ul></li><li><a href="#操作系统">操作系统</a><ul><li><a href="#1-selectpoll和epoll">1 select,poll和epoll</a></li><li><a href="#2-调度算法">2 调度算法</a></li><li><a href="#3-死锁">3 死锁</a></li><li><a href="#4-程序编译与链接">4 程序编译与链接</a><ul><li><a href="#1-预处理">1 预处理</a></li><li><a href="#2-编译">2 编译</a></li><li><a href="#3-汇编">3 汇编</a></li><li><a href="#4-链接">4 链接</a></li></ul></li><li><a href="#5-静态链接和动态链接">5 静态链接和动态链接</a></li><li><a href="#6-虚拟内存技术">6 虚拟内存技术</a></li><li><a href="#7-分页和分段">7 分页和分段</a><ul><li><a href="#分页与分段的主要区别">分页与分段的主要区别</a></li></ul></li><li><a href="#8-页面置换算法">8 页面置换算法</a></li><li><a href="#9-边沿触发和水平触发">9 边沿触发和水平触发</a></li></ul></li><li><a href="#数据库">数据库</a><ul><li><a href="#1-事务">1 事务</a></li><li><a href="#2-数据库索引">2 数据库索引</a></li><li><a href="#3-redis原理">3 Redis原理</a><ul><li><a href="#redis是什么">Redis是什么？</a></li><li><a href="#redis数据库">Redis数据库</a></li><li><a href="#redis缺点">Redis缺点</a></li></ul></li><li><a href="#4-乐观锁和悲观锁">4 乐观锁和悲观锁</a></li><li><a href="#5-mvcc">5 MVCC</a><ul><li><a href="#mysql的innodb引擎是如何实现mvcc的"><a href="http://lib.csdn.net/base/mysql" target="_blank" rel="external">MySQL</a>的innodb引擎是如何实现MVCC的</a></li></ul></li><li><a href="#6-myisam和innodb">6 MyISAM和InnoDB</a></li></ul></li><li><a href="#网络">网络</a><ul><li><a href="#1-三次握手">1 三次握手</a></li><li><a href="#2-四次挥手">2 四次挥手</a></li><li><a href="#3-arp协议">3 ARP协议</a></li><li><a href="#4-urllib和urllib2的区别">4 urllib和urllib2的区别</a></li><li><a href="#5-post和get">5 Post和Get</a></li><li><a href="#6-cookie和session">6 Cookie和Session</a></li><li><a href="#7-apache和nginx的区别">7 apache和nginx的区别</a></li><li><a href="#8-网站用户密码保存">8 网站用户密码保存</a></li><li><a href="#9-http和https">9 HTTP和HTTPS</a></li><li><a href="#10-xsrf和xss">10 XSRF和XSS</a></li><li><a href="#11-幂等-idempotence">11 幂等 Idempotence</a></li><li><a href="#12-restful架构soaprpc">12 RESTful架构(SOAP,RPC)</a></li><li><a href="#13-soap">13 SOAP</a></li><li><a href="#14-rpc">14 RPC</a></li><li><a href="#15-cgi和wsgi">15 CGI和WSGI</a></li><li><a href="#16-中间人攻击">16 中间人攻击</a></li><li><a href="#17-c10k问题">17 c10k问题</a></li><li><a href="#18-socket">18 socket</a></li><li><a href="#19-浏览器缓存">19 浏览器缓存</a></li><li><a href="#20-http10和http11">20 HTTP1.0和HTTP1.1</a></li><li><a href="#21-ajax">21 Ajax</a></li></ul></li><li><a href="#nix">*NIX</a><ul><li><a href="#unix进程间通信方式ipc">unix进程间通信方式(IPC)</a></li></ul></li><li><a href="#数据结构">数据结构</a><ul><li><a href="#1-红黑树">1 红黑树</a></li></ul></li><li><a href="#编程题">编程题</a><ul><li><a href="#1-台阶问题斐波那契">1 台阶问题/斐波那契</a></li><li><a href="#2-变态台阶问题">2 变态台阶问题</a></li><li><a href="#3-矩形覆盖">3 矩形覆盖</a></li><li><a href="#4-杨氏矩阵查找">4 杨氏矩阵查找</a></li><li><a href="#5-去除列表中的重复元素">5 去除列表中的重复元素</a></li><li><a href="#6-链表成对调换">6 链表成对调换</a></li><li><a href="#7-创建字典的方法">7 创建字典的方法</a><ul><li><a href="#1-直接创建">1 直接创建</a></li><li><a href="#2-工厂方法">2 工厂方法</a></li><li><a href="#3-fromkeys方法">3 fromkeys()方法</a></li></ul></li><li><a href="#8-合并两个有序列表">8 合并两个有序列表</a></li><li><a href="#9-交叉链表求交点">9 交叉链表求交点</a></li><li><a href="#10-二分查找">10 二分查找</a></li><li><a href="#11-快排">11 快排</a></li><li><a href="#12-找零问题">12 找零问题</a></li><li><a href="#13-广度遍历和深度遍历二叉树">13 广度遍历和深度遍历二叉树</a></li><li><a href="#17-前中后序遍历">17 前中后序遍历</a></li><li><a href="#18-求最大树深">18 求最大树深</a></li><li><a href="#19-求两棵树是否相同">19 求两棵树是否相同</a></li><li><a href="#20-前序中序求后序">20 前序中序求后序</a></li><li><a href="#21-单链表逆置">21 单链表逆置</a></li><li><a href="#22-两个字符串是否是变位词">22 两个字符串是否是变位词</a></li><li><a href="#23-动态规划问题">23 动态规划问题</a></li></ul></li></ul><!-- markdown-toc end --><h1 id="Python语言特性"><a href="#Python语言特性" class="headerlink" title="Python语言特性"></a>Python语言特性</h1><h2 id="1-Python的函数参数传递"><a href="#1-Python的函数参数传递" class="headerlink" title="1 Python的函数参数传递"></a>1 Python的函数参数传递</h2><p>看两个例子:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">1</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(a)</span>:</span></div><div class="line">    a = <span class="number">2</span></div><div class="line">fun(a)</div><div class="line"><span class="keyword">print</span> a  <span class="comment"># 1</span></div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a = []</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(a)</span>:</span></div><div class="line">    a.append(<span class="number">1</span>)</div><div class="line">fun(a)</div><div class="line"><span class="keyword">print</span> a  <span class="comment"># [1]</span></div></pre></td></tr></table></figure><p>所有的变量都可以理解是内存中一个对象的“引用”，或者，也可以看似c中void*的感觉。</p><p>通过<code>id</code>来看引用<code>a</code>的内存地址可以比较理解：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">1</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(a)</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"func_in"</span>,id(a)   <span class="comment"># func_in 41322472</span></div><div class="line">    a = <span class="number">2</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"re-point"</span>,id(a), id(<span class="number">2</span>)   <span class="comment"># re-point 41322448 41322448</span></div><div class="line"><span class="keyword">print</span> <span class="string">"func_out"</span>,id(a), id(<span class="number">1</span>)  <span class="comment"># func_out 41322472 41322472</span></div><div class="line">fun(a)</div><div class="line"><span class="keyword">print</span> a  <span class="comment"># 1</span></div></pre></td></tr></table></figure><p>注：具体的值在不同电脑上运行时可能不同。</p><p>可以看到，在执行完<code>a = 2</code>之后，<code>a</code>引用中保存的值，即内存地址发生变化，由原来<code>1</code>对象的所在的地址变成了<code>2</code>这个实体对象的内存地址。</p><p>而第2个例子<code>a</code>引用保存的内存值就不会发生变化：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">a = []</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(a)</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"func_in"</span>,id(a)  <span class="comment"># func_in 53629256</span></div><div class="line">    a.append(<span class="number">1</span>)</div><div class="line"><span class="keyword">print</span> <span class="string">"func_out"</span>,id(a)     <span class="comment"># func_out 53629256</span></div><div class="line">fun(a)</div><div class="line"><span class="keyword">print</span> a  <span class="comment"># [1]</span></div></pre></td></tr></table></figure><p>这里记住的是类型是属于对象的，而不是变量。而对象有两种,“可更改”（mutable）与“不可更改”（immutable）对象。在python中，strings, tuples, 和numbers是不可更改的对象，而 list, dict, set 等则是可以修改的对象。(这就是这个问题的重点)</p><p>当一个引用传递给函数的时候,函数自动复制一份引用,这个函数里的引用和外边的引用没有半毛关系了.所以第一个例子里函数把引用指向了一个不可变对象,当函数返回的时候,外面的引用没半毛感觉.而第二个例子就不一样了,函数内的引用指向的是可变对象,对它的操作就和定位了指针地址一样,在内存里进行修改.</p><h2 id="2-Python中的元类-metaclass"><a href="#2-Python中的元类-metaclass" class="headerlink" title="2 Python中的元类(metaclass)"></a>2 Python中的元类(metaclass)</h2><p>这个非常的不常用,但是像ORM这种复杂的结构还是会需要的,类是元类的实例，元类可以定义类的行为。</p><h2 id="3-staticmethod和-classmethod"><a href="#3-staticmethod和-classmethod" class="headerlink" title="3 @staticmethod和@classmethod"></a>3 @staticmethod和@classmethod</h2><p>Python其实有3个方法,即静态方法(staticmethod),类方法(classmethod)和实例方法,如下:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"executing foo(%s)"</span>%(x)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(self,x)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"executing foo(%s,%s)"</span>%(self,x)</div><div class="line"></div><div class="line"><span class="meta">    @classmethod</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">class_foo</span><span class="params">(cls,x)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"executing class_foo(%s,%s)"</span>%(cls,x)</div><div class="line"></div><div class="line"><span class="meta">    @staticmethod</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">static_foo</span><span class="params">(x)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"executing static_foo(%s)"</span>%x</div><div class="line"></div><div class="line">a=A()</div></pre></td></tr></table></figure><p>这里先理解下函数参数里面的self和cls.这个self和cls是对类或者实例的绑定,对于一般的函数来说我们可以这么调用<code>foo(x)</code>,这个函数就是最常用的,它的工作跟任何东西(类,实例)无关.对于实例方法,我们知道在类里每次定义方法的时候都需要绑定这个实例,就是<code>foo(self, x)</code>,为什么要这么做呢?因为实例方法的调用离不开实例,我们需要把实例自己传给函数,调用的时候是这样的<code>a.foo(x)</code>(其实是<code>foo(a, x)</code>).类方法一样,只不过它传递的是类而不是实例,<code>A.class_foo(x)</code>.注意这里的self和cls可以替换别的参数,但是python的约定是这俩,还是不要改的好.</p><p>对于静态方法其实和普通的方法一样,不需要对谁进行绑定,唯一的区别是调用的时候需要使用<code>a.static_foo(x)</code>或者<code>A.static_foo(x)</code>来调用.</p><table><thead><tr><th style="text-align:left">\</th><th style="text-align:left">实例方法</th><th style="text-align:left">类方法</th><th style="text-align:left">静态方法</th></tr></thead><tbody><tr><td style="text-align:left">a = A()</td><td style="text-align:left">a.foo(x)</td><td style="text-align:left">a.class_foo(x)</td><td style="text-align:left">a.static_foo(x)</td></tr><tr><td style="text-align:left">A</td><td style="text-align:left">不可用</td><td style="text-align:left">A.class_foo(x)</td><td style="text-align:left">A.static_foo(x)</td></tr></tbody></table><h2 id="4-类变量和实例变量"><a href="#4-类变量和实例变量" class="headerlink" title="4 类变量和实例变量"></a>4 类变量和实例变量</h2><p><strong>类变量：</strong></p><blockquote><p>​    是可在类的所有实例之间共享的值（也就是说，它们不是单独分配给每个实例的）。例如下例中，num_of_instance 就是类变量，用于跟踪存在着多少个Test 的实例。</p></blockquote><p><strong>实例变量：</strong></p><blockquote><p>实例化之后，每个实例单独拥有的变量。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span><span class="params">(object)</span>:</span>  </div><div class="line">    num_of_instance = <span class="number">0</span>  </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span>  </div><div class="line">        self.name = name  </div><div class="line">        Test.num_of_instance += <span class="number">1</span>  </div><div class="line">  </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:  </div><div class="line">    <span class="keyword">print</span> Test.num_of_instance   <span class="comment"># 0</span></div><div class="line">    t1 = Test(<span class="string">'jack'</span>)  </div><div class="line">    <span class="keyword">print</span> Test.num_of_instance   <span class="comment"># 1</span></div><div class="line">    t2 = Test(<span class="string">'lucy'</span>)  </div><div class="line">    <span class="keyword">print</span> t1.name , t1.num_of_instance  <span class="comment"># jack 2</span></div><div class="line">    <span class="keyword">print</span> t2.name , t2.num_of_instance  <span class="comment"># lucy 2</span></div></pre></td></tr></table></figure><blockquote><p>补充的例子</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></div><div class="line">    name=<span class="string">"aaa"</span></div><div class="line"></div><div class="line">p1=Person()</div><div class="line">p2=Person()</div><div class="line">p1.name=<span class="string">"bbb"</span></div><div class="line"><span class="keyword">print</span> p1.name  <span class="comment"># bbb</span></div><div class="line"><span class="keyword">print</span> p2.name  <span class="comment"># aaa</span></div><div class="line"><span class="keyword">print</span> Person.name  <span class="comment"># aaa</span></div></pre></td></tr></table></figure><p>这里<code>p1.name=&quot;bbb&quot;</code>是实例调用了类变量,这其实和上面第一个问题一样,就是函数传参的问题,<code>p1.name</code>一开始是指向的类变量<code>name=&quot;aaa&quot;</code>,但是在实例的作用域里把类变量的引用改变了,就变成了一个实例变量,self.name不再引用Person的类变量name了.</p><p>可以看看下面的例子:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></div><div class="line">    name=[]</div><div class="line"></div><div class="line">p1=Person()</div><div class="line">p2=Person()</div><div class="line">p1.name.append(<span class="number">1</span>)</div><div class="line"><span class="keyword">print</span> p1.name  <span class="comment"># [1]</span></div><div class="line"><span class="keyword">print</span> p2.name  <span class="comment"># [1]</span></div><div class="line"><span class="keyword">print</span> Person.name  <span class="comment"># [1]</span></div></pre></td></tr></table></figure><h2 id="5-Python自省"><a href="#5-Python自省" class="headerlink" title="5 Python自省"></a>5 Python自省</h2><p>这个也是python彪悍的特性.</p><p>自省就是面向对象的语言所写的程序在运行时,所能知道对象的类型.简单一句就是运行时能够获得对象的类型.比如type(),dir(),getattr(),hasattr(),isinstance().</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</div><div class="line">b = &#123;<span class="string">'a'</span>:<span class="number">1</span>,<span class="string">'b'</span>:<span class="number">2</span>,<span class="string">'c'</span>:<span class="number">3</span>&#125;</div><div class="line">c = <span class="keyword">True</span></div><div class="line"><span class="keyword">print</span> type(a),type(b),type(c) <span class="comment"># &lt;type 'list'&gt; &lt;type 'dict'&gt; &lt;type 'bool'&gt;</span></div><div class="line"><span class="keyword">print</span> isinstance(a,list)  <span class="comment"># True</span></div></pre></td></tr></table></figure><h2 id="6-字典推导式"><a href="#6-字典推导式" class="headerlink" title="6 字典推导式"></a>6 字典推导式</h2><p>可能你见过列表推导时,却没有见过字典推导式,在2.7中才加入的:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d = &#123;key: value <span class="keyword">for</span> (key, value) <span class="keyword">in</span> iterable&#125;</div></pre></td></tr></table></figure><h2 id="7-Python中单下划线和双下划线"><a href="#7-Python中单下划线和双下划线" class="headerlink" title="7 Python中单下划线和双下划线"></a>7 Python中单下划线和双下划线</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">()</span>:</span></div><div class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line"><span class="meta">... </span>            self.__superprivate = <span class="string">"Hello"</span></div><div class="line"><span class="meta">... </span>            self._semiprivate = <span class="string">", world!"</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mc = MyClass()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> mc.__superprivate</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">AttributeError: myClass instance has no attribute <span class="string">'__superprivate'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> mc._semiprivate</div><div class="line">, world!</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> mc.__dict__</div><div class="line">&#123;<span class="string">'_MyClass__superprivate'</span>: <span class="string">'Hello'</span>, <span class="string">'_semiprivate'</span>: <span class="string">', world!'</span>&#125;</div></pre></td></tr></table></figure><p><code>__foo__</code>:一种约定,Python内部的名字,用来区别其他用户自定义的命名,以防冲突，就是例如<code>__init__()</code>,<code>__del__()</code>,<code>__call__()</code>这些特殊方法</p><p><code>_foo</code>:一种约定,用来指定变量私有.程序员用来指定私有变量的一种方式.不能用from module import * 导入，其他方面和公有一样访问；</p><p><code>__foo</code>:这个有真正的意义:解析器用<code>_classname__foo</code>来代替这个名字,以区别和其他类相同的命名,它无法直接像公有成员一样随便访问,通过对象名._类名__xxx这样的方式可以访问.</p><h2 id="8-字符串格式化-和-format"><a href="#8-字符串格式化-和-format" class="headerlink" title="8 字符串格式化:%和.format"></a>8 字符串格式化:%和.format</h2><p>.format在许多方面看起来更便利.对于<code>%</code>最烦人的是它无法同时传递一个变量和元组.你可能会想下面的代码不会有什么问题:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;hi there %s&quot; % name</div></pre></td></tr></table></figure><p>但是,如果name恰好是(1,2,3),它将会抛出一个TypeError异常.为了保证它总是正确的,你必须这样做:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">"hi there %s"</span> % (name,)   <span class="comment"># 提供一个单元素的数组而不是一个参数</span></div><div class="line"><span class="string">"hi there &#123;1&#125; &#123;2&#125; &#123;0&#125;"</span>.format(<span class="string">"str0"</span>, <span class="string">"str1"</span>, <span class="string">"str2"</span>)</div><div class="line"><span class="string">"hi there &#123;name&#125; "</span>.format(name=name,)</div></pre></td></tr></table></figure><p>但是有点丑..format就没有这些问题。format的参数可以指定顺序或命名.</p><p>你为什么不用它?</p><ul><li>不知道它(在读这个之前)</li><li>为了和Python2.5兼容(譬如logging库建议使用<code>%</code>(<a href="https://github.com/taizilongxu/interview_python/issues/4" target="_blank" rel="external">issue #4</a>))</li></ul><h2 id="9-迭代器和生成器"><a href="#9-迭代器和生成器" class="headerlink" title="9 迭代器和生成器"></a>9 迭代器和生成器</h2><p>这里有个关于生成器的创建问题面试官有考：<br>问：  将列表生成式中[]改成() 之后数据结构是否改变？<br>答案：是，从列表变为生成器</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>L = [x*x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>L</div><div class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>, <span class="number">36</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">81</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>g = (x*x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>g</div><div class="line">&lt;generator object &lt;genexpr&gt; at <span class="number">0x0000028F8B774200</span>&gt;</div></pre></td></tr></table></figure><p>通过列表生成式，可以直接创建一个列表。但是，受到内存限制，列表容量肯定是有限的。而且，创建一个包含百万元素的列表，不仅是占用很大的内存空间，如：我们只需要访问前面的几个元素，后面大部分元素所占的空间都是浪费的。因此，没有必要创建完整的列表（节省大量内存空间）。在Python中，我们可以采用生成器：边循环，边计算的机制—&gt;generator</p><h2 id="10-args-and-kwargs"><a href="#10-args-and-kwargs" class="headerlink" title="10 *args and **kwargs"></a>10 <code>*args</code> and <code>**kwargs</code></h2><p>用<code>*args</code>和<code>**kwargs</code>只是为了方便并没有强制使用它们.</p><p>当你不确定你的函数里将要传递多少参数时你可以用<code>*args</code>.例如,它可以传递任意数量的参数:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">print_everything</span><span class="params">(*args)</span>:</span></div><div class="line">        <span class="keyword">for</span> count, thing <span class="keyword">in</span> enumerate(args):</div><div class="line"><span class="meta">... </span>        <span class="keyword">print</span> <span class="string">'&#123;0&#125;. &#123;1&#125;'</span>.format(count, thing)</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print_everything(<span class="string">'apple'</span>, <span class="string">'banana'</span>, <span class="string">'cabbage'</span>)</div><div class="line"><span class="number">0.</span> apple</div><div class="line"><span class="number">1.</span> banana</div><div class="line"><span class="number">2.</span> cabbage</div></pre></td></tr></table></figure><p>相似的,<code>**kwargs</code>允许你使用没有事先定义的参数名:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">table_things</span><span class="params">(**kwargs)</span>:</span></div><div class="line"><span class="meta">... </span>    <span class="keyword">for</span> name, value <span class="keyword">in</span> kwargs.items():</div><div class="line"><span class="meta">... </span>        <span class="keyword">print</span> <span class="string">'&#123;0&#125; = &#123;1&#125;'</span>.format(name, value)</div></pre></td></tr></table></figure><p>你也可以混着用.命名参数首先获得参数值然后所有的其他参数都传递给<code>*args</code>和<code>**kwargs</code>.命名参数在列表的最前端.例如:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">def table_things(titlestring, **kwargs)</div></pre></td></tr></table></figure><p><code>*args</code>和<code>**kwargs</code>可以同时在函数的定义中,但是<code>*args</code>必须在<code>**kwargs</code>前面.</p><p>当调用函数时你也可以用<code>*</code>和<code>**</code>语法.例如:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">print_three_things</span><span class="params">(a, b, c)</span>:</span></div><div class="line"><span class="meta">... </span>    <span class="keyword">print</span> <span class="string">'a = &#123;0&#125;, b = &#123;1&#125;, c = &#123;2&#125;'</span>.format(a,b,c)</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mylist = [<span class="string">'aardvark'</span>, <span class="string">'baboon'</span>, <span class="string">'cat'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print_three_things(*mylist)</div></pre></td></tr></table></figure><p>就像你看到的一样,它可以传递列表(或者元组)的每一项并把它们解包.注意必须与它们在函数里的参数相吻合.当然,你也可以在函数定义或者函数调用时用*.</p><h2 id="11-面向切面编程AOP和装饰器"><a href="#11-面向切面编程AOP和装饰器" class="headerlink" title="11 面向切面编程AOP和装饰器"></a>11 面向切面编程AOP和装饰器</h2><p>装饰器是一个很著名的设计模式，经常被用于有切面需求的场景，较为经典的有插入日志、性能测试、事务处理等。装饰器是解决这类问题的绝佳设计，有了装饰器，我们就可以抽离出大量函数中与函数功能本身无关的雷同代码并继续重用。概括的讲，<strong>装饰器的作用就是为已经存在的对象添加额外的功能。</strong></p><h2 id="12-鸭子类型"><a href="#12-鸭子类型" class="headerlink" title="12 鸭子类型"></a>12 鸭子类型</h2><p>“当看到一只鸟走起来像鸭子、游泳起来像鸭子、叫起来也像鸭子，那么这只鸟就可以被称为鸭子。”</p><p>我们并不关心对象是什么类型，到底是不是鸭子，只关心行为。</p><p>比如在python中，有很多file-like的东西，比如StringIO,GzipFile,socket。它们有很多相同的方法，我们把它们当作文件使用。</p><p>又比如list.extend()方法中,我们并不关心它的参数是不是list,只要它是可迭代的,所以它的参数可以是list/tuple/dict/字符串/生成器等.</p><p>鸭子类型在动态语言中经常使用，非常灵活，使得python不想java那样专门去弄一大堆的设计模式。</p><h2 id="13-Python中重载"><a href="#13-Python中重载" class="headerlink" title="13 Python中重载"></a>13 Python中重载</h2><p>函数重载主要是为了解决两个问题。</p><ol><li>可变参数类型。</li><li>可变参数个数。</li></ol><p>另外，一个基本的设计原则是，仅仅当两个函数除了参数类型和参数个数不同以外，其功能是完全相同的，此时才使用函数重载，如果两个函数的功能其实不同，那么不应当使用重载，而应当使用一个名字不同的函数。</p><p>好吧，那么对于情况 1 ，函数功能相同，但是参数类型不同，python 如何处理？答案是根本不需要处理，因为 python 可以接受任何类型的参数，如果函数的功能相同，那么不同的参数类型在 python 中很可能是相同的代码，没有必要做成两个不同函数。</p><p>那么对于情况 2 ，函数功能相同，但参数个数不同，python 如何处理？大家知道，答案就是缺省参数。对那些缺少的参数设定为缺省参数即可解决问题。因为你假设函数功能相同，那么那些缺少的参数终归是需要用的。</p><p>因此python 自然就<strong>不需要函数重载</strong>。</p><h2 id="14-新式类和旧式类"><a href="#14-新式类和旧式类" class="headerlink" title="14 新式类和旧式类"></a>14 新式类和旧式类</h2><p>这篇文章很好的介绍了新式类的特性: <a href="http://www.cnblogs.com/btchenguang/archive/2012/09/17/2689146.html" target="_blank" rel="external">http://www.cnblogs.com/btchenguang/archive/2012/09/17/2689146.html</a></p><p>新式类很早在2.2就出现了,所以旧式类完全是兼容的问题,Python3里的类全部都是新式类.这里有一个MRO问题可以了解下(新式类是广度优先,旧式类是深度优先),Python核心编程里讲的也很多.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 新式类, 继承自Object</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">New</span><span class="params">(Object)</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="comment"># 旧类 </span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">()</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo1</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"A"</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span><span class="params">(A)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo2</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">pass</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span><span class="params">(A)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo1</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"C"</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span><span class="params">(B, C)</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"></div><div class="line">d = D()</div><div class="line">d.foo1()</div><div class="line"></div><div class="line"><span class="comment"># A</span></div></pre></td></tr></table></figure><p><strong>按照经典类的查找顺序<code>从左到右深度优先</code>的规则，在访问<code>d.foo1()</code>的时候,D这个类是没有的..那么往上查找,先找到B,里面没有,深度优先,访问A,找到了foo1(),所以这时候调用的是A的foo1()，从而导致C重写的foo1()被绕过</strong></p><h2 id="15-new-和-init-的区别"><a href="#15-new-和-init-的区别" class="headerlink" title="15 __new__和__init__的区别"></a>15 <code>__new__</code>和<code>__init__</code>的区别</h2><p>这个<code>__new__</code>确实很少见到,先做了解吧.</p><ol><li><code>__new__</code>是一个静态方法,而<code>__init__</code>是一个实例方法.</li><li><code>__new__</code>方法会返回一个创建的实例,而<code>__init__</code>什么都不返回.</li><li>只有在<code>__new__</code>返回一个cls的实例时后面的<code>__init__</code>才能被调用.</li><li>当创建一个新实例时调用<code>__new__</code>,初始化一个实例时用<code>__init__</code>.</li></ol><p>ps: <code>__metaclass__</code>是创建类时起作用.所以我们可以分别使用<code>__metaclass__</code>,<code>__new__</code>和<code>__init__</code>来分别在类创建,实例创建和实例初始化的时候做一些小手脚.</p><h2 id="16-单例模式"><a href="#16-单例模式" class="headerlink" title="16 单例模式"></a>16 单例模式</h2><blockquote><p>​    单例模式是一种常用的软件设计模式。在它的核心结构中只包含一个被称为单例类的特殊类。通过单例模式可以保证系统中一个类只有一个实例而且该实例易于外界访问，从而方便对实例个数的控制并节约系统资源。如果希望在系统中某个类的对象只能存在一个，单例模式是最好的解决方案。</p><p><code>__new__()</code>在<code>__init__()</code>之前被调用，用于生成实例对象。利用这个方法和类的属性的特点可以实现设计模式的单例模式。单例模式是指创建唯一对象，单例模式设计的类只能实例<br><strong>这个绝对常考啊.绝对要记住1~2个方法,当时面试官是让手写的.</strong></p></blockquote><h3 id="1-使用-new-方法"><a href="#1-使用-new-方法" class="headerlink" title="1 使用__new__方法"></a>1 使用<code>__new__</code>方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, *args, **kw)</span>:</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hasattr(cls, <span class="string">'_instance'</span>):</div><div class="line">            orig = super(Singleton, cls) <span class="comment"># 获取cls的父类， super做为代理对象，帮助我们调用其第一个参数的MRO链上的下一个类的方法。</span></div><div class="line">            cls._instance = orig.__new__(cls, *args, **kw)  <span class="comment"># 创建一个实例</span></div><div class="line">        <span class="keyword">return</span> cls._instance</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(Singleton)</span>:</span></div><div class="line">    a = <span class="number">1</span></div></pre></td></tr></table></figure><h3 id="2-共享属性"><a href="#2-共享属性" class="headerlink" title="2 共享属性"></a>2 共享属性</h3><p>创建实例时把所有实例的<code>__dict__</code>指向同一个字典,这样它们具有相同的属性和方法.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Borg</span><span class="params">(object)</span>:</span></div><div class="line">    _state = &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, *args, **kw)</span>:</span></div><div class="line">        ob = super(Borg, cls).__new__(cls, *args, **kw)</div><div class="line">        ob.__dict__ = cls._state</div><div class="line">        <span class="keyword">return</span> ob</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass2</span><span class="params">(Borg)</span>:</span></div><div class="line">    a = <span class="number">1</span></div></pre></td></tr></table></figure><h3 id="3-装饰器版本"><a href="#3-装饰器版本" class="headerlink" title="3 装饰器版本"></a>3 装饰器版本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">singleton</span><span class="params">(cls, *args, **kw)</span>:</span></div><div class="line">    instances = &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getinstance</span><span class="params">()</span>:</span></div><div class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> instances:</div><div class="line">            instances[cls] = cls(*args, **kw)</div><div class="line">        <span class="keyword">return</span> instances[cls]</div><div class="line">    <span class="keyword">return</span> getinstance</div><div class="line"></div><div class="line"><span class="meta">@singleton</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>:</span></div><div class="line">  <span class="keyword">pass</span></div></pre></td></tr></table></figure><h3 id="4-import方法"><a href="#4-import方法" class="headerlink" title="4 import方法"></a>4 import方法</h3><p>作为python的模块是天然的单例模式</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># mysingleton.py</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">My_Singleton</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">pass</span></div><div class="line"></div><div class="line">my_singleton = My_Singleton()</div><div class="line"></div><div class="line"><span class="comment"># to use</span></div><div class="line"><span class="keyword">from</span> mysingleton <span class="keyword">import</span> my_singleton</div><div class="line"></div><div class="line">my_singleton.foo()</div></pre></td></tr></table></figure><h2 id="17-Python中的作用域"><a href="#17-Python中的作用域" class="headerlink" title="17 Python中的作用域"></a>17 Python中的作用域</h2><p>Python 中，一个变量的作用域总是由在代码中被赋值的地方所决定的。</p><p>当 Python 遇到一个变量的话他会按照这样的顺序进行搜索：</p><p>本地作用域（Local）→当前作用域被嵌入的本地作用域（Enclosing locals）→全局/模块作用域（Global）→内置作用域（Built-in）</p><h2 id="18-GIL线程全局锁"><a href="#18-GIL线程全局锁" class="headerlink" title="18 GIL线程全局锁"></a>18 GIL线程全局锁</h2><p>线程全局锁(Global Interpreter Lock),即Python为了保证线程安全而采取的独立线程运行的限制,说白了就是一个核只能在同一时间运行一个线程.<strong>对于io密集型任务，python的多线程起到作用，但对于cpu密集型任务，python的多线程几乎占不到任何优势，还有可能因为争夺资源而变慢。</strong></p><p>解决办法就是多进程和下面的协程(协程也只是单CPU,但是能减小切换代价提升性能).</p><h2 id="19-协程"><a href="#19-协程" class="headerlink" title="19 协程"></a>19 协程</h2><p>简单点说协程是进程和线程的升级版,进程和线程都面临着内核态和用户态的切换问题而耗费许多切换时间,而协程就是用户自己控制切换的时机,不再需要陷入系统的内核态.</p><p>协程是自己放弃运行状态转入就绪状态，让权给优先级更高的协程，低优先级的无法获得运行权。</p><p>线程切换是被剥夺运行，进入阻塞状态，然后调度新的线程运行。</p><h2 id="20-闭包"><a href="#20-闭包" class="headerlink" title="20 闭包"></a>20 闭包</h2><p>闭包(closure)是函数式编程的重要的语法结构。闭包也是一种组织代码的结构，它同样提高了代码的可重复使用性。</p><p>当一个内嵌函数引用其外部作作用域的变量,我们就会得到一个闭包. 总结一下,创建一个闭包必须满足以下几点:</p><ol><li>必须有一个内嵌函数</li><li>内嵌函数必须引用外部函数中的变量</li><li>外部函数的返回值必须是内嵌函数</li></ol><p>感觉闭包还是有难度的,几句话是说不明白的,还是查查相关资料.</p><p>重点是函数运行后并不会被撤销,就像16题的instance字典一样,当函数运行完后,instance并不被销毁,而是继续留在内存空间里.这个功能类似类里的类变量,只不过迁移到了函数上.</p><p>闭包就像个空心球一样,你知道外面和里面,但你不知道中间是什么样.</p><h2 id="21-lambda函数"><a href="#21-lambda函数" class="headerlink" title="21 lambda函数"></a>21 lambda函数</h2><p>其实就是一个匿名函数,为什么叫lambda?因为和函数式编程有关.</p><h2 id="22-Python函数式编程"><a href="#22-Python函数式编程" class="headerlink" title="22 Python函数式编程"></a>22 Python函数式编程</h2><p>python中函数式编程支持:</p><p>filter 函数的功能相当于过滤器。调用一个布尔函数<code>bool_func</code>来迭代遍历每个seq中的元素；返回一个使<code>bool_seq</code>返回值为true的元素的序列。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt;a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]</div><div class="line">&gt;&gt;&gt;b = filter(<span class="keyword">lambda</span> x: x &gt; <span class="number">5</span>, a)</div><div class="line">&gt;&gt;&gt;<span class="keyword">print</span> b</div><div class="line">&gt;&gt;&gt;[<span class="number">6</span>,<span class="number">7</span>]</div></pre></td></tr></table></figure><p>map函数是对一个序列的每个项依次执行函数，下面是对一个序列每个项都乘以2：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = map(<span class="keyword">lambda</span> x:x*<span class="number">2</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(a)</div><div class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</div></pre></td></tr></table></figure><p>reduce函数是对一个序列的每个项迭代调用函数，下面是求3的阶乘：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>reduce(<span class="keyword">lambda</span> x,y:x*y,range(<span class="number">1</span>,<span class="number">4</span>))</div><div class="line"><span class="number">6</span></div></pre></td></tr></table></figure><h2 id="23-Python里的拷贝"><a href="#23-Python里的拷贝" class="headerlink" title="23 Python里的拷贝"></a>23 Python里的拷贝</h2><p>引用和copy(),deepcopy()的区别</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> copy</div><div class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>]]  <span class="comment">#原始对象</span></div><div class="line"></div><div class="line">b = a  <span class="comment">#赋值，传对象的引用</span></div><div class="line">c = copy.copy(a)  <span class="comment">#对象拷贝，浅拷贝</span></div><div class="line">d = copy.deepcopy(a)  <span class="comment">#对象拷贝，深拷贝</span></div><div class="line"></div><div class="line">a.append(<span class="number">5</span>)  <span class="comment">#修改对象a</span></div><div class="line">a[<span class="number">4</span>].append(<span class="string">'c'</span>)  <span class="comment">#修改对象a中的['a', 'b']数组对象</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">'a = '</span>, a</div><div class="line"><span class="keyword">print</span> <span class="string">'b = '</span>, b</div><div class="line"><span class="keyword">print</span> <span class="string">'c = '</span>, c</div><div class="line"><span class="keyword">print</span> <span class="string">'d = '</span>, d</div><div class="line"></div><div class="line">输出结果：</div><div class="line">a =  [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>], <span class="number">5</span>]</div><div class="line">b =  [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>], <span class="number">5</span>]</div><div class="line">c =  [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]]</div><div class="line">d =  [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>]]</div></pre></td></tr></table></figure><h2 id="24-Python垃圾回收机制"><a href="#24-Python垃圾回收机制" class="headerlink" title="24 Python垃圾回收机制"></a>24 Python垃圾回收机制</h2><p>Python GC主要使用引用计数（reference counting）来跟踪和回收垃圾。在引用计数的基础上，通过“标记-清除”（mark and sweep）解决容器对象可能产生的循环引用问题，通过“分代回收”（generation collection）以空间换时间的方法提高垃圾回收效率。</p><h3 id="1-引用计数"><a href="#1-引用计数" class="headerlink" title="1 引用计数"></a>1 引用计数</h3><p>PyObject是每个对象必有的内容，其中<code>ob_refcnt</code>就是做为引用计数。当一个对象有新的引用时，它的<code>ob_refcnt</code>就会增加，当引用它的对象被删除，它的<code>ob_refcnt</code>就会减少.引用计数为0时，该对象生命就结束了。</p><p>优点:</p><ol><li>简单</li><li>实时性</li></ol><p>缺点:</p><ol><li>维护引用计数消耗资源</li><li>循环引用</li></ol><h3 id="2-标记-清除机制"><a href="#2-标记-清除机制" class="headerlink" title="2 标记-清除机制"></a>2 标记-清除机制</h3><p>基本思路是先按需分配，等到没有空闲内存的时候从寄存器和程序栈上的引用出发，遍历以对象为节点、以引用为边构成的图，把所有可以访问到的对象打上标记，然后清扫一遍内存空间，把所有没标记的对象释放。</p><h3 id="3-分代技术"><a href="#3-分代技术" class="headerlink" title="3 分代技术"></a>3 分代技术</h3><p>分代回收的整体思想是：将系统中的所有内存块根据其存活时间划分为不同的集合，每个集合就成为一个“代”，垃圾收集频率随着“代”的存活时间的增大而减小，存活时间通常利用经过几次垃圾回收来度量。</p><p>Python默认定义了三代对象集合，索引数越大，对象存活时间越长。</p><p>举例：<br>当某些内存块M经过了3次垃圾收集的清洗之后还存活时，我们就将内存块M划到一个集合A中去，而新分配的内存都划分到集合B中去。当垃圾收集开始工作时，大多数情况都只对集合B进行垃圾回收，而对集合A进行垃圾回收要隔相当长一段时间后才进行，这就使得垃圾收集机制需要处理的内存少了，效率自然就提高了。在这个过程中，集合B中的某些内存块由于存活时间长而会被转移到集合A中，当然，集合A中实际上也存在一些垃圾，这些垃圾的回收会因为这种分代的机制而被延迟。</p><h2 id="25-Python的List"><a href="#25-Python的List" class="headerlink" title="25 Python的List"></a>25 Python的List</h2><p>使用的数组结构，因此存在重新分配内存的问题。</p><h2 id="26-Python的is"><a href="#26-Python的is" class="headerlink" title="26 Python的is"></a>26 Python的is</h2><p>is是对比地址,==是对比值</p><h2 id="27-read-readline和readlines"><a href="#27-read-readline和readlines" class="headerlink" title="27 read,readline和readlines"></a>27 read,readline和readlines</h2><ul><li>read        读取整个文件</li><li>readline    读取下一行,使用生成器方法</li><li>readlines   读取整个文件到一个迭代器以供我们遍历</li></ul><h2 id="28-Python2和3的区别"><a href="#28-Python2和3的区别" class="headerlink" title="28 Python2和3的区别"></a>28 Python2和3的区别</h2><ul><li>py2可以使用<code>__future__</code>导入支持py3新特性的包</li><li>print变为函数</li><li>整除， py3 中<code>/是带小数的除， &quot;//&quot;是整除</code></li><li>py3有 unicode字符串，以及字节类byte</li><li>py3 中没有xrange，range即为生成器实现</li></ul><h2 id="29-super-init"><a href="#29-super-init" class="headerlink" title="29 super init"></a>29 super init</h2><p>MRO： Method Resolution Order</p><p>super() lets you avoid referring to the base class explicitly, which can be nice. But the main advantage comes with multiple inheritance, where all sorts of fun stuff can happen. See the standard docs on super if you haven’t already.</p><p>Note that the syntax changed in Python 3.0: you can just say super().<code>__init__</code>() instead of super(ChildB, self).<code>__init__</code>() which MRO is quite a bit nicer.</p><h2 id="30-range-and-xrange"><a href="#30-range-and-xrange" class="headerlink" title="30 range and xrange"></a>30 range and xrange</h2><p>​    xrange生成器模式，占用内存小</p><h1 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h1><h2 id="1-select-poll和epoll"><a href="#1-select-poll和epoll" class="headerlink" title="1 select,poll和epoll"></a>1 select,poll和epoll</h2><p>IO多路复用机制。I/O多路复用就通过一种机制，可以监视多个描述符，一旦某个描述符就绪（一般是读就绪或者写就绪），能够通知程序进行相应的读写操作。</p><p>但select，poll，epoll本质上都是<strong>同步I/O</strong>，因为他们都需要在读写事件就绪后自己负责进行读写，也就是说这个读写过程是阻塞的，而异步I/O则无需自己负责进行读写，异步I/O的实现会负责把数据从内核拷贝到用户空间。</p><ul><li>select有3个缺点:连接数受限（1024），查找配对速度慢，数据由内核拷贝到用户态。</li><li>poll改善了select第一个缺点，但是查找时遍历全部文件句柄；epoll改了三个缺点,查找匹配时仅返回状态发生变化的文件句柄。</li></ul><p>不仅仅是文件IO，还有网络IO</p><p><code>epoll技术的编程模型就是异步非阻塞回调</code>，也可以叫做Reactor，事件驱动，事件轮循（EventLoop）。Nginx，libevent，node.js这些就是Epoll时代的产物。tornado也使用了epoll.</p><h2 id="2-调度算法"><a href="#2-调度算法" class="headerlink" title="2 调度算法"></a>2 调度算法</h2><ol><li>先来先服务(FCFS, First Come First Serve)</li><li>短作业优先(SJF, Shortest Job First)</li><li>最高优先权调度(Priority Scheduling)</li><li>时间片轮转(RR, Round Robin)</li><li>多级反馈队列调度(multilevel feedback queue scheduling)</li></ol><p>实时调度算法:</p><ol><li>最早截至时间优先 EDF</li><li>最低松弛度优先 LLF</li></ol><h2 id="3-死锁"><a href="#3-死锁" class="headerlink" title="3 死锁"></a>3 死锁</h2><p>原因:</p><ol><li>竞争资源</li><li>程序推进顺序不当</li></ol><p>必要条件:</p><ol><li>互斥条件</li><li>请求和保持条件</li><li>不剥夺条件</li><li>环路等待条件</li></ol><p>处理死锁基本方法:</p><ol><li>预防死锁(摒弃除1以外的条件)</li><li>避免死锁(银行家算法)</li><li>检测死锁(资源分配图)</li><li>解除死锁<ol><li>剥夺资源</li><li>撤销进程</li></ol></li></ol><h2 id="4-程序编译与链接"><a href="#4-程序编译与链接" class="headerlink" title="4 程序编译与链接"></a>4 程序编译与链接</h2><p>Bulid过程可以分解为4个步骤:预处理(Prepressing), 编译(Compilation)、汇编(Assembly)、链接(Linking)</p><p>以c语言为例:</p><h3 id="1-预处理"><a href="#1-预处理" class="headerlink" title="1 预处理"></a>1 预处理</h3><p>预编译过程主要处理那些源文件中的以“#”开始的预编译指令，主要处理规则有：</p><ol><li>将所有的“#define”删除，并展开所用的宏定义</li><li>处理所有条件预编译指令，比如“#if”、“#ifdef”、 “#elif”、“#endif”</li><li>处理“#include”预编译指令，将被包含的文件插入到该编译指令的位置，注：此过程是递归进行的</li><li>删除所有注释</li><li>添加行号和文件名标识，以便于编译时编译器产生调试用的行号信息以及用于编译时产生编译错误或警告时可显示行号</li><li>保留所有的#pragma编译器指令。</li></ol><h3 id="2-编译"><a href="#2-编译" class="headerlink" title="2 编译"></a>2 编译</h3><p>编译过程就是把预处理完的文件进行一系列的词法分析、语法分析、语义分析及优化后生成相应的汇编代码文件。这个过程是整个程序构建的核心部分。</p><h3 id="3-汇编"><a href="#3-汇编" class="headerlink" title="3 汇编"></a>3 汇编</h3><p>汇编器是将汇编代码转化成机器可以执行的指令，每一条汇编语句几乎都是一条机器指令。经过编译、链接、汇编输出的文件成为目标文件(Object File)</p><h3 id="4-链接"><a href="#4-链接" class="headerlink" title="4 链接"></a>4 链接</h3><p>链接的主要内容就是把各个模块之间相互引用的部分处理好，使各个模块可以正确的拼接。<br>链接的主要过程包块 地址和空间的分配（Address and Storage Allocation）、符号决议(Symbol Resolution)和重定位(Relocation)等步骤。</p><h2 id="5-静态链接和动态链接"><a href="#5-静态链接和动态链接" class="headerlink" title="5 静态链接和动态链接"></a>5 静态链接和动态链接</h2><p>静态链接方法：静态链接的时候，载入代码就会把程序会用到的动态代码或动态代码的地址确定下来<br>静态库的链接可以使用静态链接，动态链接库也可以使用这种方法链接导入库</p><p>动态链接方法：使用这种方式的程序并不在一开始就完成动态链接，而是直到真正调用动态库代码时，载入程序才计算(被调用的那部分)动态代码的逻辑地址，然后等到某个时候，程序又需要调用另外某块动态代码时，载入程序又去计算这部分代码的逻辑地址，所以，这种方式使程序初始化时间较短，但运行期间的性能比不上静态链接的程序</p><h2 id="6-虚拟内存技术"><a href="#6-虚拟内存技术" class="headerlink" title="6 虚拟内存技术"></a>6 虚拟内存技术</h2><p>虚拟存储器是指具有请求调入功能和置换功能,能从逻辑上对内存容量加以扩充的一种存储系统.</p><h2 id="7-分页和分段"><a href="#7-分页和分段" class="headerlink" title="7 分页和分段"></a>7 分页和分段</h2><p>分页: 用户程序的地址空间被划分成若干固定大小的区域，称为“页”，相应地，内存空间分成若干个物理块，页和块的大小相等。可将用户程序的任一页放在内存的任一块中，实现了离散分配。</p><p>分段: 将用户程序地址空间分成若干个大小不等的段，每段可以定义一组相对完整的逻辑信息。存储分配时，以段为单位，段与段在内存中可以不相邻接，也实现了离散分配。</p><h3 id="分页与分段的主要区别"><a href="#分页与分段的主要区别" class="headerlink" title="分页与分段的主要区别"></a>分页与分段的主要区别</h3><ol><li>页是信息的物理单位,分页是为了实现非连续分配,以便解决内存碎片问题,或者说分页是由于系统管理的需要.段是信息的逻辑单位,它含有一组意义相对完整的信息,分段的目的是为了更好地实现共享,满足用户的需要.</li><li>页的大小固定,由系统确定,将逻辑地址划分为页号和页内地址是由机器硬件实现的.而段的长度却不固定,决定于用户所编写的程序,通常由编译程序在对源程序进行编译时根据信息的性质来划分.</li><li>分页的作业地址空间是一维的.分段的地址空间是二维的.</li></ol><h2 id="8-页面置换算法"><a href="#8-页面置换算法" class="headerlink" title="8 页面置换算法"></a>8 页面置换算法</h2><ol><li>最佳置换算法OPT:不可能实现</li><li>先进先出FIFO</li><li>最近最久未使用算法LRU:最近一段时间里最久没有使用过的页面予以置换.</li><li>clock算法</li></ol><h2 id="9-边沿触发和水平触发"><a href="#9-边沿触发和水平触发" class="headerlink" title="9 边沿触发和水平触发"></a>9 边沿触发和水平触发</h2><p>边缘触发是指每当状态变化时发生一个 io 事件，条件触发是只要满足条件就发生一个 io 事件</p><h1 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h1><h2 id="1-事务"><a href="#1-事务" class="headerlink" title="1 事务"></a>1 事务</h2><p>数据库事务(Database Transaction) ，是指作为单个逻辑工作单元执行的一系列操作，要么完全地执行，要么完全地不执行。<br>原子性、一致性、隔离性、持久性</p><h2 id="2-数据库索引"><a href="#2-数据库索引" class="headerlink" title="2 数据库索引"></a>2 数据库索引</h2><p>聚集索引,非聚集索引,B-Tree,B+Tree,最左前缀原理</p><p>非聚集索引：索引的数据区存储的是真实数据的地址，索引与数据分开</p><h2 id="3-Redis原理"><a href="#3-Redis原理" class="headerlink" title="3 Redis原理"></a>3 Redis原理</h2><h3 id="Redis是什么？"><a href="#Redis是什么？" class="headerlink" title="Redis是什么？"></a>Redis是什么？</h3><ol><li>是一个完全开源免费的key-value内存数据库 </li><li>通常被认为是一个数据结构服务器，主要是因为其有着丰富的数据结构 strings、map、 list、sets、 sorted sets</li></ol><h3 id="Redis数据库"><a href="#Redis数据库" class="headerlink" title="Redis数据库"></a>Redis数据库</h3><blockquote><p>​    通常局限点来说，Redis也以消息队列的形式存在，作为内嵌的List存在，满足实时的高并发需求。在使用缓存的时候，redis比memcached具有更多的优势，并且支持更多的数据类型，把redis当作一个中间存储系统，用来处理高并发的数据库操作</p></blockquote><ul><li>速度快：使用标准C写，所有数据都在内存中完成，读写速度分别达到10万/20万 </li><li>持久化：对数据的更新采用Copy-on-write技术，可以异步地保存到磁盘上，主要有两种策略，一是根据时间，更新次数的快照（save 300 10 ）二是基于语句追加方式(Append-only file，aof) </li><li>自动操作：对不同数据类型的操作都是自动的，很安全 </li><li>快速的主–从复制，官方提供了一个数据，Slave在21秒即完成了对Amazon网站10G key set的复制。 </li><li>Sharding技术： 很容易将数据分布到多个Redis实例中，数据库的扩展是个永恒的话题，在关系型数据库中，主要是以添加硬件、以分区为主要技术形式的纵向扩展解决了很多的应用场景，但随着web2.0、移动互联网、云计算等应用的兴起，这种扩展模式已经不太适合了，所以近年来，像采用主从配置、数据库复制形式的，Sharding这种技术把负载分布到多个特理节点上去的横向扩展方式用处越来越多。</li></ul><h3 id="Redis缺点"><a href="#Redis缺点" class="headerlink" title="Redis缺点"></a>Redis缺点</h3><ul><li>是数据库容量受到物理内存的限制,不能用作海量数据的高性能读写,因此Redis适合的场景主要局限在较小数据量的高性能操作和运算上。</li><li>Redis较难支持在线扩容，在集群容量达到上限时在线扩容会变得很复杂。因此开发者必须合理利用有限内存，仅缓存热数据。</li><li>Redis的持久化并不是很靠谱</li><li>Redis 3.0推出了官方集群方案，但是也有很多优秀的开源解决方案，比如<code>Codis</code>。</li></ul><h3 id="Redis应用"><a href="#Redis应用" class="headerlink" title="Redis应用"></a>Redis应用</h3><h4 id="数据缓存"><a href="#数据缓存" class="headerlink" title="数据缓存"></a>数据缓存</h4><ul><li><p>以string类型存储序列化后的对象</p></li><li><p>序列化方式要效率高、内存占用小</p></li><li><p>key的命名要唯一、有语义且尽可能的短</p></li><li><p>数据一致性问题</p><p>设置缓存过期时间、发现失效后清除缓存。</p><p>一般在查询、新增对象后，将对象放入缓存；修改对象后更新缓存；删除对象后清除对应的缓存；</p></li></ul><h4 id="消息队列"><a href="#消息队列" class="headerlink" title="消息队列"></a>消息队列</h4><p>Redis 中<code>list</code>的数据结构实现是双向链表，所以可以非常便捷的应用于消息队列（生产者 / 消费者模型）。消息的生产者只需要通过<code>lpush</code>将消息放入 list，消费者便可以通过<code>rpop</code>取出该消息，并且可以保证消息的有序性。如果需要实现带有优先级的消息队列也可以选择<code>sorted set</code>。而<code>pub/sub</code>功能也可以用作发布者 / 订阅者模型的消息。无论使用何种方式，由于 Redis 拥有持久化功能，也不需要担心由于服务器故障导致消息丢失的情况。</p><h4 id="时间轴"><a href="#时间轴" class="headerlink" title="时间轴"></a>时间轴</h4><p><code>list</code>作为双向链表，不光可以作为队列使用。如果将它用作栈便可以成为一个公用的时间轴。当用户发完微博后，都通过<code>lpush</code>将它存放在一个 key 为<code>LATEST_WEIBO</code>的<code>list</code>中，之后便可以通过<code>lrange</code>取出当前最新的微博。</p><h4 id="排行榜"><a href="#排行榜" class="headerlink" title="排行榜"></a>排行榜</h4><p>使用<code>sorted set</code>和一个计算热度的算法便可以轻松打造一个热度排行榜，<code>zrevrangebyscore</code>可以得到以分数倒序排列的序列，<code>zrank</code>可以得到一个成员在该排行榜的位置（是分数正序排列时的位置，如果要获取倒序排列时的位置需要用<code>zcard</code>-<code>zrank</code>）。</p><h4 id="计数器"><a href="#计数器" class="headerlink" title="计数器"></a>计数器</h4><p>计数功能应该是最适合 Redis 的使用场景之一了，因为它高频率读写的特征可以完全发挥 Redis 作为内存数据库的高效。在 Redis 的数据结构中，<code>string</code>、<code>hash</code>和<code>sorted set</code>都提供了<code>incr</code>方法用于原子性的自增操作，下面举例说明一下它们各自的使用场景：</p><ul><li>如果应用需要显示每天的注册用户数，便可以使用<code>string</code>作为计数器，设定一个名为<code>REGISTERED_COUNT_TODAY</code>的 key，并在初始化时给它设置一个到凌晨 0 点的过期时间，每当用户注册成功后便使用<code>incr</code>命令使该 key 增长 1，同时当每天凌晨 0 点后，这个计数器都会因为 key 过期使值清零。</li><li>每条微博都有点赞数、评论数、转发数和浏览数四条属性，这时用<code>hash</code>进行计数会更好，将该计数器的 key 设为<code>weibo:weibo_id</code>，<code>hash</code>的 field 为<code>like_number</code>、<code>comment_number</code>、<code>forward_number</code>和<code>view_number</code>，在对应操作后通过<code>hincrby</code>使<code>hash 中</code>的 field 自增。</li><li>如果应用有一个发帖排行榜的功能，便选择<code>sorted set</code>吧，将集合的 key 设为<code>POST_RANK</code>。当用户发帖后，使用<code>zincrby</code>将该用户 id 的 score 增长 1。<code>sorted set</code>会重新进行排序，用户所在排行榜的位置也就会得到实时的更新。</li></ul><h4 id="好友关系"><a href="#好友关系" class="headerlink" title="好友关系"></a>好友关系</h4><p>这个场景最开始是是一篇介绍微博 Redis 应用的 PPT 中看到的，其中提到微博的 Redis 主要是用在在计数和好友关系两方面上，当时对好友关系方面的用法不太了解，后来看到《Redis 设计与实现》中介绍到作者最开始去使用 Redis 便是希望能通过<code>set</code>解决传统数据库无法快速计算集合中交集这个功能。后来联想到微博当前的业务场景，确实能够以这种方式实现，所以姑且猜测一下：</p><p>对于一个用户 A，将它的关注和粉丝的用户 id 都存放在两个 set 中：</p><ul><li><p><code>A:follow</code>：存放 A 所有关注的用户 id</p></li><li><p><code>A:follower</code>：存放 A 所有粉丝的用户 id</p><p>那么通过<code>sinter</code>命令便可以根据<code>A:follow</code>和<code>A:follower</code>的交集得到与 A 互相关注的用户。当 A 进入另一个用户 B 的主页后，<code>A:follow</code>和<code>B:follow</code>的交集便是 A 和 B 的共同专注，<code>A:follow</code>和<code>B:follower</code>的交集便是 A 关注的人也关注了 B。</p></li></ul><h4 id="分布式锁"><a href="#分布式锁" class="headerlink" title="分布式锁"></a>分布式锁</h4><p>在 Redis 2.6.12 版本开始，<code>string</code>的<code>set</code>命令增加了三个参数：</p><ul><li><p><code>EX</code>：设置键的过期时间（单位为秒）</p></li><li><p><code>PX</code>：设置键的过期时间（单位为毫秒）</p></li><li><p><code>NX</code> | <code>XX</code>：当设置为<code>NX</code>时，仅当 key 存在时才进行操作，设置为<code>XX</code>时，仅当 key 不存在才会进行操作</p><p>由于这个操作是原子性的，可以简单地以此实现一个分布式的锁，例如：</p></li></ul><p><code>set key &quot;lock&quot; EX 1 XX</code></p><p>如果这个操作返回<code>false</code>，说明 key 的添加不成功，也就是当前有人在占用这把锁。而如果返回<code>true</code>，则说明得了锁，便可以继续进行操作，并且在操作后通过<code>del</code>命令释放掉锁。并且即使程序因为某些原因并没有释放锁，由于设置了过期时间，该锁也会在 1 秒后自动释放，不会影响到其他程序的运行。</p><h4 id="倒排索引"><a href="#倒排索引" class="headerlink" title="倒排索引"></a>倒排索引</h4><p>倒排索引是构造搜索功能的最常见方式，在 Redis 中也可以通过<code>set</code>进行建立倒排索引，这里以简单的拼音 + 前缀搜索城市功能举例：</p><p>假设一个城市<code>北京</code>，通过拼音词库将<code>北京</code>转为<code>beijing</code>，再通过前缀分词将这两个词分为若干个前缀索引，有：<code>北</code>、<code>北京</code>、<code>b</code>、<code>be</code>…<code>beijin</code>和<code>beijing</code>。将这些索引分别作为<code>set</code>的 key（例如:<code>index:北</code>）并存储<code>北京</code>的 id，倒排索引便建立好了。接下来只需要在搜索时通过关键词取出对应的<code>set</code>并得到其中的 id 即可。</p><h2 id="4-乐观锁和悲观锁"><a href="#4-乐观锁和悲观锁" class="headerlink" title="4 乐观锁和悲观锁"></a>4 乐观锁和悲观锁</h2><p>悲观锁：假定会发生并发冲突，屏蔽一切可能违反数据完整性的操作</p><p>乐观锁：假设不会发生并发冲突，只在提交操作时检查是否违反数据完整性。</p><h2 id="5-MVCC"><a href="#5-MVCC" class="headerlink" title="5 MVCC"></a>5 MVCC</h2><blockquote><p>​    全称是Multi-Version Concurrent Control，即多版本并发控制，在MVCC协议下，每个读操作会看到一个一致性的snapshot，并且可以实现非阻塞的读。MVCC允许数据具有多个版本，这个版本可以是时间戳或者是全局递增的事务ID，在同一个时间点，不同的事务看到的数据是不同的。</p></blockquote><p><strong>MySQL的innodb引擎是如何实现MVCC的</strong></p><p>innodb会为每一行添加两个字段，分别表示该行<strong>创建的版本</strong>和<strong>删除的版本</strong>，填入的是事务的版本号，这个版本号随着事务的创建不断递增。在repeated read的隔离级别下，具体各种数据库操作的实现：</p><ul><li>select：满足以下两个条件innodb会返回该行数据：<ul><li>该行的创建版本号小于等于当前版本号，用于保证在select操作之前所有的操作已经执行落地。</li><li>该行的删除版本号大于当前版本或者为空。删除版本号大于当前版本意味着有一个并发事务将该行删除了。</li></ul></li><li>insert：将新插入的行的创建版本号设置为当前系统的版本号。</li><li>delete：将要删除的行的删除版本号设置为当前系统的版本号。</li><li>update：不执行原地update，而是转换成insert + delete。将旧行的删除版本号设置为当前版本号，并将新行insert同时设置创建版本号为当前版本号。</li></ul><p>其中，写操作（insert、delete和update）执行时，需要将系统版本号递增。</p><p>​    由于旧数据并不真正的删除，所以必须对这些数据进行清理，innodb会开启一个后台线程执行清理工作，具体的规则是将删除版本号小于当前系统版本的行删除，这个过程叫做purge。</p><p>通过MVCC很好的实现了事务的隔离性，可以达到repeated read级别，要实现serializable还必须加锁。</p><h2 id="6-MyISAM和InnoDB"><a href="#6-MyISAM和InnoDB" class="headerlink" title="6 MyISAM和InnoDB"></a>6 MyISAM和InnoDB</h2><p>MyISAM 适合于一些需要大量查询的应用，但其对于有大量写操作并不是很好。甚至你只是需要update一个字段，整个表都会被锁起来，而别的进程，就算是读进程都无法操作直到写操作完成。另外，MyISAM 对于 SELECT COUNT(*) 这类的计算是超快无比的。</p><p>InnoDB 的趋势会是一个非常复杂的存储引擎，对于一些小的应用，它会比 MyISAM 还慢。他是它支持“行锁” ，于是在写操作比较多的时候，会更优秀。并且，他还支持更多的高级应用，比如：事务。</p><h1 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h1><h2 id="1-三次握手"><a href="#1-三次握手" class="headerlink" title="1 三次握手"></a>1 三次握手</h2><ol><li>客户端通过向服务器端发送一个SYN来创建一个主动打开，作为三次握手的一部分。客户端把这段连接的序号设定为随机数 A。</li><li>服务器端应当为一个合法的SYN回送一个SYN/ACK。ACK 的确认码应为 A+1，SYN/ACK 包本身又有一个随机序号 B。</li><li>最后，客户端再发送一个ACK。当服务端受到这个ACK的时候，就完成了三路握手，并进入了连接创建状态。此时包序号被设定为收到的确认号 A+1，而响应则为 B+1。</li></ol><h2 id="2-四次挥手"><a href="#2-四次挥手" class="headerlink" title="2 四次挥手"></a>2 四次挥手</h2><p><em>注意: 中断连接端可以是客户端，也可以是服务器端. 下面仅以客户端断开连接举例, 反之亦然.</em></p><ol><li>客户端发送一个数据分段, 其中的 FIN 标记设置为1. 客户端进入 FIN-WAIT 状态. 该状态下客户端只接收数据, 不再发送数据.</li><li>服务器接收到带有 FIN = 1 的数据分段, 发送带有 ACK = 1 的剩余数据分段, 确认收到客户端发来的 FIN 信息.</li><li>服务器等到所有数据传输结束, 向客户端发送一个带有 FIN = 1 的数据分段, 并进入 CLOSE-WAIT 状态, 等待客户端发来带有 ACK = 1 的确认报文.</li><li>客户端收到服务器发来带有 FIN = 1 的报文, 返回 ACK = 1 的报文确认, 为了防止服务器端未收到需要重发, 进入 TIME-WAIT 状态. 服务器接收到报文后关闭连接. 客户端等待 2MSL 后未收到回复, 则认为服务器成功关闭, 客户端关闭连接.</li></ol><h2 id="3-ARP协议"><a href="#3-ARP协议" class="headerlink" title="3 ARP协议"></a>3 ARP协议</h2><p>地址解析协议(Address Resolution Protocol)，其基本功能为透过目标设备的IP地址，查询目标的MAC地址，以保证通信的顺利进行。它是IPv4网络层必不可少的协议，不过在IPv6中已不再适用，并被邻居发现协议（NDP）所替代。</p><h2 id="4-urllib和urllib2的区别"><a href="#4-urllib和urllib2的区别" class="headerlink" title="4 urllib和urllib2的区别"></a>4 urllib和urllib2的区别</h2><p>这个面试官确实问过,当时答的urllib2可以Post而urllib不可以.</p><ol><li>urllib提供urlencode方法用来GET查询字符串的产生，而urllib2没有。这是为何urllib常和urllib2一起使用的原因。</li><li>urllib2可以接受一个Request类的实例来设置URL请求的headers，urllib仅可以接受URL。这意味着，你不可以伪装你的User Agent字符串等。</li></ol><h2 id="5-Post和Get"><a href="#5-Post和Get" class="headerlink" title="5 Post和Get"></a>5 Post和Get</h2><h2 id="6-Cookie和Session"><a href="#6-Cookie和Session" class="headerlink" title="6 Cookie和Session"></a>6 Cookie和Session</h2><table><thead><tr><th style="text-align:left"></th><th style="text-align:left">Cookie</th><th style="text-align:left">Session</th></tr></thead><tbody><tr><td style="text-align:left">储存位置</td><td style="text-align:left">客户端</td><td style="text-align:left">服务器端</td></tr><tr><td style="text-align:left">目的</td><td style="text-align:left">跟踪会话，也可以保存用户偏好设置或者保存用户名密码等</td><td style="text-align:left">跟踪会话</td></tr><tr><td style="text-align:left">安全性</td><td style="text-align:left">不安全</td><td style="text-align:left">安全</td></tr></tbody></table><p>session技术是要使用到cookie的，之所以出现session技术，主要是为了安全。</p><h2 id="7-apache和nginx的区别"><a href="#7-apache和nginx的区别" class="headerlink" title="7 apache和nginx的区别"></a>7 apache和nginx的区别</h2><p>nginx 相对 apache 的优点：</p><ul><li>轻量级，同样起web 服务，比apache 占用更少的内存及资源</li><li>抗并发，nginx 处理请求是异步非阻塞的，支持更多的并发连接，而apache 则是阻塞型的，在高并发下nginx 能保持低资源低消耗高性能</li><li>配置简洁</li><li>高度模块化的设计，编写模块相对简单</li><li>社区活跃</li></ul><p>apache 相对nginx 的优点：</p><ul><li>rewrite ，比nginx 的rewrite 强大</li><li>模块超多，基本想到的都可以找到</li><li>少bug ，nginx 的bug 相对较多</li><li>超稳定</li></ul><h2 id="8-网站用户密码保存"><a href="#8-网站用户密码保存" class="headerlink" title="8 网站用户密码保存"></a>8 网站用户密码保存</h2><ol><li>明文保存</li><li>明文hash后保存,如md5</li><li>MD5+Salt方式,这个salt可以随机</li><li>知乎使用了Bcrypy(好像)加密</li></ol><h2 id="9-HTTP和HTTPS"><a href="#9-HTTP和HTTPS" class="headerlink" title="9 HTTP和HTTPS"></a>9 HTTP和HTTPS</h2><table><thead><tr><th style="text-align:left">状态码</th><th style="text-align:left">定义</th></tr></thead><tbody><tr><td style="text-align:left">1xx 报告</td><td style="text-align:left">接收到请求，继续进程</td></tr><tr><td style="text-align:left">2xx 成功</td><td style="text-align:left">步骤成功接收，被理解，并被接受</td></tr><tr><td style="text-align:left">3xx 重定向</td><td style="text-align:left">为了完成请求,必须采取进一步措施</td></tr><tr><td style="text-align:left">4xx 客户端出错</td><td style="text-align:left">请求包括错的顺序或不能完成</td></tr><tr><td style="text-align:left">5xx 服务器出错</td><td style="text-align:left">服务器无法完成显然有效的请求</td></tr></tbody></table><p>403: Forbidden<br>404: Not Found</p><p>HTTPS握手,对称加密,非对称加密,TLS/SSL,RSA</p><h2 id="10-XSRF和XSS"><a href="#10-XSRF和XSS" class="headerlink" title="10 XSRF和XSS"></a>10 XSRF和XSS</h2><ul><li>CSRF(Cross-site request forgery)跨站请求伪造</li><li>XSS(Cross Site Scripting)跨站脚本攻击</li></ul><p>CSRF重点在请求,XSS重点在脚本</p><h2 id="11-幂等-Idempotence"><a href="#11-幂等-Idempotence" class="headerlink" title="11 幂等 Idempotence"></a>11 幂等 Idempotence</h2><p>HTTP方法的幂等性是指一次和多次请求某一个资源应该具有同样的<strong>副作用</strong>。(注意是副作用)</p><p><code>GET http://www.bank.com/account/123456</code>，不会改变资源的状态，不论调用一次还是N次都没有副作用。请注意，这里强调的是一次和N次具有相同的副作用，而不是每次GET的结果相同。<code>GET http://www.news.com/latest-news</code>这个HTTP请求可能会每次得到不同的结果，但它本身并没有产生任何副作用，因而是满足幂等性的。</p><p>DELETE方法用于删除资源，有副作用，但它应该满足幂等性。比如：<code>DELETE http://www.forum.com/article/4231</code>，调用一次和N次对系统产生的副作用是相同的，即删掉id为4231的帖子；因此，调用者可以多次调用或刷新页面而不必担心引起错误。</p><p>POST所对应的URI并非创建的资源本身，而是资源的接收者。比如：<code>POST http://www.forum.com/articles</code>的语义是在<code>http://www.forum.com/articles</code>下创建一篇帖子，HTTP响应中应包含帖子的创建状态以及帖子的URI。两次相同的POST请求会在服务器端创建两份资源，它们具有不同的URI；所以，POST方法不具备幂等性。</p><p>PUT所对应的URI是要创建或更新的资源本身。比如：<code>PUT http://www.forum/articles/4231</code>的语义是创建或更新ID为4231的帖子。对同一URI进行多次PUT的副作用和一次PUT是相同的；因此，PUT方法具有幂等性。</p><h2 id="12-RESTful架构-SOAP-RPC"><a href="#12-RESTful架构-SOAP-RPC" class="headerlink" title="12 RESTful架构(SOAP,RPC)"></a>12 RESTful架构(SOAP,RPC)</h2><blockquote><p>REST (Representational State Transfer) 是一种软件架构风格。它将服务端的信息和功能等所有事物统称为资源，客户端的请求实际就是对资源进行操作，它的主要特点有： 每一个资源都会对应一个独一无二的 url , 客户端通过 HTTP 的 GET、POST、PUT、DELETE 请求方法对资源进行查询、创建、修改、删除操作 - 客户端与服务端的交互必须是无状态的</p></blockquote><p>URI表示资源，HTTP的方法表示对资源的操作。</p><h2 id="13-SOAP"><a href="#13-SOAP" class="headerlink" title="13 SOAP"></a>13 SOAP</h2><p>SOAP（原为Simple Object Access Protocol的首字母缩写，即简单对象访问协议）是交换数据的一种协议规范，使用在计算机网络Web服务（web service）中，交换带结构信息。SOAP为了简化网页服务器（Web Server）从XML数据库中提取数据时，节省去格式化页面时间，以及不同应用程序之间按照HTTP通信协议，遵从XML格式执行资料互换，使其抽象于语言实现、平台和硬件。</p><h2 id="14-RPC"><a href="#14-RPC" class="headerlink" title="14 RPC"></a>14 RPC</h2><p>RPC（Remote Procedure Call Protocol）——远程过程调用协议，它是一种通过网络从远程计算机程序上请求服务，而不需要了解底层网络技术的协议。RPC协议假定某些传输协议的存在，如TCP或UDP，为通信程序之间携带信息数据。在OSI网络通信模型中，RPC跨越了传输层和应用层。RPC使得开发包括网络分布式多程序在内的应用程序更加容易。</p><p>总结:服务提供的两大流派.传统意义以方法调用为导向通称RPC。为了企业SOA,若干厂商联合推出webservice,制定了wsdl接口定义,传输soap.当互联网时代,臃肿SOA被简化为http+xml/json.但是简化出现各种混乱。以资源为导向,任何操作无非是对资源的增删改查，于是统一的REST出现了.</p><p>进化的顺序: RPC -&gt; SOAP -&gt; RESTful</p><h2 id="15-CGI和WSGI"><a href="#15-CGI和WSGI" class="headerlink" title="15 CGI和WSGI"></a>15 CGI和WSGI</h2><p>CGI是通用网关接口，是连接web服务器和应用程序的接口，用户通过CGI来获取动态数据或文件等。<br>CGI程序是一个独立的程序，它可以用几乎所有语言来写，包括perl，c，lua，python等等。</p><p>WSGI, Web Server Gateway Interface，是Python应用程序或框架和Web服务器之间的一种接口，WSGI的其中一个目的就是让用户可以用统一的语言(Python)编写前后端。</p><h2 id="16-中间人攻击"><a href="#16-中间人攻击" class="headerlink" title="16 中间人攻击"></a>16 中间人攻击</h2><p>在GFW里屡见不鲜的,呵呵.</p><p>中间人攻击（Man-in-the-middle attack，通常缩写为MITM）是指攻击者与通讯的两端分别创建独立的联系，并交换其所收到的数据，使通讯的两端认为他们正在通过一个私密的连接与对方直接对话，但事实上整个会话都被攻击者完全控制。</p><h2 id="17-c10k问题"><a href="#17-c10k问题" class="headerlink" title="17 c10k问题"></a>17 c10k问题</h2><p>所谓c10k问题，指的是服务器同时支持成千上万个客户端的问题，也就是concurrent 10 000 connection（这也是c10k这个名字的由来）。</p><ul><li>异步非阻塞，如基于epoll原理的编程</li><li>分布式系统</li></ul><h2 id="18-socket"><a href="#18-socket" class="headerlink" title="18 socket"></a>18 socket</h2><p>Socket=Ip address+ TCP/UDP + port</p><h2 id="19-浏览器缓存"><a href="#19-浏览器缓存" class="headerlink" title="19 浏览器缓存"></a>19 浏览器缓存</h2><p>304 Not Modified</p><h2 id="20-HTTP1-0和HTTP1-1"><a href="#20-HTTP1-0和HTTP1-1" class="headerlink" title="20 HTTP1.0和HTTP1.1"></a>20 HTTP1.0和HTTP1.1</h2><p>新的特点：请求头有Host字段,因此一个服务器可部署多个网站；长链接；文件断点续传；身份认证,状态管理,Cache缓存</p><p>HTTP/1.1协议中共定义了8种HTTP请求方法，不同的方法规定了不同的操作指定的资源方式。服务端也会根据不同的请求方法做不同的响应。</p><ul><li>GET ：一般只用于数据的读取，而不应当用于会产生副作用的非幂等的操作中。</li><li>HEAD: 只请求服务器的响应头信息。</li><li>POST: 向指定资源提交数据如：表单数据提交、文件上传等，请求数据会被包含在请求体中。POST方法是非幂等的方法，因为这个请求可能会创建新的资源或/和修改现有资源。</li><li>PUT: 向指定资源位置上传其最新内容，PUT方法是幂等的方法。通过该方法客户端可以将指定资源的最新数据传送给服务器取代指定的资源的内容。</li><li>DELETE: 用于请求服务器删除所请求URI所标识的资源。DELETE方法也是幂等的。</li><li>CONNECT: HTTP/1.1协议预留的，能够将连接改为管道方式的代理服务器。通常用于SSL加密服务器的链接与非加密的HTTP代理服务器的通信。</li><li>OPTIONS: 请求服务器返回该资源所支持的所有HTTP请求方法，该方法会用’*’来代替资源名称，向服务器发送OPTIONS请求，可以测试服务器功能是否正常。JavaScript的XMLHttpRequest对象进行CORS跨域资源共享时，就是使用OPTIONS方法发送嗅探请求，以判断是否有对指定资源的访问权限。 </li><li>TRACE: 请求服务器回显其收到的请求信息，该方法主要用于HTTP请求的测试或诊断</li><li>PATCH:1.1新增的方法，同PUT一样，用于资源的更新,PATCH一般用于资源的部分更新，而PUT一般用于资源的整体更新。 当资源不存在时，PATCH会创建一个新的资源，而PUT只会对已在资源进行更新。</li></ul><h2 id="21-Ajax"><a href="#21-Ajax" class="headerlink" title="21 Ajax"></a>21 Ajax</h2><p>AJAX,Asynchronous JavaScript and XML（异步的 JavaScript 和 XML）, 是与在不重新加载整个页面的情况下，与服务器交换数据并更新部分网页的技术。</p><h1 id="UNIX"><a href="#UNIX" class="headerlink" title="UNIX"></a>UNIX</h1><h2 id="unix进程间通信方式-IPC"><a href="#unix进程间通信方式-IPC" class="headerlink" title="unix进程间通信方式(IPC)"></a>unix进程间通信方式(IPC)</h2><ol><li>管道（Pipe）：管道可用于具有亲缘关系进程间的通信，允许一个进程和另一个与它有共同祖先的进程之间进行通信。</li><li>命名管道（named pipe）：命名管道克服了管道没有名字的限制，因此，除具有管道所具有的功能外，它还允许无亲缘关系进程间的通信。命名管道在文件系统中有对应的文件名。命名管道通过命令mkfifo或系统调用mkfifo来创建。</li><li>信号（Signal）：信号是比较复杂的通信方式，用于通知接受进程有某种事件发生，除了用于进程间通信外，进程还可以发送信号给进程本身；linux除了支持Unix早期信号语义函数sigal外，还支持语义符合Posix.1标准的信号函数sigaction（实际上，该函数是基于BSD的，BSD为了实现可靠信号机制，又能够统一对外接口，用sigaction函数重新实现了signal函数）。</li><li>消息（Message）队列：消息队列是消息的链接表，包括Posix消息队列system V消息队列。有足够权限的进程可以向队列中添加消息，被赋予读权限的进程则可以读走队列中的消息。消息队列克服了信号承载信息量少，管道只能承载无格式字节流以及缓冲区大小受限等缺</li><li>共享内存：使得多个进程可以访问同一块内存空间，是最快的可用IPC形式。是针对其他通信机制运行效率较低而设计的。往往与其它通信机制，如信号量结合使用，来达到进程间的同步及互斥。</li><li>内存映射（mapped memory）：内存映射允许任何多个进程间通信，每一个使用该机制的进程通过把一个共享的文件映射到自己的进程地址空间来实现它。</li><li>信号量（semaphore）：主要作为进程间以及同一进程不同线程之间的同步手段。</li><li>套接口（Socket）：更为一般的进程间通信机制，可用于不同机器之间的进程间通信。起初是由Unix系统的BSD分支开发出来的，但现在一般可以移植到其它类Unix系统上：Linux和System V的变种都支持套接字。</li></ol><h1 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h1><h2 id="1-红黑树"><a href="#1-红黑树" class="headerlink" title="1 红黑树"></a>1 红黑树</h2><p>红黑树与AVL的比较：</p><p>AVL是严格平衡树，因此在增加或者删除节点的时候，根据不同情况，旋转的次数比红黑树要多；</p><p>红黑是用非严格的平衡来换取增删节点时候旋转次数的降低；</p><p>所以简单说，如果你的应用中，搜索的次数远远大于插入和删除，那么选择AVL，如果搜索，插入删除次数几乎差不多，应该选择RB。</p><h1 id="编程题"><a href="#编程题" class="headerlink" title="编程题"></a>编程题</h1><h2 id="1-台阶问题-斐波那契"><a href="#1-台阶问题-斐波那契" class="headerlink" title="1 台阶问题/斐波那契"></a>1 台阶问题/斐波那契</h2><p>一只青蛙一次可以跳上1级台阶，也可以跳上2级。求该青蛙跳上一个n级的台阶总共有多少种跳法。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fib = <span class="keyword">lambda</span> n: n <span class="keyword">if</span> n &lt;= <span class="number">2</span> <span class="keyword">else</span> fib(n - <span class="number">1</span>) + fib(n - <span class="number">2</span>)</div></pre></td></tr></table></figure><p>第二种记忆方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">memo</span><span class="params">(func)</span>:</span></div><div class="line">    cache = &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrap</span><span class="params">(*args)</span>:</span></div><div class="line">        <span class="keyword">if</span> args <span class="keyword">not</span> <span class="keyword">in</span> cache:</div><div class="line">            cache[args] = func(*args)</div><div class="line">        <span class="keyword">return</span> cache[args]</div><div class="line">    <span class="keyword">return</span> wrap</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">@memo</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(i)</span>:</span></div><div class="line">    <span class="keyword">if</span> i &lt; <span class="number">2</span>:</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> fib(i<span class="number">-1</span>) + fib(i<span class="number">-2</span>)</div></pre></td></tr></table></figure><p>第三种方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(n)</span>:</span></div><div class="line">    a, b = <span class="number">0</span>, <span class="number">1</span></div><div class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(n):</div><div class="line">        a, b = b, a + b</div><div class="line">    <span class="keyword">return</span> b</div></pre></td></tr></table></figure><h2 id="2-变态台阶问题"><a href="#2-变态台阶问题" class="headerlink" title="2 变态台阶问题"></a>2 变态台阶问题</h2><p>一只青蛙一次可以跳上1级台阶，也可以跳上2级……它也可以跳上n级。求该青蛙跳上一个n级的台阶总共有多少种跳法。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fib = <span class="keyword">lambda</span> n: n <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">else</span> <span class="number">2</span> * fib(n - <span class="number">1</span>)</div></pre></td></tr></table></figure><h2 id="3-矩形覆盖"><a href="#3-矩形覆盖" class="headerlink" title="3 矩形覆盖"></a>3 矩形覆盖</h2><p>我们可以用<code>2*1</code>的小矩形横着或者竖着去覆盖更大的矩形。请问用n个<code>2*1</code>的小矩形无重叠地覆盖一个<code>2*n</code>的大矩形，总共有多少种方法？</p><blockquote><p>第<code>2*n</code>个矩形的覆盖方法等于第<code>2*(n-1)</code>加上第<code>2*(n-2)</code>的方法。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f = <span class="keyword">lambda</span> n: <span class="number">1</span> <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">else</span> f(n - <span class="number">1</span>) + f(n - <span class="number">2</span>)</div></pre></td></tr></table></figure><h2 id="4-杨氏矩阵查找"><a href="#4-杨氏矩阵查找" class="headerlink" title="4 杨氏矩阵查找"></a>4 杨氏矩阵查找</h2><p>在一个m行n列二维数组中，每一行都按照从左到右递增的顺序排序，每一列都按照从上到下递增的顺序排序。请完成一个函数，输入这样的一个二维数组和一个整数，判断数组中是否含有该整数。</p><p>使用Step-wise线性搜索。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_value</span><span class="params">(l, r, c)</span>:</span></div><div class="line">    <span class="keyword">return</span> l[r][c]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find</span><span class="params">(l, x)</span>:</span></div><div class="line">    m = len(l) - <span class="number">1</span></div><div class="line">    n = len(l[<span class="number">0</span>]) - <span class="number">1</span></div><div class="line">    r = <span class="number">0</span></div><div class="line">    c = n</div><div class="line">    <span class="keyword">while</span> c &gt;= <span class="number">0</span> <span class="keyword">and</span> r &lt;= m:</div><div class="line">        value = get_value(l, r, c)</div><div class="line">        <span class="keyword">if</span> value == x:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">        <span class="keyword">elif</span> value &gt; x:</div><div class="line">            c = c - <span class="number">1</span></div><div class="line">        <span class="keyword">elif</span> value &lt; x:</div><div class="line">            r = r + <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">False</span></div></pre></td></tr></table></figure><h2 id="5-去除列表中的重复元素"><a href="#5-去除列表中的重复元素" class="headerlink" title="5 去除列表中的重复元素"></a>5 去除列表中的重复元素</h2><p>用集合</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">list(set(l))</div></pre></td></tr></table></figure><p>用字典</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">l1 = [<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'a'</span>,<span class="string">'a'</span>]</div><div class="line">l2 = &#123;&#125;.fromkeys(l1).keys()</div><div class="line"><span class="keyword">print</span> l2</div></pre></td></tr></table></figure><p>用字典并保持顺序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">l1 = [<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'a'</span>,<span class="string">'a'</span>]</div><div class="line">l2 = list(set(l1))</div><div class="line">l2.sort(key=l1.index)</div><div class="line"><span class="keyword">print</span> l2</div></pre></td></tr></table></figure><p>列表推导式</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">l1 = [<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'a'</span>,<span class="string">'a'</span>]</div><div class="line">l2 = []</div><div class="line">[l2.append(i) <span class="keyword">for</span> i <span class="keyword">in</span> l1 <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> l2]</div></pre></td></tr></table></figure><p>sorted排序并且用列表推导式.</p><p>l = [‘b’,’c’,’d’,’b’,’c’,’a’,’a’]<br>[single.append(i) for i in sorted(l) if i not in single]<br>print single</p><h2 id="6-链表成对调换"><a href="#6-链表成对调换" class="headerlink" title="6 链表成对调换"></a>6 链表成对调换</h2><p><code>1-&gt;2-&gt;3-&gt;4</code>转换成<code>2-&gt;1-&gt;4-&gt;3</code>.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListNode</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x)</span>:</span></div><div class="line">        self.val = x</div><div class="line">        self.next = <span class="keyword">None</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></div><div class="line">    <span class="comment"># @param a ListNode</span></div><div class="line">    <span class="comment"># @return a ListNode</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">swapPairs</span><span class="params">(self, head)</span>:</span></div><div class="line">        <span class="keyword">if</span> head != <span class="keyword">None</span> <span class="keyword">and</span> head.next != <span class="keyword">None</span>:</div><div class="line">            next = head.next</div><div class="line">            head.next = self.swapPairs(next.next)</div><div class="line">            next.next = head</div><div class="line">            <span class="keyword">return</span> next</div><div class="line">        <span class="keyword">return</span> head</div></pre></td></tr></table></figure><h2 id="7-创建字典的方法"><a href="#7-创建字典的方法" class="headerlink" title="7 创建字典的方法"></a>7 创建字典的方法</h2><h3 id="1-直接创建"><a href="#1-直接创建" class="headerlink" title="1 直接创建"></a>1 直接创建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dict = &#123;<span class="string">'name'</span>:<span class="string">'earth'</span>, <span class="string">'port'</span>:<span class="string">'80'</span>&#125;</div></pre></td></tr></table></figure><h3 id="2-工厂方法"><a href="#2-工厂方法" class="headerlink" title="2 工厂方法"></a>2 工厂方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">items=[(<span class="string">'name'</span>,<span class="string">'earth'</span>),(<span class="string">'port'</span>,<span class="string">'80'</span>)]</div><div class="line">dict2=dict(items)</div><div class="line">dict1=dict(([<span class="string">'name'</span>,<span class="string">'earth'</span>],[<span class="string">'port'</span>,<span class="string">'80'</span>]))</div></pre></td></tr></table></figure><h3 id="3-fromkeys-方法"><a href="#3-fromkeys-方法" class="headerlink" title="3 fromkeys()方法"></a>3 fromkeys()方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dict1=&#123;&#125;.fromkeys((<span class="string">'x'</span>,<span class="string">'y'</span>),<span class="number">-1</span>)</div><div class="line">dict=&#123;<span class="string">'x'</span>:<span class="number">-1</span>,<span class="string">'y'</span>:<span class="number">-1</span>&#125;</div><div class="line">dict2=&#123;&#125;.fromkeys((<span class="string">'x'</span>,<span class="string">'y'</span>))</div><div class="line">dict2=&#123;<span class="string">'x'</span>:<span class="keyword">None</span>, <span class="string">'y'</span>:<span class="keyword">None</span>&#125;</div></pre></td></tr></table></figure><h2 id="8-合并两个有序列表"><a href="#8-合并两个有序列表" class="headerlink" title="8 合并两个有序列表"></a>8 合并两个有序列表</h2><p>尾递归</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">_recursion_merge_sort2</span><span class="params">(l1, l2, tmp)</span>:</span></div><div class="line">    <span class="keyword">if</span> len(l1) == <span class="number">0</span> <span class="keyword">or</span> len(l2) == <span class="number">0</span>:</div><div class="line">        tmp.extend(l1)</div><div class="line">        tmp.extend(l2)</div><div class="line">        <span class="keyword">return</span> tmp</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">if</span> l1[<span class="number">0</span>] &lt; l2[<span class="number">0</span>]:</div><div class="line">            tmp.append(l1[<span class="number">0</span>])</div><div class="line">            <span class="keyword">del</span> l1[<span class="number">0</span>]</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            tmp.append(l2[<span class="number">0</span>])</div><div class="line">            <span class="keyword">del</span> l2[<span class="number">0</span>]</div><div class="line">        <span class="keyword">return</span> _recursion_merge_sort2(l1, l2, tmp)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">recursion_merge_sort2</span><span class="params">(l1, l2)</span>:</span></div><div class="line">    <span class="keyword">return</span> _recursion_merge_sort2(l1, l2, [])</div></pre></td></tr></table></figure><p>循环算法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">loop_merge_sort</span><span class="params">(l1, l2)</span>:</span></div><div class="line">    tmp = []</div><div class="line">    <span class="keyword">while</span> len(l1) &gt; <span class="number">0</span> <span class="keyword">and</span> len(l2) &gt; <span class="number">0</span>:</div><div class="line">        <span class="keyword">if</span> l1[<span class="number">0</span>] &lt; l2[<span class="number">0</span>]:</div><div class="line">            tmp.append(l1[<span class="number">0</span>])</div><div class="line">            <span class="keyword">del</span> l1[<span class="number">0</span>]</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            tmp.append(l2[<span class="number">0</span>])</div><div class="line">            <span class="keyword">del</span> l2[<span class="number">0</span>]</div><div class="line">    tmp.extend(l1)</div><div class="line">    tmp.extend(l2)</div><div class="line">    <span class="keyword">return</span> tmp</div></pre></td></tr></table></figure><p>pop弹出</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">7</span>]</div><div class="line">b = [<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">merge_sortedlist</span><span class="params">(a,b)</span>:</span></div><div class="line">    c = []</div><div class="line">    <span class="keyword">while</span> a <span class="keyword">and</span> b:</div><div class="line">        <span class="keyword">if</span> a[<span class="number">0</span>] &gt;= b[<span class="number">0</span>]:</div><div class="line">            c.append(b.pop(<span class="number">0</span>))</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            c.append(a.pop(<span class="number">0</span>))</div><div class="line">    <span class="keyword">while</span> a:</div><div class="line">        c.append(a.pop(<span class="number">0</span>))</div><div class="line">    <span class="keyword">while</span> b:</div><div class="line">        c.append(b.pop(<span class="number">0</span>))</div><div class="line">    <span class="keyword">return</span> c</div><div class="line"><span class="keyword">print</span> merge_sortedlist(a,b)</div></pre></td></tr></table></figure><h2 id="9-交叉链表求交点"><a href="#9-交叉链表求交点" class="headerlink" title="9 交叉链表求交点"></a>9 交叉链表求交点</h2><blockquote><p>其实思想可以按照从尾开始比较两个链表，如果相交，则从尾开始必然一致，只要从尾开始比较，直至不一致的地方即为交叉点，如图所示</p></blockquote><p><img src="http://hi.csdn.net/attachment/201106/28/0_1309244136MWLP.gif" alt=""></p><p>我觉得用栈更简单。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListNode</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x)</span>:</span></div><div class="line">        self.val = x</div><div class="line">        self.next = <span class="keyword">None</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">node</span><span class="params">(l1, l2)</span>:</span></div><div class="line">    length1, length2 = <span class="number">0</span>, <span class="number">0</span></div><div class="line">    <span class="comment"># 求两个链表长度</span></div><div class="line">    <span class="keyword">while</span> l1.next:</div><div class="line">        l1 = l1.next<span class="comment">#尾节点</span></div><div class="line">        length1 += <span class="number">1</span></div><div class="line">    <span class="keyword">while</span> l2.next:</div><div class="line">        l2 = l2.next<span class="comment">#尾节点</span></div><div class="line">        length2 += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="comment">#如果相交</span></div><div class="line">    <span class="keyword">if</span> l1.next == l2.next:</div><div class="line">        <span class="comment"># 长的链表先走</span></div><div class="line">        <span class="keyword">if</span> length1 &gt; length2:</div><div class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(length1 - length2):</div><div class="line">                l1 = l1.next</div><div class="line">            <span class="keyword">return</span> l1<span class="comment">#返回交点</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(length2 - length1):</div><div class="line">                l2 = l2.next</div><div class="line">            <span class="keyword">return</span> l2<span class="comment">#返回交点</span></div><div class="line">    <span class="comment"># 如果不相交</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span></div></pre></td></tr></table></figure><h2 id="10-二分查找"><a href="#10-二分查找" class="headerlink" title="10 二分查找"></a>10 二分查找</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">binary_search</span><span class="params">(list,item)</span>:</span></div><div class="line">    low = <span class="number">0</span></div><div class="line">    high = len(list)<span class="number">-1</span></div><div class="line">    <span class="keyword">while</span> low&lt;=high:</div><div class="line">        mid = (low+high)/<span class="number">2</span></div><div class="line">        guess = list[mid]</div><div class="line">        <span class="keyword">if</span> guess&gt;item:</div><div class="line">            high = mid<span class="number">-1</span></div><div class="line">        <span class="keyword">elif</span> guess&lt;item:</div><div class="line">            low = mid+<span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> mid</div><div class="line">    <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line">mylist = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>]</div><div class="line"><span class="keyword">print</span> binary_search(mylist,<span class="number">3</span>)</div></pre></td></tr></table></figure><h2 id="11-快排"><a href="#11-快排" class="headerlink" title="11 快排"></a>11 快排</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">quicksort</span><span class="params">(list)</span>:</span></div><div class="line">    <span class="keyword">if</span> len(list)&lt;<span class="number">2</span>:</div><div class="line">        <span class="keyword">return</span> list</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        midpivot = list[<span class="number">0</span>]</div><div class="line">        lessbeforemidpivot = [i <span class="keyword">for</span> i <span class="keyword">in</span> list[<span class="number">1</span>:] <span class="keyword">if</span> i&lt;=midpivot]</div><div class="line">        biggerafterpivot = [i <span class="keyword">for</span> i <span class="keyword">in</span> list[<span class="number">1</span>:] <span class="keyword">if</span> i &gt; midpivot]</div><div class="line">        finallylist = quicksort(lessbeforemidpivot)+[midpivot]+quicksort(biggerafterpivot)</div><div class="line">        <span class="keyword">return</span> finallylist</div><div class="line"></div><div class="line"><span class="keyword">print</span> quicksort([<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>])</div></pre></td></tr></table></figure><h2 id="12-找零问题"><a href="#12-找零问题" class="headerlink" title="12 找零问题"></a>12 找零问题</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="comment">#values是硬币的面值values = [ 25, 21, 10, 5, 1]</span></div><div class="line"><span class="comment">#valuesCounts   钱币对应的种类数</span></div><div class="line"><span class="comment">#money  找出来的总钱数</span></div><div class="line"><span class="comment">#coinsUsed   对应于目前钱币总数i所使用的硬币数目</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">coinChange</span><span class="params">(values,valuesCounts,money,coinsUsed)</span>:</span></div><div class="line">    <span class="comment">#遍历出从1到money所有的钱数可能</span></div><div class="line">    <span class="keyword">for</span> cents <span class="keyword">in</span> range(<span class="number">1</span>,money+<span class="number">1</span>):</div><div class="line">        minCoins = cents</div><div class="line">        <span class="comment">#把所有的硬币面值遍历出来和钱数做对比</span></div><div class="line">        <span class="keyword">for</span> kind <span class="keyword">in</span> range(<span class="number">0</span>,valuesCounts):</div><div class="line">            <span class="keyword">if</span> (values[kind] &lt;= cents):</div><div class="line">                temp = coinsUsed[cents - values[kind]] +<span class="number">1</span></div><div class="line">                <span class="keyword">if</span> (temp &lt; minCoins):</div><div class="line">                    minCoins = temp</div><div class="line">        coinsUsed[cents] = minCoins</div><div class="line">        <span class="keyword">print</span> (<span class="string">'面值:&#123;0&#125;的最少硬币使用数为:&#123;1&#125;'</span>.format(cents, coinsUsed[cents]))</div></pre></td></tr></table></figure><h2 id="13-广度遍历和深度遍历二叉树"><a href="#13-广度遍历和深度遍历二叉树" class="headerlink" title="13 广度遍历和深度遍历二叉树"></a>13 广度遍历和深度遍历二叉树</h2><p>给定一个数组，构建二叉树，并且按层次打印这个二叉树</p><h2 id="14-二叉树节点"><a href="#14-二叉树节点" class="headerlink" title="14 二叉树节点"></a>14 二叉树节点</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, data, left=None, right=None)</span>:</span></div><div class="line">        self.data = data</div><div class="line">        self.left = left</div><div class="line">        self.right = right</div><div class="line"></div><div class="line">tree = Node(<span class="number">1</span>, Node(<span class="number">3</span>, Node(<span class="number">7</span>, Node(<span class="number">0</span>)), Node(<span class="number">6</span>)), Node(<span class="number">2</span>, Node(<span class="number">5</span>), Node(<span class="number">4</span>)))</div></pre></td></tr></table></figure><h2 id="15-层次遍历"><a href="#15-层次遍历" class="headerlink" title="15 层次遍历"></a>15 层次遍历</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">lookup</span><span class="params">(root)</span>:</span></div><div class="line">    stack = [root]</div><div class="line">    <span class="keyword">while</span> stack:</div><div class="line">        current = stack.pop(<span class="number">0</span>)</div><div class="line">        <span class="keyword">print</span> current.data</div><div class="line">        <span class="keyword">if</span> current.left:</div><div class="line">            stack.append(current.left)</div><div class="line">        <span class="keyword">if</span> current.right:</div><div class="line">            stack.append(current.right)</div></pre></td></tr></table></figure><h2 id="16-深度遍历"><a href="#16-深度遍历" class="headerlink" title="16 深度遍历"></a>16 深度遍历</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">deep</span><span class="params">(root)</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> root:</div><div class="line">        <span class="keyword">return</span></div><div class="line">    <span class="keyword">print</span> root.data</div><div class="line">    deep(root.left)</div><div class="line">    deep(root.right)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    lookup(tree)</div><div class="line">    deep(tree)</div></pre></td></tr></table></figure><h2 id="17-前中后序遍历"><a href="#17-前中后序遍历" class="headerlink" title="17 前中后序遍历"></a>17 前中后序遍历</h2><p>深度遍历改变顺序就OK了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line"><span class="comment">#二叉树的遍历</span></div><div class="line"><span class="comment">#简单的二叉树节点类</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,value,left,right)</span>:</span></div><div class="line">        self.value = value</div><div class="line">        self.left = left</div><div class="line">        self.right = right</div><div class="line"></div><div class="line"><span class="comment">#中序遍历:遍历左子树,访问当前节点,遍历右子树</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">mid_travelsal</span><span class="params">(root)</span>:</span></div><div class="line">    <span class="keyword">if</span> root.left <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">        mid_travelsal(root.left)</div><div class="line">    <span class="comment">#访问当前节点</span></div><div class="line">    print(root.value)</div><div class="line">    <span class="keyword">if</span> root.right <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        mid_travelsal(root.right)</div><div class="line"></div><div class="line"><span class="comment">#前序遍历:访问当前节点,遍历左子树,遍历右子树</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pre_travelsal</span><span class="params">(root)</span>:</span></div><div class="line">    <span class="keyword">print</span> (root.value)</div><div class="line">    <span class="keyword">if</span> root.left <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        pre_travelsal(root.left)</div><div class="line">    <span class="keyword">if</span> root.right <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        pre_travelsal(root.right)</div><div class="line"></div><div class="line"><span class="comment">#后续遍历:遍历左子树,遍历右子树,访问当前节点</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">post_trvelsal</span><span class="params">(root)</span>:</span></div><div class="line">    <span class="keyword">if</span> root.left <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        post_trvelsal(root.left)</div><div class="line">    <span class="keyword">if</span> root.right <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        post_trvelsal(root.right)</div><div class="line">    <span class="keyword">print</span> (root.value)</div></pre></td></tr></table></figure><h2 id="18-求最大树深"><a href="#18-求最大树深" class="headerlink" title="18 求最大树深"></a>18 求最大树深</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">maxDepth</span><span class="params">(root)</span>:</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span></div><div class="line">        <span class="keyword">return</span> max(maxDepth(root.left), maxDepth(root.right)) + <span class="number">1</span></div></pre></td></tr></table></figure><h2 id="19-求两棵树是否相同"><a href="#19-求两棵树是否相同" class="headerlink" title="19 求两棵树是否相同"></a>19 求两棵树是否相同</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">isSameTree</span><span class="params">(p, q)</span>:</span></div><div class="line">    <span class="keyword">if</span> p == <span class="keyword">None</span> <span class="keyword">and</span> q == <span class="keyword">None</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">    <span class="keyword">elif</span> p <span class="keyword">and</span> q :</div><div class="line">        <span class="keyword">return</span> p.val == q.val <span class="keyword">and</span> isSameTree(p.left,q.left) <span class="keyword">and</span> isSameTree(p.right,q.right)</div><div class="line">    <span class="keyword">else</span> :</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div></pre></td></tr></table></figure><h2 id="20-前序中序求后序"><a href="#20-前序中序求后序" class="headerlink" title="20 前序中序求后序"></a>20 前序中序求后序</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">rebuild</span><span class="params">(pre, center)</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> pre:</div><div class="line">        <span class="keyword">return</span></div><div class="line">    cur = Node(pre[<span class="number">0</span>])</div><div class="line">    index = center.index(pre[<span class="number">0</span>])</div><div class="line">    cur.left = rebuild(pre[<span class="number">1</span>:index + <span class="number">1</span>], center[:index])</div><div class="line">    cur.right = rebuild(pre[index + <span class="number">1</span>:], center[index + <span class="number">1</span>:])</div><div class="line">    <span class="keyword">return</span> cur</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">deep</span><span class="params">(root)</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> root:</div><div class="line">        <span class="keyword">return</span></div><div class="line">    deep(root.left)</div><div class="line">    deep(root.right)</div><div class="line">    <span class="keyword">print</span> root.data</div></pre></td></tr></table></figure><h2 id="21-单链表逆置"><a href="#21-单链表逆置" class="headerlink" title="21 单链表逆置"></a>21 单链表逆置</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, data=None, next=None)</span>:</span></div><div class="line">        self.data = data</div><div class="line">        self.next = next</div><div class="line"></div><div class="line">link = Node(<span class="number">1</span>, Node(<span class="number">2</span>, Node(<span class="number">3</span>, Node(<span class="number">4</span>, Node(<span class="number">5</span>, Node(<span class="number">6</span>, Node(<span class="number">7</span>, Node(<span class="number">8</span>, Node(<span class="number">9</span>)))))))))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">rev</span><span class="params">(link)</span>:</span></div><div class="line">    pre = link</div><div class="line">    cur = link.next</div><div class="line">    pre.next = <span class="keyword">None</span></div><div class="line">    <span class="keyword">while</span> cur:</div><div class="line">        tmp = cur.next</div><div class="line">        cur.next = pre</div><div class="line">        pre = cur</div><div class="line">        cur = tmp</div><div class="line">    <span class="keyword">return</span> pre</div><div class="line"></div><div class="line">root = rev(link)</div><div class="line"><span class="keyword">while</span> root:</div><div class="line">    <span class="keyword">print</span> root.data</div><div class="line">    root = root.next</div></pre></td></tr></table></figure><h2 id="22-两个字符串是否是变位词"><a href="#22-两个字符串是否是变位词" class="headerlink" title="22 两个字符串是否是变位词"></a>22 两个字符串是否是变位词</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Anagram</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line"><span class="string">    @:param s1: The first string</span></div><div class="line"><span class="string">    @:param s2: The second string</span></div><div class="line"><span class="string">    @:return true or false</span></div><div class="line"><span class="string">    """</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Solution1</span><span class="params">(s1,s2)</span>:</span></div><div class="line">        alist = list(s2)</div><div class="line"></div><div class="line">        pos1 = <span class="number">0</span></div><div class="line">        stillOK = <span class="keyword">True</span></div><div class="line"></div><div class="line">        <span class="keyword">while</span> pos1 &lt; len(s1) <span class="keyword">and</span> stillOK:</div><div class="line">            pos2 = <span class="number">0</span></div><div class="line">            found = <span class="keyword">False</span></div><div class="line">            <span class="keyword">while</span> pos2 &lt; len(alist) <span class="keyword">and</span> <span class="keyword">not</span> found:</div><div class="line">                <span class="keyword">if</span> s1[pos1] == alist[pos2]:</div><div class="line">                    found = <span class="keyword">True</span></div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    pos2 = pos2 + <span class="number">1</span></div><div class="line"></div><div class="line">            <span class="keyword">if</span> found:</div><div class="line">                alist[pos2] = <span class="keyword">None</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                stillOK = <span class="keyword">False</span></div><div class="line"></div><div class="line">            pos1 = pos1 + <span class="number">1</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> stillOK</div><div class="line"></div><div class="line">    print(Solution1(<span class="string">'abcd'</span>,<span class="string">'dcba'</span>))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Solution2</span><span class="params">(s1,s2)</span>:</span></div><div class="line">        alist1 = list(s1)</div><div class="line">        alist2 = list(s2)</div><div class="line"></div><div class="line">        alist1.sort()</div><div class="line">        alist2.sort()</div><div class="line"></div><div class="line"></div><div class="line">        pos = <span class="number">0</span></div><div class="line">        matches = <span class="keyword">True</span></div><div class="line"></div><div class="line">        <span class="keyword">while</span> pos &lt; len(s1) <span class="keyword">and</span> matches:</div><div class="line">            <span class="keyword">if</span> alist1[pos] == alist2[pos]:</div><div class="line">                pos = pos + <span class="number">1</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                matches = <span class="keyword">False</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> matches</div><div class="line"></div><div class="line">    print(Solution2(<span class="string">'abcde'</span>,<span class="string">'edcbg'</span>))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Solution3</span><span class="params">(s1,s2)</span>:</span></div><div class="line">        c1 = [<span class="number">0</span>]*<span class="number">26</span></div><div class="line">        c2 = [<span class="number">0</span>]*<span class="number">26</span></div><div class="line"></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s1)):</div><div class="line">            pos = ord(s1[i])-ord(<span class="string">'a'</span>)</div><div class="line">            c1[pos] = c1[pos] + <span class="number">1</span></div><div class="line"></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s2)):</div><div class="line">            pos = ord(s2[i])-ord(<span class="string">'a'</span>)</div><div class="line">            c2[pos] = c2[pos] + <span class="number">1</span></div><div class="line"></div><div class="line">        j = <span class="number">0</span></div><div class="line">        stillOK = <span class="keyword">True</span></div><div class="line">        <span class="keyword">while</span> j&lt;<span class="number">26</span> <span class="keyword">and</span> stillOK:</div><div class="line">            <span class="keyword">if</span> c1[j] == c2[j]:</div><div class="line">                j = j + <span class="number">1</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                stillOK = <span class="keyword">False</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> stillOK</div><div class="line"></div><div class="line">    print(Solution3(<span class="string">'apple'</span>,<span class="string">'pleap'</span>))</div></pre></td></tr></table></figure><h2 id="23-动态规划问题"><a href="#23-动态规划问题" class="headerlink" title="23 动态规划问题"></a>23 动态规划问题</h2><blockquote><p>背包问题(Knapsack problem)是一种组合优化的NP完全问题。问题可以描述为：给定一组物品，每种物品都有自己的重量和价格，在限定的总重量内，如何选择才能使得物品的总价格最高。</p></blockquote><h3 id="01背包问题"><a href="#01背包问题" class="headerlink" title="01背包问题"></a>01背包问题</h3><p><strong>问题描述</strong>：有编号分别为a,b,c,d,e的五件物品，它们的重量分别是2,2,6,5,4，它们的价值分别是6,3,5,4,6，每件物品数量只有一个，现在给你个承重为10的背包，如何让背包里装入的物品具有最大的价值总和？</p><p><strong>基本思路</strong>：将该问题转换成子问题，考虑五件物品在给定承重 C 的背包下最大价值为原问题，如下表所示，即为考虑abcde，C = 10时的最大价值，假设为<code>f[5][10]</code>，原问题的解可以分解为两种情况，第一种情况是不考虑放入a只考虑放入bcde承重为C时的最大价值<code>f[4][C]</code>,第二种情况是考虑放入a时的最大价值，即<code>value[a]+f[4][10-weight[a]]</code>。 原问题的解<code>f[5][10]</code>取上述两种情况中的最大值，即<code>f[5][10] = max{f[4][10], (f[4][10-weight[a]+value[a]))}</code>。 由此可以看出里面涉及到需要计算<code>f[4][10]</code>和<code>f[4][10-weight[a]]</code>即<code>f[4][4]</code>等子问题。 以此类推，自顶向下的分析可以看出原问题需要子问题的解，我们需要先计算出子问题的解，自底向上求解。求解方式如下表所示，顺序是自底向上、从左往右，或者从左往右、自底向上都可以。注意此问题中的abcde可以包含相同的物件，它们之间的顺序也可以是任意的，不影响最终的结果。</p><table><thead><tr><th>name</th><th>weight</th><th>value</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th></tr></thead><tbody><tr><td>a</td><td>2</td><td>6</td><td>0</td><td>0</td><td>6</td><td>6</td><td>9</td><td>9</td><td>12</td><td>12</td><td>15</td><td>15</td><td>15</td></tr><tr><td>b</td><td>2</td><td>3</td><td>0</td><td>0</td><td>3</td><td>3</td><td>6</td><td>6</td><td>9</td><td>9</td><td>9</td><td>10</td><td>11</td></tr><tr><td>c</td><td>6</td><td>5</td><td>0</td><td>0</td><td>0</td><td>0</td><td>6</td><td>6</td><td>6</td><td>6</td><td>6</td><td>10</td><td>11</td></tr><tr><td>d</td><td>5</td><td>4</td><td>0</td><td>0</td><td>0</td><td>0</td><td>6</td><td>6</td><td>6</td><td>6</td><td>6</td><td>10</td><td>10</td></tr><tr><td>e</td><td>4</td><td>6</td><td>0</td><td>0</td><td>0</td><td>0</td><td>6</td><td>6</td><td>6</td><td>6</td><td>6</td><td>6</td><td>6</td></tr></tbody></table><p>按上述描述的递推公式计算时，我们需要初始值，<code>f[i][0]=0(1&lt;=i&lt;=5)</code>, <code>f[1][j]=(j &lt; weight[e])?0:value[e]</code>,(1&lt;=j&lt;=10)。</p><h3 id="完全背包问题"><a href="#完全背包问题" class="headerlink" title="完全背包问题"></a>完全背包问题</h3><p><strong>问题描述</strong>：有编号分别为a,b,c,d的四件物品，它们的重量分别是2,3,4,7，它们的价值分别是1,3,5,9，每件物品数量无限个，现在给你个承重为10的背包，如何让背包里装入的物品具有最大的价值总和？</p><p><strong>思路</strong>： 问题解法其实和01背包问题一样，只是初始化的值和递推公式需要稍微变化一下。初始化时，当只考虑一件物品a时，<code>f[1][j] = j/weight[a]</code>。 递推公式计算时，<code>f[i][y] = max{f[i-1][y], (f[i][y-weight[i]]+value[i])}</code>，注意这里当考虑放入一个物品 i 时应当考虑还可能继续放入 i，因此这里是<code>f[i][y-weight[i]]+value[i]</code>, 而不是<code>f[i-1][y-weight[i]]+value[i]</code>。</p><table><thead><tr><th>name</th><th>weight</th><th>value</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th></tr></thead><tbody><tr><td>d</td><td>7</td><td>9</td><td>0</td><td>0</td><td>1</td><td>3</td><td>5</td><td>5</td><td>6</td><td>9</td><td>10</td><td>10</td><td>12</td></tr><tr><td>c</td><td>4</td><td>5</td><td>0</td><td>0</td><td>1</td><td>3</td><td>5</td><td>5</td><td>6</td><td>8</td><td>10</td><td>10</td><td>11</td></tr><tr><td>b</td><td>3</td><td>3</td><td>0</td><td>0</td><td>1</td><td>3</td><td>3</td><td>4</td><td>6</td><td>6</td><td>7</td><td>9</td><td>9</td></tr><tr><td>a</td><td>2</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>2</td><td>2</td><td>3</td><td>3</td><td>4</td><td>4</td><td>5</td></tr></tbody></table><h3 id="多重背包问题"><a href="#多重背包问题" class="headerlink" title="多重背包问题"></a>多重背包问题</h3><p><strong>问题描述</strong>：有编号分别为a,b,c的三件物品，它们的重量分别是1，2，2，它们的价值分别是6，10，20，他们的数目分别是10，5，2，现在给你个承重为 8 的背包，如何让背包里装入的物品具有最大的价值总和？</p><p><strong>解题思路</strong>： </p><ol><li><p>作为一个新问题考虑，由于每个物品多了数目限制，因此初始化和递推公式都需要更改一下。初始化时，只考虑一件物品a时，<code>f[1][j] = min{num[1], j/weight[1]}</code>。 计算考虑i件物品承重限制为y时最大价值<code>f[i][y]</code>时，递推公式考虑两种情况，要么第 i 件物品一件也不放，就是<code>f[i-1][y]</code>, 要么第 i 件物品放 k 件，其中 <code>1 &lt;= k &lt;= (y/weight[i])</code>，考虑这一共 k+1 种情况取其中的最大价值即为<code>f[i][y]</code>的值，即<code>f[i][y] = max{f[i-1][y], (f[i-1][y-k*weight[i]]+k*value[i])}</code>。 这里为什么不能像完全背包一样直接考虑<code>f[i][y-weight[i]]+value[i]</code>呢？因为这样不容易判断第 i 件物品的个数是否超过限制数量 <code>num[i]</code>。</p><p>| name | weight | value | num  | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    |<br>| —- | —— | —– | —- | —- | —- | —- | —- | —- | —- | —- | —- | —- |<br>| c    | 2      | 20    | 2    | 0    | 6    | 20   | 26   | 40   | 46   | 52   | 58   | 64   |<br>| b    | 2      | 10    | 5    | 0    | 6    | 12   | 18   | 24   | 30   | 36   | 42   | 48   |<br>| a    | 1      | 6     | 10   | 0    | 6    | 12   | 18   | 24   | 30   | 36   | 42   | 48   |</p></li><li><p>由01背包的分析可知，01背包中允许放入的物品有重复，即01背包中如果考虑要放入的物品的重量和价格相同，不影响最终的结果，因为我们可以考虑把多重背包问题中限制数目的物品拆分成单独的一件件物品，作为01背包问题考虑。问题解法和01背包一致。</p></li></ol><h1 id="Python-Web后端面试"><a href="#Python-Web后端面试" class="headerlink" title="Python Web后端面试"></a>Python Web后端面试</h1><blockquote><p>后端面试主要是三个方面：python语言，web框架，数据库</p></blockquote><h2 id="Git-Flow工作流程"><a href="#Git-Flow工作流程" class="headerlink" title="Git Flow工作流程"></a>Git Flow工作流程</h2><h3 id="主要分支"><a href="#主要分支" class="headerlink" title="主要分支"></a>主要分支</h3><p><img src="http://img.shuaiyy.cn/blog/180318/7I14eFiak3.png?imageslim" alt="mark"></p><ul><li>master ： 主分支，用于对外发布产品</li><li>develop： 开发分支，从master克隆代码后，进行开发工作</li><li>release： 测试分支，在开发完成后，从develop分支克隆到本分支测试，小的bug直接修复后合并到develop。作为临时分支，测试完成后可以删除</li><li>bugfix： 基于master分支或发布的Tag克隆，用于修复收到的bug反馈。修复完成后分别合并到develop和master里。</li><li>feature：功能分支，基于develop克隆，用于探索性功能或多人协助开发，开发完成后合并到develop分支。</li></ul><h3 id="开发流程"><a href="#开发流程" class="headerlink" title="开发流程"></a>开发流程</h3><ol><li><p>进入本地仓库工作区，从远程仓库克隆代码到本地</p></li><li><p>基于master分支，创建develop分支</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">/* 切换到master分支 */</div><div class="line"><span class="meta">$</span>git checkout master</div><div class="line">/* 基于master分支克隆develop分支，并在克隆完毕后直接跳转到develop分支 */</div><div class="line"><span class="meta">$</span>git checkout -b develop</div><div class="line">/* 推送develop分支到远程仓库 */</div><div class="line"><span class="meta">$</span>git push origin develop</div></pre></td></tr></table></figure></li><li><p>本地开发</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">/* 提交修改到缓冲区 */</div><div class="line"><span class="meta">$</span>git add .</div><div class="line">/* 提交修改到本地仓库 */</div><div class="line">/* 如果是修复的BUG，应该在修改说明的最开始添加Bug#ID，多个Bug用逗号分隔，例如Bug#002,003 */</div><div class="line">/* 如果是完成了一个指派的任务，应该在修改说明的最开始添加Task#TaskID,例如Task#165 */</div><div class="line"><span class="meta">$</span>git commit -m "Bug#123 修改说明"</div><div class="line">/* 每完成一个功能点可以对代码进行打包 */</div><div class="line"><span class="meta">$</span>git tag -m "简要说明增加/修复/删除了什么功能" v0.0.0.170718</div></pre></td></tr></table></figure><p>实现一个功能或一天工作结束时，提交代码。不是每一个Tag都需要提交到远程仓库，在编译成功&amp;测试通过后，再打一个新的Tag包（里程碑Tag包），仅将里程碑Tag包推送到远程仓库</p></li><li><p>推送代码到远程仓库</p><p>当完成一个功能点或阶段工作时，将代码推送到远程仓库develop分支</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/* 执行代码拉取操作，防止代码冲突 */</div><div class="line"><span class="meta">$</span>git pull</div><div class="line">/* 解决代码冲突后，推送代码到远程仓库*/</div><div class="line"><span class="meta">$</span>git push origin develop1234</div></pre></td></tr></table></figure><p>注：禁止将未编译或编译不通过的代码提交到远程仓库，如果编码工作进行未完成可以提交到本地仓库中，等待该功能点全部实现后再将代码推送到远程仓库中。</p></li><li><p>将代码发布到测试分支</p><p>阶段性的开发工作已完成，启动小批量测试工作，将代码发布到测试分支release</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span>git checkout develop</div><div class="line"><span class="meta">$</span>git checkout -b release</div><div class="line"><span class="meta">$</span>git push origin release</div></pre></td></tr></table></figure></li><li><p>修复测试提交的bug</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">/* 克隆仓库 */</div><div class="line"><span class="meta">$</span>git clone https://admin@192.168.1.88:8443/r/admin/test.$git</div><div class="line">/* 查看远程仓库分支情况：克隆仓库时只能克隆master分支，因此需要拉取指定分支，我们使用$git branch -r查看远程分支情况 */</div><div class="line"><span class="meta">$</span>git branch -r</div><div class="line">  origin/HEAD -&gt; origin/master</div><div class="line">  origin/dev</div><div class="line">  origin/master</div><div class="line">  origin/release</div><div class="line">/* 拉取测试分支 */</div><div class="line"><span class="meta">$</span>git checkout -b release origin/release</div></pre></td></tr></table></figure><p>在commit提交时，要在修复说明中添加<code>Bug#bugID</code>及相关说明。</p></li><li><p>测试完成后，代码合并到develop分支</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">/* 切换到develop分支 */</div><div class="line"><span class="meta">$</span>git checkout develop</div><div class="line">/* 执行合并操作,将release分支代码合并到develop分支 */</div><div class="line"><span class="meta">$</span>git merge release</div><div class="line">/* 如果合并报错，则解决冲突，冲突解决后继续再次执行合并 */</div></pre></td></tr></table></figure><p>​</p></li><li><p>开发、测试完成后，将develop分支合并到master，进行版本发布，同时打一个里程碑Tag包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span> 合并</div><div class="line"><span class="meta">$</span>git checkout master</div><div class="line"><span class="meta">$</span>git merge develop</div><div class="line"><span class="meta">#</span> 打Tag</div><div class="line">/* 创建里程碑Tag */</div><div class="line"><span class="meta">$</span>git tag -m "Task#003 v1.0.0 首版发布" v1.0.0.170718</div><div class="line">/* 推送里程碑Tag到远程仓库 */</div><div class="line"><span class="meta">$</span>git push origin v1.0.0.170718</div></pre></td></tr></table></figure></li></ol><h3 id="发布后Bug修复"><a href="#发布后Bug修复" class="headerlink" title="发布后Bug修复"></a>发布后Bug修复</h3><ol><li><p>获取Bug产品的版本号</p></li><li><p>查看里程碑Tag，并基于出bug的里程碑创建分支</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/* 查询里程碑及其提交说明 */</div><div class="line"><span class="meta"> $</span>git tag -n1 -l v*</div><div class="line"> /* git checkout -b [创建的分支名称] [里程碑Tag名称] */</div><div class="line"><span class="meta"> $</span>git checkout -b bugfix-v1.0.0.170718 v1.0.0.170718</div></pre></td></tr></table></figure></li><li><p>修复代码后查看修改的地方，然后合并到develop和master</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span>git diff</div><div class="line"></div><div class="line">/* 合并到develop */</div><div class="line"><span class="meta">$</span>git checkout develop</div><div class="line"><span class="meta">$</span>git merge hotfix-v1.0.0.170718</div><div class="line">/* 提交到远程仓库develop分支 */</div><div class="line"><span class="meta">$</span>git push origin develop</div><div class="line">/* 合并到master：如果随下一个版本再发布，可不用合并至master分支 */</div><div class="line"><span class="meta">$</span>git checkout master</div><div class="line"><span class="meta">$</span>git merge develop</div><div class="line">/* 提交到远程仓库master分支 */</div><div class="line"><span class="meta">$</span>git push origin master</div></pre></td></tr></table></figure></li><li><p>创建新的里程碑，删除bugfix分支</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span>git tag -m "Bug#002 修复某某Bug" v1.0.1.170719</div><div class="line"> /* 推送到远程仓库 */</div><div class="line"><span class="meta"> $</span>git push origin v1.0.1.170719</div></pre></td></tr></table></figure><p>/<em> 删除本地分支-$git branch -d [本地分支名]</em>/<br>$git branch -d bugfix-v1.0.0.170718<br>/<em> 删除远程分支-$git push origin :[远程分支名]</em>/<br>$git push origin :bugfix-v1.0.0.170718</p></li></ol><h3 id="撤销操作"><a href="#撤销操作" class="headerlink" title="撤销操作"></a>撤销操作</h3><ul><li><p>commit以后发现有几个文件没提交，可以对上次提交修正，而不是新发起一个提交</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">/* 正常提交 */</div><div class="line"><span class="meta">$</span>git commit -m "发布v1.0"</div><div class="line">/* 发现漏了文件，重新添加 */</div><div class="line"><span class="meta">$</span>git add CHANGELOG.md</div><div class="line">/* 重新提交,仍以"发布v1.0的名义提交"，最终只有一个提交*/</div><div class="line"><span class="meta">$</span>git commit --amend</div></pre></td></tr></table></figure></li><li><p>撤销上次提交，但是保留暂存区和当前修改不变 <code>$git reset --soft HEAD~</code></p></li><li><p>撤销上次提交和暂存区修改，仅保留当前修改不变  <code>$git reset --mixed HEAD~</code></p></li><li><p>撤销上次提交，丢弃所有修改，并回档到上上次的提交  <code>$git reset --hard HEAD~</code></p></li><li><p>整体回档到指定的版本，谨慎使用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">/* 正常提交 */</div><div class="line"><span class="meta">$</span>git commit -m "发布v1.0"</div><div class="line">/* 修改多个文件 */</div><div class="line">/* 添加到暂存区 */</div><div class="line">git add .</div><div class="line">/* 撤销暂存区和本地目录下所有文件的修改，并整体回档到上一次提交的状态 */</div><div class="line"><span class="meta">$</span>git reset --hard HEAD</div><div class="line">/* 可以修改HEAD为SHA-1值回档到任意版本 */</div><div class="line">/* 使用git log查看每次提交的SHA-1值，可以仅指定前7位 */</div><div class="line"><span class="meta">$</span>git reset --hard 745d8cd</div></pre></td></tr></table></figure></li><li><p>git add后撤回</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/* 添加文件到暂存区 */</div><div class="line"><span class="meta">$</span>git add README</div><div class="line">/* 将文件从暂存区撤回 */</div><div class="line"><span class="meta">$</span>git reset HEAD README</div></pre></td></tr></table></figure></li><li><p>撤销对文件的修改，恢复成上次提交的样子</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">/* 撤销对CHANGELOG.md文件的修改，请注意这是一个危险的命令，</div><div class="line"> * 对指定文件的修改都会被取消，会还原成上次提交的样子 */</div><div class="line"><span class="meta">$</span>git checkout -- CHANGELOG.md</div></pre></td></tr></table></figure></li></ul><h2 id="Job1"><a href="#Job1" class="headerlink" title="Job1"></a>Job1</h2><p><strong>职位描述</strong></p><ol><li>开发和维护平台系统</li><li>负责web数据中心和运营中心功能的开发</li><li>配合团队其他成员进行模块开发及整合</li></ol><p><strong>任职要求</strong></p><ol><li>Python及其他开发语言</li><li>熟悉Tornado，Twisted，Libevent等异步socket通讯框架</li><li>熟练使用MySQL，熟悉MongoDB，Redis，具有面向对象设计思想，接口清晰，命名规范</li><li>熟悉Linux开发平台</li></ol><p><strong>过程</strong></p><ol><li>自我介绍</li><li>谈一下学习后端的感想</li><li>GIL是什么，怎么解决GIL带来的问题</li><li>装饰器是什么，应用场景是什么</li><li>闭包是什么</li><li>数据库原生语句会写吗,事务了解吗</li><li>编译原理了解吗</li></ol><h2 id="Job2"><a href="#Job2" class="headerlink" title="Job2"></a>Job2</h2><p><strong>工作职责</strong></p><ol><li>参与网站的平台开发，架构设计和维护</li><li>参与需求分析和产品设计</li><li>撰写Python，Django进行后台及API的开发</li><li>撰写测试以及团队成员间进行Code Review</li><li>负责产品的开发，测试以及日后的维护升级</li></ol><p><strong>任职要求</strong></p><ol><li>2年以上Python工作职责</li><li>熟悉互联网项目开发，熟悉Python以及Django</li><li>良好的技术相关英文能力</li><li>熟悉Git及Git Flow开发流程</li><li>逻辑抽象能力强，具有良好的沟通能力</li><li>熟悉Linux操作系统</li></ol><p><strong>过程</strong></p><ol><li>redis持久化，如果redis现需要重启，rdb模式下怎么在重启前保存数据</li><li>mysql怎么处理高并发</li><li>说一下myisam和innodb的锁分别是什么</li><li>get post区别</li><li>git多人开发下的使用, 工作流</li><li>nginx作用</li><li>三个web框架区别（flask，django，tornado）</li></ol><h2 id="Job3"><a href="#Job3" class="headerlink" title="Job3"></a>Job3</h2><p><strong>职位描述</strong></p><ol><li>负责服务端软件的设计，开发，维护</li><li>负责后台数据库，程序模块的设计和开发；维护优化产品，进行性能优化和架构优化</li><li>负责基础架构组件开发和优化，负责开发和维护平台公用组件和模块。负责和前端/app集成的接口及联调</li></ol><p><strong>任职要求</strong></p><ol><li>计算机基础知识扎实，包括不限定于操作系统，网络，数据结构和算法</li><li>熟练掌握至少一门语言：Ruby，Python</li><li>有些测试的习惯，熟悉单元测试和集成测试</li><li>熟悉MySql，Redis</li><li>了解RESTful API接口和常用的充值，支付，分享等第三方服务</li><li>了解html5,css3,bootstrap,angular js等前端框架</li><li>良好的编码习惯，良好的团队合作精神和学习能力，做事严谨踏实，责任心强</li></ol><p><strong>过程</strong></p><ol><li>介绍一下项目，某个项目数据库怎么设计的</li><li>mysql高可用</li><li>redis，mysql，nginx</li><li>tornado和django区别</li><li>符合restful的url是什么样子</li></ol><h2 id="Job4"><a href="#Job4" class="headerlink" title="Job4"></a>Job4</h2><p><strong>职位描述</strong></p><ol><li>参与产品，架构设计和相关技术文档的完善</li><li>根据产品需求，完成基于Python的系统或模块的设计和开发</li><li>与各部门团队成员协同配合，完成迭代开发任务，确保产品的顺利上线</li></ol><p><strong>岗位要求</strong></p><ol><li>熟悉掌握web后端开发，熟悉后端开发常用技术如：缓存，队列等</li><li>熟悉Linux基本操作</li><li>具备XML，RESTful或WebService接口开发经验</li></ol><p><strong>过程</strong></p><p>装饰器<br>谈一下tornado</p><h2 id="Job5"><a href="#Job5" class="headerlink" title="Job5"></a>Job5</h2><p><strong>职位描述</strong></p><ol><li>根据业务，梳理产品需求并合理设计后端服务开发流程</li><li>后端设计与开发以服务Web端，手机端，公众平台，小程序等</li><li>后端服务的自动化测试，运维及性能优化</li></ol><p><strong>职位要求</strong></p><ol><li>本科，专业计算机</li><li>一年以上Python后端开发经验，软件知识结构全面，有成熟作品优先</li><li>熟悉Linux操作系统下开发，部署，维护</li><li>精通Python服务端编程，精通网络编程</li><li>精通Pythonn爬虫系统编程</li><li>熟练掌握一种以上Web开发框架</li><li>熟悉SQL语言</li><li>熟悉缓存机制以及NoSQL数据库，有redis开发经验优先</li><li>能对某个新领域进行搜索，总结并快速学习，有能力维护个人技术博客优先 加分项：</li><li>有良好的编程习惯与规范</li><li>有支付系统开发经验的优先</li><li>熟练使用Git</li><li>熟练运用阿里云或UCloud等云部署</li></ol><p><strong>过程</strong></p><ol><li>介绍一下自己</li></ol><ol><li>git熟悉吗</li></ol><ol><li>http方法有哪些</li></ol><ol><li>谈谈restful</li></ol><ol><li>正则熟悉吗，匹配一个邮箱</li></ol><ol><li>redis熟悉吗，怎么使用的</li><li>python3要用python2的包怎么办</li><li>存储过程了解吗</li><li>1000万个数据里面删掉1000条，如何优化</li><li>nginx是什么，负载均衡什么意思</li><li>多台设备登录，怎么实现告知先登录设备账号异地登录（后来谈到tornado里面的websocket，websocket是什么，websocket断线重连）</li><li>排序算法了解吗</li><li>前后端分离</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- markdown-toc start - Don&#39;t edit this section. Run M-x markdown-toc-generate-toc again --&gt;
&lt;p&gt;&lt;strong&gt;Table of Contents&lt;/strong&gt;&lt;/p&gt;
&lt;ul
      
    
    </summary>
    
      <category term="学习" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="求职" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/"/>
    
      <category term="基础知识" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E6%B1%82%E8%81%8C/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="Python" scheme="http://shuaiyy.cn/tags/Python/"/>
    
      <category term="求职" scheme="http://shuaiyy.cn/tags/%E6%B1%82%E8%81%8C/"/>
    
  </entry>
  
  <entry>
    <title>Spring boot 入门</title>
    <link href="http://shuaiyy.cn/2018/03/04/%E6%8A%80%E6%9C%AF/Spring%20Boot%20%E5%85%A5%E9%97%A8/"/>
    <id>http://shuaiyy.cn/2018/03/04/技术/Spring Boot 入门/</id>
    <published>2018-03-03T16:00:00.000Z</published>
    <updated>2018-11-22T11:02:28.471Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Spring-Boot-入门"><a href="#Spring-Boot-入门" class="headerlink" title="Spring Boot 入门"></a>Spring Boot 入门</h1><p>spring boot是可以基于maven项目快速搭建SSM/H（或者其他Spring相关的项目）的开发框架。<br>可以简化SSM框架的一系列配置，从而快速开发。</p><h2 id="快速搭建Web项目"><a href="#快速搭建Web项目" class="headerlink" title="快速搭建Web项目"></a>快速搭建Web项目</h2><ul><li><p>创建项目</p><p>在IDEA中，菜单 -&gt; New -&gt; Project -&gt; Spring Initializer 然后点 Next。</p><p>输入项目名称，然后next。</p><p>选择web模块，然后next，指定项目路径，ok。</p><p><img src="http://img.shuaiyy.cn/blog/180418/Di0aC2EBGb.png?imageslim" alt="mark"></p><p>项目结构如下：</p><p><img src="http://img.shuaiyy.cn/blog/180418/CmKI7596Gd.png?imageslim" alt="mark"></p><p>其中绿色的是手动创建的，红色的文件是springboot创建的。</p></li><li><p>配置切换</p><p>spring boot仍然需要一定的配置，可以为不同环境设置单独的配置。</p><p>配置端口和servlet的根URL 。</p><p>配置JSP支持，需引入maven依赖。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"># 主配置，application.properties</div><div class="line"></div><div class="line"># jsp文件重定向</div><div class="line">spring.mvc.view.prefix=/WEB-INF/jsp/</div><div class="line">spring.mvc.view.suffix=.jsp</div><div class="line"># 指定使用生产环境的配置文件</div><div class="line">spring.profiles.active=pro</div><div class="line"></div><div class="line"># 专用配置文件，由主配置中指定 </div><div class="line"># application-dev.properties 或者 application-pro.properties</div><div class="line">server.port=8080</div><div class="line">server.servlet.path=/test</div><div class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/test?characterEncoding=UTF-8</div><div class="line">spring.datasource.username=root</div><div class="line">spring.datasource.password=123456</div><div class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</div><div class="line">spring.jpa.properties.hibernate.hbm2ddl.auto=update</div></pre></td></tr></table></figure></li><li><p>基于yml格式的配置</p><p>yml格式用“冒号 空格” 区分键值， 如果分级，则使用4个空格。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="attr">spring:</span></div><div class="line"><span class="attr">    mvc:</span></div><div class="line"><span class="attr">        view:</span></div><div class="line"><span class="attr">            prefix:</span> <span class="string">/WEB-INF/jsp/</span></div><div class="line"><span class="attr">            suffix:</span> <span class="string">.jsp</span></div><div class="line"><span class="attr">server:</span></div><div class="line"><span class="attr">    port:</span> <span class="number">8888</span></div><div class="line"><span class="attr">    context-path:</span> <span class="string">/test</span></div></pre></td></tr></table></figure></li></ul>  <a id="more"></a><p>  ​</p><ul><li><p>maven依赖</p><p>由于IDEA的bug，无法使用provided scope，因此需要删除jar包依赖配置中的provided，以及项目结构文件iml中的provided。</p><p>不需要直接引入spring-core之类的jar包，spring-boot的依赖已经引用并管理了一系列相关的jar包。</p><p>由于从parent继承，一些jar包的版本也无需指定。从maven依赖关系图可以看出，spring-boot-starter-web下有spring-webmvc。</p><p><img src="http://img.shuaiyy.cn/blog/180418/aC11Agkhcb.png?imageslim" alt="mark"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></div><div class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.shuaiyy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sboot_idea<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--&lt;packaging&gt;jar&lt;/packaging&gt;--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>sboot_idea<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 官方为相关jar包提供了版本控制 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--&lt;scope&gt;provided&lt;/scope&gt;--&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- servlet依赖. --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--&lt;scope&gt;provided&lt;/scope&gt;--&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- tomcat的支持.--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--&lt;scope&gt;provided&lt;/scope&gt;--&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">      </div><div class="line">      <span class="comment">&lt;!-- jpa--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- mybatis --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">      </div><div class="line">      <span class="comment">&lt;!--mysql驱动包--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 分页插件支持 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>MVC contoller</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldController</span> </span>&#123;</div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(Model model)</span></span>&#123;</div><div class="line">        System.out.println(<span class="string">"hello"</span>);</div><div class="line">        model.addAttribute(<span class="string">"now"</span>, DateFormat.getDateTimeInstance().format(<span class="keyword">new</span> Date()));</div><div class="line">        <span class="keyword">return</span> <span class="string">"hello"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>启动</p><p>SpringbootApplication, 其被@SpringBootApplication 所注解，表示这个是一个Springboot 应用，用于启动项目。</p><p>spring boot内置了Tomcat服务器，因此可以由spring-boot应用直接启动，也可以由Tomcat启动web应用。</p><p>浏览器访问<code>http://127.0.0.1:8080/hello</code></p></li></ul><h2 id="打包部署"><a href="#打包部署" class="headerlink" title="打包部署"></a>打包部署</h2><ul><li><p>jar方式：</p><p>执行 <code>mvn install</code> ,然后运行jar包 <code>java -jar target/springboot-0.0.1-SNAPSHOT.jar --spring.profiles.active=pro</code> 。</p><p><img src="http://img.shuaiyy.cn/blog/180418/8Chd35LJiD.png?imageslim" alt="mark"></p></li><li><p>war方式：</p><p>spring boot app要添加一个注解<code>@ServletComponentScan</code>，并继承类<code>SpringBootServletInitializer</code>，重写configure方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// war方式打包</span></div><div class="line"><span class="meta">@SpringBootApplication</span></div><div class="line"><span class="meta">@ServletComponentScan</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SbootIdeaApplication</span> <span class="keyword">extends</span> <span class="title">SpringBootServletInitializer</span></span>&#123;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> SpringApplicationBuilder <span class="title">configure</span><span class="params">(SpringApplicationBuilder builder)</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> builder.sources(SbootIdeaApplication.class);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">SpringApplication.run(SbootIdeaApplication.class, args);</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>pom中修改packaging方式为war方式。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></div></pre></td></tr></table></figure><p>然后运行<code>mvn clean package</code>, 构建war包。</p></li><li><p>热部署</p><p>每次rebuild项目后自动部署，不用重启Application类。idea也可以设置成自动build。</p><p>只需增加一个依赖：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure></li></ul><h2 id="持久层支持"><a href="#持久层支持" class="headerlink" title="持久层支持"></a>持久层支持</h2><h3 id="JPA"><a href="#JPA" class="headerlink" title="JPA"></a>JPA</h3><p>JPA(Java Persistence API)是Sun官方提出的Java持久化规范，用来方便大家操作数据库。真正干活的可能是Hibernate,TopLink等等实现了JPA规范的不同厂商,默认是Hibernate。</p><ul><li>在配置文件中增加参数：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">spring.mvc.view.prefix=/WEB-INF/jsp/</div><div class="line">spring.mvc.view.suffix=.jsp</div><div class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/test?characterEncoding=UTF-8</div><div class="line">spring.datasource.username=root</div><div class="line">spring.datasource.password=123456</div><div class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</div><div class="line">spring.jpa.properties.hibernate.hbm2ddl.auto=update</div></pre></td></tr></table></figure><ul><li><p>增加mysql和jpa的依赖包</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- mysql--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="comment">&lt;!-- jpa--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>创建一个dao接口，即可使用对应的jpa方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryDAO</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Category</span>,<span class="title">Integer</span>&gt;</span>&#123;&#125;</div><div class="line"><span class="comment">// 使用</span></div><div class="line"><span class="meta">@Autowired</span> CategoryDAO categoryDAO;</div><div class="line"><span class="comment">// find</span></div><div class="line">List&lt;Category&gt; cs=categoryDAO.findAll();</div><div class="line"><span class="comment">// add or update</span></div><div class="line">categoryDAO.save(c);</div><div class="line"><span class="comment">// delete</span></div><div class="line">categoryDAO.delete(c)</div></pre></td></tr></table></figure></li><li><p>实现分页，返回的是Page对象。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/list"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">listByJPA</span><span class="params">(Model model, @RequestParam(value = <span class="string">"start"</span>,defaultValue = <span class="string">"0"</span>)</span> <span class="keyword">int</span> start,</span></div><div class="line"><span class="function">                        @<span class="title">RequestParam</span><span class="params">(value = <span class="string">"size"</span>,defaultValue = <span class="string">"5"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">  <span class="comment">// 分页， 降序， size必须大于0</span></div><div class="line">  start = start &lt; <span class="number">0</span> ? <span class="number">0</span>:start;</div><div class="line">  Sort sort = <span class="keyword">new</span> Sort(Sort.Direction.DESC, <span class="string">"id"</span>);</div><div class="line">  Pageable pageable = <span class="keyword">new</span> PageRequest(start, size, sort);</div><div class="line">  Page&lt;Category&gt; page = categoryDAO.findAll(pageable);</div><div class="line">  model.addAttribute(<span class="string">"page"</span>, page);</div><div class="line">  <span class="keyword">return</span> <span class="string">"list_category_page"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>page对象的使用：</p><p><img src="http://img.shuaiyy.cn/blog/180420/lFDBDIGJLj.png?imageslim" alt="mark"></p></li></ul><h3 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h3><ul><li><p>增加相关依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- mybatis --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- mysql --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 分页插件 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>创建Mapper接口，并实现相应的CRUD方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Mapper</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="meta">@Select</span>(<span class="string">"select * from category_ "</span>)</div><div class="line">    <span class="function">List&lt;Category&gt; <span class="title">findAll</span><span class="params">()</span></span>;</div><div class="line"> </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 使用</span></div><div class="line"><span class="meta">@Autowired</span> CategoryMapper categoryMapper;</div><div class="line">List&lt;Category&gt; cs=categoryMapper.findAll();</div></pre></td></tr></table></figure></li><li><p>实现分页</p><p>需要实现一个PageHelper的拦截器Bean，可以使用spring Configuration类实现相关bean的定义。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.shuaiyy.springboot.config;</div><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageHelperConfig</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="meta">@Bean</span></div><div class="line">    <span class="function"><span class="keyword">public</span> PageHelper <span class="title">pageHelper</span><span class="params">()</span> </span>&#123;</div><div class="line">        PageHelper pageHelper = <span class="keyword">new</span> PageHelper();</div><div class="line">        Properties p = <span class="keyword">new</span> Properties();</div><div class="line">        p.setProperty(<span class="string">"offsetAsPageNum"</span>, <span class="string">"true"</span>);</div><div class="line">        p.setProperty(<span class="string">"rowBoundsWithCount"</span>, <span class="string">"true"</span>);</div><div class="line">        p.setProperty(<span class="string">"reasonable"</span>, <span class="string">"true"</span>);</div><div class="line">        pageHelper.setProperties(p);</div><div class="line">        <span class="keyword">return</span> pageHelper;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>mapper接口无需改动，在查询前设置分页信息,并返回pageInfo对象:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/mybatis/list"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">listCategoryByMybatis</span><span class="params">(Model model, @RequestParam(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>)</span> <span class="keyword">int</span> start,</span></div><div class="line"><span class="function">     @<span class="title">RequestParam</span><span class="params">(value=<span class="string">"size"</span>,  defaultValue = <span class="string">"3"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">  <span class="comment">//        ModelAndView mav = new ModelAndView();</span></div><div class="line">  start = start&gt;<span class="number">0</span> ? start:<span class="number">0</span>;</div><div class="line">  PageHelper.startPage(start,size, <span class="string">"id desc"</span>);</div><div class="line">  List&lt;Category&gt; categories = categoryMapper.findAll();</div><div class="line">  PageInfo&lt;Category&gt; pageInfo = <span class="keyword">new</span> PageInfo&lt;&gt;(categories);</div><div class="line">  model.addAttribute(<span class="string">"page"</span>, pageInfo);</div><div class="line">  <span class="keyword">return</span> <span class="string">"list_category_by_pagehelper"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>pageInfo对象的使用：</p><p><img src="http://img.shuaiyy.cn/blog/180420/DChaiA5ijD.png?imageslim" alt="mark"></p></li></ul><h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><ul><li><p>post 上传二进制文件，注意name参数用于后端获取数据对象 </p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;form action=<span class="string">"upload"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</div><div class="line">  选择图片:&lt;input type=<span class="string">"file"</span> name=<span class="string">"file"</span> accept=<span class="string">"image/*"</span> /&gt; &lt;br&gt;</div><div class="line">  &lt;input type=<span class="string">"submit"</span> value=<span class="string">"上传"</span>&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></li><li><p>上传,使用MultipartFile对象接收二进制数据，确定存储位置和文件名后，使用transferTo保存。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/upload"</span>, method = RequestMethod.POST)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">upload</span><span class="params">(HttpServletRequest req, @RequestParam(<span class="string">"file"</span>)</span> MultipartFile file,Model m) </span>&#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                String fileName = System.currentTimeMillis()+file.getOriginalFilename();</div><div class="line">                String destFileName=req.getServletContext().getRealPath(<span class="string">""</span>)+<span class="string">"uploaded"</span>+File.separator+fileName;</div><div class="line">                 </div><div class="line">                File destFile = <span class="keyword">new</span> File(destFileName);</div><div class="line">                destFile.getParentFile().mkdirs();</div><div class="line">                file.transferTo(destFile);</div><div class="line">                m.addAttribute(<span class="string">"fileName"</span>,fileName);</div><div class="line">            &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">                <span class="keyword">return</span> <span class="string">"上传失败,"</span> + e.getMessage();</div><div class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">                <span class="keyword">return</span> <span class="string">"上传失败,"</span> + e.getMessage();</div><div class="line">            &#125;</div><div class="line">             </div><div class="line">            <span class="keyword">return</span> <span class="string">"showImg"</span>;</div><div class="line">    &#125;   </div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>上传文件的大小设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">spring.servlet.multipart.max-file-size=100Mb</div><div class="line">spring.servlet.multipart.max-request-size=100Mb</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="实现RESTFUL"><a href="#实现RESTFUL" class="headerlink" title="实现RESTFUL"></a>实现RESTFUL</h2><ul><li><p>后端的HTTP方法 使用PUT delete POST GET，当进行增删改时，返回视图会出错405，method不允许，应该直接返回字符串或者redirect。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryRestful</span> </span>&#123;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    CategoryDAO categoryDAO;</div><div class="line"></div><div class="line">    <span class="meta">@GetMapping</span>(value = <span class="string">"/category/&#123;id&#125;"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">get</span><span class="params">(Model model, @PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id)</span>&#123;</div><div class="line">        List&lt;Category&gt; categories = <span class="keyword">new</span> LinkedList&lt;&gt;();</div><div class="line">        categories.add(categoryDAO.getOne(id));</div><div class="line">        model.addAttribute(<span class="string">"categories"</span>, categories);</div><div class="line">        <span class="keyword">return</span> <span class="string">"list_category"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@GetMapping</span>(value = <span class="string">"/category"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAll</span><span class="params">(Model model)</span></span>&#123;</div><div class="line">        List&lt;Category&gt; categories = categoryDAO.findAll();</div><div class="line">        model.addAttribute(<span class="string">"categories"</span>, categories);</div><div class="line">        <span class="keyword">return</span> <span class="string">"list_category"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="meta">@DeleteMapping</span>(value = <span class="string">"/category/&#123;id&#125;"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id)</span>&#123;</div><div class="line">        Category category = <span class="keyword">new</span> Category();</div><div class="line">        category.setId(id);</div><div class="line">        categoryDAO.delete(category);</div><div class="line">        <span class="keyword">return</span> <span class="string">"redirect:/category"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@PostMapping</span>(value = <span class="string">"/category/&#123;id&#125;"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(Model model, @PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id, Category category)</span>&#123;</div><div class="line">        category.setId(id);</div><div class="line">        categoryDAO.save(category);</div><div class="line">        List&lt;Category&gt; categories = categoryDAO.findAll();</div><div class="line">        model.addAttribute(<span class="string">"categories"</span>, categories);</div><div class="line">        <span class="keyword">return</span> <span class="string">"redirect:/category"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@PutMapping</span>(value = <span class="string">"/category"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(Category category)</span></span>&#123;</div><div class="line">        categoryDAO.save(category);</div><div class="line">        <span class="keyword">return</span> <span class="string">"redirect:/category"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>前端发起请求时，使用form表单提交，并在hidden input使用<code>_method PUT</code>来标识相应的方法，spring mvc会自动将post方法转为对应的方法。</p><p><img src="http://img.shuaiyy.cn/blog/180420/dcHchHk66L.png?imageslim" alt="mark"></p><p>​</p></li></ul><h2 id="JSON提交、获取数据"><a href="#JSON提交、获取数据" class="headerlink" title="JSON提交、获取数据"></a>JSON提交、获取数据</h2><ul><li><p>实体类增加注解<code>@JsonIgnoreProperties({ &quot;handler&quot;,&quot;hibernateLazyInitializer&quot; })</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="meta">@Table</span>(name = <span class="string">"category_"</span>)</div><div class="line"><span class="meta">@JsonIgnoreProperties</span>(&#123; <span class="string">"handler"</span>,<span class="string">"hibernateLazyInitializer"</span> &#125;) </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="meta">@Id</span></div><div class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</div><div class="line">    <span class="meta">@Column</span>(name = <span class="string">"id"</span>)</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>控制器类，必须使用RestController，即返回的是字符串，而不是视图。提交数据使用PUT，获取数据使用GET,直接return对象，会自动转换成相应的json字符串对象。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RestController</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</div><div class="line">    <span class="meta">@Autowired</span> CategoryDAO categoryDAO;</div><div class="line">     </div><div class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/category"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">listCategory</span><span class="params">(@RequestParam(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>)</span> <span class="keyword">int</span> start,@<span class="title">RequestParam</span><span class="params">(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        start = start&lt;<span class="number">0</span>?<span class="number">0</span>:start;</div><div class="line">        Sort sort = <span class="keyword">new</span> Sort(Sort.Direction.DESC, <span class="string">"id"</span>);</div><div class="line">        Pageable pageable = <span class="keyword">new</span> PageRequest(start, size, sort);</div><div class="line">        Page&lt;Category&gt; page =categoryDAO.findAll(pageable);</div><div class="line">        <span class="keyword">return</span> page.getContent();</div><div class="line">    &#125;</div><div class="line">     </div><div class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/category/&#123;id&#125;"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id) <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        Category c= categoryDAO.getOne(id);</div><div class="line">        System.out.println(c);</div><div class="line">        <span class="keyword">return</span> c;</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@PutMapping</span>(<span class="string">"/category"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCategory</span><span class="params">(@RequestBody Category category)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        System.out.println(<span class="string">"springboot接受到浏览器以JSON格式提交的数据："</span>+category);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>前端提交数据时，使用PUT方法，raw格式数据，并设置json的context header。</p><p><img src="http://img.shuaiyy.cn/blog/180420/6L5Efk4LCj.png?imageslim" alt="mark"></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Spring-Boot-入门&quot;&gt;&lt;a href=&quot;#Spring-Boot-入门&quot; class=&quot;headerlink&quot; title=&quot;Spring Boot 入门&quot;&gt;&lt;/a&gt;Spring Boot 入门&lt;/h1&gt;&lt;p&gt;spring boot是可以基于maven项目快速搭建SSM/H（或者其他Spring相关的项目）的开发框架。&lt;br&gt;可以简化SSM框架的一系列配置，从而快速开发。&lt;/p&gt;
&lt;h2 id=&quot;快速搭建Web项目&quot;&gt;&lt;a href=&quot;#快速搭建Web项目&quot; class=&quot;headerlink&quot; title=&quot;快速搭建Web项目&quot;&gt;&lt;/a&gt;快速搭建Web项目&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;创建项目&lt;/p&gt;
&lt;p&gt;在IDEA中，菜单 -&amp;gt; New -&amp;gt; Project -&amp;gt; Spring Initializer 然后点 Next。&lt;/p&gt;
&lt;p&gt;输入项目名称，然后next。&lt;/p&gt;
&lt;p&gt;选择web模块，然后next，指定项目路径，ok。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.shuaiyy.cn/blog/180418/Di0aC2EBGb.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;项目结构如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.shuaiyy.cn/blog/180418/CmKI7596Gd.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;p&gt;其中绿色的是手动创建的，红色的文件是springboot创建的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;配置切换&lt;/p&gt;
&lt;p&gt;spring boot仍然需要一定的配置，可以为不同环境设置单独的配置。&lt;/p&gt;
&lt;p&gt;配置端口和servlet的根URL 。&lt;/p&gt;
&lt;p&gt;配置JSP支持，需引入maven依赖。&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;# 主配置，application.properties&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# jsp文件重定向&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;spring.mvc.view.prefix=/WEB-INF/jsp/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;spring.mvc.view.suffix=.jsp&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# 指定使用生产环境的配置文件&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;spring.profiles.active=pro&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# 专用配置文件，由主配置中指定 &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# application-dev.properties 或者 application-pro.properties&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;server.port=8080&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;server.servlet.path=/test&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;spring.datasource.url=jdbc:mysql://127.0.0.1:3306/test?characterEncoding=UTF-8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;spring.datasource.username=root&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;spring.datasource.password=123456&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;spring.datasource.driver-class-name=com.mysql.jdbc.Driver&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;spring.jpa.properties.hibernate.hbm2ddl.auto=update&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;基于yml格式的配置&lt;/p&gt;
&lt;p&gt;yml格式用“冒号 空格” 区分键值， 如果分级，则使用4个空格。&lt;/p&gt;
&lt;figure class=&quot;highlight yml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;spring:&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;    mvc:&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;        view:&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;            prefix:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;/WEB-INF/jsp/&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;            suffix:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;.jsp&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;server:&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;    port:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;8888&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;    context-path:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;/test&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="技术" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/"/>
    
      <category term="SpringBoot" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/SpringBoot/"/>
    
    
      <category term="Java" scheme="http://shuaiyy.cn/tags/Java/"/>
    
      <category term="SpringBoot" scheme="http://shuaiyy.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>CentOS 6.8服务器使用</title>
    <link href="http://shuaiyy.cn/2018/03/02/%E6%8A%80%E6%9C%AF/CentOS%206.8/"/>
    <id>http://shuaiyy.cn/2018/03/02/技术/CentOS 6.8/</id>
    <published>2018-03-01T16:00:00.000Z</published>
    <updated>2018-11-27T04:23:23.223Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CentOS-6-8"><a href="#CentOS-6-8" class="headerlink" title="CentOS 6.8"></a>CentOS 6.8</h1><h2 id="开启SSH"><a href="#开启SSH" class="headerlink" title="开启SSH"></a>开启SSH</h2><p>默认是开机启动并自动运行的，无需设置。</p><ul><li>查看是否安装ssh<code>rpm -qa | grep ssh</code> </li><li>安装命令 <code>yum install openssh-server</code></li><li>查看服务状态<code>service sshd status</code> </li></ul><h2 id="文件传输"><a href="#文件传输" class="headerlink" title="文件传输"></a>文件传输</h2><ul><li><p>安装lrzsz</p></li><li><p>安装并开启ftp服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">39  yum -y install vsftpd</div><div class="line"><span class="meta">#</span> 为ftp创建一个Linux用户，其主目录用于文件传输，禁止其登陆系统， </div><div class="line">46  useradd ftpuser -d /ftpfile -s /sbin/nologin</div><div class="line"><span class="meta">#</span> 修改主目录的所有权</div><div class="line">47  chown ftpuser.ftpuser /ftpfile</div><div class="line"><span class="meta">#</span> 修改用户密码</div><div class="line">48  passwd ftpuser</div><div class="line">50  vim /etc/vsftpd/chroot_list</div><div class="line">51  vim /etc/selinux/config </div><div class="line">52  vim /etc/vsftpd/vsftpd.conf </div><div class="line">53  service vsftpd restart</div><div class="line"><span class="meta">#</span> 配置防火墙</div><div class="line">54  iptables -I INPUT -p tcp --dport 61001:62000 -j ACCEPT</div><div class="line">55  iptables -I OUTPUT -p tcp --sport 61001:62000 -j ACCEPT</div><div class="line">56  iptables -I INPUT -p tcp --dport 20 -j ACCEPT</div><div class="line">57  iptables -I OUTPUT -p tcp --sport 20 -j ACCEPT</div><div class="line">58  iptables -I INPUT -p tcp --dport 21 -j ACCEPT</div><div class="line">59  iptables -I OUTPUT -p tcp --sport 21 -j ACCEPT</div><div class="line">60  iptables-save</div><div class="line">61  service iptables save # 永久保存</div><div class="line">62  vim /ftpfile/index.html</div><div class="line">63  setsebool -P ftp_home_dir 1</div><div class="line">64  vim /etc/selinux/config  # 关闭selinux</div><div class="line">65  reboot</div><div class="line">79  service vsftpd restart</div></pre></td></tr></table></figure><p>​</p><p>​</p></li></ul><h2 id="增加用户sudoer权限"><a href="#增加用户sudoer权限" class="headerlink" title="增加用户sudoer权限"></a>增加用户sudoer权限</h2><p>root用户下执行 visudo，并添加用户<code>ypur_user ALL=(ALL)       ALL</code></p><h2 id="更改阿里云源"><a href="#更改阿里云源" class="headerlink" title="更改阿里云源"></a>更改阿里云源</h2><p><code>sudo wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo</code></p><p><code>yum makecache</code></p><a id="more"></a><h2 id="配置Java开发环境"><a href="#配置Java开发环境" class="headerlink" title="配置Java开发环境"></a>配置Java开发环境</h2><h3 id="JDK"><a href="#JDK" class="headerlink" title="JDK"></a>JDK</h3><ul><li><p>官网下载jdk的rpm包，卸载自带的openjdk  <code>rpm -qa | grep jdk</code>   <code>yum remove XXX</code></p></li><li><p>安装jdk，并配置环境变量</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">5  chmod 777 jdk-8u171-linux-x64.rpm </div><div class="line">7  rpm -ivh jdk-8u171-linux-x64.rpm </div><div class="line">9  java -version</div><div class="line">10 vim /etc/profile</div><div class="line">export JAVA_HOME=/usr/java/jdk1.8.0_171-amd64</div><div class="line">export CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/jre/lib/dt.jar:$JAVA_HOME/jre/lib/tools.jar</div><div class="line">11 source /etc/profile</div></pre></td></tr></table></figure><p>​</p></li></ul><h3 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h3><ul><li><p>下载、解压</p></li><li><p>配置环境变量</p></li><li><p>修改配置文件，设置URI编码为utf-8字符集， <code>vim /developer/apache-tomcat-8.5.30/conf/server.xml</code></p><p><img src="http://img.shuaiyy.cn/blog/180419/AIBL4Gma1c.png?imageslim" alt="mark"></p></li><li><p>执行startup.sh启动， shutdown.sh停止。</p></li><li><p>开放防火墙端口8080访问权限 <code>iptables -I INPUT -p tcp --dport 8080 -j ACCEPT</code>  <code>service iptables save</code></p></li><li><p>访问url :  ip:8080</p></li></ul><h3 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h3><ul><li>maven3.5，下载、解压、配置环境变量</li></ul><h3 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h3><ul><li><p>安装依赖  <code>yum install -y gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel</code></p></li><li><p>下载解压,编译，安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> cd nginx-1.4.0</div><div class="line"> 91  ./configure </div><div class="line"> 92  make</div><div class="line"> 95  make install</div><div class="line"> 96  whereis nginx</div><div class="line"> 97  cd /usr/local/nginx/sbin/</div><div class="line"> 99  ./nginx </div><div class="line">100  ps aux | grep nginx</div><div class="line">101  curl http://localhost</div></pre></td></tr></table></figure></li><li><p><strong>nginx的常用命令</strong></p><p>cd /usr/local/nginx/sbin</p><p>启动：./nginx</p><p>停止：./nginx -s stop</p><p>重启：./nginx -s reopen</p></li><li><p>设置图片文件服务反向代理</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line">  114  vim /usr/local/nginx/conf/nginx.conf</div><div class="line"><span class="meta">#</span>增加一行，表示扫描该目录下的配置文件,以域名命名配置文件，方便管理</div><div class="line">  include vhost/*.conf</div><div class="line">  115  ls /usr/local/nginx/conf/</div><div class="line">  116  mkdir /usr/local/nginx/conf/vhost</div><div class="line">  117  cd /usr/local/nginx/conf/vhost</div><div class="line">  118  vim /usr/local/nginx/conf/vhost/img.happymall.com.conf</div><div class="line"><span class="meta">  #</span>目录转发，将此二级域名指向指定的文件存储位置，端口和域名是可以修改的</div><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line">    autoindex off;  #开启后可以通过索引 遍历访问</div><div class="line">    server_name img.happymmall.com;</div><div class="line">    access_log /usr/local/nginx/logs/access.log combined;</div><div class="line">    index index.html index.htm index.jsp index.php;</div><div class="line">    #error_page 404 /404.html;</div><div class="line">    if ( $query_string ~* ".*[\;'\&lt;\&gt;].*" )&#123;</div><div class="line">        return 404;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ~ /(mmall_fe|mmall_admin_fe)/dist/view/* &#123;</div><div class="line">        deny all;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location / &#123;</div><div class="line">        root /ftpfile/img/;</div><div class="line">        add_header Access-Control-Allow-Origin *;</div><div class="line"></div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line">118 vim /usr/local/nginx/conf/vhost/happymall.com.conf</div><div class="line"><span class="meta">#</span>端口转发，将happymmall.com的请求，转发至http://127.0.0.1:8080的Tomcat服务。</div><div class="line">server &#123;</div><div class="line">listen 80;</div><div class="line">autoindex on;</div><div class="line">server_name happymmall.com www.happymmall.com;</div><div class="line">access_log /usr/local/nginx/logs/access.log combined;</div><div class="line">index index.html index.htm index.jsp index.php;</div><div class="line">if ( $query_string ~* ".*[\;'\&lt;\&gt;].*" )&#123;</div><div class="line">        return 404;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">location = / &#123;</div><div class="line">        root /product/front/mmall_fe/dist/view;</div><div class="line">        index index.html;</div><div class="line">&#125;</div><div class="line"></div><div class="line">location ~ .*\.html$ &#123;</div><div class="line">        root /product/front/mmall_fe/dist/view;</div><div class="line">        index index.html;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">location / &#123;</div><div class="line">        proxy_pass http://127.0.0.1:8080/;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|flv|ico)$ &#123;</div><div class="line">        proxy_pass http://127.0.0.1:8080;</div><div class="line">        expires 30d;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">location ~ .*\.(js|css)?$ &#123;</div><div class="line">        proxy_pass http://127.0.0.1:8080;</div><div class="line">        expires 7d;</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line">  119  service vsftpd status</div><div class="line">  120  /usr/local/nginx/sbin/nginx -s reload</div></pre></td></tr></table></figure><p>由于没有真实的域名，修改<code>C:\Windows\System32\drivers\etc\hosts</code>文件，将Nginx的ip与其代理的域名关联起来，就可以本地访问，看到转发效果了。</p></li></ul><h3 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h3><ul><li><p>安装 <code>yum -y install mysql-server</code></p></li><li><p>默认配置文件 <code>/etc/my.cnf</code></p><p>在mysqld节点下增加 <code>default-character-set=utf8  character-set-server=utf8</code></p></li><li><p>设置开机启动，配置防火墙</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">127  vim /etc/my.cnf </div><div class="line">128  chkconfig mysqld on</div><div class="line">129  chkconfig --list  mysqld </div><div class="line">130  iptables -A INPUT -p tcp -m tcp --dport 3306 -j ACCEPT</div><div class="line">131  iptables-save</div><div class="line">132  service iptables save</div><div class="line">service mysqld satrt</div></pre></td></tr></table></figure></li><li><p>设置数据库用户和密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">mysql -u root #默认没密码</div><div class="line"><span class="meta">&gt;</span>set password for root@localhost=password('123456');</div><div class="line"><span class="meta">&gt;</span>select user,host from mysql.user; # 查看用户</div><div class="line"><span class="meta">#</span>删除匿名用户，即用户名为空的用户</div><div class="line">delete from mysql.user where user='';</div><div class="line"><span class="meta">#</span>添加新用户</div><div class="line">insert into mysql.user(Host,User,Password) values('localhost', 'test', password('123456'));</div><div class="line"><span class="meta">#</span>刷新</div><div class="line">flush privileges;</div><div class="line"><span class="meta">#</span>创建新的数据库，数据库名用的不是单引号，是~键所在的那个。如果不是保留字也可以不用点。</div><div class="line">CREATE DATABASE `tpcms` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci</div><div class="line"><span class="meta">#</span> 授权（增删改查） db.table 对 user@ip  使用user密码验证</div><div class="line">GRANT ALL PRIVILEGES ON  *.*  TO root@"%" IDENTIFIED BY '用户root的密码';</div><div class="line"><span class="meta">#</span> 查看权限</div><div class="line">select * from mysql.user \G</div></pre></td></tr></table></figure></li></ul><h3 id="GIT"><a href="#GIT" class="headerlink" title="GIT"></a>GIT</h3><ul><li>安装和配置</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">162  yum remove git</div><div class="line">163  yum install -y curl-devel expat-devel gettext-devel openssl-devel zlib-devel asciidoc xmlto perl-devel perl-CPAN autoconf*</div><div class="line">164  wget https://github.com/git/git/archive/v2.17.0.tar.gz</div><div class="line">165  pwd</div><div class="line">166  tar -zxvf v2.17.0.tar.gz </div><div class="line">168  cd git-2.17.0/</div><div class="line">169  make configure</div><div class="line">170  ./configure --prefix=/usr/local/git --with-iconv=/usr/local/libiconv</div><div class="line">171  make all doc</div><div class="line">172  make install install-doc install-html</div><div class="line"><span class="meta">#</span>环境变量</div><div class="line">176  echo "export PATH=$PATH:/usr/local/git/bin" &gt;&gt; /etc/bashrc</div><div class="line">177  source /etc/bashrc </div><div class="line">180  vim /etc/profile</div><div class="line">181  source /etc/profile</div><div class="line">182  git --version</div><div class="line"></div><div class="line">git config --global core.autocrlf false  # 不去管win/linux换行符的问题</div><div class="line">git config --global gui.encoding utf-8</div><div class="line">git config --global core.quotepath off  # 避免git status的中文乱码问题</div><div class="line">git config --global</div></pre></td></tr></table></figure><ul><li><p>生成SSH key pair</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ssh-keygen -t rsa -C "syy@163.com"</div><div class="line">187  ssh-add ~/.ssh/id_rsa #添加秘钥</div><div class="line">188  eval `ssh-agent`  #上一步出错时执行</div><div class="line">189  ssh-add ~/.ssh/id_rsa  #添加秘钥</div><div class="line">190  cat ~/.ssh/id_rsa.pub  #将公钥添加到githubo 或码云里</div><div class="line">git clone git@gitee.com:shuayy/helloworld.git</div></pre></td></tr></table></figure><p>​</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;CentOS-6-8&quot;&gt;&lt;a href=&quot;#CentOS-6-8&quot; class=&quot;headerlink&quot; title=&quot;CentOS 6.8&quot;&gt;&lt;/a&gt;CentOS 6.8&lt;/h1&gt;&lt;h2 id=&quot;开启SSH&quot;&gt;&lt;a href=&quot;#开启SSH&quot; class=&quot;headerlink&quot; title=&quot;开启SSH&quot;&gt;&lt;/a&gt;开启SSH&lt;/h2&gt;&lt;p&gt;默认是开机启动并自动运行的，无需设置。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;查看是否安装ssh&lt;code&gt;rpm -qa | grep ssh&lt;/code&gt; &lt;/li&gt;
&lt;li&gt;安装命令 &lt;code&gt;yum install openssh-server&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;查看服务状态&lt;code&gt;service sshd status&lt;/code&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;文件传输&quot;&gt;&lt;a href=&quot;#文件传输&quot; class=&quot;headerlink&quot; title=&quot;文件传输&quot;&gt;&lt;/a&gt;文件传输&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;安装lrzsz&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安装并开启ftp服务&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;39  yum -y install vsftpd&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt; 为ftp创建一个Linux用户，其主目录用于文件传输，禁止其登陆系统， &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46  useradd ftpuser -d /ftpfile -s /sbin/nologin&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt; 修改主目录的所有权&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47  chown ftpuser.ftpuser /ftpfile&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt; 修改用户密码&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48  passwd ftpuser&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50  vim /etc/vsftpd/chroot_list&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51  vim /etc/selinux/config &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52  vim /etc/vsftpd/vsftpd.conf &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53  service vsftpd restart&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt; 配置防火墙&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54  iptables -I INPUT -p tcp --dport 61001:62000 -j ACCEPT&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55  iptables -I OUTPUT -p tcp --sport 61001:62000 -j ACCEPT&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56  iptables -I INPUT -p tcp --dport 20 -j ACCEPT&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57  iptables -I OUTPUT -p tcp --sport 20 -j ACCEPT&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58  iptables -I INPUT -p tcp --dport 21 -j ACCEPT&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;59  iptables -I OUTPUT -p tcp --sport 21 -j ACCEPT&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;60  iptables-save&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;61  service iptables save # 永久保存&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;62  vim /ftpfile/index.html&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;63  setsebool -P ftp_home_dir 1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;64  vim /etc/selinux/config  # 关闭selinux&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;65  reboot&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;79  service vsftpd restart&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​&lt;/p&gt;
&lt;p&gt;​&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;增加用户sudoer权限&quot;&gt;&lt;a href=&quot;#增加用户sudoer权限&quot; class=&quot;headerlink&quot; title=&quot;增加用户sudoer权限&quot;&gt;&lt;/a&gt;增加用户sudoer权限&lt;/h2&gt;&lt;p&gt;root用户下执行 visudo，并添加用户&lt;code&gt;ypur_user ALL=(ALL)       ALL&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;更改阿里云源&quot;&gt;&lt;a href=&quot;#更改阿里云源&quot; class=&quot;headerlink&quot; title=&quot;更改阿里云源&quot;&gt;&lt;/a&gt;更改阿里云源&lt;/h2&gt;&lt;p&gt;&lt;code&gt;sudo wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;yum makecache&lt;/code&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Linux" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Linux/"/>
    
      <category term="Server" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Linux/Server/"/>
    
    
      <category term="Linux" scheme="http://shuaiyy.cn/tags/Linux/"/>
    
      <category term="CentOS" scheme="http://shuaiyy.cn/tags/CentOS/"/>
    
  </entry>
  
  <entry>
    <title>Spring入门</title>
    <link href="http://shuaiyy.cn/2018/02/25/%E6%8A%80%E6%9C%AF/Spring%E5%85%A5%E9%97%A8-Hello%20World/"/>
    <id>http://shuaiyy.cn/2018/02/25/技术/Spring入门-Hello World/</id>
    <published>2018-02-24T16:00:00.000Z</published>
    <updated>2018-11-22T11:02:28.482Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Spring-Hello-World"><a href="#Spring-Hello-World" class="headerlink" title="Spring Hello World"></a>Spring Hello World</h1><blockquote><p> Spring 是一个IOC(DI) 和AOP 容器框架</p></blockquote><h2 id="IOC-DI"><a href="#IOC-DI" class="headerlink" title="IOC/DI"></a>IOC/DI</h2><p><strong>两个概念</strong>（其实是不同的角度） </p><p>控制反转：对象实例由spring通过配置创建，而不是程序员主动new构造。</p><p>依赖注入：拿到的对象实例可以直接使用，其定义在配置文件的属性值在实例化时已被注入。</p><ul><li><p>创建一个pojo类，<em>POJO</em>（Plain Ordinary Java Object）简单的Java对象，实际就是普通JavaBeans。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> id;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.id = id;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ul>  <a id="more"></a><ul><li><p>创建spring的配置文件，在bean中配置要生成的对象实例及其属性。</p><p><code>applicationContext.xml</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</div><div class="line">&lt;beans xmlns=<span class="string">"http://www.springframework.org/schema/beans"</span></div><div class="line">       xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></div><div class="line">       xmlns:aop=<span class="string">"http://www.springframework.org/schema/aop"</span></div><div class="line">       xmlns:tx=<span class="string">"http://www.springframework.org/schema/tx"</span></div><div class="line">       xmlns:context=<span class="string">"http://www.springframework.org/schema/context"</span>&gt;</div><div class="line">&lt;!-- 定义bean对象及其属性 --&gt;</div><div class="line">  &lt;bean name=<span class="string">"c"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"com.how2java.pojo.Category"</span>&gt;</div><div class="line">      &lt;property name=<span class="string">"name"</span> value=<span class="string">"category_1"</span> /&gt;</div><div class="line">      &lt;property name=<span class="string">"id"</span> value=<span class="string">"1000"</span> /&gt;</div><div class="line">  &lt;/bean&gt;</div><div class="line"></div><div class="line">&lt;/beans&gt;</div></pre></td></tr></table></figure></li><li><p>Spring通过配置文件创建实例</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</div><div class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</div><div class="line"><span class="keyword">import</span> Category;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(</div><div class="line">                <span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</div><div class="line">        Category c = (Category) context.getBean(<span class="string">"c"</span>);</div><div class="line"></div><div class="line">        System.out.println(c.getName());</div><div class="line">        c.setName(<span class="string">"hello"</span>);</div><div class="line">        System.out.println(c.getName());</div><div class="line">        System.out.println(c.getId());</div><div class="line">        c.setId(<span class="number">100</span>);</div><div class="line">        System.out.println(c.getId());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>注入对象</p><p>假设一个Product类的属性里有Category类，在实例化Product类时，可以注入一个已有的Category实例。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</div><div class="line">  </div><div class="line">    <span class="keyword">private</span> Category category;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> category;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.category = category;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>配置<code>applicationContext.xml</code>,使用rel指定对象实例。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"c"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"category 1"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"p"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Product"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"product1"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"category"</span> <span class="attr">ref</span>=<span class="string">"c"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="通过注解方式实现IOC-DI"><a href="#通过注解方式实现IOC-DI" class="headerlink" title="通过注解方式实现IOC/DI"></a>通过注解方式实现IOC/DI</h2><ul><li><p>在<code>applicationContext</code>中声明使用注解方式进行装配</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"c"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"category_1"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1000"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"p1"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Product"</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!--&lt;property name="category" ref="c"/&gt;--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"product_1"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p><code>@Autowired</code> 自动装配依赖对象</p><p>首先了解beans里的default-autowire参数，声明了该参数，则会使用指定的方式自动配置，不用显示的在bean中指定依赖。</p><p><code>&lt;beans xmlns=&quot;...&quot; default-autowire=&quot;byName&quot;&gt;</code></p><p>默认值为no，即不自动装配。四种方式：</p><ol><li>byName,找到与属性名一样的bean，然后装配给该属性</li><li>byType， 找到与属性类型一样的bean，然后装配给该属性。如果 找到多个，抛出异常，没找到不会异常(设置dependency-check=“object” 可以让spring抛出异常)</li><li>constructor，与byType类似，使用的是构造器方法参数的类型，如果找不到类型一致的bean，则会异常</li><li>autodect，通过bean的自省来决定，如果是默认的构造器则用byType，否则使用constructor。</li></ol><p><strong>自动装配依赖对象</strong></p><p>@Autowired 可以用来注解构造方法、属性、setter方法，使用的是<code>byType</code>方式装配</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</div><div class="line"><span class="comment">//    @Autowired</span></div><div class="line">    <span class="keyword">private</span> Category category;</div><div class="line">    </div><div class="line">    <span class="meta">@Autowired</span>(required=<span class="keyword">false</span>)  <span class="comment">// 默认是不允许对象为null的，可以使用required参数修改</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Product</span><span class="params">(Category category)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.category = category;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> category;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="comment">//    @Autowired</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.category = category;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p><code>@Resource(name=&quot;xxx&quot;)</code></p><p>使用<code>@Resource</code>注解也可以实现为bean自动注入对象</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</div><div class="line"><span class="comment">//    @Autowired</span></div><div class="line">    <span class="meta">@Resource</span>(name=<span class="string">"c"</span>)</div><div class="line">    <span class="keyword">private</span> Category category;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p><code>@Component</code>  将pojo类注解为Spring bean，在配置文件中声明bean class的位置，bean的初始化不再由配置文件注入，而是由类自身实现。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.test.pojo"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Component</span>(<span class="string">"c"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String name=<span class="string">"category_1"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Component</span>(<span class="string">"p"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    <span class="keyword">private</span> Category category;</div><div class="line">    <span class="keyword">private</span> String name=<span class="string">"category_1"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h2><blockquote><p>AOP 即 Aspect Oriented Program 面向切面编程 .</p><p>首先在面向切面编程的思想里面，把功能分为核心业务功能，和周边功能。<br> 核心业务，比如登陆，数据操作等；周边功能如性能统计，日志，事务管理等等 </p></blockquote><p>传统的面向对象编程OOP如果实现周边功能，需要在每个类中实现该功能接口，耦合高。</p><p>在面向切面编程AOP的思想里面，核心业务功能和周边功能分别独立进行开发， 然后把周边功能和核心业务功能 “编织” 在一起，这就叫AOP。</p><p><strong>简单的示例</strong>: 在执行核心功能前后执行log打印</p><ul><li><p>核心业务，在切点上执行</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.test.service;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductService</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Thread.sleep(<span class="number">2000</span>);</div><div class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        System.out.println(<span class="string">"do someting!"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>辅助业务， 在切面上执行</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.test.aspect;</div></pre></td></tr></table></figure><p>import org.aspectj.lang.ProceedingJoinPoint;</p><p>public class LogAspect {</p><pre><code>public Object log(ProceedingJoinPoint joinPoint) throws Throwable {    System.out.println(&quot;start at&quot; + System.currentTimeMillis());  // 辅助功能    Object obj = joinPoint.proceed();  // 执行核心功能    System.out.println(&quot;end at&quot; + System.currentTimeMillis()); // 辅助功能    return obj;}</code></pre><p>}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">+ 声明切点、切面的bean对象，并配置AOP关系</div><div class="line"></div><div class="line">  ```xml</div><div class="line">  &lt;!-- 定义切点、切面 --&gt;</div><div class="line">  &lt;bean name=&quot;product_service&quot; class=&quot;com.how2java.service.ProductService&quot;/&gt;</div><div class="line">  &lt;bean name=&quot;logAspect&quot; class=&quot;com.how2java.aspect.LogAspect&quot;/&gt;    </div><div class="line"></div><div class="line">  &lt;!-- 配置切点和切面 --&gt;</div><div class="line">  &lt;aop:config&gt;</div><div class="line">          &lt;aop:pointcut id=&quot;logPointCut&quot; expression=&quot;execution(* com.test.service.ProductService.*(..)) &quot;/&gt;</div><div class="line">          &lt;aop:aspect id=&quot;logger&quot; ref=&quot;logAspect&quot;&gt;</div><div class="line">              &lt;aop:around pointcut-ref=&quot;logPointCut&quot; method=&quot;log&quot;/&gt;</div><div class="line">          &lt;/aop:aspect&gt;</div><div class="line">      &lt;/aop:config&gt;</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="通过注解实现AOP"><a href="#通过注解实现AOP" class="headerlink" title="通过注解实现AOP"></a>通过注解实现AOP</h2><ul><li><p><code>@Component</code> 表示这是一个bean,由Spring进行管理，业务类和切面类都是由spring管理的bean类。</p></li><li><p><code>@Aspect</code> 注解表示这是一个切面，用在切面类上</p></li><li><p><code>@Around(value = &quot;execution(* com.test.service.ProductService.*(..))&quot;)</code> 用在切面方法上，表示对哪些业务类的哪些方法进行切面操作。</p></li><li><p>业务类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Component</span>(<span class="string">"productService"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductService</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Thread.sleep(<span class="number">2000</span>);</div><div class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        System.out.println(<span class="string">"do someting!"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>切面类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Component</span>(<span class="string">"logAspect"</span>)</div><div class="line"><span class="meta">@Aspect</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogAspect</span> </span>&#123;</div><div class="line">    <span class="meta">@Around</span>(value = <span class="string">"execution(* com.how2java.service.ProductService.*(..))"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">log</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"start at"</span> + System.currentTimeMillis());</div><div class="line"></div><div class="line">        Object obj = joinPoint.proceed();  <span class="comment">// 执行核心功能</span></div><div class="line"></div><div class="line">        System.out.println(<span class="string">"end at"</span> + System.currentTimeMillis());</div><div class="line">        <span class="keyword">return</span> obj;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>applicationContext.xml配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.aspect"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.service"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="通过注解执行Spring测试类"><a href="#通过注解执行Spring测试类" class="headerlink" title="通过注解执行Spring测试类"></a>通过注解执行Spring测试类</h2><ul><li><p><code>@RunWith(SpringJUnit4ClassRunner.class)</code> 声明这是一个Spring的测试类</p></li><li><p><code>@ContextConfiguration(&quot;classpath:applicationContext.xml&quot;)</code> 加载Spring的配置文件</p></li><li><p><code>@Autowired</code> 给属性自动装配相关对象</p></li><li><p><code>@Test</code> 声明方法为测试类Test方法, 需要junit和hamcrest-all jar包</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@ContextConfiguration</span>(<span class="string">"classpath:applicationContext.xml"</span>)</div><div class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    Category c;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    Product p1;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    ProductService ps;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(c.getName());</div><div class="line">        System.out.println(p1.getName());</div><div class="line">        ps.doSomething();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>不使用注解的话和测试类的话</p><p>需要main方法执行，手动加载配置，获取beans并执行</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(</div><div class="line">                <span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</div><div class="line"></div><div class="line">        Category c = (Category) context.getBean(<span class="string">"c"</span>);</div><div class="line"></div><div class="line">        System.out.println(c.getName());</div><div class="line">        c.setName(<span class="string">"hello"</span>);</div><div class="line">        System.out.println(c.getName());</div><div class="line">        System.out.println(c.getId());</div><div class="line">        c.setId(<span class="number">100</span>);</div><div class="line">        System.out.println(c.getId());</div><div class="line"></div><div class="line">        Product p1 = (Product) context.getBean(<span class="string">"p1"</span>);</div><div class="line">        System.out.println(p1.getName() + p1.getCategory().getName() + p1.getCategory().getId());</div><div class="line"></div><div class="line">        ProductService ps = (ProductService) context.getBean(<span class="string">"productService"</span>);</div><div class="line">        ps.doSomething();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ul><h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1><h2 id="配置Bean"><a href="#配置Bean" class="headerlink" title="配置Bean"></a>配置Bean</h2><ul><li><p>配置形式：基于xml、基于注解</p></li><li><p>Bean 的配置方式：通过全类名（反射）、通过工厂方法（静态工厂方法&amp;<br>实例工厂方法）、FactoryBean</p></li><li><p>IOC 容器BeanFactory &amp; ApplicationContext</p><p>ApplicationContext是Beanfactory的子接口，IOC容器负责实例化Bean。ApplicationContext 在初始化上下文时就实例化了所有的单例Bean。</p><p><code>ClassPathXmlApplicationContext</code>：从类路径下加载配置文件<br><code>FileSystemXmlApplicationContext</code>: 从文件系统中加载配置文件</p></li><li><p>依赖注入的方式：属性注入（通过setter方法）；构造器注入.</p><p>属性可以使用ref引用其他bean，也可以创建内部bean。</p><p><img src="http://img.shuaiyy.cn/blog/180409/bgGAkBm82c.png?imageslim" alt="mark"></p><p><img src="http://img.shuaiyy.cn/blog/180409/gIkb16mJEj.png?imageslim" alt="mark"></p><p>​</p></li><li><p>注入属性值的字面值，即可以用字符串表示的值，基本类型，封装类都可以。 <code>&lt;null/&gt;</code>表示注入null值。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 可以根据 index 和 type 进行更加精确的定位. (了解) --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"car"</span> <span class="attr">class</span>=<span class="string">"com.atguigu.spring.helloworld.Car"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"KUGA"</span> <span class="attr">index</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"ChangAnFord"</span> <span class="attr">index</span>=<span class="string">"0"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"250000"</span> <span class="attr">type</span>=<span class="string">"float"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 若字面值中包含特殊字符, 则可以使用 CDATA 来进行赋值. (了解) --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">constructor-arg</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>&lt;![CDATA[&lt;ATARZA&gt;]]&gt;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure><p>集合属性值：</p><ul><li>util.map 子标签 entry key value</li><li>list</li><li>props定义util.Properties，子标签为prop</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 装配集合属性 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.atguigu.spring.helloworld.User"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"userName"</span> <span class="attr">value</span>=<span class="string">"Jack"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cars"</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 使用 list 元素来装配集合属性 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">list</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"car"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"car2"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">list</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">      <span class="comment">&lt;!-- 引用外部声明的 list --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"newCars"</span> <span class="attr">ref</span>=<span class="string">"cars"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 声明集合类型的 bean --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">util:list</span> <span class="attr">id</span>=<span class="string">"cars"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"car"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"car2"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">util:list</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>自动装配：byName, byType</p></li><li><p>bean 之间的关系：继承；依赖</p><p>子Bean 从父Bean 中继承或覆盖配置, 包括Bean 的属性配置。</p><p>父Bean 可以作为配置模板, 也可以作为Bean 实例. 若只想把父Bean 作为模板, 可以设置父bean的abstract 属性为true, 这样Spring 将不会实例化这个 Bean。</p><p>depends-on，依赖关系，依赖的bean会在本bean之前实例化</p></li><li><p>bean 的作用域：singleton；prototype；WEB 环境作用域；</p><p>scope属性设置作用域，默认是单例的，即singleton，容器加载后即创建单实例的Bean。</p><p>prototype是每次返回一个新的实例。</p></li><li><p>使用外部属性文件</p><p>使用PropertyPlaceholderConfigurer载入外部properties配置文件，然后使用<code>${varName}</code>引用</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 导入外部的资源文件 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:db.properties"</span>/&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>spEL，使用<code>#{...}</code>作为定界符。</p><p>表示字面量、引用对象及其属性或方法`#{5}  #{“string1”} #{false} #{obj} #{obj.id}  #{obj.toString()} </p><p>算数运算，三元运算，正则表达式，调用静态类使用 <code>#{ T(java.lang.Math).PI}</code></p></li><li><p>IOC 容器中Bean 的生命周期</p><p>scope属性可以设置是单例还是prototype，生命周期也会不同。</p><p>Bean的配置中可以声明init-method和destroy-method属性，为Bean指定初始化和销毁方法。</p><p>在初始化方法执行的前后仍可以使用自定的Bean后置处理器，执行before和after的相关逻辑代码。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 初始化和销毁方法--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"boy"</span> <span class="attr">class</span>=<span class="string">"com.helloworld.User"</span> <span class="attr">init-method</span>=<span class="string">"init"</span> <span class="attr">destroy-method</span>=<span class="string">"destroy"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"userName"</span> <span class="attr">value</span>=<span class="string">"bob"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"wifeName"</span> <span class="attr">value</span>=<span class="string">"#&#123;girl.userName&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 前置处理器，自己实现的类，AOP --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 配置 bean 后置处理器: 不需要配置 id 属性, IOC 容器会识别到他是一个 bean 后置处理器, 并调用其方法， 注意：所有的bean都会被处理--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.helloworld.MyBeanPostProcessor"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure><p>java类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line">System.out.println(<span class="string">"init method..."</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>&#123;</div><div class="line">System.out.println(<span class="string">"destroy method..."</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Bean 后置处理器</span></div><div class="line"><span class="keyword">import</span> org.springframework.beans.BeansException;</div><div class="line"><span class="keyword">import</span> org.springframework.beans.factory.config.BeanPostProcessor;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title">BeanPostProcessor</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="comment">//该方法在 init 方法之后被调用</span></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">postProcessAfterInitialization</span><span class="params">(Object arg0, String arg1)</span></span></div><div class="line"><span class="function"><span class="keyword">throws</span> BeansException </span>&#123;</div><div class="line"><span class="keyword">if</span>(arg1.equals(<span class="string">"boy"</span>))&#123;</div><div class="line">System.out.println(<span class="string">"postProcessAfterInitialization..."</span> + arg0 + <span class="string">","</span> + arg1);</div><div class="line">User user = (User) arg0;</div><div class="line">user.setUserName(<span class="string">"李大齐"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> arg0;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//该方法在 init 方法之前被调用</span></div><div class="line"><span class="comment">//可以工作返回的对象来决定最终返回给 getBean 方法的对象是哪一个, 属性值是什么</span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@param</span> arg0: 实际要返回的对象</span></div><div class="line"><span class="comment"> * <span class="doctag">@param</span> arg1: bean 的 id 值</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">postProcessBeforeInitialization</span><span class="params">(Object arg0, String arg1)</span></span></div><div class="line"><span class="function"><span class="keyword">throws</span> BeansException </span>&#123;</div><div class="line"><span class="keyword">if</span>(arg1.equals(<span class="string">"boy"</span>))</div><div class="line">System.out.println(<span class="string">"postProcessBeforeInitialization..."</span> + arg0 + <span class="string">","</span> + arg1);</div><div class="line"><span class="keyword">return</span> arg0;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ul><h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><ul><li><p>组件扫描，component-scan，可以扫描并实例化具有特定注解的组件</p><p>配置中<code>&lt;context:component-scan&gt;</code>, base-package 属性指定一个需要扫描的基类包，Spring 容器将会扫描<br>这个基类包里及其子包中的所有类. 当需要扫描多个包时, 可以使用逗号分隔. 还可以指定包含或过滤的特定类，或者匹配模式</p><p><img src="http://img.shuaiyy.cn/blog/180409/cB0817ICh4.png?imageslim" alt="mark"></p><p>@Autowired 和@Resource 、@Inject注解的属性也会被自动装配。</p></li><li><p>特定组件：</p><p><img src="http://img.shuaiyy.cn/blog/180409/cJmKhF0GhE.png?imageslim" alt="mark"></p></li><li><p>默认命名为类名的首字母小写，或者通过注解的value指定。</p></li><li><p>自动装配</p><p><img src="http://img.shuaiyy.cn/blog/180409/fIlBE1E3JG.png?imageslim" alt="mark"></p><p>​</p><p><img src="http://img.shuaiyy.cn/blog/180409/5k7j1hkI3D.png?imageslim" alt="mark"></p></li></ul><h2 id="AOP-1"><a href="#AOP-1" class="headerlink" title="AOP"></a>AOP</h2><p>如日志、验证等需要面向切面编程的场景。做到核心业务与辅助业务相分离。</p><p><strong>相关概念</strong>：</p><ul><li><p>切面(Aspect): 横切关注点(跨越应用程序多个模块的功能)被模块化的特殊对象</p></li><li><p>通知(Advice): 切面必须要完成的工作</p></li><li><p>目标(Target): 被通知的对象</p></li><li><p>代理(Proxy): 向目标对象应用通知之后创建的对象</p></li><li><p>连接点（Joinpoint）：程序执行的某个特定位置：如类某个方法调用前、调用后、方法抛出异常后等。连接点由两个信息确定：执行点和相对执行点的方位。</p></li><li><p>切点（pointcut）：每个类都拥有多个连接点, AOP通过切点定位到特定的连接点。</p><p>切点通过 org.springframework.aop.Pointcut 接口进行描述，它使用类和方法作为连接点的查询条件。</p></li></ul><p><strong>声明配置切面</strong></p><p>AspectJ是Java 社区里最完整最流行的AOP 框架，开启支持需要导入相关的jar包，并配置<code>&lt;aop:aspectj-autoproxy&gt;</code></p><p><strong>通过注解配置AOP</strong></p><ol><li><p>配置文件中自动扫描切面组件 <code>&lt;context:component-scan base-package=&quot;com.helloworld.spring.aop&quot;&gt;&lt;/context:component-scan&gt;</code></p></li><li><p>加入使 AspjectJ 注解起作用的配置:<code>&lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</code>为匹配的类自动生成动态代理对象. </p></li><li><p>编写切面类，需要<code>@Component</code> 和 <code>@Aspect</code> 声明类为spring bean，且为切面。在切面类的方法上声明为通知方法，如<code>@Before(&quot;切点表达式&quot;)声明前置通知。</code></p><p>可在通知方法中添加 JoinPoint 类型的参数, 以访问到切点方法（被通知的方法）的签名和方法的参数. </p><p>​</p></li></ol><ul><li><p>切面只是一个带有@Aspect 注解的Java 类. </p></li><li><p>通知Advice是标注有某种注解的简单的Java 方法.</p><p>– @Before: 前置通知, 在方法执行之前执行<br>– @After: 后置通知, 在方法执行（正常返回或异常）之后执行<br>– @AfterRunning: 返回通知, 在方法返回结果之后执行<br>– @AfterThrowing: 异常通知, 在方法抛出异常之后<br>– @Around: 环绕通知, 围绕着方法执行</p><p>@DeclareParents(value=”目标类对象”， defaultImpl=YourImpl.class)：引入通知，为目标类对象动态的增加接口实现，实现多重继承。而不用修改目标类的代码。 新接口实现由yourImpl负责实现</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Aspect</span></div><div class="line"><span class="meta">@Order</span>(<span class="number">0</span>) <span class="comment">// 执行优先级，越小越先被执行</span></div><div class="line"><span class="meta">@Compoment</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoggingAspect</span> </span>&#123;</div><div class="line"><span class="meta">@Before</span>(<span class="string">"execution(public int com.helloworld.Calculator.*(int, int))"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeMethod</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</div><div class="line">String methodName = joinPoint.getSignature().getName();</div><div class="line">Object [] args = joinPoint.getArgs();</div><div class="line">&#125;</div><div class="line">  <span class="comment">// 无论是正常返回还是出现异常，后置通知都会执行</span></div><div class="line"><span class="meta">@After</span>(<span class="string">"execution(* com.helloworld.spring.aop.*.*(..))"</span>) <span class="comment">//表达式支持通配符</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterMethod</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</div><div class="line">String methodName = joinPoint.getSignature().getName();</div><div class="line">System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends"</span>);</div><div class="line">&#125;</div><div class="line">  <span class="comment">// 正常返回后执行通知, 使用returning属性获取返回值，并在通知方法的参数中接收，参数名要一致</span></div><div class="line"><span class="meta">@AfterReturing</span>(pointcut=<span class="string">"execution(* com.helloworld.spring.aop.*.*(..))"</span>, returning=<span class="string">"result"</span>) </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(JoinPoint joinPoint, Object result)</span></span>&#123;</div><div class="line">String methodName = joinPoint.getSignature().getName();</div><div class="line">System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends with "</span> + result);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 异常通知，通知方法传入的异常可以指定具体的类型以捕获感兴趣的通知</span></div><div class="line">    <span class="meta">@AfterThrowing</span>(pointcut=<span class="string">"execution(* com.helloworld.spring.aop.*.*(..))"</span>, throwing=<span class="string">"e"</span>) </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(JoinPoint joinPoint, Exception e)</span></span>&#123;</div><div class="line">String methodName = joinPoint.getSignature().getName();</div><div class="line">System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" occurs excetion:"</span> + e);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 环绕通知，功能最为强大的, 能够全面地控制连接点. 甚至可以控制是否执行连接点</span></div><div class="line">   <span class="comment">// 必须显示调用ProceedingJoinPoint对象的proceed方法执行被代理的目标方法，并将结果返回。</span></div><div class="line"><span class="meta">@Around</span>(<span class="string">"execution(public int com.atguigu.spring.aop.ArithmeticCalculator.*(..))"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">aroundMethod</span><span class="params">(ProceedingJoinPoint pjd)</span></span>&#123;</div><div class="line"></div><div class="line">Object result = <span class="keyword">null</span>;</div><div class="line">String methodName = pjd.getSignature().getName();</div><div class="line"></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line"><span class="comment">//前置通知</span></div><div class="line">System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" begins with "</span> + Arrays.asList(pjd.getArgs()));</div><div class="line"><span class="comment">//执行目标方法</span></div><div class="line">result = pjd.proceed();</div><div class="line"><span class="comment">//返回通知</span></div><div class="line">System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends with "</span> + result);</div><div class="line">&#125; <span class="keyword">catch</span> (Throwable e) &#123;</div><div class="line"><span class="comment">//异常通知</span></div><div class="line">System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" occurs exception:"</span> + e);</div><div class="line"><span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</div><div class="line">&#125;</div><div class="line"><span class="comment">//后置通知</span></div><div class="line">System.out.println(<span class="string">"The method "</span> + methodName + <span class="string">" ends"</span>);</div><div class="line"></div><div class="line"><span class="keyword">return</span> result;  <span class="comment">// 必须返回目标方法的结果</span></div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>切入点表达式支持通配符，多个表达式可以通过操作符<code>&amp;&amp;, ||, !</code>结合起来. </p></li><li><p>切入点表达式重用，用@Pointcut(“切入点表达式”)声明一个切入点的空方法，通知注解的pointcut属性传入该方法的调用。</p><p><img src="http://img.shuaiyy.cn/blog/180410/aB0Hk3fAfd.png?imageslim" alt="mark"></p></li><li><p>连接点对象JoinPoint，可以让Advice的方法访问连接点的细节.@Around环绕通知使用的是ProceedingJoinPoint。</p><p><strong>通过XML配置AOP</strong></p><p>xml是由spring支持的，而注解则是AspctJ实现的，且AspectJ被很多AOP框架支持，应优先考虑用注解。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 配置切面的 bean. --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"loggingAspect"</span></span></div><div class="line"><span class="tag"><span class="attr">class</span>=<span class="string">"com.helloworld.aspect.LoggingAspect"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"vlidationAspect"</span></span></div><div class="line"><span class="tag"><span class="attr">class</span>=<span class="string">"com.helloworld.aspect.VlidationAspect"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 配置 AOP --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 配置切点表达式 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.helloworld.UserService.*(..))"</span> </span></div><div class="line"><span class="tag"><span class="attr">id</span>=<span class="string">"pointcut"</span>/&gt;</span></div><div class="line"><span class="comment">&lt;!-- 配置切面及通知 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"loggingAspect"</span> <span class="attr">order</span>=<span class="string">"2"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"beforeMethod"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">"afterMethod"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">"afterThrowing"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span> <span class="attr">throwing</span>=<span class="string">"e"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">"afterReturning"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span> <span class="attr">returning</span>=<span class="string">"result"</span>/&gt;</span></div><div class="line"><span class="comment">&lt;!--  </span></div><div class="line"><span class="comment">&lt;aop:around method="aroundMethod" pointcut-ref="pointcut"/&gt;</span></div><div class="line"><span class="comment">--&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></div><div class="line">      <span class="comment">&lt;!-- 同一切点执行多个切面通知时，可以指定执行顺序 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"vlidationAspect"</span> <span class="attr">order</span>=<span class="string">"1"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"validateArgs"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="JdbcTemplate"><a href="#JdbcTemplate" class="headerlink" title="JdbcTemplate"></a>JdbcTemplate</h2><p>spring对原始的jdbc api提供了封装。</p><ul><li><p>注入方式，在DAO中注入jdbcTemplate对象。</p><p><img src="http://img.shuaiyy.cn/blog/180410/0im14A43Ka.png?imageslim" alt="mark"></p></li><li><p>支持批量更新、插入、删除，查询；sql语句可以使用具名参数，如map集合进行参数绑定</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 查询一个</span></div><div class="line">String sql = <span class="string">"SELECT id, last_name lastName, email, dept_id as \"department.id\" FROM employees WHERE id = ?"</span>;</div><div class="line">RowMapper&lt;Employee&gt; rowMapper = <span class="keyword">new</span> BeanPropertyRowMapper&lt;&gt;(Employee.class);</div><div class="line">Employee employee = jdbcTemplate.queryForObject(sql, rowMapper, <span class="number">1</span>);</div><div class="line"><span class="comment">// 查询多个</span></div><div class="line">String sql = <span class="string">"SELECT id, last_name lastName, email FROM employees WHERE id &gt; ?"</span>;</div><div class="line">RowMapper&lt;Employee&gt; rowMapper = <span class="keyword">new</span> BeanPropertyRowMapper&lt;&gt;(Employee.class);</div><div class="line">List&lt;Employee&gt; employees = jdbcTemplate.query(sql, rowMapper,<span class="number">5</span>);</div><div class="line"></div><div class="line">List&lt;Object[]&gt; batchObjs = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">batchObjs.add(<span class="keyword">new</span> Object[]&#123;<span class="string">"AA"</span>, <span class="string">"aa@atguigu.com"</span>, <span class="number">1</span>&#125;);</div><div class="line">batchObjs.add(<span class="keyword">new</span> Object[]&#123;<span class="string">"BB"</span>, <span class="string">"bb@atguigu.com"</span>, <span class="number">2</span>&#125;);</div><div class="line">batchObjs.add(<span class="keyword">new</span> Object[]&#123;<span class="string">"CC"</span>, <span class="string">"cc@atguigu.com"</span>, <span class="number">3</span>&#125;);</div><div class="line">batchObjs.add(<span class="keyword">new</span> Object[]&#123;<span class="string">"DD"</span>, <span class="string">"dd@atguigu.com"</span>, <span class="number">3</span>&#125;);</div><div class="line">batchObjs.add(<span class="keyword">new</span> Object[]&#123;<span class="string">"EE"</span>, <span class="string">"ee@atguigu.com"</span>, <span class="number">2</span>&#125;);</div><div class="line"><span class="comment">// 批量更新</span></div><div class="line">String sql = <span class="string">"INSERT INTO employees(last_name, email, dept_id) VALUES(?,?,?)"</span>;</div><div class="line">jdbcTemplate.batchUpdate(sql, batchObjs);</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="spring事务管理"><a href="#spring事务管理" class="headerlink" title="spring事务管理"></a>spring事务管理</h2><p><strong>事务的关键性质</strong>：</p><ul><li>原子性：单独的最小工作单元，要么全部动作都执行成功，否则就都不起作用。</li><li>一致性：事务动作完成，一旦事务被提交，数据就会保持一致。</li><li>隔离性：多个事务处理相同数据的行为表现</li><li>持久性： 已经完成的事务结果应被持久化</li></ul><p><strong>实现方式</strong></p><p>AOP 提供了声明式的事务管理, Spring 实现了事务管理器</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 1. 配置事务管理器 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 2. 配置事务属性 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 根据方法名指定事务的属性 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"purchase"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRES_NEW"</span>/&gt;</span> <span class="comment">&lt;!-- 事务传播属性为新建事务 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"get*"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"find*"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"*"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 3. 配置事务切入点, 以及把事务切入点和事务属性关联起来 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.helloworld.dao.*.*(..))"</span> </span></div><div class="line"><span class="tag">                <span class="attr">id</span>=<span class="string">"txPointCut"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"txPointCut"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 直接在类或共有方法上使用@Transactional注解更方便  ---&gt;</span></div><div class="line"><span class="comment">&lt;!-- 需要开启事务注解支持，并配置事务管理器 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span>/&gt;</span></div></pre></td></tr></table></figure><p>或者，用@Transactional 注解声明式地管理事务。在方法或者类级别上添加 @Transactional 注解，只有public属性的方法才会应用事务管理。然后还要在配置中显示声明 <code>&lt;tx:annotation-driven&gt;</code>,并为其指定事务管理。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Transactional</span>(propagation = Propagation.REQUIRES_NEW, isolation = Isolation.READ_COMMITTED)</div><div class="line"><span class="function"><span class="keyword">public</span> Boolean <span class="title">delete</span><span class="params">(Person b)</span></span>&#123;</div><div class="line">        <span class="comment">// 数据操作相关代码</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>事务的传播属性</strong></p><p>默认为REQUIRED，使用当前的事务。REQUIRED_NEW，挂起当前事务，并开辟新的事务。</p><p><img src="http://img.shuaiyy.cn/blog/180410/DJ80iAEAfd.png?imageslim" alt="mark"></p><p><strong>事务隔离级别</strong></p><p>并发处理事务时，容易导致：</p><ul><li>脏读(读到别人更新的数据，但是别人事务失败对数据进行回滚)</li><li>不可重复读：先后访问同一数据，由于A的更新导致B读到了非原始数据。</li><li>幻读： A事务读后，B事务增加了新的记录。A再次读取就会多出n条记录。</li></ul><p>因此需要事务隔离。原则上完全隔离最好，但是没有并发，性能极低。</p><p>Spring 支持的事务隔离级别：</p><p><img src="http://img.shuaiyy.cn/blog/180410/a0dfgLga8E.png?imageslim" alt="mark"></p><p>还可以设置 回滚、不会滚、只读、超时属性。</p><ul><li>回滚： 指定的异常回滚</li><li>不回滚： 指定的异常不回滚</li><li>只读：表示这个事务只读取数据但不更新数据, 这样可以帮助数据库引擎优化事务。</li><li>超时：以秒位单位，超时回滚，避免长期占用资源。</li></ul><h1 id="Spring-MVC"><a href="#Spring-MVC" class="headerlink" title="Spring MVC"></a>Spring MVC</h1><h2 id="IOC容器"><a href="#IOC容器" class="headerlink" title="IOC容器"></a>IOC容器</h2><ol><li><p>在web容器初始化时加载spring IOC容器，指定配置文件。然后将其绑定到web容器（ServletContext）的一个属性上。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- IOC配置文件位置 --&gt;</span>    </div><div class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span></div><div class="line">            classpath:META-INF/applicationContext.xml</div><div class="line">        <span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 监听器，初始化spring --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>获取IOC容器的方法</p><p><code>WebApplicationContext ctx = WebApplicationContextUtils.getWebApplicationContext(servletContext);</code></p></li><li><p>​</p></li></ol><h2 id="Servlet拦截"><a href="#Servlet拦截" class="headerlink" title="Servlet拦截"></a>Servlet拦截</h2><ol><li><p>创建一个web项目</p></li><li><p>在<code>web.xml</code>配置使用spring 调度servlet类<code>org.springframework.web.servlet.DispatcherServlet</code>处理全部的Servlet请求。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span></div><div class="line">      org.springframework.web.servlet.DispatcherServlet</div><div class="line">    <span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>Spring bean的配置文件，定义servlet类，定义URL与Servlet类的映射关系。</p><p>配置文件的名字和web.xml中的servlet name相关。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"indexController"</span> <span class="attr">class</span>=<span class="string">"controller.IndexController"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"simpleUrlHandlerMapping"</span></span></div><div class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappings"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"/index"</span>&gt;</span>indexController<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>控制类,实现controller接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.Controller;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"index.jsp"</span>);</div><div class="line">        mav.addObject(<span class="string">"message"</span>, <span class="string">"Hello Spring MVC"</span>);</div><div class="line">        <span class="keyword">return</span> mav;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>视图</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></div><div class="line"><span class="tag">         <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span> <span class="attr">isELIgnored</span>=<span class="string">"false"</span>%&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>$&#123;message&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ol><h2 id="视图模板文件位置"><a href="#视图模板文件位置" class="headerlink" title="视图模板文件位置"></a>视图模板文件位置</h2><p>这个是可以修改的，在<code>springmvc-servlet.xml</code>中定义一个<code>viewResolver</code>的bean，指定前缀即路径文件夹，后缀即文件格式。然后将模板文件移入指定的文件夹。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"viewResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/pages/"</span>/&gt;</span></div><div class="line">        <span class="comment">&lt;!--&lt;property name="suffix" value=".jsp"/&gt;--&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"indexController"</span> <span class="attr">class</span>=<span class="string">"controller.IndexController"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"simpleUrlHandlerMapping"</span></span></div><div class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappings"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"/index"</span>&gt;</span>indexController<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure><h2 id="通过注解实现URL映射"><a href="#通过注解实现URL映射" class="headerlink" title="通过注解实现URL映射"></a>通过注解实现URL映射</h2><ul><li><p>在配置文件里使用组件扫描<code>&lt;context:component-scan base-package=&quot;controller&quot; /&gt;</code>查找有注解的类，注释掉原来的URLmapping bean。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></div><div class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></div><div class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></div><div class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></div><div class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></div><div class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context</span></span></div><div class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"controller"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"viewResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/pages/"</span>/&gt;</span></div><div class="line">        <span class="comment">&lt;!--&lt;property name="suffix" value=".jsp"/&gt;--&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!--&lt;bean id="indexController" class="controller.IndexController"/&gt;--&gt;</span></div><div class="line">    <span class="comment">&lt;!--&lt;bean id="simpleUrlHandlerMapping"--&gt;</span></div><div class="line">          <span class="comment">&lt;!--class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"&gt;--&gt;</span></div><div class="line">        <span class="comment">&lt;!--&lt;property name="mappings"&gt;--&gt;</span></div><div class="line">            <span class="comment">&lt;!--&lt;props&gt;--&gt;</span></div><div class="line">                <span class="comment">&lt;!--&lt;prop key="/index"&gt;indexController&lt;/prop&gt;--&gt;</span></div><div class="line">            <span class="comment">&lt;!--&lt;/props&gt;--&gt;</span></div><div class="line">        <span class="comment">&lt;!--&lt;/property&gt;--&gt;</span></div><div class="line">    <span class="comment">&lt;!--&lt;/bean&gt;--&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>控制类不再继承接口，而是通过注解实现控制类和url mapping</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewIndexController</span></span>&#123;</div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/index2"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleResquest1</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">        ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView(<span class="string">"index.jsp"</span>);</div><div class="line">        modelAndView.addObject(<span class="string">"message"</span>, <span class="string">"hello, index2"</span>);</div><div class="line">        <span class="keyword">return</span> modelAndView;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ul><h2 id="SpringMVC-获取参数"><a href="#SpringMVC-获取参数" class="headerlink" title="SpringMVC 获取参数"></a>SpringMVC 获取参数</h2><ul><li><p>1、直接把表单的参数写在Controller相应的方法的形参中，适用于get方式提交，不适用于post方式提交。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/addUser1"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">addUser1</span><span class="params">(String username,String password)</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"username is:"</span>+username);</div><div class="line">    System.out.println(<span class="string">"password is:"</span>+password);</div><div class="line">    <span class="keyword">return</span> <span class="string">"demo/index"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p><strong>2、通过HttpServletRequest接收，post方式和get方式都可以</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/addUser2"</span>)</div><div class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">addUser2</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</div><div class="line">       String username=request.getParameter(<span class="string">"username"</span>);</div><div class="line">       String password=request.getParameter(<span class="string">"password"</span>);</div><div class="line">       <span class="keyword">return</span> <span class="string">"demo/index"</span>;</div><div class="line">   &#125;</div></pre></td></tr></table></figure></li><li><p><strong>3、通过一个bean来接收,post方式和get方式都可以</strong></p><p>建立一个和表单中参数对应的bean，用一个bean作为Controller的形参，用户上传的参数会自动装载进bean里。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserModel</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> String username;</div><div class="line">    <span class="keyword">private</span> String password;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> username;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.username = username;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> password;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.password = password;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * Controller方法，通过一个bean来接收</span></div><div class="line"><span class="comment">      * <span class="doctag">@param</span> user</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span></span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/addUser3"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addUser3</span><span class="params">(UserModel user)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"username is:"</span>+user.getUsername());</div><div class="line">        System.out.println(<span class="string">"password is:"</span>+user.getPassword());</div><div class="line">        <span class="keyword">return</span> <span class="string">"demo/index"</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></li><li><p>4、获取URL路径参数</p><p>URL中模板变量{username}和{password}绑定到通过@PathVariable注解的同名参数上</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/addUser4/&#123;username&#125;/&#123;password&#125;"</span>,method=RequestMethod.GET)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">addUser4</span><span class="params">(@PathVariable String username,@PathVariable String password)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"username is:"</span>+username);</div><div class="line">        System.out.println(<span class="string">"password is:"</span>+password);</div><div class="line">        <span class="keyword">return</span> <span class="string">"demo/index"</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></li><li><p><strong>5、使用@ModelAttribute注解获取POST请求的FORM表单数据</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/addUser5"</span>,method=RequestMethod.POST)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addUser5</span><span class="params">(@ModelAttribute(<span class="string">"user"</span>)</span> UserModel user) </span>&#123;</div><div class="line">        System.out.println(<span class="string">"username is:"</span>+user.getUsername());</div><div class="line">        System.out.println(<span class="string">"password is:"</span>+user.getPassword());</div><div class="line">        <span class="keyword">return</span> <span class="string">"demo/index"</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></li><li><p><strong>6、用注解@RequestParam绑定请求参数到方法入参</strong></p><p>当请求参数username不存在时会有异常发生,可以通过设置属性required=false解决,例如: @RequestParam(value=”username”, required=false)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/addUser6"</span>,method=RequestMethod.GET)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">addUser6</span><span class="params">(@RequestParam(<span class="string">"username"</span>)</span> String username,@<span class="title">RequestParam</span><span class="params">(<span class="string">"password"</span>)</span> String password) </span>&#123;</div><div class="line">    System.out.println(<span class="string">"username is:"</span>+username);</div><div class="line">    System.out.println(<span class="string">"password is:"</span>+password);</div><div class="line">    <span class="keyword">return</span> <span class="string">"demo/index"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="中文编码处理"><a href="#中文编码处理" class="headerlink" title="中文编码处理"></a>中文编码处理</h2><p> 在<code>web.xml</code>中注册一个处理编码的filter类，spring中提供了<code>CharacterEncodingFilter</code>类。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></div></pre></td></tr></table></figure><h2 id="浏览器页面跳转"><a href="#浏览器页面跳转" class="headerlink" title="浏览器页面跳转"></a>浏览器页面跳转</h2><p>redirect</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewIndexController</span></span>&#123;</div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/index2"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleResquest1</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">        ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView(<span class="string">"index.jsp"</span>);</div><div class="line">        modelAndView.addObject(<span class="string">"message"</span>, <span class="string">"hello, index2"</span>);</div><div class="line">        <span class="keyword">return</span> modelAndView;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/jump"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">jump</span> <span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span>&#123;</div><div class="line">        ModelAndView indexView = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/index2"</span>);</div><div class="line">        <span class="keyword">return</span> indexView;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="访问Session"><a href="#访问Session" class="headerlink" title="访问Session"></a>访问Session</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/count"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">count</span> <span class="params">(HttpSession session)</span></span>&#123;</div><div class="line">    Integer count = (Integer) session.getAttribute(<span class="string">"count"</span>);</div><div class="line">    <span class="keyword">if</span>(count == <span class="keyword">null</span>) count = <span class="number">0</span>;</div><div class="line">    count++;</div><div class="line">    session.setAttribute(<span class="string">"count"</span>, count);</div><div class="line">    ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/index2"</span>);</div><div class="line">    <span class="keyword">return</span> mav;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/clearcount"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">clearCount</span> <span class="params">(HttpSession session)</span></span>&#123;</div><div class="line">    session.setAttribute(<span class="string">"count"</span>, <span class="number">0</span>);</div><div class="line">    ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/index2"</span>);</div><div class="line">    <span class="keyword">return</span> mav;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="上传图片"><a href="#上传图片" class="headerlink" title="上传图片"></a>上传图片</h2><ul><li><p>配置web.xml允许访问*.jpg</p><p>由于springmvc的servlet拦截器的匹配规则是<code>/</code>,导致静态资源无法访问。如果匹配的是“/*.action”这种形式就没问题。</p><p>因此必须在springmvc的servlet拦截器之前配置一个或多个default servlet，允许访问指定类型的资源。</p></li><li><p>配置springmvc-servlet.xml</p><p>spring web提供了对上传功能的支持。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultEncoding"</span> <span class="attr">value</span>=<span class="string">"utf-8"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span> <span class="attr">value</span>=<span class="string">"10485760000"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxInMemorySize"</span> <span class="attr">value</span>=<span class="string">"40960"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>form上传表单</p><p>form 的两个属性必须提供<br><code>method=&quot;post&quot;</code> 和<code>enctype=&quot;multipart/form-data&quot;</code> 缺一不可<br>上传组件 增加一个属性 accept=”image/<em>“ 表示只能选择图片进行上传<br>`&lt;input type=”file” name=”image” accept=”image/</em>“ /&gt;`</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span> <span class="attr">action</span>=<span class="string">"uploadimage"</span>&gt;</span></div><div class="line">      姓名：  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">      上传图片： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">accept</span>=<span class="string">"image/*"</span> <span class="attr">name</span>=<span class="string">"image"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"上传图片"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/image/$&#123;image_url&#125;"</span> <span class="attr">alt</span>=<span class="string">"哈哈哈！"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>UploadedImageFile</p><p>在UploadedImageFile pojo类中封装MultipartFile类型的字段 image ，用于接受页面的文件对象注入<br>这里的字段命名 image必须和上传表单的image域的name值保持一致。</p><p>使用pojo类也可以同时接收form里的非file字段。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadedImageFile</span> </span>&#123;</div><div class="line">    MultipartFile image;</div><div class="line">    String name;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> MultipartFile <span class="title">getImage</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> image;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setImage</span><span class="params">(MultipartFile image)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.image = image;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>上传控制方法</p><p>准备方法upload方法 映射上传路径<code>/uploadImage</code>,方法的第二个参数UploadedImageFile 中已经注入好了 image，为文件准备一个随机名，然后保存。根据<code>request.getServletContext().getRealPath</code>获取到web目录下的image目录，用于存放上传后的文件。<br>调用<code>file.getImage().transferTo(newFile);</code>复制文件<br> 把生成的随机文件名提交给视图，用于后续的显示</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/uploadimage"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">upload</span><span class="params">(HttpServletRequest request, UploadeImageFile file)</span></span></div><div class="line"><span class="function">        <span class="keyword">throws</span> IllegalStateException, IOException </span>&#123;</div><div class="line">    String name = RandomStringUtils.randomAlphanumeric(<span class="number">10</span>);</div><div class="line">    String newFileName = name + <span class="string">".jpg"</span>;</div><div class="line">    File newFile = <span class="keyword">new</span> File(request.getServletContext().getRealPath(<span class="string">"/image"</span>), newFileName);</div><div class="line">    newFile.getParentFile().mkdirs();</div><div class="line">    System.out.println(file.getName());</div><div class="line">    file.getImage().transferTo(newFile);</div><div class="line"></div><div class="line">    ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"index.jsp"</span>);</div><div class="line">    mav.addObject(<span class="string">"image_url"</span>, newFileName);</div><div class="line">    mav.addObject(<span class="string">"name"</span>, file.getName());</div><div class="line">    <span class="keyword">return</span> mav;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>显示图片 `&lt; img src=”/image/${image_url}”&gt;</p></li></ul><h2 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h2><p>类似servlet中的filter。用于实现日志、登录检测等需要预处理和后处理的地方。</p><p><strong>preHandle：</strong>预处理回调方法，实现预处理如登录检查；  返回值true表示继续流程, 如调用下一个拦截器或处理器; false表示流程中断，不会继续调用其他的拦截器或处理器，此时我们需要通过response来产生响应；</p><p><strong>postHandle：</strong>后处理回调方法，实现处理器的后处理（但在渲染视图之前），此时我们可以通过modelAndView对模型数据进行处理或对视图进行处理，modelAndView也可能为null。</p><p><strong>afterCompletion：</strong>整个请求处理完毕回调方法，即在视图渲染完毕时回调，如性能监控中我们可以在此记录结束时间并输出消耗时间，还可以进行一些资源清理，类似于try-catch-finally中的finally。</p><ul><li><p>实现Interceptor类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.handler.HandlerInterceptorAdapter;</div><div class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginInterceptor</span> <span class="keyword">extends</span> <span class="title">HandlerInterceptorAdapter</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">//1、请求到登录页面 放行</span></div><div class="line">        <span class="keyword">if</span>(request.getServletPath().startsWith(<span class="string">"/login"</span>)) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">//2、TODO 比如退出、首页等页面无需登录，即此处要放行 允许游客的请求</span></div><div class="line"></div><div class="line">        <span class="comment">//3、如果用户已经登录 放行</span></div><div class="line">        <span class="keyword">if</span>(request.getSession().getAttribute(<span class="string">"username"</span>) != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="comment">//更好的实现方式的使用cookie</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">//4、非法请求 即这些请求需要登录后才能访问</span></div><div class="line">        <span class="comment">//重定向到登录页面</span></div><div class="line">        response.sendRedirect(request.getContextPath() + <span class="string">"/login"</span>);</div><div class="line">        System.out.println(<span class="string">"未登录！"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 在业务处理器处理请求执行完成后,生成视图之前执行的动作</span></div><div class="line"><span class="comment">     * 可在modelAndView中加入数据，比如当前时间</span></div><div class="line"><span class="comment">     */</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request,</span></span></div><div class="line"><span class="function"><span class="params">                           HttpServletResponse response, Object handler,</span></span></div><div class="line"><span class="function"><span class="params">                           ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        System.out.println(<span class="string">"postHandle(), 在访问Controller之后，访问视图之前被调用,这里可以注入一个时间到modelAndView中，用于后续视图显示"</span>);</div><div class="line">        modelAndView.addObject(<span class="string">"date"</span>,<span class="string">"由拦截器生成的时间:"</span> + <span class="keyword">new</span> Date());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 在DispatcherServlet完全处理完请求后被调用,可用于清理资源等</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * 当有拦截器抛出异常时,会从当前拦截器往回执行所有的拦截器的afterCompletion()</span></div><div class="line"><span class="comment">     */</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request,</span></span></div><div class="line"><span class="function"><span class="params">                                HttpServletResponse response, Object handler, Exception ex)</span></span></div><div class="line"><span class="function">            <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        System.out.println(<span class="string">"afterCompletion(), 在访问视图之后被调用"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ul><ul><li><p>配置interceptors</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/index2"</span>/&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 定义在mvc:interceptor下面的表示是对特定的请求才进行拦截的 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"interceptor.LoginInterceptor"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 当设置多个拦截器时，先按顺序调用preHandle方法，然后逆序调用每个拦截器的postHandle和afterCompletion方法 --&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ul><h1 id="Spring-Struct2"><a href="#Spring-Struct2" class="headerlink" title="Spring Struct2"></a>Spring Struct2</h1><p>使用IOC容器管理struct2的action</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Spring-Hello-World&quot;&gt;&lt;a href=&quot;#Spring-Hello-World&quot; class=&quot;headerlink&quot; title=&quot;Spring Hello World&quot;&gt;&lt;/a&gt;Spring Hello World&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; Spring 是一个IOC(DI) 和AOP 容器框架&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;IOC-DI&quot;&gt;&lt;a href=&quot;#IOC-DI&quot; class=&quot;headerlink&quot; title=&quot;IOC/DI&quot;&gt;&lt;/a&gt;IOC/DI&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;两个概念&lt;/strong&gt;（其实是不同的角度） &lt;/p&gt;
&lt;p&gt;控制反转：对象实例由spring通过配置创建，而不是程序员主动new构造。&lt;/p&gt;
&lt;p&gt;依赖注入：拿到的对象实例可以直接使用，其定义在配置文件的属性值在实例化时已被注入。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;创建一个pojo类，&lt;em&gt;POJO&lt;/em&gt;（Plain Ordinary Java Object）简单的Java对象，实际就是普通JavaBeans。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Category&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; id;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;setId&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; id)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id = id;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;title&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; name;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;setName&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String name)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.name = name;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; id;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; String name;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="技术" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/"/>
    
      <category term="Spring" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/Spring/"/>
    
    
      <category term="Java" scheme="http://shuaiyy.cn/tags/Java/"/>
    
      <category term="Spring" scheme="http://shuaiyy.cn/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>Maven入门</title>
    <link href="http://shuaiyy.cn/2018/02/20/%E6%8A%80%E6%9C%AF/Maven%E5%85%A5%E9%97%A8/"/>
    <id>http://shuaiyy.cn/2018/02/20/技术/Maven入门/</id>
    <published>2018-02-19T16:00:00.000Z</published>
    <updated>2018-11-22T11:02:28.139Z</updated>
    
    <content type="html"><![CDATA[<h1 id="使用Maven"><a href="#使用Maven" class="headerlink" title="使用Maven"></a>使用Maven</h1><h2 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h2><ul><li><p>下载，解压，配置环境变量</p></li><li><p>配置仓库(repository)：本地存放位置，远程下载镜像</p><p>修改到D盘，以免重装系统时丢失。mirror使用阿里云，在<code>conf/settings.xml</code>下</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">  <span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>d:/maven/repository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/repositories/central/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>maven使用<code>pom.xml</code>维护项目依赖的jar</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>IDEA中配置maven</p><p>settings -&gt; build tools -&gt; maven</p><p>配置maven所在的路径，及其user settings文件。</p><p>file -》 other settings  -》default settings -》  build tools 下设置默认的maven</p><a id="more"></a></li></ul><h2 id="IDEA创建项目"><a href="#IDEA创建项目" class="headerlink" title="IDEA创建项目"></a>IDEA创建项目</h2><p>IDEA创建maven项目速度慢，1）修改源为阿里云；2）创建项目时添加参数<code>DarchetypeCatalog=internal</code>,或者在maven VM options添加。</p><ol><li><p>new project -》 maven</p></li><li><p>选择<code>create from archetype</code>  , archetype 即“原型、原始型”</p></li><li><p>选中需要的原型后，next</p><p><img src="http://img.shuaiyy.cn/blog/180321/ALH4Id1fHg.png?imageslim" alt="mark"></p></li><li><p>填写groupID 项目组织标识，对应包结构；ArtifactID 项目标识，对应项目名称。</p></li><li><p>初始化之后，会有import change提示，每当maven项目或pom文件改变都要import change。</p></li></ol><h2 id="IDEA-maven增加jar包"><a href="#IDEA-maven增加jar包" class="headerlink" title="IDEA maven增加jar包"></a>IDEA maven增加jar包</h2><p><strong>快速搜索、定位jar包</strong></p><blockquote><p> 必须先要定位一个jar才能引用，<code>groupId,artifacatId,version</code></p></blockquote><p>打开project structure -》 Libraries -》 +  -》 from Maven ：</p><p>输入关键词搜索，选中确认，然后在项目结构的外部依赖找到该包，在maven pom中引用。</p><p>也可以不引入，直接复制包名，然后在maven pom中添加依赖。</p><p><strong>在maven中引入依赖</strong></p><ol><li><p>在<code>pom.xml</code>中添加依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>执行maven import， 可以让IDEA自动import</p></li></ol><p><strong>包依赖关系</strong></p><p>在窗口右侧的maven工具栏可以查看, 按住Alt 后单击，可以用放大镜查看依赖图。</p><p><img src="http://img.shuaiyy.cn/blog/180321/5BmIGH08aC.png?imageslim" alt="mark"></p><h2 id="创建Maven-web项目"><a href="#创建Maven-web项目" class="headerlink" title="创建Maven web项目"></a>创建Maven web项目</h2><ul><li><p>create from archetype， 选中<code>org.apache.maven.archetypes:maven-archetype-webapp</code></p></li><li><p>maven web项目默认没有源码目录，新建一个源代码文件夹，然后mark as source root</p></li><li><p>右键 new , 可以选择创建servlet、filter、listener。</p><p>如果没有servlet选项，更新项目的<code>.iml</code>文件，sourceRoots下添加源码目录。</p><p><img src="http://img.shuaiyy.cn/blog/180321/KKme0BG9ik.png?imageslim" alt="mark"></p></li><li><p>在pom中添加servlet依赖</p></li><li><p>在web.xml中配置路由</p></li><li><p>run configure下添加Tomcat服务器，启动测试。</p></li></ul><h2 id="创建SSM项目"><a href="#创建SSM项目" class="headerlink" title="创建SSM项目"></a>创建SSM项目</h2><ol><li>创建maven web项目</li></ol><h2 id="导入SSM项目"><a href="#导入SSM项目" class="headerlink" title="导入SSM项目"></a>导入SSM项目</h2><p>File-&gt;New-&gt;Project from existing sources 输入<code>pom.xml</code>文件的路径即可。</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;使用Maven&quot;&gt;&lt;a href=&quot;#使用Maven&quot; class=&quot;headerlink&quot; title=&quot;使用Maven&quot;&gt;&lt;/a&gt;使用Maven&lt;/h1&gt;&lt;h2 id=&quot;配置环境&quot;&gt;&lt;a href=&quot;#配置环境&quot; class=&quot;headerlink&quot; title=&quot;配置环境&quot;&gt;&lt;/a&gt;配置环境&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;下载，解压，配置环境变量&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;配置仓库(repository)：本地存放位置，远程下载镜像&lt;/p&gt;
&lt;p&gt;修改到D盘，以免重装系统时丢失。mirror使用阿里云，在&lt;code&gt;conf/settings.xml&lt;/code&gt;下&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;localRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;d:/maven/repository&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;localRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;mirrors&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;mirror&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;alimaven&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;mirrorOf&lt;/span&gt;&amp;gt;&lt;/span&gt;central&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;mirrorOf&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;aliyun maven&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;http://maven.aliyun.com/nexus/content/repositories/central/&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;mirror&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;mirrors&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;​&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;maven使用&lt;code&gt;pom.xml&lt;/code&gt;维护项目依赖的jar&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;mysql&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;mysql-connector-java&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;5.1.20&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;IDEA中配置maven&lt;/p&gt;
&lt;p&gt;settings -&amp;gt; build tools -&amp;gt; maven&lt;/p&gt;
&lt;p&gt;配置maven所在的路径，及其user settings文件。&lt;/p&gt;
&lt;p&gt;file -》 other settings  -》default settings -》  build tools 下设置默认的maven&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/"/>
    
      <category term="Maven" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/Maven/"/>
    
    
      <category term="Java" scheme="http://shuaiyy.cn/tags/Java/"/>
    
      <category term="Maven" scheme="http://shuaiyy.cn/tags/Maven/"/>
    
  </entry>
  
  <entry>
    <title>Mybatis入门</title>
    <link href="http://shuaiyy.cn/2018/02/18/%E6%8A%80%E6%9C%AF/Mybatis%E5%85%A5%E9%97%A8/"/>
    <id>http://shuaiyy.cn/2018/02/18/技术/Mybatis入门/</id>
    <published>2018-02-17T16:00:00.000Z</published>
    <updated>2018-11-22T11:02:28.153Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h1><p>MyBatis 是一款优秀的持久层框架，它支持定制化 SQL、存储过程以及高级映射。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以使用简单的 XML 或注解来配置和映射原生信息，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。</p><p>Python Django的ORM框架提供了增删改查接口， mybatis必须要手动配置SQL语句。</p><p><a href="http://www.mybatis.org/mybatis-3/zh/index.html" target="_blank" rel="external">官方文档</a></p><h2 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h2><ul><li><p>创建表和数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">USE how2java;</div><div class="line"> </div><div class="line">CREATE TABLE category_ (</div><div class="line">  id int(11) NOT NULL AUTO_INCREMENT,</div><div class="line">  name varchar(32) DEFAULT NULL,</div><div class="line">  PRIMARY KEY (id)</div><div class="line">) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;</div><div class="line"></div><div class="line">INSERT INTO category_ VALUES (null,&apos;category1&apos;);</div><div class="line">INSERT INTO category_ VALUES (null,&apos;category2&apos;);</div></pre></td></tr></table></figure></li><li><p>创建对应的pojo对象</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.how2java.pojo;</div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> id;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.id = id;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line">     </div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ul>  <a id="more"></a><ul><li><p>配置文件<code>mybatis-config.xml</code></p><ol><li>配置数据库连接驱动、数据库名，用户密码，编码方式等</li><li>typeAliases， 类型-别名，在后面的配置中可以不必使用类的完整名字</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></div><div class="line">      <span class="comment">&lt;!-- 配置包或对象的别名，以简化全类名的书写 --&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>/&gt;</span> <span class="comment">&lt;!-- 可以将一些配置单独文件，然后引用变量 $&#123;var&#125; --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></div><div class="line">      <span class="comment">&lt;!-- mapper配置文件 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Product.xml"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>创建类到数据操作的映射<code>Category.xml</code>,实现增删改查，模糊查询等操作。</p><p>注意：id用于mybatis session对象调用SQL语句， parameterType为入参类型， resultType为执行结果类型</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE mapper</span></div><div class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></div><div class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 增删改查 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span>&gt;</span></div><div class="line">        insert into category_ ( name ) values (#&#123;name&#125;)</div><div class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></div><div class="line">        delete from category_ where id= #&#123;id&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCategory"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></div><div class="line">        select * from   category_  where id= #&#123;id&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></div><div class="line">        update category_ set name=#&#123;name&#125; where id=#&#123;id&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 查询全部 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategory"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></div><div class="line">        select * from   category_</div><div class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 模糊查询 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategoryByName"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></div><div class="line">        select * from category_ WHERE  name like concat('%',#&#123;0&#125;,'%')</div><div class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 多条件查询 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategoryByIdAndName"</span>  <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></div><div class="line">        select * from   category_  where id &gt; #&#123;id&#125;  and name like concat('%',#&#123;name&#125;,'%')</div><div class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>TestMybatis.java</p><ol><li>载入mybatis配置文件</li><li>创建sqlsession</li><li>执行操作</li><li>提交、关闭会话</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</div><div class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</div><div class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</div><div class="line">        SqlSession session=sqlSessionFactory.openSession();</div><div class="line">        </div><div class="line">        Category c1 = <span class="keyword">new</span> Category();</div><div class="line">        c1.setName(<span class="string">"new Category"</span>);</div><div class="line">        session.insert(<span class="string">"addCategory"</span>, c1);</div><div class="line">        session.commit();</div><div class="line">        session.close();</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="对象关系"><a href="#对象关系" class="headerlink" title="对象关系"></a>对象关系</h2><blockquote><p> 通过resultMap建立映射，sql查询的列与Java pojo对象的属性对应。</p></blockquote><ul><li><p>一对一</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- </span></div><div class="line"><span class="comment">方式一：嵌套结果：使用嵌套结果映射来处理重复的联合结果的子集</span></div><div class="line"><span class="comment">         封装联表查询的数据(去除重复的数据)</span></div><div class="line"><span class="comment">select * from class c, teacher t where c.teacher_id=t.t_id and  c.c_id=1</span></div><div class="line"><span class="comment">--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getClass"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"ClassResultMap"</span>&gt;</span></div><div class="line">select * from class c, teacher t where c.teacher_id=t.t_id and  c.c_id=#&#123;id&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"_Classes"</span> <span class="attr">id</span>=<span class="string">"ClassResultMap"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"c_id"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"c_name"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> <span class="attr">column</span>=<span class="string">"teacher_id"</span> <span class="attr">javaType</span>=<span class="string">"_Teacher"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"t_id"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"t_name"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">association</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- </span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">方式二：嵌套查询：通过执行另外一个 SQL 映射语句来返回预期的复杂类型</span></div><div class="line"><span class="comment">SELECT * FROM class WHERE c_id=1;</span></div><div class="line"><span class="comment">SELECT * FROM teacher WHERE t_id=1 //1 是上一个查询得到的 teacher_id 的值</span></div><div class="line"><span class="comment">--&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getClass2"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"ClassResultMap2"</span>&gt;</span></div><div class="line">select * from class where c_id=#&#123;id&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"_Classes"</span> <span class="attr">id</span>=<span class="string">"ClassResultMap2"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"c_id"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"c_name"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> <span class="attr">column</span>=<span class="string">"teacher_id"</span> <span class="attr">javaType</span>=<span class="string">"_Teacher"</span> </span></div><div class="line"><span class="tag"><span class="attr">select</span>=<span class="string">"getTeacher"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">association</span>&gt;</span></div><div class="line"> <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getTeacher"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"_Teacher"</span>&gt;</span></div><div class="line">SELECT t_id id, t_name name FROM teacher WHERE t_id=#&#123;id&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>一对多</p><ol><li>p.cid： 一个product对应一个category</li><li>List products: 一个category对应多个商品</li><li>取到一个category，然后可以获取其全部的product</li><li>使用left join查询category及其对应的全部product</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- Category.xml --&gt;</span>  </div><div class="line"><span class="comment">&lt;!-- 通过Left Join多表联合查询 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"categoryBean"</span> <span class="attr">type</span>=<span class="string">"Category"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"cname"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></div><div class="line">  <span class="comment">&lt;!--一对多映射, 属性products为collection类型，集合元素为Product类型--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"products"</span> <span class="attr">ofType</span>=<span class="string">"Product"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pname"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">property</span>=<span class="string">"price"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 一对多查询 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"showCategory"</span>  <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"categoryBean"</span>&gt;</span></div><div class="line">        select c.*, p.*, c.id cid, c.name cname, p.id pid, p.name pname</div><div class="line">        from category_ c LEFT join product_ p  ON cid = p.cid</div><div class="line">  where 1=1 and cid=#&#123;id&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 2. 通过嵌套查询的方式 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"showCategory"</span>  <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"categoryBean"</span>&gt;</span></div><div class="line">        select *</div><div class="line">        from category_ where id = #&#123;id&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"categoryBean"</span> <span class="attr">type</span>=<span class="string">"Category"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></div><div class="line">  <span class="comment">&lt;!--一对多映射, 属性products为collection类型，集合元素为Product类型--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"products"</span> <span class="attr">ofType</span>=<span class="string">"Product"</span>   <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">select</span>=<span class="string">"getProduct"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pname"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">property</span>=<span class="string">"price"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getProduct"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>, <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></div><div class="line">select * from product_ p where p.cid=#&#123;id&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>多对一</p><ol><li>多个product 会对应一个category</li><li>取到一个product后，可以获取其对应的属性</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Product"</span> <span class="attr">id</span>=<span class="string">"productBean"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pname"</span> <span class="attr">property</span>=<span class="string">"name"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">property</span>=<span class="string">"price"</span> /&gt;</span></div><div class="line">     </div><div class="line">            <span class="comment">&lt;!-- 多对一的关系 --&gt;</span></div><div class="line">            <span class="comment">&lt;!-- property: 指的是属性名称, javaType：指的是属性的类型 --&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"category"</span> <span class="attr">javaType</span>=<span class="string">"Category"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"cname"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">association</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line">     </div><div class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultMap</span>=<span class="string">"productBean"</span>&gt;</span></div><div class="line">            select c.*, p.*, c.id 'cid', p.id 'pid', c.name 'cname', p.name 'pname' from category_ c left join product_ p on c.id = p.cid</div><div class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>多对多 </p><p>以订单为例，一个订单有多种product，一种product也可以出现在多张订单里。</p><p>订单项包含product id，购买数量，所属订单ID。</p><ol><li>在<code>Order.xml</code>中配置映射，以及listOrder， getOrder的查询方法</li><li>在<code>OrderItem.xml</code>中配置添加、删除订单项的SQL方法</li><li>无发使用update更新多对多的映射关系，但是可以先删除后在添加新的。</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--  Order.xml --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"orderBean"</span> <span class="attr">type</span>=<span class="string">"Order"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"oid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"code"</span> <span class="attr">property</span>=<span class="string">"code"</span>/&gt;</span></div><div class="line">        <span class="comment">&lt;!--一对多映射, 属性products为collection类型，集合元素为Product类型--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"orderItems"</span> <span class="attr">ofType</span>=<span class="string">"OrderItem"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"oiid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"number"</span> <span class="attr">property</span>=<span class="string">"number"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"number"</span> <span class="attr">property</span>=<span class="string">"number"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"product"</span> <span class="attr">javaType</span>=<span class="string">"Product"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pname"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">property</span>=<span class="string">"price"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">association</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listOrder"</span> <span class="attr">resultMap</span>=<span class="string">"orderBean"</span>&gt;</span></div><div class="line">        select o.*,p.*,oi.*, o.id 'oid', p.id 'pid', oi.id 'oiid', p.name 'pname'</div><div class="line">        from order_ o</div><div class="line">        left join order_item_ oi    on o.id =oi.oid</div><div class="line">        left join product_ p on p.id = oi.pid</div><div class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getOrder"</span> <span class="attr">resultMap</span>=<span class="string">"orderBean"</span>&gt;</span></div><div class="line">            select o.*,p.*,oi.*, o.id 'oid', p.id 'pid', oi.id 'oiid', p.name 'pname'</div><div class="line">                from order_ o</div><div class="line">                left join order_item_ oi on o.id =oi.oid</div><div class="line">                left join product_ p on p.id = oi.pid</div><div class="line">            where o.id = #&#123;id&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- OrderItem.xml --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addOrderItem"</span> <span class="attr">parameterType</span>=<span class="string">"OrderItem"</span>&gt;</span></div><div class="line">        insert into order_item_ values (null, #&#123;order.id&#125;, #&#123;product.id&#125;, #&#123;number&#125;)</div><div class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteOrderItem"</span> <span class="attr">parameterType</span>=<span class="string">"OrderItem"</span> &gt;</span></div><div class="line">        delete from order_item_ where oid= #&#123;order.id&#125; and pid = #&#123;product.id&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></div></pre></td></tr></table></figure><p>java </p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">        Order o = sess.selectOne(<span class="string">"getOrder"</span>, <span class="number">1</span>);</div><div class="line">        OrderItem oi = <span class="keyword">new</span> OrderItem();</div><div class="line">        Product p = sess.selectOne(<span class="string">"getProductById"</span>, <span class="number">1</span>);</div><div class="line"></div><div class="line">        oi.setProduct(p);</div><div class="line">        oi.setNumber(<span class="number">10</span>);</div><div class="line">        oi.setOrder(o);</div><div class="line"></div><div class="line"><span class="comment">//        sess.insert("addOrderItem", oi);</span></div><div class="line"> <span class="comment">//       sess.commit();</span></div><div class="line">        sess.delete(<span class="string">"deleteOrderItem"</span>, oi);</div><div class="line"></div><div class="line">       </div><div class="line">        o = sess.selectOne(<span class="string">"getOrder"</span>, <span class="number">1</span>);</div><div class="line">        List&lt;OrderItem&gt; ois = o.getOrderItems();</div><div class="line">        <span class="keyword">for</span> (OrderItem orderItem: ois)&#123;</div><div class="line">            System.out.println(orderItem.getProduct() + <span class="string">"###"</span> + orderItem.getNumber());</div><div class="line">        &#125;</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="动态SQL"><a href="#动态SQL" class="headerlink" title="动态SQL"></a>动态SQL</h2><p>在程序中拼接SQL语句不灵活，也很痛苦，比如要注意空格和逗号，条件分支等；Mybatis提供了<a href="http://www.mybatis.org/mybatis-3/zh/dynamic-sql.html" target="_blank" rel="external">动态SQL语法</a>。</p><ul><li><p>if</p><p>一条SQL实现2种不同条件的查询</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></div><div class="line">            select * from product_</div><div class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null"</span>&gt;</span></div><div class="line">                where name like concat('%',#&#123;name&#125;,'%')</div><div class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span>         </div><div class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>when和otherwise实现if-else</p><p>没有满足条件的when就会执行otherwise</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></div><div class="line">              SELECT * FROM product_ </div><div class="line">              <span class="tag">&lt;<span class="name">where</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">choose</span>&gt;</span></div><div class="line">                  <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"name != null"</span>&gt;</span></div><div class="line">                    and name like concat('%',#&#123;name&#125;,'%')</div><div class="line">                  <span class="tag">&lt;/<span class="name">when</span>&gt;</span>           </div><div class="line">                  <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"price !=null and price != 0"</span>&gt;</span></div><div class="line">                    and price &gt; #&#123;price&#125;</div><div class="line">                  <span class="tag">&lt;/<span class="name">when</span>&gt;</span>                 </div><div class="line">                  <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></div><div class="line">                    and id &gt;1</div><div class="line">                  <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></div><div class="line">              <span class="tag">&lt;/<span class="name">where</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>where和set</p><p>if没有else分支，多条件判断时可以使用where标签，会自动处理条件中的and or关键词</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCategory"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></div><div class="line">        select * from   category_</div><div class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"id!=null"</span>&gt;</span></div><div class="line">                AND id= #&#123;id&#125;</div><div class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null"</span>&gt;</span></div><div class="line">                AND name LIKE concat("%", #&#123;name&#125;, "%")</div><div class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure><p>在update中可以使用set标签</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateProduct"</span> <span class="attr">parameterType</span>=<span class="string">"Product"</span> &gt;</span></div><div class="line">        update product_ </div><div class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name != null"</span>&gt;</span>name=#&#123;name&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"price != null"</span>&gt;</span>price=#&#123;price&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">              </div><div class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span>  </div><div class="line">         where id=#&#123;id&#125;    </div><div class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>trim (where, set)</p></li><li><p>foreach</p><p>可以实现<code>in (a, b, c)</code>的拼装</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getProductsByIds"</span>&gt;</span></div><div class="line">        SELECT * FROM product_</div><div class="line">          where id in </div><div class="line">          <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">index</span>=<span class="string">"index"</span> <span class="attr">item</span>=<span class="string">"item"</span></span></div><div class="line"><span class="tag">           <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">separator</span>=<span class="string">","</span>&gt;</span></div><div class="line">              #&#123;item&#125;</div><div class="line">          <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><h3 id="实现CRUD"><a href="#实现CRUD" class="headerlink" title="实现CRUD"></a>实现CRUD</h3><p>前面的做法是在<code>Category.xml</code>中配置类Category与SQL的映射关系<code>&lt;mapper&gt;</code></p><p>可以实现一个Mapper接口，并在接口方法上使用注解绑定SQL映射。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</div><div class="line">    <span class="meta">@Insert</span>(<span class="string">" insert into category_ ( name ) values (#&#123;name&#125;) "</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Category category)</span></span>;</div><div class="line"></div><div class="line">    <span class="meta">@Delete</span>(<span class="string">" delete from category_ where id= #&#123;id&#125; "</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</div><div class="line"></div><div class="line">    <span class="meta">@Select</span>(<span class="string">"select * from category_ where id= #&#123;id&#125; "</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</div><div class="line"></div><div class="line">    <span class="meta">@Update</span>(<span class="string">"update category_ set name=#&#123;name&#125; where id=#&#123;id&#125; "</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Category category)</span></span>;</div><div class="line"></div><div class="line">    <span class="meta">@Select</span>(<span class="string">" select * from category_ "</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>使用时先获取mapper接口对象，然后调用CURD方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">CategoryMapper mapper = session.getMapper(CategoryMapper.class);</div><div class="line">Category c = mapper.get(<span class="number">1</span>);</div><div class="line">System.out.println(c);</div></pre></td></tr></table></figure><h3 id="对象关系-1"><a href="#对象关系-1" class="headerlink" title="对象关系"></a>对象关系</h3><ul><li><p>一对多</p><p>以Category-Product 1对多模型为例，一个category对象里有多个product的集合。</p><ol><li>@select获取Category对象</li><li>@Results里，通过product mapper接口的getProductByCategoryId获取products集合。</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Select</span>(<span class="string">" select * from category_ "</span>)</div><div class="line">    <span class="meta">@Results</span>(&#123;<span class="meta">@Result</span>(column = <span class="string">"id"</span>, property = <span class="string">"id"</span>),</div><div class="line">              <span class="meta">@Result</span>(column = <span class="string">"name"</span>, property = <span class="string">"name"</span>),</div><div class="line">              <span class="meta">@Result</span>(javaType = List.class, property = <span class="string">"products"</span>, column = <span class="string">"id"</span>,</div><div class="line">                      many = <span class="meta">@Many</span>(select = <span class="string">"com.how2java.mapper.ProductMapper.getProductByCID"</span>)),</div><div class="line">    &#125;)</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProductMapper</span> </span>&#123;</div><div class="line">    <span class="meta">@Select</span>(<span class="string">"select * from product_ where cid = #&#123;cid&#125;"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProductByCID</span><span class="params">(<span class="keyword">int</span> cid)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>多对一</p><ol><li>通过一个product，找到其对应的category</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">// ProductMapper --&gt;</span></div><div class="line"><span class="meta">@Select</span>(<span class="string">"select * from product_"</span>)</div><div class="line">    <span class="meta">@Results</span>(&#123;<span class="meta">@Result</span>(property = <span class="string">"id"</span>, column = <span class="string">"id"</span>),</div><div class="line">            <span class="meta">@Result</span>(property = <span class="string">"cid"</span>, column = <span class="string">"cid"</span>),</div><div class="line">                <span class="meta">@Result</span>(property = <span class="string">"name"</span>, column = <span class="string">"name"</span>),</div><div class="line">                <span class="meta">@Result</span>(property = <span class="string">"price"</span>, column = <span class="string">"price"</span>),</div><div class="line">            <span class="meta">@Result</span>(column = <span class="string">"cid"</span>, property = <span class="string">"category"</span>, javaType = Category.class,</div><div class="line">                    one = <span class="meta">@One</span>(select = <span class="string">"com.how2java.mapper.CategoryMapper.get"</span>)),</div><div class="line">    &#125;)</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">list</span><span class="params">()</span></span>;</div><div class="line">      </div><div class="line"><span class="comment">// CategoryMapper --&gt;</span></div><div class="line"><span class="meta">@Select</span>(<span class="string">"select * from category_ where id= #&#123;id&#125; "</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</div></pre></td></tr></table></figure><p>​</p></li><li><p>多对多</p><p>遍历所有订单，并计算订单价格</p><ol><li><p>order mapper: 获取所有订单，通过OrderItem mapper 获取order下的orderitem</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrderMapper</span> </span>&#123;</div><div class="line">    <span class="meta">@Select</span>(<span class="string">"select * from order_"</span>)</div><div class="line">    <span class="meta">@Results</span>(&#123;</div><div class="line">            <span class="meta">@Result</span>(column = <span class="string">"id"</span>, property = <span class="string">"id"</span>),</div><div class="line">            <span class="meta">@Result</span>(column = <span class="string">"code"</span>, property = <span class="string">"code"</span>),</div><div class="line">            <span class="meta">@Result</span>(column = <span class="string">"id"</span>, property = <span class="string">"orderItems"</span>, javaType = List.class,</div><div class="line">            many = <span class="meta">@Many</span>(select = <span class="string">"com.how2java.mapper.OrderItemMapper.list"</span>))</div><div class="line">    &#125;)</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Order&gt; <span class="title">list</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="meta">@Select</span>(<span class="string">"select * from order_ where id = #&#123;id&#125;"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> Order <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>OrderItem mapper: 通过 product mapper拿到product信息</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrderItemMapper</span> </span>&#123;</div><div class="line">    <span class="meta">@Select</span>(<span class="string">"select * from order_item_ where oid = #&#123;oid&#125;"</span>)</div><div class="line">    <span class="meta">@Results</span>(&#123;<span class="meta">@Result</span>(column = <span class="string">"id"</span>, property = <span class="string">"id"</span>),</div><div class="line">            <span class="meta">@Result</span>(column = <span class="string">"number"</span>, property = <span class="string">"number"</span>),</div><div class="line">            <span class="meta">@Result</span>(column = <span class="string">"pid"</span>, property = <span class="string">"product"</span>, one = <span class="meta">@One</span>(select = <span class="string">"com.how2java.mapper.ProductMapper.getOne"</span>)),</div><div class="line">            <span class="meta">@Result</span>(column = <span class="string">"oid"</span>, property = <span class="string">"order"</span>, one = <span class="meta">@One</span>(select = <span class="string">"com.how2java.mapper.OrderMapper.get"</span>)),</div><div class="line">    &#125;)</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;OrderItem&gt; <span class="title">list</span><span class="params">(<span class="keyword">int</span> oid)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ol></li></ul><h3 id="动态SQL-1"><a href="#动态SQL-1" class="headerlink" title="动态SQL"></a>动态SQL</h3><p><code>org.apache.ibatis.jdbc.SQL</code>可以动态生成sql语句，可以配合注解使用</p><ul><li><p>SqlProvider类，用于动态生成sql字符串</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.apache.ibatis.jdbc.SQL;</div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryDynaSqlProvider</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</div><div class="line">         <span class="keyword">return</span> <span class="keyword">new</span> SQL()</div><div class="line">                 .SELECT(<span class="string">"*"</span>)</div><div class="line">                 .FROM(<span class="string">"category_"</span>)</div><div class="line">                 .toString();</div><div class="line">         </div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">get</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()</div><div class="line">                .SELECT(<span class="string">"*"</span>)</div><div class="line">                .FROM(<span class="string">"category_"</span>)</div><div class="line">                .WHERE(<span class="string">"id=#&#123;id&#125;"</span>)</div><div class="line">                .toString();</div><div class="line">    &#125;</div><div class="line">     </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()</div><div class="line">                .INSERT_INTO(<span class="string">"category_"</span>)</div><div class="line">                .VALUES(<span class="string">"name"</span>, <span class="string">"#&#123;name&#125;"</span>)</div><div class="line">                .toString();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()</div><div class="line">                .UPDATE(<span class="string">"category_"</span>)</div><div class="line">                .SET(<span class="string">"name=#&#123;name&#125;"</span>)</div><div class="line">                .WHERE(<span class="string">"id=#&#123;id&#125;"</span>)</div><div class="line">                .toString();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()</div><div class="line">                .DELETE_FROM(<span class="string">"category_"</span>)</div><div class="line">                .WHERE(<span class="string">"id=#&#123;id&#125;"</span>)</div><div class="line">                .toString();</div><div class="line">    &#125;</div><div class="line">     </div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>在mapper接口中使用<code>@InsertProvider</code>引用SqlProvider中的sql查询方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</div><div class="line">  </div><div class="line">    <span class="meta">@InsertProvider</span>(type=CategoryDynaSqlProvider.class,method=<span class="string">"add"</span>)  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Category category)</span></span>;  </div><div class="line">        </div><div class="line">    <span class="meta">@DeleteProvider</span>(type=CategoryDynaSqlProvider.class,method=<span class="string">"delete"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>;  </div><div class="line">        </div><div class="line">    <span class="meta">@SelectProvider</span>(type=CategoryDynaSqlProvider.class,method=<span class="string">"get"</span>)  </div><div class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;  </div><div class="line">      </div><div class="line">    <span class="meta">@UpdateProvider</span>(type=CategoryDynaSqlProvider.class,method=<span class="string">"update"</span>)  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Category category)</span></span>;   </div><div class="line">        </div><div class="line">    <span class="meta">@SelectProvider</span>(type=CategoryDynaSqlProvider.class,method=<span class="string">"list"</span>)      </div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>一个复杂的查询示例</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> String <span class="title">selectPersonSql</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> SQL() &#123;&#123;</div><div class="line">    SELECT(<span class="string">"P.ID, P.USERNAME, P.PASSWORD, P.FULL_NAME"</span>);</div><div class="line">    SELECT(<span class="string">"P.LAST_NAME, P.CREATED_ON, P.UPDATED_ON"</span>);</div><div class="line">    FROM(<span class="string">"PERSON P"</span>);</div><div class="line">    FROM(<span class="string">"ACCOUNT A"</span>);</div><div class="line">    INNER_JOIN(<span class="string">"DEPARTMENT D on D.ID = P.DEPARTMENT_ID"</span>);</div><div class="line">    INNER_JOIN(<span class="string">"COMPANY C on D.COMPANY_ID = C.ID"</span>);</div><div class="line">    WHERE(<span class="string">"P.ID = A.ID"</span>);</div><div class="line">    WHERE(<span class="string">"P.FIRST_NAME like ?"</span>);</div><div class="line">    OR();</div><div class="line">    WHERE(<span class="string">"P.LAST_NAME like ?"</span>);</div><div class="line">    GROUP_BY(<span class="string">"P.ID"</span>);</div><div class="line">    HAVING(<span class="string">"P.LAST_NAME like ?"</span>);</div><div class="line">    OR();</div><div class="line">    HAVING(<span class="string">"P.FIRST_NAME like ?"</span>);</div><div class="line">    ORDER_BY(<span class="string">"P.ID"</span>);</div><div class="line">    ORDER_BY(<span class="string">"P.FULL_NAME"</span>);</div><div class="line">  &#125;&#125;.toString();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="字段名与实体类属性命名不相同"><a href="#字段名与实体类属性命名不相同" class="headerlink" title="字段名与实体类属性命名不相同"></a>字段名与实体类属性命名不相同</h3><p>由于mybatis根据记录字段名将相应的数据注入实体类的属性中，如果字段名与实体类不一致，则对象映射会失败。</p><p>有2种解决方法：</p><ul><li><p>在SQL语句中为字段定义别名，别名与实体类的属性名一致</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 字段的值的别名与Order对象的属性一致 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectOrder"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"Order"</span>&gt;</span></div><div class="line">select order_id id, order_no orderNo,order_price price from orders where order_id=#&#123;id&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>通过resultMap定义字段与属性的映射关系</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectOrderResultMap"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"orderResultMap"</span>&gt;</span></div><div class="line">select * from orders where order_id=#&#123;id&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Order"</span> <span class="attr">id</span>=<span class="string">"orderResultMap"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"order_id"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"orderNo"</span> <span class="attr">column</span>=<span class="string">"order_no"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"price"</span> <span class="attr">column</span>=<span class="string">"order_price"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ul><h3 id="日志输出"><a href="#日志输出" class="headerlink" title="日志输出"></a>日志输出</h3><p>Mybatis实现了日志工厂，支持Log4J等日志工具，只需导入相关的jar包，并进行相关配置即可。</p><ul><li><p>mybatis-config.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logPrefix"</span> <span class="attr">value</span>=<span class="string">"mybatis_log"</span>/&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"LOG4J"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>log4j.properties</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># Global logging configuration</div><div class="line">log4j.rootLogger=TRACE, stdout</div><div class="line"># MyBatis logging configuration...</div><div class="line">log4j.logger.com.how2java=TRACE,stdout</div><div class="line"># Console output...</div><div class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</div><div class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</div><div class="line">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] [%c]  - %m%n</div></pre></td></tr></table></figure><p>​</p></li></ul><h3 id="事务支持"><a href="#事务支持" class="headerlink" title="事务支持"></a>事务支持</h3><ul><li><p>需要配置environments.transactionManger。 <code>&lt;transactionManager type=&quot;JDBC&quot;/&gt;</code></p><p><img src="http://img.shuaiyy.cn/blog/180329/FAc690HcgG.png?imageslim" alt="mark"></p></li><li><p>mysql表的数据引擎必须是innodb才支持事务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">alter table category_ ENGINE  = innodb;</div><div class="line">show table status from how2java;</div></pre></td></tr></table></figure><p>​</p></li><li><p>在同一个session里的全部操作视为一个事务，支持回滚。</p></li></ul><h3 id="调用存储过程"><a href="#调用存储过程" class="headerlink" title="调用存储过程"></a>调用存储过程</h3><ul><li><p>创建存储过程</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* 创建存储过程 */</span></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test.get_user_count(<span class="keyword">IN</span> sex_id <span class="built_in">INT</span>, <span class="keyword">OUT</span> user_count <span class="built_in">INT</span>)</div><div class="line"><span class="keyword">BEGIN</span></div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> test.user_ <span class="keyword">INTO</span> user_count;</div><div class="line"><span class="keyword">END</span></div><div class="line"><span class="comment">/* 调用存储过程 */</span></div><div class="line"><span class="keyword">SET</span> @user_count = <span class="number">0</span>;</div><div class="line"><span class="keyword">CALL</span> test.get_user_count(@user_count);</div><div class="line"><span class="keyword">SELECT</span> @user_count;</div></pre></td></tr></table></figure></li><li><p>mybatis中调用</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCount"</span> <span class="attr">resultType</span>=<span class="string">"java.util.Map"</span> <span class="attr">statementType</span>=<span class="string">"CALLABLE"</span>&gt;</span></div><div class="line">&#123;call </div><div class="line">get_user_count(#&#123;sex_id,mode=IN,jdbcType=INTEGER&#125;,#&#123;result,mode=OUT,jdbcType=INTEGER&#125;)</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ul><h3 id="延迟加载"><a href="#延迟加载" class="headerlink" title="延迟加载"></a>延迟加载</h3><p>在一对多的对象关系查询中，如果不使用延迟加载，则执行查询对象A时，也会同时执行查询A关联的多个B对象。</p><p>延迟加载则在访问了B对象时在进行数据库查询。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span> </div><div class="line">     <span class="comment">&lt;!-- 打开延迟加载的开关 --&gt;</span> </div><div class="line">     <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span> </div><div class="line">     <span class="comment">&lt;!-- 将积极加载改为消息加载即按需加载 --&gt;</span> </div><div class="line">     <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span> </div><div class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></div></pre></td></tr></table></figure><h3 id="分页-amp-PageHelper"><a href="#分页-amp-PageHelper" class="headerlink" title="分页 &amp; PageHelper"></a>分页 &amp; PageHelper</h3><ul><li><p>普通的查询语句加上limit参数即可</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategory"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></div><div class="line">  select * from   category_</div><div class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"start!=null and count!=null"</span>&gt;</span></div><div class="line">    limit #&#123;start&#125;,#&#123;count&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure><p>或者使用注解：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">@Select</span>(<span class="string">" select * from category_ limit #&#123;start&#125;,#&#123;count&#125;"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">listByPage</span><span class="params">(@Param(<span class="string">"start"</span>)</span> <span class="keyword">int</span> start, @<span class="title">Param</span><span class="params">(<span class="string">"count"</span>)</span><span class="keyword">int</span> count)</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>使用插件进行分页</p><p>需要导入第三方包，PageHelper<a href="https://github.com/pagehelper/Mybatis-PageHelper" target="_blank" rel="external">主页</a></p><p>使用<a href="https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md" target="_blank" rel="external">方法</a></p><ol><li><p>mybatis配置中添加插件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- com.github.pagehelper为PageHelper类所在包名 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 使用下面的方式配置参数，后面会有所有的参数介绍 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"param1"</span> <span class="attr">value</span>=<span class="string">"value1"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>调用方式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//第一种，RowBounds方式的调用</span></div><div class="line">List&lt;Country&gt; list = sqlSession.selectList(<span class="string">"x.y.selectIf"</span>, <span class="keyword">null</span>, <span class="keyword">new</span> RowBounds(<span class="number">0</span>, <span class="number">10</span>));</div><div class="line"></div><div class="line"><span class="comment">//第二种，Mapper接口方式的调用，推荐这种使用方式。</span></div><div class="line">PageHelper.startPage(<span class="number">1</span>, <span class="number">10</span>);</div><div class="line">List&lt;Country&gt; list = countryMapper.selectIf(<span class="number">1</span>);</div><div class="line"></div><div class="line"><span class="comment">//第三种，Mapper接口方式的调用，推荐这种使用方式。</span></div><div class="line">PageHelper.offsetPage(<span class="number">1</span>, <span class="number">10</span>);</div><div class="line">List&lt;Country&gt; list = countryMapper.selectIf(<span class="number">1</span>);</div></pre></td></tr></table></figure><p>​</p></li></ol></li></ul><h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><p>一级缓存</p><ul><li>同一session下的相同查询只执行一次数据库访问，后续从缓存中取查询结果</li></ul><p>二级缓存</p><ul><li><p>通过配置启用sessionFactory的缓存，同一个SessionFactory下查询只执行一次</p><ol><li><code>&lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;</code> 开启缓存</li><li>pojo对象要实现<code>Serializable</code>接口</li><li>pojo的mapper配置文件里添加<code>&lt;cached/&gt;</code></li><li>暂时没找到注解如何使用缓存</li><li>一般情况下不应使用mybatis自带的缓存机制，spring或其他框架会有更好的缓存实现。</li></ol></li><li><p>使用Ehcache</p><ol><li><p>导入jar包</p></li><li><p>配置ehcache，在 classpath 下 加入ehcache 的配置文件 ehcache.xml:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">name</span>=<span class="string">"default"</span></span></div><div class="line"><span class="tag">    <span class="attr">maxElementsInMemory</span>=<span class="string">"10000"</span></span></div><div class="line"><span class="tag">    <span class="attr">eternal</span>=<span class="string">"false"</span></span></div><div class="line"><span class="tag">    <span class="attr">timeToIdleSeconds</span>=<span class="string">"3600"</span></span></div><div class="line"><span class="tag">    <span class="attr">timeToLiveSeconds</span>=<span class="string">"10"</span></span></div><div class="line"><span class="tag">    <span class="attr">overflowToDisk</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">    <span class="attr">diskPersistent</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">    <span class="attr">diskExpiryThreadIntervalSeconds</span>=<span class="string">"120"</span></span></div><div class="line"><span class="tag">    <span class="attr">maxElementsOnDisk</span>=<span class="string">"10000"</span></span></div><div class="line"><span class="tag">/&gt;</span></div></pre></td></tr></table></figure></li><li><p>sql映射文件中使用：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 配置个性化缓存配置，默认使用&lt;cached/&gt;即开启缓存并使用ehcache的全局配置  --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">type</span>=<span class="string">"org.mybatis.caches.ehcache.LoggingEhcache"</span> &gt;</span> </div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"timeToIdleSeconds"</span> <span class="attr">value</span>=<span class="string">"3600"</span>/&gt;</span><span class="comment">&lt;!--1 hour--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"timeToLiveSeconds"</span> <span class="attr">value</span>=<span class="string">"3600"</span>/&gt;</span><span class="comment">&lt;!--1 hour--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxEntriesLocalHeap"</span> <span class="attr">value</span>=<span class="string">"1000"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxEntriesLocalDisk"</span> <span class="attr">value</span>=<span class="string">"10000000"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"memoryStoreEvictionPolicy"</span> <span class="attr">value</span>=<span class="string">"LRU"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">cache</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCategory"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span> <span class="attr">useCache</span>=<span class="string">"false"</span>&gt;</span> <span class="comment">&lt;!-- 禁用缓存 ---&gt;</span></div><div class="line">        select * from   category_  where id= #&#123;id&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ol></li></ul><h3 id="连接池"><a href="#连接池" class="headerlink" title="连接池"></a>连接池</h3><p>c3p0 、Druid等连接池比mybatis自带的高效，健壮。</p><p>mybatis需要自己写个DataSource的类，然后更改配置里DataSource的Type，自带的为<code>POOLED</code></p><p>换成type=”C3P0DataSourceFactory”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.apache.ibatis.datasource.unpooled.UnpooledDataSourceFactory;</div><div class="line"> </div><div class="line"><span class="keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;</div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">C3P0DataSourceFactory</span> <span class="keyword">extends</span> <span class="title">UnpooledDataSourceFactory</span></span>&#123;</div><div class="line">     </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">C3P0DataSourceFactory</span><span class="params">()</span></span>&#123;</div><div class="line">     </div><div class="line">           <span class="keyword">this</span>.dataSource =<span class="keyword">new</span> ComboPooledDataSource();</div><div class="line">     </div><div class="line">        &#125;</div><div class="line">     </div><div class="line">    &#125;</div></pre></td></tr></table></figure><h1 id="Spring-amp-Mybatis"><a href="#Spring-amp-Mybatis" class="headerlink" title="Spring &amp; Mybatis"></a>Spring &amp; Mybatis</h1><ol><li><p>mybatis里先建立pojo和SQL的映射类mapper</p><p>映射可以使用注解的方式写在mapper类里，或者单独xml mapper配置文件,然后在<code>SqlSessionFactoryBean</code>中指定mapperLocations。</p></li><li><p>spring配置文件里，添加DataSource数据源、sqlSessionFactory工厂,  MapperScannerConfigurer的bean。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span>  <span class="comment">&lt;!-- 使用注解的方式加载context配置和装载bean --&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 1. 数据源 : DriverManagerDataSource --&gt;</span>    </div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </div><div class="line"></div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 2. mybatis 的 SqlSession 的工厂: SqlSessionFactoryBean --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.pojo"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:com/how2java/mapper/*.xml"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 3. mybatis 自动扫描加载 Sql 映射文件 : MapperScannerConfigurer --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.mapper"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 4. 事务管理 : DataSourceTransactionManager --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"txManager"</span> </span></div><div class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></div><div class="line">  </div><div class="line"><span class="comment">&lt;!-- 5. 使用声明式事务 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"txManager"</span> /&gt;</span></div></pre></td></tr></table></figure></li><li><p>测试代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</div><div class="line"><span class="meta">@ContextConfiguration</span>(<span class="string">"classpath:applicationContext.xml"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisTest</span> </span>&#123;</div><div class="line"> </div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    <span class="keyword">private</span> CategoryMapper categoryMapper;</div><div class="line"> </div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAdd</span><span class="params">()</span> </span>&#123;</div><div class="line">        Category category = <span class="keyword">new</span> Category();</div><div class="line">        category.setName(<span class="string">"new Category"</span>);</div><div class="line">        categoryMapper.add(category);</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testList</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(categoryMapper);</div><div class="line">        List&lt;Category&gt; cs=categoryMapper.list();</div><div class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</div><div class="line">            System.out.println(c.getName());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ol><h1 id="SSM"><a href="#SSM" class="headerlink" title="SSM"></a>SSM</h1><h2 id="hello-world-1"><a href="#hello-world-1" class="headerlink" title="hello world"></a>hello world</h2><ul><li><p>项目结构：</p><p><img src="http://img.shuaiyy.cn/blog/180401/993fFjDDb2.png?imageslim" alt="mark"></p></li><li><p>controller接收request请求，通过service接口获取数据，然后将数据和模板组装好后返回给客户端。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">""</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    <span class="keyword">private</span> CategoryService categoryService;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"addCategory"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">add</span><span class="params">(Category category)</span></span>&#123;</div><div class="line">        categoryService.add(category);</div><div class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"addResult"</span>);</div><div class="line">        mav.addObject(<span class="string">"category"</span>, category);</div><div class="line">        <span class="keyword">return</span> mav;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>service类通过mybatis mapper接口访问数据库获取数据。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Service</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span> <span class="keyword">implements</span> <span class="title">CategoryService</span> </span>&#123;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    <span class="keyword">private</span> CategoryMapper categoryMapper;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Category category)</span> </span>&#123;</div><div class="line">        categoryMapper.add(category);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> categoryMapper.list();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>Maven pom配置中指定相关依赖，在build的参数中添加编译插件，指定resource位置。</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 资源文件拷贝插件 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-resources-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- java编译插件 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">pluginManagement</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></div><div class="line">            <span class="comment">&lt;!-- 配置Tomcat插件 --&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">pluginManagement</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.tld<span class="tag">&lt;/<span class="name">include</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></div></pre></td></tr></table></figure><ol><li><p>Tomcat首先根据web.xml初始化web容器(生命周期同Tomcat， Servlet)</p></li><li><p>web.xml定义了spring父容器（生命周期同servlet）和spring MVC子容器的初始化。</p><p>spring的初始化由监听ServletContext的Listener完成，父容器加载完后，加载spring MVC容器。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--把applicationContext.xml加入到配置文件中--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 加载spring --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p><p>web容器中定义的dispatcherServlet（调度）会转发web容器接收的请求，交给Spring MVC。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--配置springmvc DispatcherServlet--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!--配置springMVCr.xml作为mvc的配置文件--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springMVC.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">async-supported</span>&gt;</span>true<span class="tag">&lt;/<span class="name">async-supported</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>由spring初始化的bean（和mybatis相关），dataSource， sqlSessionFactory， mapper</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/ssm?characterEncoding=UTF-8"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"com.shuaiyy.pojo"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></div><div class="line">        <span class="comment">&lt;!--&lt;property name="mapperLocations" value="classpath:com/shuaiyy/mapper/*.xml"/&gt;--&gt;</span></div><div class="line">        <span class="comment">&lt;!--&lt;property name="mapperLocations" value="classpath:com/shuaiyy/mapper/*.*"/&gt;--&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.shuaiyy.mapper"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>spring mvc 负责定位资源及模板，扫描装配Controller bean。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span></div><div class="line">  <span class="comment">&lt;!--启用spring的一些annotation --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></div><div class="line">  <span class="comment">&lt;!-- 配置注解驱动 可以将request参数与绑定到controller参数上 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!--静态资源映射--&gt;</span></div><div class="line">  <span class="comment">&lt;!--本项目把静态资源放在了webapp的statics目录下，资源映射如下--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">"/css/**"</span> <span class="attr">location</span>=<span class="string">"/WEB-INF/statics/css/"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">"/js/**"</span> <span class="attr">location</span>=<span class="string">"/WEB-INF/statics/js/"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">"/image/**"</span> <span class="attr">location</span>=<span class="string">"/WEB-INF/statics/image/"</span>/&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- 视图定位 --&gt;</span></div><div class="line">  <span class="comment">&lt;!-- 对模型视图名称的解析，即在模型视图名称添加前后缀(如果最后一个还是表示文件夹,则最后的斜杠不要漏了) 使用JSP--&gt;</span></div><div class="line">  <span class="comment">&lt;!-- 默认的视图解析器 在上边的解析错误时使用 (默认使用html)- --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"defaultViewResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"viewClass"</span> <span class="attr">value</span>=<span class="string">"org.springframework.web.servlet.view.JstlView"</span>/&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/view/jsp/"</span>/&gt;</span><span class="comment">&lt;!--设置JSP文件的目录位置--&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>/&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"exposeContextBeansAsAttributes"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- 自动扫描装配 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.shuaiyy.controller"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span></span></div><div class="line"><span class="tag">                              <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ol><h2 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h2><p>首先定义一个Page对象来接收request参数，start， count， end。</p><ol><li><p>在sql查询语句中使用limit关键字 </p><p>​</p></li><li><p>使用PageHelper插件</p><p>在bean容器配置文件applicationContext中的sqlSessionFactory bean中配置插件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.pojo"</span> /&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:com/how2java/mapper/*.xml"</span>/&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"plugins"</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">array</span>&gt;</span></div><div class="line">             <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span></div><div class="line">               <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"properties"</span>&gt;</span></div><div class="line">                 <span class="comment">&lt;!--使用下面的方式配置参数，一行配置一个 --&gt;</span></div><div class="line">                 <span class="tag">&lt;<span class="name">value</span>&gt;</span></div><div class="line">                 <span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">               <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">             <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">           <span class="tag">&lt;/<span class="name">array</span>&gt;</span></div><div class="line">         <span class="tag">&lt;/<span class="name">property</span>&gt;</span>    </div><div class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ol><h2 id="更换连接池"><a href="#更换连接池" class="headerlink" title="更换连接池"></a>更换连接池</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.alibaba.druid.pool.DruidDataSource"</span> <span class="attr">init-method</span>=<span class="string">"init"</span> <span class="attr">destroy-method</span>=<span class="string">"close"</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 基本属性 url、user、password --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/ssm?characterEncoding=UTF-8"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span> /&gt;</span></div><div class="line"> </div><div class="line">        <span class="comment">&lt;!-- 配置初始化大小、最小、最大 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"initialSize"</span> <span class="attr">value</span>=<span class="string">"3"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"minIdle"</span> <span class="attr">value</span>=<span class="string">"3"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxActive"</span> <span class="attr">value</span>=<span class="string">"20"</span> /&gt;</span></div><div class="line"> </div><div class="line">        <span class="comment">&lt;!-- 配置获取连接等待超时的时间 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxWait"</span> <span class="attr">value</span>=<span class="string">"60000"</span> /&gt;</span></div><div class="line"> </div><div class="line">        <span class="comment">&lt;!-- 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"timeBetweenEvictionRunsMillis"</span> <span class="attr">value</span>=<span class="string">"60000"</span> /&gt;</span></div><div class="line"> </div><div class="line">        <span class="comment">&lt;!-- 配置一个连接在池中最小生存的时间，单位是毫秒 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"minEvictableIdleTimeMillis"</span> <span class="attr">value</span>=<span class="string">"300000"</span> /&gt;</span></div><div class="line"> </div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"validationQuery"</span> <span class="attr">value</span>=<span class="string">"SELECT 1"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testWhileIdle"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testOnBorrow"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testOnReturn"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line"> </div><div class="line">        <span class="comment">&lt;!-- 打开PSCache，并且指定每个连接上PSCache的大小 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"poolPreparedStatements"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxPoolPreparedStatementPerConnectionSize"</span> <span class="attr">value</span>=<span class="string">"20"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure><h2 id="实现CRUD-1"><a href="#实现CRUD-1" class="headerlink" title="实现CRUD"></a>实现CRUD</h2><ol><li><p>控制器中配置相应URL映射和视图模型，调用service接口实现对应的数据操作</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"addCategory"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">addCategory</span><span class="params">(Category category)</span></span>&#123;</div><div class="line">categoryService.add(category);</div><div class="line">ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/listCategory"</span>);</div><div class="line">    <span class="keyword">return</span> mav;</div><div class="line">&#125;</div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"deleteCategory"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">deleteCategory</span><span class="params">(Category category)</span></span>&#123;</div><div class="line">categoryService.delete(category);</div><div class="line">ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/listCategory"</span>);</div><div class="line"><span class="keyword">return</span> mav;</div><div class="line">&#125;</div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"editCategory"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">editCategory</span><span class="params">(Category category)</span></span>&#123;</div><div class="line">Category c= categoryService.get(category.getId());</div><div class="line">ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"editCategory"</span>);</div><div class="line">mav.addObject(<span class="string">"c"</span>, c);</div><div class="line"><span class="keyword">return</span> mav;</div><div class="line">&#125;</div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"updateCategory"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">updateCategory</span><span class="params">(Category category)</span></span>&#123;</div><div class="line">categoryService.update(category);</div><div class="line">ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/listCategory"</span>);</div><div class="line"><span class="keyword">return</span> mav;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>service接口的实现类中调用mapper接口进行数据库操作。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Service</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span> <span class="keyword">implements</span> <span class="title">CategoryService</span> </span>&#123;</div><div class="line">    <span class="meta">@Autowired</span></div><div class="line">    <span class="keyword">private</span> CategoryMapper categoryMapper;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Category category)</span> </span>&#123;</div><div class="line">        categoryMapper.add(category);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Category  category)</span> </span>&#123;</div><div class="line">        categoryMapper.delete(category);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Category category)</span> </span>&#123;</div><div class="line">        categoryMapper.update(category);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> categoryMapper.get(id);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>mapper接口实现数据库访问</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</div><div class="line">    <span class="meta">@Insert</span>(<span class="string">"insert into category_(id,NAME) VALUES(#&#123;id&#125;, #&#123;name&#125;)"</span>)</div><div class="line"><span class="comment">//    @Insert(" insert into category_ ( name ) values (#&#123;name&#125;)")</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Category category)</span></span>;</div><div class="line"></div><div class="line">    <span class="meta">@Delete</span>(<span class="string">"delete from category_ where id = #&#123;id&#125; and name= #&#123;name&#125;"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Category category)</span></span>;</div><div class="line"></div><div class="line">    <span class="meta">@Select</span>(<span class="string">" select * from category_ where id = #&#123;id&#125;"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</div><div class="line"></div><div class="line">    <span class="meta">@Update</span>(<span class="string">"update category_ set name=#&#123;name&#125; where id = #&#123;id&#125;"</span> )</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Category category)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ol><h2 id="事务管理"><a href="#事务管理" class="headerlink" title="事务管理"></a>事务管理</h2><p>需要导入aspectjweaver包依赖。</p><ul><li><p>配置事务管理器和事务注解扫描器 applicationContext.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>为指定的方法加上事务注解</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line">    <span class="meta">@Transactional</span>(propagation=Propagation.REQUIRED,rollbackForClassName=<span class="string">"Exception"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addTwo</span><span class="params">()</span> </span>&#123;</div><div class="line">         </div><div class="line">        Category c1 = <span class="keyword">new</span> Category();</div><div class="line">        c1.setName(<span class="string">"短的名字"</span>);</div><div class="line">        categoryMapper.add(c1);</div><div class="line">         </div><div class="line">        Category c2 = <span class="keyword">new</span> Category();</div><div class="line">        c2.setName(<span class="string">"名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,"</span>);</div><div class="line">        categoryMapper.add(c2);</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ul><p>使用AOP方式配置事务管理</p><ul><li><p>配置AOP</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txadvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span> </div><div class="line">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span> </div><div class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"add*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span> /&gt;</span> </div><div class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"del*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"edit*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"update*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span> </div><div class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"list*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span> </div><div class="line">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span> </div><div class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span> </div><div class="line">        </div><div class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span> </div><div class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"serviceMethod"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.how2java.service.*.*(..))"</span>/&gt;</span> </div><div class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">pointcut-ref</span>=<span class="string">"serviceMethod"</span> <span class="attr">advice-ref</span>=<span class="string">"txadvice"</span>/&gt;</span> </div><div class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h2><ul><li><p>使用fastjson依赖包处理json字符串</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">JSONObject result = <span class="keyword">new</span> JSONObject();</div><div class="line">result.put(<span class="string">"OK"</span>, <span class="string">"OK"</span>);</div></pre></td></tr></table></figure><p>​</p></li><li><p>spring mvc 依赖jackson依赖包，处理RequestBody， ResponseBody中的json对象。</p><p>@RequestBody 从请求体解析json对象 @ResponseBody，将返回的json字符串作为响应体。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@ResponseBody</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/submitCategory"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">submitCategory</span><span class="params">(@RequestBody Category category)</span> </span>&#123;</div><div class="line">    System.out.println(<span class="string">"SSM接受到浏览器提交的json，并转换为Category对象:"</span>+category);</div><div class="line">    JSONObject result = <span class="keyword">new</span> JSONObject();</div><div class="line">    result.put(<span class="string">"OK"</span>, <span class="string">"OK"</span>);</div><div class="line">    <span class="keyword">return</span> result.toJSONString();</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>jquery提交post请求</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&lt;form &gt;</div><div class="line">    id：&lt;input type=<span class="string">"text"</span> id=<span class="string">"id"</span> value=<span class="string">"123"</span> /&gt;<span class="xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></div><div class="line">    名称：&lt;input type=<span class="string">"text"</span> id=<span class="string">"name"</span> value=<span class="string">"category xxx"</span>/&gt;<span class="xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></div><div class="line">    &lt;input type=<span class="string">"button"</span> value=<span class="string">"提交"</span> id=<span class="string">"sender3"</span>&gt;</div><div class="line">&lt;<span class="regexp">/form&gt;</span></div><div class="line"><span class="regexp">&lt;div id="messageDiv3"&gt;&lt;/</span>div&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">    $(<span class="string">'#sender3'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> id=<span class="built_in">document</span>.getElementById(<span class="string">'id'</span>).value;</div><div class="line">        <span class="keyword">var</span> name=<span class="built_in">document</span>.getElementById(<span class="string">'name'</span>).value;</div><div class="line">        <span class="keyword">var</span> category=&#123;<span class="string">"name"</span>:name,<span class="string">"id"</span>:id&#125;;</div><div class="line">        <span class="keyword">var</span> jsonData = <span class="built_in">JSON</span>.stringify(category);</div><div class="line">        <span class="keyword">var</span> page=<span class="string">"submitCategory"</span>;</div><div class="line"></div><div class="line">        $.ajax(&#123;</div><div class="line">            type:<span class="string">"post"</span>,</div><div class="line">            url: page,</div><div class="line">            data:jsonData,</div><div class="line">            dataType:<span class="string">"json"</span>,</div><div class="line">            contentType : <span class="string">"application/json;charset=UTF-8"</span>,</div><div class="line">            success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</div><div class="line">                alert(<span class="string">"提交成功，请在Tomcat控制台查看服务端接收到的数据"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="RESTFUL-API"><a href="#RESTFUL-API" class="headerlink" title="RESTFUL API"></a>RESTFUL API</h2><p>restful简单的讲URI指定资源，http请求的方法来决定对资源对象的操作。</p><p><img src="http://img.shuaiyy.cn/blog/180402/mmc71b4gBh.png?imageslim" alt="mark"></p><ul><li><p>SpringMVC的dispatcherServlet只能处理post和get，因此需要在web.xml中配置filter增加对put和delete方法的变相支持，会将POST请求转换为对应的方法。即在POST表单中指定<code>_method</code>为<code>PUT</code>或<code>DELETE</code>, 表单域可以设为hidden。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>在jsp中实现CRUD对应的请求发起操作</p><p>在POST表单中定义<code>_method</code>隐藏域的请求方法属性值， 确定action的URI，最后jQuery POST提交函数。</p></li><li><p>jsp</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">        &lt;c:forEach items=<span class="string">"$&#123;categorys&#125;"</span> var=<span class="string">"c"</span> varStatus=<span class="string">"st"</span>&gt;</div><div class="line">            &lt;tr&gt;</div><div class="line">                &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</div><div class="line">                &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</div><div class="line">                &lt;td&gt;&lt;a class="edit" name="$&#123;c.name&#125;/$&#123;c.id&#125;" href="#add_edit" &gt;编辑&lt;/a&gt;&lt;/td&gt;</div><div class="line">                &lt;td&gt;&lt;a class="delete" href="category/$&#123;c.id&#125;"&gt;删除&lt;/a&gt;&lt;/td&gt;</div><div class="line">            &lt;/tr&gt;</div><div class="line">        &lt;/c:forEach&gt;</div><div class="line"></div><div class="line">    &lt;div&gt;  &lt;!-- 增加使用PUT方法--&gt;</div><div class="line">        &lt;form id=<span class="string">"add_edit"</span> method=<span class="string">"post"</span> action=<span class="string">"category"</span>&gt;</div><div class="line">            &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"_method"</span> value=<span class="string">"PUT"</span>&gt;</div><div class="line">            分类id： &lt;input name=<span class="string">"id"</span> value=<span class="string">""</span> type=<span class="string">"text"</span> &gt; &lt;br&gt;&lt;br&gt;</div><div class="line">            分类名称： &lt;input name=<span class="string">"name"</span> value=<span class="string">""</span> type=<span class="string">"text"</span>&gt; &lt;br&gt;&lt;br&gt;</div><div class="line">            &lt;input type=<span class="string">"submit"</span> value=<span class="string">"增加分类"</span>&gt;</div><div class="line">            &lt;input type=<span class="string">"reset"</span> value=<span class="string">"清空输入"</span>&gt;</div><div class="line">        &lt;/form&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;form id=<span class="string">"formdelete"</span> action=<span class="string">""</span> method=<span class="string">"POST"</span> &gt;</div><div class="line">    &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"_method"</span> value=<span class="string">"DELETE"</span>&gt;</div><div class="line">&lt;/form&gt;</div><div class="line"></div><div class="line"></div><div class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</div><div class="line">    <span class="comment">/*将post method 改变为delete*/</span></div><div class="line">    $(function()&#123;</div><div class="line">        $(<span class="string">".delete"</span>).click(function()&#123;</div><div class="line">            var href=$(<span class="keyword">this</span>).attr(<span class="string">"href"</span>);</div><div class="line">            $(<span class="string">"#formdelete"</span>).attr(<span class="string">"action"</span>,href).submit();</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;)</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="comment">/* 修改操作使用post method*/</span></div><div class="line">    $(function()&#123;</div><div class="line">        $(<span class="string">".edit"</span>).click(function()&#123;</div><div class="line">            var list =$(<span class="keyword">this</span>).attr(<span class="string">"name"</span>).split(<span class="string">"/"</span>);</div><div class="line">            var cid = list.pop();</div><div class="line">            var name = list.pop();</div><div class="line">            var uri = <span class="string">"category/"</span>+cid;</div><div class="line">            $(<span class="string">"#add_edit"</span>).attr(<span class="string">"action"</span>, uri);</div><div class="line">            $(<span class="string">"#add_edit input[name=id]"</span>).attr(<span class="string">"value"</span>, cid);</div><div class="line">            $(<span class="string">"#add_edit input[name=id]"</span>).attr(<span class="string">"disabled"</span>, <span class="string">"disabled"</span>);</div><div class="line">            $(<span class="string">"#add_edit input[name=name]"</span>).attr(<span class="string">"value"</span>, name);</div><div class="line">            $(<span class="string">"#add_edit input[type=submit]"</span>).attr(<span class="string">"value"</span>, <span class="string">"修改此分类"</span>);</div><div class="line">            $(<span class="string">"#add_edit input[type=hidden]"</span>).remove();</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><p>​</p></li><li><p>controller</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 删除</span></div><div class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"category/&#123;id&#125;"</span>, method = RequestMethod.DELETE)</div><div class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">delete</span><span class="params">(@PathVariable <span class="keyword">int</span> id)</span></span>&#123;</div><div class="line">        categoryService.deleteByID(id);</div><div class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/listCategory"</span>);</div><div class="line">        <span class="keyword">return</span> mav;</div><div class="line">    &#125;</div><div class="line"><span class="comment">// 修改</span></div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"category/&#123;id&#125;"</span>, method = RequestMethod.POST)</div><div class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">edit</span><span class="params">(Category category)</span></span>&#123;</div><div class="line">        categoryService.update(category);</div><div class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/listCategory"</span>);</div><div class="line">        <span class="keyword">return</span> mav;</div><div class="line">    &#125;</div><div class="line"><span class="comment">// 增加</span></div><div class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"category"</span>, method = RequestMethod.PUT)</div><div class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">addCategoryByPost</span><span class="params">(Category category)</span></span>&#123;</div><div class="line">        categoryService.add(category);</div><div class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/listCategory"</span>);</div><div class="line">        <span class="keyword">return</span> mav;</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p>​</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Mybatis&quot;&gt;&lt;a href=&quot;#Mybatis&quot; class=&quot;headerlink&quot; title=&quot;Mybatis&quot;&gt;&lt;/a&gt;Mybatis&lt;/h1&gt;&lt;p&gt;MyBatis 是一款优秀的持久层框架，它支持定制化 SQL、存储过程以及高级映射。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以使用简单的 XML 或注解来配置和映射原生信息，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。&lt;/p&gt;
&lt;p&gt;Python Django的ORM框架提供了增删改查接口， mybatis必须要手动配置SQL语句。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mybatis.org/mybatis-3/zh/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官方文档&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;hello-world&quot;&gt;&lt;a href=&quot;#hello-world&quot; class=&quot;headerlink&quot; title=&quot;hello world&quot;&gt;&lt;/a&gt;hello world&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;创建表和数据&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;USE how2java;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;CREATE TABLE category_ (&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  id int(11) NOT NULL AUTO_INCREMENT,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  name varchar(32) DEFAULT NULL,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  PRIMARY KEY (id)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;INSERT INTO category_ VALUES (null,&amp;apos;category1&amp;apos;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;INSERT INTO category_ VALUES (null,&amp;apos;category2&amp;apos;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;创建对应的pojo对象&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;package&lt;/span&gt; com.how2java.pojo;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Category&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; id;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; String name;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; id;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;setId&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; id)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id = id;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;title&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; name;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;setName&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String name)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.name = name;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;     &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="技术" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/"/>
    
      <category term="Mybatis" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/Mybatis/"/>
    
    
      <category term="Java" scheme="http://shuaiyy.cn/tags/Java/"/>
    
      <category term="ORM" scheme="http://shuaiyy.cn/tags/ORM/"/>
    
      <category term="MyBatis" scheme="http://shuaiyy.cn/tags/MyBatis/"/>
    
  </entry>
  
  <entry>
    <title>Hibernate入门</title>
    <link href="http://shuaiyy.cn/2018/02/16/%E6%8A%80%E6%9C%AF/Hibernate%E5%85%A5%E9%97%A8/"/>
    <id>http://shuaiyy.cn/2018/02/16/技术/Hibernate入门/</id>
    <published>2018-02-15T16:00:00.000Z</published>
    <updated>2018-11-22T11:02:28.001Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Hibernate入门"><a href="#Hibernate入门" class="headerlink" title="Hibernate入门"></a>Hibernate入门</h1><p>一个Java 领域的持久化框架，ORM 框架。</p><p>“持久化”包括和数据库相关的各种操作：增删查改，根据OID加载对象。</p><h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><ul><li><p>创建数据库表和POJO对象 Product.java</p></li><li><p>配置POJO到table的映射关系 <code>Product.hbm.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0"?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE hibernate-mapping PUBLIC</span></div><div class="line"><span class="meta">        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></div><div class="line"><span class="meta">        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"cn.shuaiyy.pojo"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></div></pre></td></tr></table></figure></li></ul>  <a id="more"></a><ul><li><p>Hibernate配置文件<code>hibernate.cfg.xml</code>中配置数据库连接，并添加mapping配置。</p><p>​</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version='1.0' encoding='utf-8'?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE hibernate-configuration PUBLIC</span></div><div class="line"><span class="meta">        "-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></div><div class="line"><span class="meta">        "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- Database connection settings --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/test?characterEncoding=UTF-8<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- SQL dialect --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">      <span class="comment">&lt;!-- 映射关系配置 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"cn/shuaiyy/pojo/Product.hbm.xml"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>导入hibernate-core包，进行测试 <code>TestHibernate.java</code></p><ol><li>获取SessionFactory对象，并创建一个session</li><li>在session中开启一个事务</li><li>通过session进行CRUD</li><li>session提交事务</li><li>关闭session和sessionFactory</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">      <span class="comment">// 获取session，开启事务</span></div><div class="line">      SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</div><div class="line"><span class="comment">// 如果配置文件不在classpath下目录，可以传入File对象。</span></div><div class="line"><span class="comment">// File config = new File("xx/xxx/hibernate.cfg.xml");</span></div><div class="line"><span class="comment">// new Configuration().configure(config)</span></div><div class="line">      Session s = sf.openSession();</div><div class="line">      s.beginTransaction();</div><div class="line">      </div><div class="line">      Product p = <span class="keyword">new</span> Product();</div><div class="line">      p.setName(<span class="string">"iphone8"</span>);</div><div class="line">      p.setPrice(<span class="number">8000</span>);</div><div class="line">      s.save(p);  <span class="comment">// 增加</span></div><div class="line">      p = s.get(Product.class, <span class="number">1</span>); <span class="comment">// 查询</span></div><div class="line">      System.out.println(p.getName() + p.getPrice());</div><div class="line">      s.getTransaction().commit(); <span class="comment">// 提交事务</span></div><div class="line">      s.close();</div><div class="line">      sf.close();</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="hibernate配置"><a href="#hibernate配置" class="headerlink" title="hibernate配置"></a>hibernate配置</h2><p><strong>cfg.xml</strong></p><ul><li>show_sql：是否将运行期生成的SQL输出到日志以供调试</li><li>format_sql：是否将SQL 转化为格式良好的SQL</li><li>hbm2ddl.auto：在启动和停止时自动地创建，更新或删除数据库。取值create | update | create-drop |<br>validate</li><li>hibernate.jdbc.fetch_size：需要底层数据库支持，每次查询取出的记录数。取100时性能较好。</li><li>hibernate.jdbc.batch_size：批量操作的批次大小，Oracle数据库取30较好。</li></ul><p><strong>hbm.xml</strong></p><p>hibernate-mapping的属性：</p><ul><li>default-cascade(默认为none): 设置hibernate默认的级联风格</li><li>default-access (默认为property): 指定Hibernate 的默认的属性访问策略。默认值为 property, 即使用getter, setter 方法来访问属性. 若指定access, 则通过反射访问成员变量.</li><li>default-lazy(默认为true): 设置Hibernat morning的延迟加载策略. 该属性的默认值为 true, 即启用延迟加载策略. </li><li>package (可选): 指定一个包前缀，配置类名时该包下的类可以不用全类名。</li></ul><p>class节点的属性: 用于配置类与表的映射。</p><ul><li>name:指定该持久化类映射的持久化类的类名</li><li>table:指定该持久化类映射的表名, Hibernate 默认以持久化类的类名作为表名</li><li>dynamic-insert: 若设置为true, 表示当保存一个对象时, 会动态生成 insert 语句, insert 语句中仅包含所有取值不为null 的字段. 默认值为false</li><li>dynamic-update: 若设置为true, 表示当更新一个对象时, 会动态生成 update 语句, update 语句中仅包含所有<br>取值需要更新的字段. 默认值为false</li><li>select-before-update:设置Hibernate 在更新某个持久化对象之前是否需要先执行一次查询. 默认值为false</li><li>batch-size:指定根据OID 来抓取实例时每批抓取的实例数.</li><li>lazy: 指定是否使用延迟加载. </li><li>mutable: 若设置为true, 等价于所有的<code>&lt;property&gt;</code> 元素的update 属性为false, 表示整个实例不能被更新. 默<br>认为true. </li><li>discriminator-value: 指定区分不同子类的值. 当使用<code>&lt;subclass/&gt;</code> 元素来定义持久化类的继承关系时需要使<br>用该属性</li></ul><p>id节点：设定持久化类的OID 和表的主键的映射</p><ul><li><p>name: 标识持久化类OID 的属性名</p></li><li><p>column: 设置标识属性所映射的数据表的列名(主键字段的名字). </p></li><li><p>unsaved-value:若设定了该属性, Hibernate 会通过比较持久化类的OID 值和该属性值来区分当前持久化类的<br>对象是否为临时对象</p></li><li><p>type:指定Hibernate 映射类型. Hibernate 映射类型是Java 类型与SQL 类型的桥梁. 如果没有为某个属性显<br>式设定映射类型, Hibernate 会运用反射机制先识别出持久化类的特定属性的Java 类型, 然后自动使用与之对<br>应的默认的Hibernate 映射类型</p><p><img src="http://img.shuaiyy.cn/blog/180412/d5c4a99mlG.png?imageslim" alt="mark"></p><p><img src="http://img.shuaiyy.cn/blog/180412/fkE9GkkfL6.png?imageslim" alt="mark"></p><p>​</p></li><li><p>Java 的基本数据类型和包装类型对应相同的Hibernate 映射类型. 基本数据类型无法表达null, 所以对于持久化<br>类的OID 推荐使用包装类型。对于时间类型，java类中应使用Date，Hibernate内部实现了对于的映射时间类型。</p><p><img src="http://img.shuaiyy.cn/blog/180412/6B92FEbbL8.png?imageslim" alt="mark"></p></li></ul><p>property节点：</p><ul><li><p>name:指定该持久化类的属性的名字</p></li><li><p>column:指定与类的属性映射的表的字段名. 如果没有设置该属性, Hibernate 将直接使用类的属性名作为字段名. </p></li><li><p>type:指定Hibernate 映射类型. Hibernate 映射类型是Java 类型与SQL 类型的桥梁. 如果没有为某个属性显式设定映射类型, Hibernate 会运用反射机制先识别出持久化类的特定属性的 Java 类型, 然后自动使用与之对应的默认的 Hibernate 映射类型.</p></li><li><p>not-null:若该属性值为true, 表明不允许为null, 默认为false</p></li><li><p>access:指定Hibernate 的默认的属性访问策略。默认值为property, 即使用getter, setter 方法来访问属性. 若指定field, 则Hibernate 会忽略getter/setter 方法, 而通过反射访问成员变量</p></li><li><p>unique: 设置是否为该属性所映射的数据列添加唯一约束. </p></li><li><p>index: 指定一个字符串的索引名称. 当系统需要Hibernate 自动建表时, 用于为该属性所映射的数据列创建索引, 从而加快该数据列的查询.</p></li><li><p>length: 指定该属性所映射数据列的字段的长度</p></li><li><p>scale: 指定该属性所映射数据列的小数位数, 对double, float, decimal 等类型的数据列有效.</p></li><li><p>formula：设置一个SQL 表达式, Hibernate 将根据它来计算出派生属性的值. </p><p>派生属性: 并不是持久化类的所有属性都直接和表的字段匹配, 持久化类的有些属性的值必须在运行时通过计算才能得出来,</p><p><code>formula=&quot;(SELECT concat(author, &#39;: &#39;, title) FROM NEWS n WHERE n.id = id)&quot;</code>, 必须把sql放到括号内，其中id 是入参, 和当前持久化对象的id 属性对应的列的 id 值将作为参数传入.</p></li></ul><p>component子节点： 一个实体类是另外一个实体类组成的一部分</p><ul><li>parent：指定组成关系</li><li>property节点：同class下的property。</li></ul><h2 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h2><h3 id="利用主键获取一个对象"><a href="#利用主键获取一个对象" class="headerlink" title="利用主键获取一个对象"></a>利用主键获取一个对象</h3><ul><li>get方式，立即调用SQL获取对象全部属性，如果不存在则返回null。</li><li>load方式，延迟加载，当访问对象属性时，才执行SQL语句。如果对象不存在会抛出异常。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Product p1 = s.get(Product.class, <span class="number">80</span>); <span class="comment">// 查询</span></div><div class="line">Product p2 = s.load(Product.class, <span class="number">81</span>); <span class="comment">// 查询</span></div></pre></td></tr></table></figure><h3 id="增加"><a href="#增加" class="headerlink" title="增加"></a>增加</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">p.setName(<span class="string">"shuaiyy"</span> + i);</div><div class="line">p.setPrice(<span class="number">200</span>*i);</div><div class="line">s.save(p);  <span class="comment">// 增加</span></div></pre></td></tr></table></figure><h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Product p2 = s.load(Product.class, <span class="number">81</span>); <span class="comment">// 查询</span></div><div class="line">s.delete(p2); <span class="comment">// 删除</span></div><div class="line">s.getTransaction().commit(); <span class="comment">// 提交事务</span></div></pre></td></tr></table></figure><h3 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">s.beginTransaction();</div><div class="line">Product p =(Product) s.get(Product.class, <span class="number">6</span>); <span class="comment">//获取修改对象</span></div><div class="line">p.setName(<span class="string">"new_name"</span>);  <span class="comment">// 修改</span></div><div class="line">s.update(p);  <span class="comment">// 更新</span></div><div class="line">s.getTransaction().commit();</div></pre></td></tr></table></figure><h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><p>查询策略：</p><ol><li><p>减少内存浪费，关联对象如果没被访问，则不应提前载入内存</p><p>class的延迟加载。set的lazy和fetch属性</p></li><li><p>提高查询效率：较少的发送SQL语句</p><p>batch-size</p></li></ol><ul><li><p>HQL方式</p><p>hibernate query language， 不需要select，from后是对象，而不是数据表。</p><ol><li>创建一个Query对象，根据hql语法</li><li>设置参数，参数起始于0</li><li>调用list或者getSingleResult 获取查询结果</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1. 创建 Query 对象，基于位置的参数. </span></div><div class="line">String hql = <span class="string">"FROM Employee e WHERE e.salary &gt; ? AND e.email LIKE ? AND e.dept = ? "</span></div><div class="line">  + <span class="string">"ORDER BY e.salary"</span>;</div><div class="line">Query query = session.createQuery(hql);</div><div class="line"><span class="comment">//2. 绑定参数， Query 对象调用 setXxx 方法支持方法链的编程风格.</span></div><div class="line">Department dept = <span class="keyword">new</span> Department();</div><div class="line">dept.setId(<span class="number">80</span>); </div><div class="line">query.setFloat(<span class="number">0</span>, <span class="number">6000</span>)</div><div class="line">  .setString(<span class="number">1</span>, <span class="string">"%A%"</span>)</div><div class="line">  .setEntity(<span class="number">2</span>, dept);</div><div class="line"><span class="comment">//3. 执行查询</span></div><div class="line">List&lt;Employee&gt; emps = query.list();</div><div class="line">System.out.println(emps.size()); </div><div class="line"></div><div class="line"><span class="comment">/**** 使用命名参数 :name ***/</span></div><div class="line"><span class="comment">//1。基于命名参数的query查询，传入的值可以是entity实体类对象。</span></div><div class="line">String hql = <span class="string">"FROM Employee e WHERE e.salary &gt; :sal AND e.email LIKE :email"</span>;</div><div class="line">Query query = session.createQuery(hql);</div><div class="line"><span class="comment">//2. 绑定参数</span></div><div class="line">query.setFloat(<span class="string">"sal"</span>, <span class="number">7000</span>)</div><div class="line">  .setString(<span class="string">"email"</span>, <span class="string">"%A%"</span>);</div><div class="line"><span class="comment">//3. 执行查询</span></div><div class="line">List&lt;Employee&gt; emps = query.list();</div><div class="line">System.out.println(emps.size());  </div><div class="line"></div><div class="line"><span class="comment">// 分页查询</span></div><div class="line"><span class="keyword">int</span> pageNo = <span class="number">22</span>;</div><div class="line"><span class="keyword">int</span> pageSize = <span class="number">5</span>;</div><div class="line">List&lt;Employee&gt; emps = query.setFirstResult((pageNo - <span class="number">1</span>) * pageSize)</div><div class="line">  .setMaxResults(pageSize)</div><div class="line">  .list();</div></pre></td></tr></table></figure></li><li><p>QBC（Query by Criteria）方式</p><p>criteria： 准则；条件；规准。</p><p>新版本中不被推荐使用了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Criteria query = s.createCriteria(Product.class);</div><div class="line">query.add(Restrictions.like(<span class="string">"name"</span>, <span class="string">"%uai%"</span>));</div><div class="line">List&lt;Product&gt; ps= query.list();</div><div class="line"><span class="keyword">for</span> (Product p : ps) &#123;</div><div class="line">  System.out.println(p.getName());</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>标准SQL方式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">String sql = <span class="string">"select * from product_ p where p.name like '%ai%'"</span>;</div><div class="line">Query q= s.createSQLQuery(sql);</div><div class="line">List&lt;Object[]&gt; records= q.list();</div><div class="line"><span class="keyword">for</span> (Object[] record : records) &#123;</div><div class="line">  <span class="keyword">for</span> (Object filed: record) &#123;</div><div class="line">    System.out.print(filed+<span class="string">"\t"</span>);</div><div class="line">  &#125;</div><div class="line">  System.out.println();</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="对象关系"><a href="#对象关系" class="headerlink" title="对象关系"></a>对象关系</h2><ul><li>如果需要把持久化类的实例放到Set 中(如多对一映射),需要重写eqauls 和hashCode 方法。</li><li>持久化类需要一个标识属性(identifier property): 通常映射为数据库表的主键字段.否则一些功能将不起作用，如：<code>Session.saveOrUpdate()</code></li><li>持久化类为非final类，因为Hibernate的代理机制。类字段要设置setter 、getter访问方法。</li></ul><h3 id="一对一"><a href="#一对一" class="headerlink" title="一对一"></a>一对一</h3><ul><li><p>基于外键的方式，在存在外键的一端使用many-to-one，为其加上unique=”true”。另一端使用one-to-one，其property-ref属性的值为关联实体many-to-one属性的name。</p></li><li><p>基于主键的方式：一端的主键采用foreign生成器的方式关联，并在one-to-one属性上添加constrained=true 属性, 以使当前的主键上添加外键约束。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Department"</span> <span class="attr">table</span>=<span class="string">"DEPARTMENTS"</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"deptId"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"DEPT_ID"</span> /&gt;</span></div><div class="line">            <span class="comment">&lt;!-- 使用外键的方式来生成当前的主键，即department的主键生成要根据mgr的主键来生成，不能自己独立创建 --&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"foreign"</span>&gt;</span></div><div class="line">            <span class="comment">&lt;!-- property 属性指定使用当前持久化类的哪一个属性的主键作为外键 --&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"property"</span>&gt;</span>mgr<span class="tag">&lt;/<span class="name">param</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--  </span></div><div class="line"><span class="comment">采用 foreign 主键生成器策略的一端增加 one-to-one 元素映射关联属性,</span></div><div class="line"><span class="comment">其 one-to-one 节点还应增加 constrained=true 属性, 以使当前的主键上添加外键约束</span></div><div class="line"><span class="comment">--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">one-to-one</span> <span class="attr">name</span>=<span class="string">"mgr"</span> <span class="attr">class</span>=<span class="string">"Manager"</span> <span class="attr">constrained</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">one-to-one</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">class</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Manager"</span> <span class="attr">table</span>=<span class="string">"MANAGERS"</span>&gt;</span></div><div class="line">        </div><div class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"mgrId"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"MGR_ID"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">one-to-one</span> <span class="attr">name</span>=<span class="string">"dept"</span> </span></div><div class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"Department"</span>&gt;</span><span class="tag">&lt;/<span class="name">one-to-one</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">class</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ul><h3 id="多对一"><a href="#多对一" class="headerlink" title="多对一"></a>多对一</h3><p>一个category下有多个product，通过product找到其对应的category。</p><ol><li><p>product pojo中增加category属性，数据表中增加一列cid，对应category_表中的id</p></li><li><p>配置category和product的hibernate 映射配置文件。product中增加一个<code>&lt;many-to-one&gt;</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"cn.shuaiyy.pojo"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"category"</span> <span class="attr">class</span>=<span class="string">"Category"</span> <span class="attr">column</span>=<span class="string">"cid"</span>  /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>查询和访问</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">s.beginTransaction();</div><div class="line">Query query = s.createQuery(<span class="string">"from Product p where p.category.id=?"</span>);</div><div class="line">query.setParameter(<span class="number">0</span>, <span class="number">2</span>);</div><div class="line">List&lt;Product&gt; ps= query.list();</div><div class="line"><span class="keyword">for</span> (Product p : ps) &#123;</div><div class="line">  System.out.println(p.getName());</div><div class="line">  System.out.println(p.getCategory().getName());</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ol><h3 id="一对多"><a href="#一对多" class="headerlink" title="一对多"></a>一对多</h3><ol><li><p>通过一个category查找其对应的多个product</p></li><li><p>categeory pojo 中增加属性products，可以是list set map类型，必须是集合接口，可以赋初值为null。</p></li><li><p>配置一对多的集合映射</p><p>xml会检查子元素的顺序，key， list-index， one-to-many</p><p>设置<code>inverse=&quot;true&quot;</code>，即本端不维护关联关系，有多的那端维护。 </p><p>order-by，SQL中的排序条件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"cn.shuaiyy.pojo"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Category"</span> <span class="attr">table</span>=<span class="string">"category_"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">list</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">table</span>=<span class="string">"product_"</span> &gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">list-index</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></div><div class="line">      </div><div class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"productsSet"</span> <span class="attr">table</span>=<span class="string">"product_"</span> <span class="attr">inverse</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">             <span class="attr">order-by</span>=<span class="string">"ORDER_NAME DESC"</span> <span class="attr">lazy</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">        <span class="attr">batch-size</span>=<span class="string">"2"</span> <span class="attr">fetch</span>=<span class="string">"subselect"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></div><div class="line">      </div><div class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>访问</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Query query = s.createQuery(<span class="string">"from Category c"</span>);</div><div class="line">List&lt;Category&gt; cs= query.list();</div><div class="line">System.out.println(cs);</div><div class="line"><span class="keyword">for</span> (Category c : cs) &#123;</div><div class="line">  System.out.println(c.getName());</div><div class="line">  System.out.println(c.getProducts());</div><div class="line">  System.out.println(c.getProductsSet());</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ol><h3 id="多对多"><a href="#多对多" class="headerlink" title="多对多"></a>多对多</h3><ol><li><p>一个用户可以购买多个商品，而一个商品也可以被多个用户购买，因此需要额外的user_product对应关系表。</p></li><li><p>many-to-many两边都要指定column属性，且指向相同的表。必须其中一端放弃维护关系(inverse=”true”)，否则有可能造成主键冲突。</p></li><li><p>实体类都有集合属性。User pojo中增加products属性，type为set。Product pojo中增加users属性，type为 set。</p></li><li><p>配置对应的mapping</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"cn.shuaiyy.pojo"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"category"</span> <span class="attr">class</span>=<span class="string">"Category"</span> <span class="attr">column</span>=<span class="string">"cid"</span>  /&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"users"</span> <span class="attr">table</span>=<span class="string">"user_product_"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">column</span>=<span class="string">"uid"</span> <span class="attr">class</span>=<span class="string">"User"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"User"</span> <span class="attr">table</span>=<span class="string">"user_"</span> &gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"user_id"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"user_name"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">table</span>=<span class="string">"user_product_"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"uid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> <span class="attr">column</span>=<span class="string">"pid"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>访问对象</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Query query = s.createQuery(<span class="string">"from User c"</span>);</div><div class="line">List&lt;User&gt; users= query.list();</div><div class="line">System.out.println(users);</div><div class="line"><span class="keyword">for</span> (User user : users) &#123;</div><div class="line">  System.out.println(user.getName());</div><div class="line">  Set&lt;Product&gt; ps = user.getProducts();  <span class="comment">// 通过user访问其购买的product</span></div><div class="line">  <span class="keyword">for</span> (Product p : ps) &#123;</div><div class="line">    System.out.println(p.getName());</div><div class="line">    Set&lt;User&gt; pUsers = p.getUsers(); <span class="comment">// 通过product访问购买者user</span></div><div class="line">    System.out.println(<span class="string">"购买&#123; "</span>+p.getName()+<span class="string">"&#125; 的人共有："</span>+ pUsers.size()); </div><div class="line">    <span class="keyword">for</span>(User u : pUsers) System.out.println(u.getName() + <span class="string">" 购买了"</span> + p.getName());</div><div class="line">    &#125;</div><div class="line"> &#125;</div></pre></td></tr></table></figure><p>​</p></li></ol><h2 id="继承映射"><a href="#继承映射" class="headerlink" title="继承映射"></a>继承映射</h2><p><img src="http://img.shuaiyy.cn/blog/180412/23EEJ11HF6.png?imageslim" alt="mark"></p><p>实现多态查询，当查询父类对象时，也可以将其所有子类一起找到。</p><ul><li><p>subclass: 使用一张表保存父类和子类，使用一个辨别类型type字段<code>discriminator column</code>，并给父类和子类设定type的取值<code>discriminator-value</code>。子类自有的字段，在父类记录中为null值。</p><p>缺点是有冗余字段，子类独有字段不能加非空约束。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Person"</span> <span class="attr">table</span>=<span class="string">"PERSONS"</span> <span class="attr">discriminator-value</span>=<span class="string">"PERSON"</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"ID"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"NAME"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 配置辨别者列 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">discriminator</span> <span class="attr">column</span>=<span class="string">"TYPE"</span> <span class="attr">type</span>=<span class="string">"string"</span>&gt;</span><span class="tag">&lt;/<span class="name">discriminator</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 映射子类 Student, 使用 subclass 进行映射 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">subclass</span> <span class="attr">name</span>=<span class="string">"Student"</span> <span class="attr">discriminator-value</span>=<span class="string">"STUDENT"</span>&gt;</span></div><div class="line">          <span class="comment">&lt;!--子类独有的属性 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"school"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">column</span>=<span class="string">"SCHOOL"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">subclass</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>joined-subclass:  父类实例保存在父类表中，子类实例由父类表和子类表共同存储。父类表保存共同的属性，每个子类使用单独的表保存独有字段。</p><p>插入子类时，要插入2张数据表。查询时也要做内连接查询。</p><p>优点：没有冗余字段，子类独有字段可以加非空约束。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Person"</span> <span class="attr">table</span>=<span class="string">"PERSONS"</span>&gt;</span></div><div class="line"></div><div class="line">       <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"ID"</span> /&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span> /&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">       </div><div class="line">       <span class="tag">&lt;<span class="name">joined-subclass</span> <span class="attr">name</span>=<span class="string">"Student"</span> <span class="attr">table</span>=<span class="string">"STUDENTS"</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"STUDENT_id"</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span>  <span class="comment">&lt;!-- 关联父类的ID --&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"school"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">column</span>=<span class="string">"SCHOOL"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">joined-subclass</span>&gt;</span> </div><div class="line">   <span class="tag">&lt;/<span class="name">class</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>union-subclass</p><p>父类表只包含父类的记录，子类表里只包含子类的记录，子类表包含父类的全部字段以及专有字段，因此父表主键的生成策略不能是identity(native) 的主键生成策略， native 会根据数据库优先使identity或sequence。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Person"</span> <span class="attr">table</span>=<span class="string">"PERSONS"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"ID"</span> /&gt;</span></div><div class="line">            <span class="comment">&lt;!-- 主键生成策略不能是native或identity --&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"hilo"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">union-subclass</span> <span class="attr">name</span>=<span class="string">"Student"</span> <span class="attr">table</span>=<span class="string">"STUDENTS"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"school"</span> <span class="attr">column</span>=<span class="string">"SCHOOL"</span> <span class="attr">type</span>=<span class="string">"string"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">union-subclass</span>&gt;</span>               </div><div class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><ul><li><p>包括类，属性，关系的注解，及其他的注解。</p></li><li><p>使用注解和使用xml配置的优缺点</p><p>小的项目，简单的配置使用注解，开发速度快。大的项目，维护复杂，多人协同，用配置文件。</p><ul><li>配置文件： 容易编辑修改，配置集中，方便别人理解，重启生效，无需编译。缺点是繁琐、丑陋，配置过多时难以管理。</li><li>注解：简洁，开发时方便，和代码聚合度高。缺点也很明显，配置分散在各个类文件里，不易维护，修改后必须重新编译、打包、发布、上线启动应用。</li></ul></li></ul><h3 id="类、属性、关系注解"><a href="#类、属性、关系注解" class="headerlink" title="类、属性、关系注解"></a>类、属性、关系注解</h3><ul><li><p>修饰类</p><p>@Entity 表示这是一个实体类，用于映射表<br>@Table(name = “product”) 表示这是一个类，映射到的表名:product</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="meta">@Table</span>(name = <span class="string">"product_"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> id;</div><div class="line">    String name;</div><div class="line">    <span class="keyword">float</span> price;</div><div class="line">  </div><div class="line">  <span class="meta">@Id</span></div><div class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY) </div><div class="line">    <span class="meta">@Column</span>(name = <span class="string">"id"</span>)   </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> id;</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Column</span>(name = <span class="string">"name"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>属性注解</p><p>注意：属性的注解是配置在对应属性的getter方法上。</p><p>@Id 表示这是主键<br>@GeneratedValue(strategy = GenerationType.IDENTITY) </p><ul><li>identity 表示自增长方式使用mysql自带的</li><li>sequence 底层数据库序列生成标识符，mysql不支持</li><li>hilo 由Hibernate负责生成，应用high/low算法</li><li>native：自行依次匹配上面3种</li></ul><p>@Column(name = “id”) 表示映射到字段id</p></li><li><p>多对一注解</p><p>多个Product对应一个category，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="meta">@Table</span>(name = <span class="string">"product_"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> Category category;</div><div class="line">  <span class="meta">@ManyToOne</span>(targetEntity = Category.class)</div><div class="line">    <span class="meta">@JoinColumn</span>(name = <span class="string">"cid"</span>) <span class="comment">//外键</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> category;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 或者使用JoinTable</span></div><div class="line">      <span class="meta">@ManyToOne</span>(cascade=&#123;CascadeType.PERSIST,CascadeType.MERGE&#125;) </div><div class="line">      <span class="meta">@JoinTable</span>(name=<span class="string">"关联表名"</span>， </div><div class="line">      joinColumns = <span class="meta">@JoinColumn</span>(name=<span class="string">"主表外键"</span>), </div><div class="line">      inverseJoinColumns = <span class="meta">@JoinColumns</span>(name=<span class="string">"从表外键"</span>) </div><div class="line">      )</div><div class="line">      <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> category;</div><div class="line">      &#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>一对多注解</p><p>1个category可以获取多个product</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="meta">@Table</span>(name = <span class="string">"category_"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Set&lt;Product&gt; productsSet;</div><div class="line">  </div><div class="line">    <span class="meta">@OneToMany</span>(fetch = FetchType.EAGER)</div><div class="line">    <span class="meta">@JoinColumn</span>(name=<span class="string">"cid"</span>)  <span class="comment">// 外键</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProductsSet</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> productsSet;</div><div class="line">    &#125;</div><div class="line">  <span class="comment">//或者  mappedBy= “多” pojo类的关联属性</span></div><div class="line">  <span class="meta">@OneToMany</span>(fetch = FetchType.EAGER, mappedBy = <span class="string">"category"</span>) <span class="comment">// Product的 category属性</span></div><div class="line">  <span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProductsSet</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> productsSet;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>多对多注解</p><p>多个用户可以拥有多个物品，需要单独一张表维护用户-物品关系</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"> <span class="meta">@Entity</span></div><div class="line"><span class="meta">@Table</span>(name = <span class="string">"user_"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Set&lt;Product&gt; products;  <span class="comment">// 通过用户获取其多个物品   </span></div><div class="line">    <span class="meta">@ManyToMany</span>(targetEntity = Product.class)</div><div class="line">    <span class="meta">@JoinTable</span>(name = <span class="string">"user_product_"</span>,</div><div class="line">            joinColumns = <span class="meta">@JoinColumn</span>(name=<span class="string">"uid"</span>), <span class="comment">// user与user_product join</span></div><div class="line">            inverseJoinColumns = <span class="meta">@JoinColumn</span>(name=<span class="string">"pid"</span>)) <span class="comment">// product与user_product 连接</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> products;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="meta">@Table</span>(name = <span class="string">"product_"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Set&lt;User&gt; users;  <span class="comment">//获取拥有该物品的全部用户</span></div><div class="line">  </div><div class="line">    <span class="meta">@ManyToMany</span>(targetEntity = User.class)  </div><div class="line">    <span class="meta">@JoinTable</span>(name = <span class="string">"user_product_"</span>,</div><div class="line">      joinColumns = <span class="meta">@JoinColumn</span>(name = <span class="string">"pid"</span>), <span class="comment">// product 与user_product的关联列是pid</span></div><div class="line">     inverseJoinColumns = <span class="meta">@JoinColumn</span>(name = <span class="string">"uid"</span>)) <span class="comment">// user与user_product的关联列是uid</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Set&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> users;</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h3><p>对数据的修改操作应在事务中进行，以保护数据的完整性。</p><p><img src="http://img.shuaiyy.cn/blog/180411/dL3id7h48j.png?imageslim" alt="mark"></p><p>hibernate.connection.isolation 属性设置事务的隔离级别。</p><h3 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h3><p>通过JDBC的API来实现，具体的方式是实现Work接口的匿名类。</p><p><img src="http://img.shuaiyy.cn/blog/180411/kgkl0h5Cc3.png?imageslim" alt="mark"></p><h3 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h3><p>数据库底层的触发器对Session是透明的，会导致缓存与数据库里的数据不一致。尤其是update()方法，无论游离对象的属性是否变化，都会执行update查询，激活相应的触发器。</p><p>解决方法1、执行数据操作后立即显示的调用flush和refresh方法。2、映射文件的class级别设置属性<code>select-before-update</code>，更新前先检查对象是否发生变化。</p><h3 id="延迟加载"><a href="#延迟加载" class="headerlink" title="延迟加载"></a>延迟加载</h3><ul><li><p>属性延迟加载</p><p>使用load获取对象时，只有第一次访问到了对象的属性，才去数据库里取该对象数据。</p></li><li><p>关系延迟加载</p><p>映射关系的lazy设置为true <code>&lt;</code>setname<code>=</code>“products” lazy<code>=</code>“true”<code>&gt;</code></p></li><li><p>一旦session关闭，访问延时加载的属性就会抛出延时加载异常</p></li></ul><h3 id="级联"><a href="#级联" class="headerlink" title="级联"></a>级联</h3><p>级联一般用在one-many 或many-to-many的关系上，在删除，保存，更新时，同时修改其关联的数据对象。</p><p>比如删除一个分类吗，则该分类下的产品都删除。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">cascade</span>=<span class="string">"delete"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></div></pre></td></tr></table></figure><p>cascade取值常用的有4种：</p><ol><li><p>none，默认值，不级联</p></li><li><p>delete， 删除操作级联</p><p>删除分类时，会将对应cid的product都删除。不级联时，只把cid设置为null。</p></li><li><p>save-update，保存更新时级联</p><p>保存category时，会将其products属性里的product写入数据库</p></li><li><p>all，即删除，保存，更新时级联</p></li><li><p>delete-orphan： 删除所有和当前对象解除关联关系的对象。比如删除一个category，则该分类下的商品都是孤儿，会被删除。</p></li></ol><h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><ul><li><p>一级缓存</p><p>同一session下的相同查询，只访问一次数据库。</p><ul><li>flush()  将缓存中对象的变更同步到数据库，commit事务之后才会执行写数据库。调用commit或执行查询之前都会调用flush方法。但是如果调用save方法，且OID为native生成器生成时，会立即执行sql写入数据库。因为必须访问数据库才能确定OID，所以是直接插入。</li><li>refresh()： 从数据库中更新session缓存</li><li>clear()  清除session缓存</li></ul></li><li><p>二级缓存</p><p>不同session的相同查询，只第一次去数据库取数据</p><p>hibernate本身未实现二级缓存功能，，需要第三方插件，这里使用EhCache</p><ol><li><p>导入ehcache包，并增加二级缓存的配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></div><div class="line">  ...  </div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.cache.use_second_level_cache"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.cache.provider_class"</span>&gt;</span>org.hibernate.cache.EhCacheProvider<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>创建一个ehcache.xml用于EHCache的缓存配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ehcache</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!--  </span></div><div class="line"><span class="comment">    指定一个目录：当 EHCache 把数据写到硬盘上时, 将把数据写到这个目录下.</span></div><div class="line"><span class="comment">    --&gt;</span>     </div><div class="line">    <span class="tag">&lt;<span class="name">diskStore</span> <span class="attr">path</span>=<span class="string">"d:\\tempDirectory"</span>/&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!--Default Cache configuration. These will applied to caches programmatically created through</span></div><div class="line"><span class="comment">        the CacheManager.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">        The following attributes are required for defaultCache:</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">        maxInMemory       - Sets the maximum number of objects that will be created in memory</span></div><div class="line"><span class="comment">        eternal           - Sets whether elements are eternal. If eternal,  timeouts are ignored and the element</span></div><div class="line"><span class="comment">                            is never expired.</span></div><div class="line"><span class="comment">        timeToIdleSeconds - Sets the time to idle for an element before it expires. Is only used</span></div><div class="line"><span class="comment">                            if the element is not eternal. Idle time is now - last accessed time</span></div><div class="line"><span class="comment">        timeToLiveSeconds - Sets the time to live for an element before it expires. Is only used</span></div><div class="line"><span class="comment">                            if the element is not eternal. TTL is now - creation time</span></div><div class="line"><span class="comment">        overflowToDisk    - Sets whether elements can overflow to disk when the in-memory cache</span></div><div class="line"><span class="comment">                            has reached the maxInMemory limit.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">        --&gt;</span></div><div class="line">    <span class="comment">&lt;!--  </span></div><div class="line"><span class="comment">    设置缓存的默认数据过期策略 </span></div><div class="line"><span class="comment">    --&gt;</span>    </div><div class="line">    <span class="tag">&lt;<span class="name">defaultCache</span></span></div><div class="line"><span class="tag">        <span class="attr">maxElementsInMemory</span>=<span class="string">"10000"</span></span></div><div class="line"><span class="tag">        <span class="attr">eternal</span>=<span class="string">"false"</span></span></div><div class="line"><span class="tag">        <span class="attr">timeToIdleSeconds</span>=<span class="string">"120"</span></span></div><div class="line"><span class="tag">        <span class="attr">timeToLiveSeconds</span>=<span class="string">"120"</span></span></div><div class="line"><span class="tag">        <span class="attr">overflowToDisk</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">        /&gt;</span></div><div class="line"></div><div class="line">   <span class="comment">&lt;!--  </span></div><div class="line"><span class="comment">   设定具体的命名缓存的数据过期策略。每个命名缓存代表一个缓存区域</span></div><div class="line"><span class="comment">   缓存区域(region)：一个具有名称的缓存块，可以给每一个缓存块设置不同的缓存策略。</span></div><div class="line"><span class="comment">   如果没有设置任何的缓存区域，则所有被缓存的对象，都将使用默认的缓存策略。即：&lt;defaultCache.../&gt;</span></div><div class="line"><span class="comment">   Hibernate 在不同的缓存区域保存不同的类/集合。</span></div><div class="line"><span class="comment">对于类而言，区域的名称是类名。如:com.atguigu.domain.Customer</span></div><div class="line"><span class="comment">对于集合而言，区域的名称是类名加属性名。如com.atguigu.domain.Customer.orders</span></div><div class="line"><span class="comment">   --&gt;</span></div><div class="line">   <span class="comment">&lt;!--  </span></div><div class="line"><span class="comment">   name: 设置缓存的名字,它的取值为类的全限定名或类的集合的名字 </span></div><div class="line"><span class="comment">maxElementsInMemory: 设置基于内存的缓存中可存放的对象最大数目 </span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">eternal: 设置对象是否为永久的, true表示永不过期,</span></div><div class="line"><span class="comment">此时将忽略timeToIdleSeconds 和 timeToLiveSeconds属性; 默认值是false </span></div><div class="line"><span class="comment">timeToIdleSeconds:设置对象空闲最长时间,以秒为单位, 超过这个时间,对象过期。</span></div><div class="line"><span class="comment">当对象过期时,EHCache会把它从缓存中清除。如果此值为0,表示对象可以无限期地处于空闲状态。 </span></div><div class="line"><span class="comment">timeToLiveSeconds:设置对象生存最长时间,超过这个时间,对象过期。</span></div><div class="line"><span class="comment">如果此值为0,表示对象可以无限期地存在于缓存中. 该属性值必须大于或等于 timeToIdleSeconds 属性值 </span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">overflowToDisk:设置基于内存的缓存中的对象数目达到上限后,是否把溢出的对象写到基于硬盘的缓存中 </span></div><div class="line"><span class="comment">   --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">cache</span> <span class="attr">name</span>=<span class="string">"com.hello.entities.Employee"</span></span></div><div class="line"><span class="tag">        <span class="attr">maxElementsInMemory</span>=<span class="string">"1"</span></span></div><div class="line"><span class="tag">        <span class="attr">eternal</span>=<span class="string">"false"</span></span></div><div class="line"><span class="tag">        <span class="attr">timeToIdleSeconds</span>=<span class="string">"300"</span></span></div><div class="line"><span class="tag">        <span class="attr">timeToLiveSeconds</span>=<span class="string">"600"</span></span></div><div class="line"><span class="tag">        <span class="attr">overflowToDisk</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">        /&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">cache</span> <span class="attr">name</span>=<span class="string">"com.hello.Department.emps"</span></span></div><div class="line"><span class="tag">        <span class="attr">maxElementsInMemory</span>=<span class="string">"1000"</span></span></div><div class="line"><span class="tag">        <span class="attr">eternal</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">        <span class="attr">timeToIdleSeconds</span>=<span class="string">"0"</span></span></div><div class="line"><span class="tag">        <span class="attr">timeToLiveSeconds</span>=<span class="string">"0"</span></span></div><div class="line"><span class="tag">        <span class="attr">overflowToDisk</span>=<span class="string">"false"</span></span></div><div class="line"><span class="tag">        /&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">ehcache</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>在需要缓存的pojo对象的mapping配置里增加一行 <code>&lt;</code>cacheusage<code>=</code>“read-only”/&gt;</p></li></ol></li><li><p>对象缓存机制</p><p>Hibernate的缓存机制，可以通过ID将查询到的对象保存在缓存中。</p><p>但是query.list()的查询结果都是取自数据库的，而不是从缓存中获取已有对象。</p><p>可以通过<strong>N+1</strong>的查询方式，利用缓存。即分2步查询：</p><ul><li>第一步查询获得N条记录，但只取出其ID；</li><li>第二部：如果ID存在缓存中，则从缓存获取对象，否则访问数据库获取ID对应的数据记录。</li></ul><p>具体代码也很简单，query的Iterator对象会先得到ID集合，然后调用next()方法获取对象即可，hibernate自动访问缓存对象。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">String name = <span class="string">"iphone"</span>;</div><div class="line">         </div><div class="line">Query q =s.createQuery(<span class="string">"from Product p where p.name like ?"</span>);</div><div class="line"></div><div class="line">q.setString(<span class="number">0</span>, <span class="string">"%"</span>+name+<span class="string">"%"</span>);</div><div class="line"></div><div class="line">Iterator&lt;Product&gt; it= q.iterate();</div><div class="line"><span class="keyword">while</span>(it.hasNext())&#123;</div><div class="line">  Product p =it.next();</div><div class="line">  System.out.println(p.getName());</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ul><h3 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h3><p>使用Criteria进行分页查询 无论你使用的是Oracle,Mysql,NoSQL还是DB2，分页查询的代码写法都是一样的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">Session s = sf.openSession();</div><div class="line">s.beginTransaction();</div><div class="line"></div><div class="line">String name = <span class="string">"iphone"</span>;</div><div class="line"></div><div class="line">Criteria c= s.createCriteria(Product.class);</div><div class="line"> <span class="comment">//得到滚动结果集</span></div><div class="line">ScrollableResults scroll = c.scroll();</div><div class="line"><span class="comment">//滚动到最后一行</span></div><div class="line">scroll.last();</div><div class="line"><span class="keyword">int</span> total = scroll.getRowNumber() + <span class="number">1</span>; <span class="comment">// 全部记录数</span></div><div class="line"></div><div class="line">c.add(Restrictions.like(<span class="string">"name"</span>, <span class="string">"%"</span>+name+<span class="string">"%"</span>));</div><div class="line"><span class="comment">//起始</span></div><div class="line">c.setFirstResult(<span class="number">2</span>);</div><div class="line"><span class="comment">//每页数量</span></div><div class="line">c.setMaxResults(<span class="number">5</span>);</div><div class="line"></div><div class="line"><span class="comment">// 拿到数据</span></div><div class="line">List&lt;Product&gt; ps = c.list();</div><div class="line"><span class="keyword">for</span> (Product p : ps) &#123;</div><div class="line">  System.out.println(p.getName());</div><div class="line">&#125;</div><div class="line">          </div><div class="line">s.getTransaction().commit();</div></pre></td></tr></table></figure><p>获取总数的另一种方式：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Query q =s.createQuery(<span class="string">"select count(*) from Product p where p.name like ?"</span>);</div><div class="line">q.setString(<span class="number">0</span>, <span class="string">"%"</span>+name+<span class="string">"%"</span>);</div><div class="line"><span class="keyword">long</span> total= (Long) q.uniqueResult();</div><div class="line">System.out.println(total);</div></pre></td></tr></table></figure><h3 id="OpenSession"><a href="#OpenSession" class="headerlink" title="OpenSession"></a>OpenSession</h3><p>获取session有两种方式： openSession 和getCurrentSession</p><ol><li>openSession每次都会得到一个新的Session对象， 只有在增加，删除，修改的时候需要事务，查询时不需要的 。</li><li>getCurrentSession在同一个线程中，每次都是获取相同的Session对象，但是在不同的线程中获取的是不同的Session对象 。getCurrentSession是所有操作都<strong>必须</strong>放在<strong>事务</strong>中进行，并且提交事务后，session就<strong>自动关闭</strong>，不能够调用close方法。 </li></ol><h3 id="乐观锁"><a href="#乐观锁" class="headerlink" title="乐观锁"></a>乐观锁</h3><p>数据库锁机制是为了保护数据完整性，防止产生脏数据的。</p><p>以脏读数据为例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">i = <span class="number">0</span>;</div><div class="line">session1&#123;</div><div class="line">  get i;</div><div class="line">  i++; <span class="comment">// i=1</span></div><div class="line">&#125;</div><div class="line">session2&#123;</div><div class="line">  get i;</div><div class="line">  i++; <span class="comment">// i=1</span></div><div class="line">&#125;</div><div class="line">session1.commit()</div><div class="line">session1.commit()</div><div class="line"><span class="comment">// 两次相加后i仍是1，而不是2.因为session在未提交时，没写回最新数据，旧数据又被读出</span></div></pre></td></tr></table></figure><p> 实现乐观锁的核心，版本控制：</p><ol><li><p>为product pojo 增加version属性。</p></li><li><p>在mapping配置中，增加version节点，version必须紧挨着id节点的下一个。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">  <span class="comment">&lt;!--version元素必须紧挨着id后面  --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">version</span> <span class="attr">name</span>=<span class="string">"version"</span> <span class="attr">column</span>=<span class="string">"ver"</span> <span class="attr">type</span>=<span class="string">"int"</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">class</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li></ol><h3 id="连接池"><a href="#连接池" class="headerlink" title="连接池"></a>连接池</h3><p>导入c3p0包hibernate-c3p0，使用c3p0连接池，在cfg配置文件的session-factory中添加如下配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--&lt;property name="hibernate.connection.provider_class"&gt;--&gt;</span></div><div class="line">            <span class="comment">&lt;!--org.hibernate.c3p0.internal.C3P0ConnectionProvider--&gt;</span></div><div class="line">        <span class="comment">&lt;!--&lt;/property&gt;--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.max_size"</span>&gt;</span>20<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.min_size"</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.timeout"</span>&gt;</span>50000<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.max_statements"</span>&gt;</span>100<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.idle_test_period"</span>&gt;</span>3000<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 当连接池耗尽并接到获得连接的请求，则新增加连接的数量 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.acquire_increment"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 是否验证，检查连接 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.validate"</span>&gt;</span>false<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div></pre></td></tr></table></figure><h1 id="Spring-Hibernate"><a href="#Spring-Hibernate" class="headerlink" title="Spring + Hibernate"></a>Spring + Hibernate</h1><p>由spring管理bean对象 和SessionFactory对象</p><ol><li><p>数据库连接池</p></li><li><p>Hibernate SessionFactory</p></li><li><p>session bean</p><p>hibernate3需要一个继承 <code>HibernateTemplate</code>的子类来接收SessionFactory的注入</p><p>hibernate4不在需要由spring提供HibernateTemplate类的支持，使用原生的hibernate API更好。</p><p>因此可以在dao中直接获取sessionFactory使用session创建query查询。</p></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 连接池 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/test?characterEncoding=UTF-8"</span>/&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate5.LocalSessionFactoryBean"</span>&gt;</span></div><div class="line">     <span class="comment">&lt;!-- 指定Hibernate配置文件的路径， 或者使用 property name="hibernateProperties"--&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"hibernate.cfg.xml"</span>/&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></div><div class="line">     <span class="comment">&lt;!-- 指定映射文件的位置 --&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappingResources"</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">list</span>&gt;</span></div><div class="line">               <span class="tag">&lt;<span class="name">value</span>&gt;</span>cn/shuaiyy/pojo/Category.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">               <span class="tag">&lt;<span class="name">value</span>&gt;</span>cn/shuaiyy/pojo/Product.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">               <span class="tag">&lt;<span class="name">value</span>&gt;</span>cn/shuaiyy/pojo/User.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">           <span class="tag">&lt;/<span class="name">list</span>&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">value</span>&gt;</span></div><div class="line">               hibernate.dialect=org.hibernate.dialect.MySQLDialect</div><div class="line">               hibernate.show_sql=true</div><div class="line">               hbm2ddl.auto=update</div><div class="line">           <span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">   </div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"dao"</span> <span class="attr">class</span>=<span class="string">"cn.shuaiyy.dao.DAO"</span>&gt;</span></div><div class="line">       <span class="comment">&lt;!-- 为dao注入sessionFactory属性 --&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sessionFactory"</span>/&gt;</span> </div><div class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"></div><div class="line">   <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"cn.shuaiyy.pojo"</span>/&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></div></pre></td></tr></table></figure><ol><li><p>测试</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testSpring</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">        ApplicationContext context = <span class="keyword">new</span>  ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</div><div class="line">        DAO dao = (DAO) context.getBean(<span class="string">"dao"</span>);</div><div class="line">        Product p = dao.get(Product.class, <span class="number">1</span>);</div><div class="line"></div><div class="line">        SessionFactory sf = (SessionFactory) context.getBean(<span class="string">"sessionFactory"</span>);</div><div class="line">        Session session =  sf.openSession();</div><div class="line">        System.out.println(session.get(Product.class, <span class="number">1</span>).toString());</div><div class="line">        System.out.println(p.getName());</div><div class="line">        List&lt;Category&gt; cs = (List&lt;Category&gt;) session.createQuery(<span class="string">"from Category c "</span>).list();</div><div class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</div><div class="line">            System.out.println(c.getName());</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p>​</p></li></ol><h1 id="Spring-SpringMVC-Hibernate"><a href="#Spring-SpringMVC-Hibernate" class="headerlink" title="Spring + SpringMVC + Hibernate"></a>Spring + SpringMVC + Hibernate</h1>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Hibernate入门&quot;&gt;&lt;a href=&quot;#Hibernate入门&quot; class=&quot;headerlink&quot; title=&quot;Hibernate入门&quot;&gt;&lt;/a&gt;Hibernate入门&lt;/h1&gt;&lt;p&gt;一个Java 领域的持久化框架，ORM 框架。&lt;/p&gt;
&lt;p&gt;“持久化”包括和数据库相关的各种操作：增删查改，根据OID加载对象。&lt;/p&gt;
&lt;h2 id=&quot;Hello-World&quot;&gt;&lt;a href=&quot;#Hello-World&quot; class=&quot;headerlink&quot; title=&quot;Hello World&quot;&gt;&lt;/a&gt;Hello World&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;创建数据库表和POJO对象 Product.java&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;配置POJO到table的映射关系 &lt;code&gt;Product.hbm.xml&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot;?&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;lt;!DOCTYPE hibernate-mapping PUBLIC&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;        &quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;        &quot;http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd&quot;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;hibernate-mapping&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;package&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;cn.shuaiyy.pojo&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;Product&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;table&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;product_&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;id&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;column&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;id&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;generator&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;native&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;generator&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;property&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;property&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;price&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;class&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;hibernate-mapping&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="技术" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/"/>
    
      <category term="Hibernate" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/Hibernate/"/>
    
    
      <category term="Java" scheme="http://shuaiyy.cn/tags/Java/"/>
    
      <category term="ORM" scheme="http://shuaiyy.cn/tags/ORM/"/>
    
      <category term="Hibernate" scheme="http://shuaiyy.cn/tags/Hibernate/"/>
    
  </entry>
  
  <entry>
    <title>IDEA创建Java Web项目</title>
    <link href="http://shuaiyy.cn/2018/02/11/%E5%B7%A5%E5%85%B7/IDEA%E5%88%9B%E5%BB%BAWEB%E9%A1%B9%E7%9B%AE/"/>
    <id>http://shuaiyy.cn/2018/02/11/工具/IDEA创建WEB项目/</id>
    <published>2018-02-10T16:00:00.000Z</published>
    <updated>2018-11-27T04:58:51.763Z</updated>
    
    <content type="html"><![CDATA[<h3 id="IDEA创建WEB项目"><a href="#IDEA创建WEB项目" class="headerlink" title="IDEA创建WEB项目"></a>IDEA创建WEB项目</h3><ul><li><p>new project  &gt; web application</p><p><img src="http://img.shuaiyy.cn/blog/180304/BHKlfgKFHm.png?imageslim" alt="mark"></p></li><li><p>更改编译输出的目录，引入项目依赖的包</p><p><code>ctrl alt shift s</code> 打开project structure：</p><p><img src="http://img.shuaiyy.cn/blog/180304/mBkJHl4hEB.png?imageslim" alt="mark"></p><a id="more"></a></li><li><p>配置Tomcat 和项目自动部署</p><ol><li><p>edit configure，添加Tomcat服务器</p><p><img src="http://img.shuaiyy.cn/blog/180304/36IbcHd940.png?imageslim" alt="mark"> </p></li><li><p>在deployment选项卡下，添加Artifact</p><p><img src="http://img.shuaiyy.cn/blog/180304/f3IemdEIJl.png?imageslim" alt="mark"> </p></li><li><p>选中server选项卡，配置项目自动更新和部署</p><p><img src="http://img.shuaiyy.cn/blog/180304/iDikH9FG70.png?imageslim" alt="mark"> </p></li><li><p>应用设置后，运行Tomcat</p><p><img src="http://img.shuaiyy.cn/blog/180304/KC6EHbmG3D.png?imageslim" alt="mark"></p></li></ol></li><li><p>修改webapp的部署路径</p><p>修改<strong>Project Structure—&gt;Artifacts</strong>中的<strong>Output</strong>的目录，如改到tomat的webapps下。</p></li></ul><h3 id="Java普通项目转为-Web-Application"><a href="#Java普通项目转为-Web-Application" class="headerlink" title="Java普通项目转为 Web Application"></a>Java普通项目转为 Web Application</h3><ul><li><p>新建一个java普通项目</p></li><li><p>从已有的web项目中，将webapp文件夹复制到普通java项目中</p></li><li><p>File-&gt;project structure-&gt;Facts，然后点击绿色的“+”号，点击web，</p><p>在右侧框中，上半部分的路径修改为web.xml的路径，下半部分的路径修改为webapp文件夹的路径</p><p>如果有黄色的！，则fix -&gt; created。创建的artifacts中<strong>Output</strong>路径定位到web一级。</p></li><li><p>edit configure，配置Tomcat服务器和Deployment设置。</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;IDEA创建WEB项目&quot;&gt;&lt;a href=&quot;#IDEA创建WEB项目&quot; class=&quot;headerlink&quot; title=&quot;IDEA创建WEB项目&quot;&gt;&lt;/a&gt;IDEA创建WEB项目&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;new project  &amp;gt; web application&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.shuaiyy.cn/blog/180304/BHKlfgKFHm.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;更改编译输出的目录，引入项目依赖的包&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ctrl alt shift s&lt;/code&gt; 打开project structure：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.shuaiyy.cn/blog/180304/mBkJHl4hEB.png?imageslim&quot; alt=&quot;mark&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="工具" scheme="http://shuaiyy.cn/categories/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="IDEA" scheme="http://shuaiyy.cn/categories/%E5%B7%A5%E5%85%B7/IDEA/"/>
    
    
      <category term="Java" scheme="http://shuaiyy.cn/tags/Java/"/>
    
      <category term="IDEA" scheme="http://shuaiyy.cn/tags/IDEA/"/>
    
  </entry>
  
  <entry>
    <title>Java J2EE</title>
    <link href="http://shuaiyy.cn/2018/02/10/%E6%8A%80%E6%9C%AF/J2EE/"/>
    <id>http://shuaiyy.cn/2018/02/10/技术/J2EE/</id>
    <published>2018-02-09T16:00:00.000Z</published>
    <updated>2018-11-27T04:47:53.350Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h3><h4 id="下载Tomcat"><a href="#下载Tomcat" class="headerlink" title="下载Tomcat"></a>下载Tomcat</h4><p>进入官网<a href="http://tomcat.apache.org/，选择download，下载所需Tomcat版本。" target="_blank" rel="external">http://tomcat.apache.org/，选择download，下载所需Tomcat版本。</a></p><p>我用的是Tomcat7，core x64 zip。不同版本的比较参考<a href="http://tomcat.apache.org/whichversion.html" target="_blank" rel="external">官网</a>。</p><p>解压后，点击bin里的startup.bat运行，访问<a href="http://127.0.0.1:8080，可以看到欢迎界面，运行shutdown.bat关闭Tomcat。" target="_blank" rel="external">http://127.0.0.1:8080，可以看到欢迎界面，运行shutdown.bat关闭Tomcat。</a></p><h4 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h4><ul><li><p>在系统变量里添加2个变量 CATALINA_BASE，CATALINA_HOME</p><p><strong>变量名：CATALINA_BASE</strong></p><p><strong>变量值：C:\Program Files\Java\apache-tomcat-7.0.85       //Tomcat安装目录</strong></p><p><strong>变量名：CATALINA_HOME</strong></p><p><strong>变量值：C:\Program Files\Java\apache-tomcat-7.0.85</strong></p></li><li><p>修改classpath和path</p><p>在ClassPath的变量值中加入：<code>%CATALINA_HOME%\lib\servlet-api.jar;</code>（注意加的时候在原变量值后加<code>;</code>）</p><p>在path中添加 <code>%CATALINA_HOME%\bin;%CATALINA_HOME%\lib;</code></p></li><li><p>验证</p><p>新打开一个cmd，输入startup：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20189</span>&gt;startup</div><div class="line">Using CATALINA_BASE:   <span class="string">"C:\Program Files\Java\apache-tomcat-7.0.85"</span></div><div class="line">Using CATALINA_HOME:   <span class="string">"C:\Program Files\Java\apache-tomcat-7.0.85"</span></div><div class="line">Using CATALINA_TMPDIR: <span class="string">"C:\Program Files\Java\apache-tomcat-7.0.85\temp"</span></div><div class="line">Using JRE_HOME:        <span class="string">"C:\Program Files\Java\jdk1.8.0_151"</span></div><div class="line">Using CLASSPATH:       <span class="string">"C:\Program Files\Java\apache-tomcat-7.0.85\bin\bootstrap.jar;C:\Program Files\Java\apache-tomcat-7.0.85\bin\tomcat-juli.jar"</span></div></pre></td></tr></table></figure></li></ul><a id="more"></a><h4 id="Tomcat的配置文件"><a href="#Tomcat的配置文件" class="headerlink" title="Tomcat的配置文件"></a>Tomcat的配置文件</h4><p>在conf目录下，server.xml中修改端口号和webapps所在的目录</p><p>Host下增加<code>&lt;Context path=&quot;/web&quot; reloadable=&quot;false&quot; docBase=&quot;D:\\j2ee\\web&quot; /&gt;</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span></span></div><div class="line"><span class="tag">               <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span></span></div><div class="line"><span class="tag">               <span class="attr">redirectPort</span>=<span class="string">"8443"</span> /&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">Host</span> <span class="attr">name</span>=<span class="string">"localhost"</span>  <span class="attr">appBase</span>=<span class="string">"webapps"</span></span></div><div class="line"><span class="tag">            <span class="attr">unpackWARs</span>=<span class="string">"true"</span> <span class="attr">autoDeploy</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">"/web"</span> <span class="attr">reloadable</span>=<span class="string">"false"</span> <span class="attr">docBase</span>=<span class="string">"D:\\j2ee\\web"</span> /&gt;</span> </div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- SingleSignOn valve, share authentication between web applications</span></div><div class="line"><span class="comment">             Documentation at: /docs/config/valve.html --&gt;</span></div><div class="line">        <span class="comment">&lt;!--</span></div><div class="line"><span class="comment">        &lt;Valve className="org.apache.catalina.authenticator.SingleSignOn" /&gt;</span></div><div class="line"><span class="comment">        --&gt;</span></div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- Access log processes all example.</span></div><div class="line"><span class="comment">             Documentation at: /docs/config/valve.html</span></div><div class="line"><span class="comment">             <span class="doctag">Note:</span> The pattern used is equivalent to using pattern="common" --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Valve</span> <span class="attr">className</span>=<span class="string">"org.apache.catalina.valves.AccessLogValve"</span> <span class="attr">directory</span>=<span class="string">"logs"</span></span></div><div class="line"><span class="tag">               <span class="attr">prefix</span>=<span class="string">"localhost_access_log."</span> <span class="attr">suffix</span>=<span class="string">".txt"</span></span></div><div class="line"><span class="tag">               <span class="attr">pattern</span>=<span class="string">"%h %l %u %t &amp;quot;%r&amp;quot; %s %b"</span> /&gt;</span></div><div class="line"></div><div class="line">      <span class="tag">&lt;/<span class="name">Host</span>&gt;</span></div></pre></td></tr></table></figure><p>cmd查看端口占用并kill相关进程</p><ul><li>查看端口占用进程的pid <code>netstat -ano|findstr &quot;80&quot;</code> </li><li>找到对应PID的进程详情<code>tasklist|findstr &quot;1828&quot;</code></li><li>根据进程名kill进程 <code>taskkill /f /t /im java.exe</code></li></ul><h4 id="在IDEA中配置Tomcat"><a href="#在IDEA中配置Tomcat" class="headerlink" title="在IDEA中配置Tomcat"></a>在IDEA中配置Tomcat</h4><ol><li><p>点击Run-Edit Configurations…</p></li><li><p>点击左侧“+”，选择Tomcat Server–Local</p></li><li><p>在Tomcat Server -&gt; Unnamed -&gt; Server -&gt; Application server下，点击 Configuration ，找到本地 Tomcat 服务器所在目录，点击 OK按钮。还可以修改name，端口号等其他配置。</p><p><img src="http://img.shuaiyy.cn/blog/180302/f2HLdDC7fc.png?imageslim" alt="mark"></p></li></ol><h4 id="IDEA中部署webapp到Tomcat"><a href="#IDEA中部署webapp到Tomcat" class="headerlink" title="IDEA中部署webapp到Tomcat"></a>IDEA中部署webapp到Tomcat</h4><h3 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h3><h4 id="简单的Servlet"><a href="#简单的Servlet" class="headerlink" title="简单的Servlet"></a>简单的Servlet</h4><p>项目结构：</p><p><img src="http://img.shuaiyy.cn/blog/180303/KDJm2I6hD8.png?imageslim" alt="mark"></p><ul><li><p>创建目录<code>web\WEB-INF\classes</code> ，将Servlet类的编译文件输出到classes目录下。</p><p>IDEA修改项目编译输出的位置：“ ctrl alt shift s” 打开project structure，module  -&gt; Paths </p></li><li><p>与classes同级的位置创建<code>web.xml</code>配置文件，配置Servlet类的URL映射。</p></li></ul><ul><li><p>HelloServlet.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.util.Date;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            resp.getWriter().println(<span class="string">"&lt;h1&gt;Hello World！&lt;/h1&gt; &lt;br&gt;"</span>);</div><div class="line">            resp.getWriter().println(<span class="keyword">new</span> Date().toString());</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p><code>web/WEB-INF/web.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- URL映射 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p><code>Tomcat/conf/server.xml</code></p><p>Tomcat的<code>server.xml</code>中配置网站的prefix URL和对应的web文件目录。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Host</span> <span class="attr">name</span>=<span class="string">"localhost"</span>  <span class="attr">appBase</span>=<span class="string">"webapps"</span> <span class="attr">unpackWARs</span>=<span class="string">"true"</span> <span class="attr">autoDeploy</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- webapp的前缀URL和对应的webapp的位置 --&gt;</span> </div><div class="line">              <span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">"/web"</span> <span class="attr">reloadable</span>=<span class="string">"false"</span> <span class="attr">docBase</span>=<span class="string">"C:\Users\20189\IdeaProjects\HelloWeb\web"</span> /&gt;</span></div></pre></td></tr></table></figure></li></ul><h4 id="request和response对象"><a href="#request和response对象" class="headerlink" title="request和response对象"></a>request和response对象</h4><ul><li><p>定义处理get 、post请求</p><p>重写HttpServlet的doGet、doPost方法,或者使用service方法，会自动判读get、post请求</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span>&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span>&#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>获取参数和中文解析</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">request.setCharacterEncoding(<span class="string">"utf-8"</span>); <span class="comment">// 最开始设置编码后，就不用对每个参数都中文解码了</span></div><div class="line"></div><div class="line">String username = request.getParameter(<span class="string">"username"</span>); <span class="comment">// get ,post 获取参数方式一样</span></div><div class="line">        <span class="comment">//中文参数解码</span></div><div class="line"><span class="comment">//        byte[] bytes=  username.getBytes("ISO-8859-1");</span></div><div class="line"><span class="comment">//        username = new String(bytes,"UTF-8");</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>返回响应</p><p>html标签要齐全，必须在头文件中声明html格式内容，这样浏览器才能正常解析</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 返回的响应支持中文编码</span></div><div class="line">response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>); <span class="comment">// 设置内容格式和编码格式</span></div><div class="line">response.setCharacterEncoding(<span class="string">"UTF-8"</span>); <span class="comment">//设置编码格式的</span></div><div class="line">PrintWriter pw = response.getWriter();</div><div class="line">pw.println(html);</div></pre></td></tr></table></figure></li><li><p>URL跳转</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 让Servlet进行页面跳转, 浏览器的url改变 302临时跳转</span></div><div class="line">        response.sendRedirect(<span class="string">"fail.html"</span>);</div><div class="line"><span class="comment">// 301永久重定向, url跳转</span></div><div class="line">        response.setStatus(<span class="number">301</span>);</div><div class="line">        response.setHeader(<span class="string">"Location"</span>, <span class="string">"404.html"</span>);</div><div class="line"></div><div class="line"><span class="comment">//服务器页面跳转，浏览器地址中的地址不变</span></div><div class="line">        request.getRequestDispatcher(<span class="string">"success.html"</span>).forward(request, response);</div></pre></td></tr></table></figure></li><li><p>常用方法</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// 获取ip 端口等，默认的端口80，取到的值为空</span></div><div class="line"></div><div class="line">    System.out.println(<span class="string">"完整的URL请求（协议、主机名、端口）: "</span> + request.getRequestURL());</div><div class="line">    System.out.println(<span class="string">"请求的资源名部分，去掉了协议和主机名: "</span> + request.getRequestURI());</div><div class="line">    System.out.println(<span class="string">"请求行中的参数部分: "</span> + request.getQueryString());</div><div class="line">    System.out.println(<span class="string">"浏览器所处于的客户机的IP地址: "</span> + request.getRemoteAddr());</div><div class="line">    System.out.println(<span class="string">"浏览器所处于的客户机的主机名: "</span> + request.getRemoteHost());</div><div class="line">    System.out.println(<span class="string">"浏览器所处于的客户机使用的网络端口: "</span> + request.getRemotePort());</div><div class="line">    System.out.println(<span class="string">"服务器的IP地址: "</span> + request.getLocalAddr());</div><div class="line">    System.out.println(<span class="string">"服务器的主机名: "</span> + request.getLocalName());</div><div class="line">    System.out.println(<span class="string">"得到客户机请求方式: "</span> + request.getMethod());</div><div class="line"><span class="comment">// 获取浏览器头信息</span></div><div class="line">        Enumeration&lt;String&gt; headerNames= request.getHeaderNames();</div><div class="line">        <span class="keyword">while</span>(headerNames.hasMoreElements())&#123;</div><div class="line">            String header = headerNames.nextElement();</div><div class="line">            String value = request.getHeader(header);</div><div class="line">            System.out.printf(<span class="string">"%s\t%s%n"</span>,header,value);</div><div class="line">        &#125;</div><div class="line"><span class="comment">// 获取用户提交的参数</span></div><div class="line">        Map&lt;String, String[]&gt; parameters = request.getParameterMap();</div><div class="line"></div><div class="line">        Set&lt;String&gt; paramNames = parameters.keySet();</div><div class="line">        <span class="keyword">for</span> (String param : paramNames) &#123;</div><div class="line">            String[] value = parameters.get(param);</div><div class="line">            System.out.println(param + <span class="string">":"</span> + Arrays.asList(value));</div><div class="line">        &#125;</div><div class="line"><span class="comment">// 设置编码格式，第一种会要求浏览器也使用utf-8编码</span></div><div class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</div><div class="line">        response.setCharacterEncoding(<span class="string">"UTF-8"</span>);</div><div class="line"><span class="comment">// 浏览器不缓存页面</span></div><div class="line">        response.setDateHeader(<span class="string">"Expires"</span>,<span class="number">0</span> );</div><div class="line">        response.setHeader(<span class="string">"Cache-Control"</span>,<span class="string">"no-cache"</span>);</div><div class="line">        response.setHeader(<span class="string">"pragma"</span>,<span class="string">"no-cache"</span>);</div></pre></td></tr></table></figure><h4 id="Servlet实例化与生命周期"><a href="#Servlet实例化与生命周期" class="headerlink" title="Servlet实例化与生命周期"></a>Servlet实例化与生命周期</h4><p>一个Servlet的生命周期由 实例化，初始化，提供服务，销毁，被回收 几个步骤组成。</p><ul><li><p>实例化</p><p>一个servlet在webapp启动后只会被实例化一次。</p></li><li><p>初始化</p><p>覆写HttpServlet的init方法，可以在servlet被实例化时执行初始化相关代码。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"init(ServletConfig)"</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>提供服务</p><p>通过service或者doPost doGet方法提供http服务</p></li><li><p>销毁和GC回收</p><p>web应用重启时 或Tomcat服务器关闭时，销毁。</p><p>在server.xml中配置改为reloadable=”true”，任何类发生更新，则web应用自动重启。</p><p><code>&lt;Context path=&quot;/&quot; docBase=&quot;e:\\web&quot; debug=&quot;0&quot; reloadable=&quot;true&quot; /&gt;</code></p></li></ul><h4 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h4><ol><li><p>Post表单上传文件，提交数据为二进制文件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/upload"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></div><div class="line">  英雄名称:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"userName"</span> /&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">  上传头像 : <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"filepath"</span> /&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"上传"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>导入依赖包</p><p>下载第三方的jar包，commons-io.jar和commons-fileupload.jar,放在WEB-INF/lib下.然后在项目中引入。</p></li><li><p>UploadServlet</p><p>获取文件流，定义文件名，获取相对路径和存储位置，保存文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileUploadServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</div><div class="line">        String filename = <span class="keyword">null</span>; <span class="comment">// 不能直接使用上传文件的文件名，以免重复</span></div><div class="line">        DiskFileItemFactory factory = <span class="keyword">new</span> DiskFileItemFactory();</div><div class="line">        factory.setSizeThreshold(<span class="number">1024</span>*<span class="number">1024</span>*<span class="number">5</span>); <span class="comment">// 上传大小不超过5M</span></div><div class="line">        ServletFileUpload upload = <span class="keyword">new</span> ServletFileUpload(factory);</div><div class="line">        List items = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            items = upload.parseRequest(request);</div><div class="line">        &#125; <span class="keyword">catch</span> (FileUploadException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        Iterator iter = items.iterator();</div><div class="line">        <span class="keyword">while</span> (iter.hasNext())&#123;</div><div class="line">            FileItem item = (FileItem) iter.next();</div><div class="line">            <span class="keyword">if</span> (!item.isFormField())&#123; <span class="comment">// 不是表单域，即上传的文件</span></div><div class="line">                filename = System.currentTimeMillis() + <span class="string">".jpg"</span>; <span class="comment">// 自定义存储文件名</span></div><div class="line">                <span class="comment">//通过getRealPath获取上传文件夹，如果项目在./web,那么就会自动获取到 ./web/uploaded</span></div><div class="line">                String photoFolder =request.getServletContext().getRealPath(<span class="string">"uploaded"</span>);</div><div class="line">                System.out.println(photoFolder);</div><div class="line">                File f = <span class="keyword">new</span> File(photoFolder, filename);</div><div class="line">                f.getParentFile().mkdirs();</div><div class="line"></div><div class="line">                InputStream is = item.getInputStream();</div><div class="line">                FileOutputStream fout = <span class="keyword">new</span> FileOutputStream(f);</div><div class="line">                <span class="keyword">byte</span> b[] = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>*<span class="number">1024</span>];</div><div class="line">                <span class="keyword">int</span> length = <span class="number">0</span>;</div><div class="line">                <span class="keyword">while</span> ((length = is.read(b)) != -<span class="number">1</span>)&#123;</div><div class="line">                    fout.write(b, <span class="number">0</span>, length);</div><div class="line">                &#125;</div><div class="line">                fout.close();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span>&#123;  <span class="comment">// 处理表单域</span></div><div class="line">                System.out.println(item.getFieldName());</div><div class="line">                <span class="comment">// 中文处理</span></div><div class="line">                String value = <span class="keyword">new</span> String(item.getString().getBytes(<span class="string">"iso-8859-1"</span>), <span class="string">"utf-8"</span>);</div><div class="line">                System.out.println(value);</div><div class="line">            &#125;</div><div class="line">        &#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>处理不是File的字段</p><p>由于form提交的是二进制数据，因此无法使用<code>request.getParameter(&quot;XXX&quot;)</code>,  使用item取出的值如果有中文，还需要进行编码处理。</p></li><li><p>在<code>web.xml</code>中配置servlet和URL路由。</p></li></ol><h4 id="使用JQuery和JSON提交数据"><a href="#使用JQuery和JSON提交数据" class="headerlink" title="使用JQuery和JSON提交数据"></a>使用JQuery和JSON提交数据</h4><ol><li><p>下载json-lib包，放入WEB-INF/lib目录，并在项目中导入json包</p><p>要使用json-lib，必须同时导入其依赖的另外5个包：</p><p><strong>commons</strong> -beanutils-1.8.3.jar   commons -lang -2.5.jar  commons -logging.jar  commons-collections-3.1.jar    ezmorph-1.0.6.jar</p><p>不然使用json-lib库会报错，<code>java.lang.ClassNotFoundException</code> </p><p>maven项目可以设置自动导入相关依赖包。</p></li><li><p>html前端使用jQuery ajax异步post提交数据</p><p>导入JQuery包</p><p>form中使用button，不使用submit input。submit按钮点击后就会自动提交。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"form-data"</span>&gt;</span></div><div class="line">       用户名称： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>  <span class="attr">placeholder</span>=<span class="string">"用户名"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">       年龄： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"year"</span> &gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"以json方式提交"</span> <span class="attr">id</span>=<span class="string">"json-post"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="javascript">    $(<span class="string">"#json-post"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></div><div class="line"><span class="javascript">        <span class="keyword">var</span> url = <span class="string">"json"</span>;</span></div><div class="line"><span class="javascript">        <span class="keyword">var</span> username = $(<span class="string">"#form-data input[name='username']"</span>).val();</span></div><div class="line"><span class="javascript">        <span class="keyword">var</span> year = $(<span class="string">"#form-data input[name='year']"</span>).val();</span></div><div class="line"><span class="javascript">        <span class="keyword">var</span> data=&#123;<span class="string">"username"</span>:username,<span class="string">"year"</span>:year&#125;;</span></div><div class="line"><span class="javascript">        <span class="built_in">console</span>.log(username);</span></div><div class="line"><span class="javascript">        <span class="built_in">console</span>.log(year);</span></div><div class="line"><span class="javascript">        $.post(</span></div><div class="line"><span class="undefined">            url,</span></div><div class="line"><span class="javascript">            &#123;<span class="string">"data"</span>: <span class="built_in">JSON</span>.stringify(data)&#125;,</span></div><div class="line"><span class="javascript">            <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span></div><div class="line"><span class="javascript">                alert(<span class="string">"已经提交数据"</span>);</span></div><div class="line"><span class="javascript">                <span class="built_in">console</span>.log(res);</span></div><div class="line"><span class="undefined">            &#125;);</span></div><div class="line"><span class="undefined">    &#125;);</span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></li><li><p>编写servlet，配置路由</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> net.sf.json.JSONObject;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JsonServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</div><div class="line">        String data = req.getParameter(<span class="string">"data"</span>);</div><div class="line">        JSONObject json = JSONObject.fromObject(data);</div><div class="line">        System.out.println(<span class="string">"data: "</span>+ data);</div><div class="line">        System.out.println(<span class="string">"json: "</span>+ json);</div><div class="line"><span class="comment">//        Hero hero = (Hero)JSONObject.toBean(json,Hero.class);</span></div><div class="line"><span class="comment">//        System.out.println("转换为Hero对象之后是："+hero);</span></div><div class="line">      </div><div class="line">        resp.getWriter().println(<span class="string">"submit success!"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ol><h4 id="使用json和JQuery获取对象"><a href="#使用json和JQuery获取对象" class="headerlink" title="使用json和JQuery获取对象"></a>使用json和JQuery获取对象</h4><ol><li><p>jquery代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"data"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"获取json对象"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="javascript">  $(<span class="string">"input"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></div><div class="line"><span class="javascript">    <span class="keyword">var</span> url = <span class="string">"getdata"</span>;</span></div><div class="line"><span class="javascript">    $.post(</span></div><div class="line"><span class="undefined">    url,</span></div><div class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span></div><div class="line"><span class="javascript">        <span class="keyword">var</span> man = <span class="built_in">JSON</span>.parse(res);</span></div><div class="line"><span class="javascript">        $(<span class="string">"#data"</span>).html(<span class="string">"名字："</span> + man.name + <span class="string">"&lt;br&gt;年龄:"</span> + man.year);</span></div><div class="line"><span class="undefined">      &#125;);</span></div><div class="line"><span class="undefined">  &#125;);</span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>servlet</p><p>创建一个Hero对象并将其转换为JSONObject对象，用个一个新的JSONObject对象存放Hero JSONObject，其key值为man。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> net.sf.json.JSONObject; </div><div class="line">   </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetOneServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123; </div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span></div><div class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</div><div class="line">          </div><div class="line">        Hero hero = <span class="keyword">new</span> Hero();</div><div class="line">        hero.setName(<span class="string">"盖伦"</span>);</div><div class="line">        hero.setYear(<span class="number">353</span>);</div><div class="line">         </div><div class="line">        JSONObject json= <span class="keyword">new</span> JSONObject();</div><div class="line">        json.put(<span class="string">"hero"</span>, JSONObject.fromObject(hero));</div><div class="line">      </div><div class="line">        response.setContentType(<span class="string">"text/html;charset=utf-8"</span>); </div><div class="line">        response.getWriter().print(json);</div><div class="line">    &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ol><p><strong>获取多个对象，JSON数组</strong></p><ol><li><p>jQuery代码, 通过<code>$.parseJSON</code>转换为json数组</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#sender'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </div><div class="line">        <span class="keyword">var</span> url=<span class="string">"getdata"</span>; </div><div class="line">        $.post(</div><div class="line">                url,</div><div class="line">                <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">                    <span class="keyword">var</span> heros = $.parseJSON(data);</div><div class="line">                     <span class="keyword">for</span>(i <span class="keyword">in</span> heros)&#123;</div><div class="line">                         <span class="keyword">var</span> oldHtml = $(<span class="string">"#data"</span>).html();</div><div class="line">                         <span class="keyword">var</span> hero = heros[i];</div><div class="line">                         $(<span class="string">"#data"</span>).html(oldHtml + <span class="string">"&lt;br&gt;"</span>+hero.name+<span class="string">"   -----   "</span>+hero.hp); </div><div class="line">                     &#125;</div><div class="line">         &#125;);  </div><div class="line">    &#125;);</div></pre></td></tr></table></figure></li><li><p>servlet</p><p>将10个Hero对象的集合，通过<code>JSONSerializer.toJSON(heros)</code>转化为JSON字符串,然后返回给浏览器。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> net.sf.json.JSONSerializer; </div><div class="line">   </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetManyServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123; </div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span></div><div class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</div><div class="line">        List&lt;Hero&gt; heros = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">            Hero hero = <span class="keyword">new</span> Hero();</div><div class="line">            hero.setName(<span class="string">"name"</span>+i);</div><div class="line">            hero.setYear(<span class="number">500</span>+i);</div><div class="line">            heros.add(hero);</div><div class="line">        &#125;</div><div class="line">         </div><div class="line">        String result =JSONSerializer.toJSON(heros).toString();</div><div class="line"> </div><div class="line">        response.setContentType(<span class="string">"text/html;charset=utf-8"</span>); </div><div class="line">        response.getWriter().print(result);</div><div class="line">    &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ol><h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h3><h4 id="请求头"><a href="#请求头" class="headerlink" title="请求头"></a>请求头</h4><p>Host: 主机名<br>Use-Agent: 浏览器基本资料<br>Accept: 浏览器能够识别的响应类型<br>Accept-Language: 浏览器默认语言<br>Accept-Encoding: 浏览器能够识别的压缩方式<br>Referer: 来路页面， /addHero 这个路径是通过addHero.html这个页面跳转过来的。<br>Connecton：是否保持连接</p><h4 id="请求数据"><a href="#请求数据" class="headerlink" title="请求数据"></a>请求数据</h4><p>GET参数</p><p>Post的form表单数据</p><h4 id="响应状态码"><a href="#响应状态码" class="headerlink" title="响应状态码"></a>响应状态码</h4><p>200 ok</p><p>301 表示客户端跳转，永久性的跳转</p><p>302 客户端跳转，临时性的跳转</p><p>304 表示资源未被修改。</p><p>404 页面不存在</p><p>500 表示服务端的错误</p><h4 id="响应头"><a href="#响应头" class="headerlink" title="响应头"></a>响应头</h4><p>Content-Length: 表示长度<br>Content-Type: 内容格式<br>Date: 日期<br>Server: 服务器类型</p><h4 id="响应正文"><a href="#响应正文" class="headerlink" title="响应正文"></a>响应正文</h4><p>html、css、js、img等。</p><h3 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h3><blockquote><p>在Servlet中写html代码很麻烦，既不直观，也很难处理页面样式和数据之间的关系。</p><p>JSP可以实现在HTML文件中编写执行Java代码，在页面需要数据、逻辑控制的地方调用java代码实现。</p></blockquote><h4 id="hello-jsp"><a href="#hello-jsp" class="headerlink" title="hello jsp"></a>hello jsp</h4><ul><li><code>hello.jsp</code></li></ul><figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;%<span class="meta">@page</span> contentType=<span class="string">"text/html; charset=UTF-8"</span>  pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</div><div class="line"> </div><div class="line">你好 JSP</div><div class="line">&lt;br&gt;</div><div class="line">&lt;%=<span class="keyword">new</span> Date().toLocaleString()%&gt;</div></pre></td></tr></table></figure><ul><li><p><code>&lt;%@page</code> jsp指令，配置页面</p></li><li><p><code>&lt;%=</code> 调用java代码执行输出</p></li><li><p>在访问hello.jsp页面时，实际上hello.jsp已经被转换为hello_jsp.java，然后编译成hello<em>jsp.class，是一个servlet，位于tomcat的子目录`\work\Catalina\localhost\</em>\org\apache\jsp` ,servlet将生产的html返回给浏览器。</p><p>hello_jsp.java继承了<code>HttpJspBase</code>类，<code>HttpJspBase</code>是HttpServlet的子类。</p></li></ul><h4 id="JSP指令"><a href="#JSP指令" class="headerlink" title="JSP指令"></a>JSP指令</h4><table><thead><tr><th><strong>指令</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>&lt;%@ page ... %&gt;</code></td><td>定义网页依赖属性，比如脚本语言、error页面、缓存需求等等</td></tr><tr><td><code>&lt;%@ include ... %&gt;</code></td><td>包含其他文件</td></tr><tr><td><code>&lt;%@ taglib ... %&gt;</code></td><td>引入标签库的定义</td></tr></tbody></table><p>语法格式<code>&lt;%@ page attribute=&quot;value&quot; %&gt;</code> 等价于XML格式<code>&lt;jsp:directive.page attribute=&quot;value&quot; /&gt;</code>。</p><table><thead><tr><th><strong>属性</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td>buffer</td><td>指定out对象使用缓冲区的大小</td></tr><tr><td>autoFlush</td><td>控制out对象的 缓存区</td></tr><tr><td>contentType</td><td>指定当前JSP页面的MIME类型和字符编码</td></tr><tr><td>errorPage</td><td>指定当JSP页面发生异常时需要转向的错误处理页面</td></tr><tr><td>isErrorPage</td><td>指定当前页面是否可以作为另一个JSP页面的错误处理页面</td></tr><tr><td>extends</td><td>指定servlet从哪一个类继承</td></tr><tr><td>import</td><td>导入要使用的Java类，逗号隔开</td></tr><tr><td>info</td><td>定义JSP页面的描述信息</td></tr><tr><td>isThreadSafe</td><td>指定对JSP页面的访问是否为线程安全</td></tr><tr><td>language</td><td>定义JSP页面所用的脚本语言，默认是Java</td></tr><tr><td>session</td><td>指定JSP页面是否使用session</td></tr><tr><td>isELIgnored</td><td>指定是否执行EL表达式</td></tr><tr><td>isScriptingEnabled</td><td>确定脚本元素能否被使用</td></tr></tbody></table><p>include指令<code>&lt;%@ include file=&quot;文件相对 url 地址&quot; %&gt;</code>,等价于xml <code>&lt;jsp:directive.include file=&quot;文件相对 url 地址&quot; /&gt;</code>， 被包含的文件可以是JSP文件、HTML文件或文本文件。</p><p>taglib指令： <code>&lt;%@ taglib uri=&quot;uri&quot; prefix=&quot;prefixOfTag&quot; %</code>, 等价XML <code>&lt;jsp:directive.taglib uri=&quot;uri&quot; prefix=&quot;prefixOfTag&quot; /&gt;</code>. uri属性确定标签库的位置，prefix属性指定标签库的前缀。</p><h4 id="JSP页面元素"><a href="#JSP页面元素" class="headerlink" title="JSP页面元素"></a>JSP页面元素</h4><ul><li><p>静态内容</p><p>html js css等</p></li><li><p>指令</p></li><li><p>表达式<code>&lt;%= %&gt;</code></p><p>用于输出一段html，<code>&lt;% out.println(&quot;hello&quot;);%&gt;也可以实现相同功能。</code></p></li><li><p>动作</p><p>XML格式的,如<code>&lt;jsp:include page=&quot;xxx.jsp&quot;&gt;</code></p></li><li><p>Scriptlet <code>&lt;% %&gt;</code></p><p>在<code>&lt;% %&gt;</code>之间可以写任意java代码</p></li><li><p>声明字段或方法 <code>&lt;%! %&gt;</code></p><p>不建议使用</p></li><li><p>注释<code>&lt;%--  --%&gt;</code></p><p>不同于HTML的注释，在浏览器看不到该注释，相当于在servlet中的注释。</p></li></ul><h4 id="JSP动作"><a href="#JSP动作" class="headerlink" title="JSP动作"></a>JSP动作</h4><p>语法格式： <code>&lt;jsp:action_name attribute=&quot;value&quot; /&gt;</code></p><table><thead><tr><th>语法</th><th>描述</th></tr></thead><tbody><tr><td>jsp:include</td><td>在页面被请求的时候引入一个文件。</td></tr><tr><td>jsp:useBean</td><td>寻找或者实例化一个JavaBean。</td></tr><tr><td>jsp:setProperty</td><td>设置JavaBean的属性。</td></tr><tr><td>jsp:getProperty</td><td>输出某个JavaBean的属性。</td></tr><tr><td>jsp:forward</td><td>把请求转到一个新的页面。</td></tr><tr><td>jsp:plugin</td><td>根据浏览器类型为Java插件生成OBJECT或EMBED标记。</td></tr><tr><td>jsp:element</td><td>定义动态XML元素</td></tr><tr><td>jsp:attribute</td><td>设置动态定义的XML元素属性。</td></tr><tr><td>jsp:body</td><td>设置动态定义的XML元素内容。</td></tr><tr><td>jsp:text</td><td>在JSP页面和文档中使用写入文本的模板</td></tr></tbody></table><ul><li><p>jsp:include</p><p>使用jsp动作include文件时，被include的页面单独编译成servlet，请求页面时，服务端会访问该servlet。可以传递参数进去，在jsp文件中使用<code>&lt;%=request.getParameter(</code>“year”<code>)%&gt;</code>获取参数。</p><p>使用include指令时，直接将被include的文件插入，而不是单独编译，服务端只有一个servlet。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;jsp:include page=<span class="string">"footer.jsp"</span>&gt;</div><div class="line">    &lt;jsp:param  name=<span class="string">"year"</span> value=<span class="string">"2017"</span> /&gt;</div><div class="line">&lt;/jsp:include&gt;</div><div class="line"></div><div class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"footer.jsp"</span> %&gt;</div></pre></td></tr></table></figure></li><li><p>jsp:forward</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 客户端跳转 --&gt;</div><div class="line">&lt;%</div><div class="line">response.sendRedirect(<span class="string">"hello.jsp"</span>);  </div><div class="line">%&gt;</div><div class="line">&lt;!-- 服务端跳转 --&gt;</div><div class="line">&lt;%</div><div class="line">request.getRequestDispatcher(<span class="string">"hello.jsp"</span>).forward(request, response); </div><div class="line">%&gt;</div><div class="line">&lt;!-- 服务端跳转，jsp动作的代码更简洁 --&gt;</div><div class="line">&lt;jsp:forward page=<span class="string">"hello.jsp"</span>/&gt;</div></pre></td></tr></table></figure><p>​</p></li></ul><h4 id="JSP隐式对象"><a href="#JSP隐式对象" class="headerlink" title="JSP隐式对象"></a>JSP隐式对象</h4><table><thead><tr><th><strong>对象</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td>request</td><td><strong>HttpServletRequest</strong>类的实例</td></tr><tr><td>response</td><td><strong>HttpServletResponse</strong>类的实例</td></tr><tr><td>out</td><td><strong>JspWriter</strong>类的实例，用于把结果输出至网页上</td></tr><tr><td>session</td><td><strong>HttpSession</strong>类的实例</td></tr><tr><td>application</td><td><strong>ServletContext</strong>类的实例，与应用上下文有关</td></tr><tr><td>config</td><td><strong>ServletConfig</strong>类的实例</td></tr><tr><td>pageContext</td><td><strong>PageContext</strong>类的实例，提供对JSP页面所有对象以及命名空间的访问</td></tr><tr><td>page</td><td>类似于Java类中的this关键字</td></tr><tr><td>Exception</td><td><strong>Exception</strong>类的对象，代表发生错误的JSP页面中对应的异常对象</td></tr></tbody></table><ul><li><p>request对象提供了一系列方法，可以获取HTTP头，cookies等等。</p></li><li><p>session对象跟踪服务器-客户端请求的对话。</p></li><li><p>pageContext对象</p><p>提供获取request、response、out、session、config等对象实例的方法。</p><p>可以修改、获取、移除作用域中的属性，<code>pageContext.removeAttribute(&quot;attrName&quot;, pageContext.PAGE_SCOPE);</code>  不提供作用域参数时，则移除4个作用域中的属性，PAGE_SCOPE，REQUEST_SCOPE，SESSION_SCOPE， APPLICATION_SCOPE。</p></li></ul><h4 id="JSP作用域"><a href="#JSP作用域" class="headerlink" title="JSP作用域"></a>JSP作用域</h4><ul><li><p>pageContext ：当前页面的作用域，也可以管理其他作用域的变量。 page相当于java中的this，servlet实例。 </p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 设置的属性只能在当前页面访问 --&gt;</div><div class="line">&lt;% pageContext.setAttribute(<span class="string">"name"</span>,<span class="string">"gareen"</span>); %&gt;</div><div class="line">&lt;%=pageContext.getAttribute(<span class="string">"name"</span>)%&gt;</div></pre></td></tr></table></figure></li><li><p>request： 一次请求，服务端跳转仍是同一请求。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;% request.setAttribute(<span class="string">"name"</span>,<span class="string">"gareen"</span>); %&gt;  </div><div class="line">&lt;%=request.getAttribute(<span class="string">"name"</span>)%&gt;</div><div class="line"></div><div class="line">&lt;!-- 使用pageContext --&gt;</div><div class="line">&lt;% pageContext.setAttribute(<span class="string">"name"</span>,<span class="string">"gareen"</span>,pageContext.REQUEST_SCOPE); %&gt;</div><div class="line"></div><div class="line">&lt;%= pageContext.getAttribute(<span class="string">"name"</span>,pageContext.REQUEST_SCOPE) %&gt;</div></pre></td></tr></table></figure></li><li><p>session：当前会话 </p><p>页面间参数传递可以使用session</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;%</div><div class="line">    session.setAttribute(<span class="string">"name"</span>,<span class="string">"gareen"</span>);</div><div class="line">    response.sendRedirect(<span class="string">"getContext.jsp"</span>);</div><div class="line">%&gt;</div><div class="line">&lt;%=session.getAttribute(<span class="string">"name"</span>)%&gt;</div><div class="line"></div><div class="line">&lt;!-- 使用pageContext --&gt;</div><div class="line">&lt;% </div><div class="line">pageContext.setAttribute(<span class="string">"name"</span>,<span class="string">"gareen"</span>,pageContext.SESSION_SCOPE);</div><div class="line">pageContext.getAttribute(<span class="string">"name"</span>,pageContext.SESSION_SCOPE);</div><div class="line">%&gt;</div></pre></td></tr></table></figure></li><li><p>application：全局，所有用户共享</p><p> application对象是ServletContext接口的实例,也可以通过 request.getServletContext()来获取.</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;%</div><div class="line">    application.setAttribute(<span class="string">"name"</span>,<span class="string">"gareen"</span>);</div><div class="line">    System.out.println(application == request.getServletContext());</div><div class="line">    response.sendRedirect(<span class="string">"getContext.jsp"</span>);</div><div class="line">%&gt;</div><div class="line">&lt;%=application.getAttribute(<span class="string">"name"</span>)%&gt;</div><div class="line"></div><div class="line">&lt;!-- 使用pageContext --&gt;</div><div class="line">&lt;% </div><div class="line">pageContext.setAttribute(<span class="string">"name"</span>,<span class="string">"gareen"</span>,pageContext.APPLICATION_SCOPE);</div><div class="line">pageContext.getAttribute(<span class="string">"name"</span>,pageContext.APPLICATION_SCOPE)</div><div class="line">%&gt;</div></pre></td></tr></table></figure></li></ul><h4 id="JSTL标准标签库"><a href="#JSTL标准标签库" class="headerlink" title="JSTL标准标签库"></a>JSTL标准标签库</h4><p>需要先导入两个包 jstl.jar 和standard.jar。</p><p>在jsp中使用taglib指令导入需要的标签库模块，常用的有core、format和function</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 变量访问，移除 --&gt;</div><div class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</div><div class="line"> </div><div class="line">设置值：&lt;c:set var=<span class="string">"name"</span> value=<span class="string">"$&#123;'gareen'&#125;"</span> scope=<span class="string">"request"</span> /&gt;</div><div class="line"> </div><div class="line">通过标签获取name: &lt;c:out value=<span class="string">"$&#123;name&#125;"</span> /&gt; &lt;br&gt;</div><div class="line"> </div><div class="line">移除变量：&lt;c:remove var=<span class="string">"name"</span> scope=<span class="string">"request"</span> /&gt; &lt;br&gt;</div><div class="line"> </div><div class="line">&lt;!-- 实现<span class="keyword">if</span>-<span class="keyword">else</span>逻辑，JSTL没有<span class="keyword">else</span>语法，可以用<span class="keyword">if</span>非或choose实现  --&gt;</div><div class="line">&lt;c:set var=<span class="string">"hp"</span> value=<span class="string">"$&#123;10&#125;"</span> scope=<span class="string">"request"</span> /&gt;</div><div class="line">&lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;hp&lt;5&#125;"</span>&gt;</div><div class="line">    &lt;p&gt;这个英雄要挂了&lt;/p&gt;</div><div class="line">&lt;/c:if&gt;</div><div class="line">&lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;!(hp&lt;5)&#125;"</span>&gt;</div><div class="line">    &lt;p&gt;这个英雄觉得自己还可以再抢救抢救&lt;/p&gt;</div><div class="line">&lt;/c:if&gt;</div><div class="line">&lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;empty weapon&#125;"</span>&gt;</div><div class="line">    &lt;p&gt;没有装备武器&lt;/p&gt;</div><div class="line">&lt;/c:if&gt;</div><div class="line"></div><div class="line">&lt;c:choose&gt;</div><div class="line">    &lt;c:when test=<span class="string">"$&#123;hp&lt;5&#125;"</span>&gt;</div><div class="line">        &lt;p&gt;这个英雄要挂了&lt;/p&gt;</div><div class="line">    &lt;/c:when&gt;</div><div class="line">    &lt;c:otherwise&gt;</div><div class="line">        &lt;p&gt;这个英雄觉得自己还可以再抢救抢救&lt;/p&gt;</div><div class="line">    &lt;/c:otherwise&gt;</div><div class="line">&lt;/c:choose&gt;</div><div class="line"></div><div class="line">&lt;!-- <span class="keyword">for</span>循环 --&gt;</div><div class="line">&lt;c:forEach items=<span class="string">"$&#123;heros&#125;"</span> var=<span class="string">"hero"</span> varStatus=<span class="string">"st"</span>  &gt;</div><div class="line">  &lt;!-- varStatus表示当前遍历的状态 --&gt;</div><div class="line">    &lt;tr&gt;</div><div class="line">        &lt;td&gt;&lt;c:out value="$&#123;st.count&#125;" /&gt;&lt;/td&gt;</div><div class="line">        &lt;td&gt;&lt;c:out value="$&#123;hero&#125;" /&gt;&lt;/td&gt;</div><div class="line">    &lt;/tr&gt;</div><div class="line">&lt;/c:forEach&gt;</div><div class="line"></div><div class="line">&lt;!-- forTokes字符串拆分 --&gt;</div><div class="line">&lt;c:set var=<span class="string">"strs"</span> value=<span class="string">"塔姆,艾克;巴德|雷克赛!卡莉丝塔"</span> /&gt;</div><div class="line"> </div><div class="line">&lt;c:forTokens items=<span class="string">"$&#123;strs&#125;"</span> delims=<span class="string">":;|!"</span> var=<span class="string">"sub_str"</span>&gt;</div><div class="line">    &lt;c:out value=<span class="string">"$&#123;sub_str&#125;"</span> /&gt; &lt;br /&gt;</div><div class="line">&lt;/c:forTokens&gt;</div></pre></td></tr></table></figure><ul><li><p>format格式化数字和时间</p><p>yyyy 表示年份，MM 表示月份，dd 表示日期，E 表示星期几，a 表示是上午还是下午</p><p>HH 表示小时，mm 表示分钟，ss 表示秒，S 表示毫秒，z 表示时区</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/fmt"</span>  prefix=<span class="string">'fmt'</span> %&gt;</div><div class="line">&lt;core:set var=<span class="string">"money"</span> value=<span class="string">"39.45896"</span>/&gt;</div><div class="line">&lt;!-- 最少<span class="number">2</span>位，最多<span class="number">6</span>位小数 --&gt;</div><div class="line">&lt;fmt:formatNumber type=<span class="string">"number"</span> value=<span class="string">"$&#123;money&#125;"</span> minFractionDigits=<span class="string">"2"</span> maxFractionDigits=<span class="string">"6"</span> /&gt; </div><div class="line"></div><div class="line">&lt;!--  格式化date --&gt;</div><div class="line">&lt;%</div><div class="line">    Date now = <span class="keyword">new</span> Date();</div><div class="line">    pageContext.setAttribute(<span class="string">"now"</span>,now);</div><div class="line">%&gt;</div><div class="line"> </div><div class="line">完整日期: &lt;fmt:formatDate value=<span class="string">"$&#123;now&#125;"</span> pattern=<span class="string">"G yyyy年MM月dd日 E"</span>/&gt;&lt;br&gt;</div><div class="line">完整时间: &lt;fmt:formatDate value=<span class="string">"$&#123;now&#125;"</span> pattern=<span class="string">"a HH:mm:ss.S z"</span>/&gt;&lt;br&gt;</div><div class="line">常见格式: &lt;fmt:formatDate value=<span class="string">"$&#123;now&#125;"</span> pattern=<span class="string">"yyyy-MM-dd HH:mm:ss"</span>/&gt;</div></pre></td></tr></table></figure><p>​</p></li><li><p>function函数库</p><p><code>&lt;%@ taglib prefix=&quot;fn&quot; uri=&quot;http://java.sun.com/jsp/jstl/functions&quot; %&gt;</code></p><p>提供了很多实用的函数</p><p>| <strong>函数</strong>                                   | <strong>描述</strong>                                   |<br>| —————————————- | —————————————- |<br>| fn:contains(string, substring)           | 如果参数string中包含参数substring，返回true          |<br>| fn:containsIgnoreCase(string, substring) | 如果参数string中包含参数substring（忽略大小写），返回true   |<br>| fn:endsWith(string, suffix)              | 如果参数 string 以参数suffix结尾，返回true           |<br>| fn:escapeXml(string)                     | 将有特殊意义的XML (和HTML)转换为对应的XML character entity code，并返回 |<br>| fn:indexOf(string, substring)            | 返回参数substring在参数string中第一次出现的位置          |<br>| fn:join(array, separator)                | 将一个给定的数组array用给定的间隔符separator串在一起，组成一个新的字符串并返回。 |<br>| fn:length(item)                          | 返回参数item中包含元素的数量。参数Item类型是数组、collection或者String。如果是String类型,返回值是String中的字符数。 |<br>| fn:replace(string, before, after)        | 返回一个String对象。用参数after字符串替换参数string中所有出现参数before字符串的地方，并返回替换后的结果 |<br>| fn:split(string, separator)              | 返回一个数组，以参数separator 为分割符分割参数string，分割后的每一部分就是数组的一个元素 |<br>| fn:startsWith(string, prefix)            | 如果参数string以参数prefix开头，返回true             |<br>| fn:substring(string, begin, end)         | 返回参数string部分字符串, 从参数begin开始到参数end位置，包括end位置的字符 |<br>| fn:substringAfter(string, substring)     | 返回参数substring在参数string中后面的那一部分字符串        |<br>| fn:substringBefore(string, substring)    | 返回参数substring在参数string中前面的那一部分字符串        |<br>| fn:toLowerCase(string)                   | 将参数string所有的字符变为小写，并将其返回                 |<br>| fn:toUpperCase(string)                   | 将参数string所有的字符变为大写，并将其返回                 |<br>| fn:trim(string)                          | 去除参数string 首尾的空格，并将其返回                   |</p></li></ul><h4 id="EL表达式语言"><a href="#EL表达式语言" class="headerlink" title="EL表达式语言"></a>EL表达式语言</h4><p>使用page指令开始EL表达式支持 <code>&lt;%@ page isELIgnored =&quot;true|false&quot; %&gt;</code></p><ul><li><p>语法： <code>${expression表达式}</code> <code>${JavaBeanObjeact.attr}</code></p></li><li><p>取变量值： <code>${killNumber}</code>;取请求参数 <code>${param.name}</code>,用到了隐式对象</p></li><li><p><code>.</code>获取JavaBean的属性</p><p>JavaBean是特殊的Java类，使用J ava语言书写，并且遵守JavaBean API规范。</p><ul><li><p>提供一个默认的无参构造</p></li><li><p>可以被序列化，实现序列化接口Serializable接口</p></li><li><p>可读写的属性以setter、getter方法提供访问</p></li><li><p>Boolean属性提供isXXX方法。</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span>%&gt;</div><div class="line">&lt;!-- jsp创建JavaBean对象，设置和获取属性 --&gt;</div><div class="line">&lt;jsp:useBean id=<span class="string">"students"</span>  <span class="class"><span class="keyword">class</span></span>=<span class="string">"com.runoob.StudentsBean"</span>&gt; </div><div class="line">   &lt;jsp:setProperty name=<span class="string">"students"</span> property=<span class="string">"firstName"</span> value=<span class="string">"小强"</span>/&gt;</div><div class="line">   &lt;jsp:setProperty name=<span class="string">"students"</span> property=<span class="string">"lastName"</span> value=<span class="string">"王"</span>/&gt;</div><div class="line">   &lt;jsp:setProperty name=<span class="string">"students"</span> property=<span class="string">"age"</span> value=<span class="string">"10"</span>/&gt;</div><div class="line">&lt;/jsp:useBean&gt;</div><div class="line"></div><div class="line">&lt;p&gt;学生名字: &lt;jsp:getProperty name="students" property="firstName"/&gt;&lt;/p&gt;</div><div class="line">&lt;p&gt;学生姓氏: &lt;jsp:getProperty name="students" property="lastName"/&gt; &lt;/p&gt;</div><div class="line">&lt;p&gt;学生年龄:  &lt;jsp:getProperty name="students" property="age"/&gt;&lt;/p&gt;</div></pre></td></tr></table></figure><p>​</p></li></ul></li><li><p>支持三元运算，可以替代if-else  <code>${killNumber ge 10? &quot;超神&quot;:&quot;还没超神&quot; }</code></p><p>基础操作符：</p><p>| <strong>操作符</strong>    | <strong>描述</strong>             |<br>| ———- | —————— |<br>| .          | 访问一个Bean属性或者一个映射条目 |<br>| []         | 访问一个数组或者链表的元素      |<br>| ( )        | 组织一个子表达式以改变优先级     |<br>| +          | 加                  |<br>| -          | 减或负                |<br>| *          | 乘                  |<br>| / or div   | 除                  |<br>| % or mod   | 取模                 |<br>| == or eq   | 测试是否相等             |<br>| != or ne   | 测试是否不等             |<br>| &lt; or lt    | 测试是否小于             |<br>| &gt; or gt    | 测试是否大于             |<br>| &lt;= or le   | 测试是否小于等于           |<br>| &gt;= or ge   | 测试是否大于等于           |<br>| &amp;&amp; or and  | 测试逻辑与              |<br>| || or or | 测试逻辑或              |<br>| ! or not   | 测试取反               |<br>| empty      | 测试是否空值             |</p></li><li><p>EL隐含对象</p><p>| <strong>隐含对象</strong>         | <strong>描述</strong>             |<br>| —————- | —————— |<br>| pageScope        | page 作用域           |<br>| requestScope     | request 作用域        |<br>| sessionScope     | session 作用域        |<br>| applicationScope | application 作用域    |<br>| param            | Request 对象的参数，字符串  |<br>| paramValues      | Request对象的参数，字符串集合 |<br>| header           | HTTP 信息头，字符串       |<br>| headerValues     | HTTP 信息头，字符串集合     |<br>| initParam        | 上下文初始化参数           |<br>| cookie           | Cookie值            |<br>| pageContext      | 当前页面的pageContext   |</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$&#123;pageContext.request.queryString&#125;</div><div class="line">$&#123;param[<span class="string">"username"</span>]&#125;</div><div class="line">$&#123;param.username&#125;</div><div class="line">$&#123;header[<span class="string">"user-agent"</span>]&#125;</div></pre></td></tr></table></figure><p>​</p></li></ul><h3 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h3><h3 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h3><blockquote><p>在请求访问服务器资源之前，拦截请求并处理；</p><p>在服务器返回响应之前，拦截响应并处理</p></blockquote><h4 id="Filter对象及方法"><a href="#Filter对象及方法" class="headerlink" title="Filter对象及方法"></a>Filter对象及方法</h4><p>过滤器是一个实现了 <code>javax.servlet.Filter</code> 接口的 Java 类。javax.servlet.Filter 接口定义了三个方法：</p><table><thead><tr><th>序号</th><th>方法 &amp; 描述</th></tr></thead><tbody><tr><td>1</td><td><strong>public void doFilter (ServletRequest, ServletResponse, FilterChain)</strong>该方法完成实际的过滤操作，当客户端请求方法与过滤器设置匹配的URL时，Servlet容器将先调用过滤器的doFilter方法。FilterChain用户访问后续过滤器。</td></tr><tr><td>2</td><td><strong>public void init(FilterConfig filterConfig)</strong>web 应用程序启动时，web 服务器将创建Filter 的实例对象，并调用其init方法，读取web.xml配置，完成对象的初始化功能，从而为后续的用户请求作好拦截的准备工作（filter对象只会创建一次，init方法也只会执行一次）。开发人员通过init方法的参数，可获得代表当前filter配置信息的FilterConfig对象。</td></tr><tr><td>3</td><td><strong>public void destroy()</strong>Servlet容器在销毁过滤器实例前调用该方法，在该方法中释放Servlet过滤器占用的资源。</td></tr></tbody></table><p> init 方法中提供了一个 FilterConfig 对象,可以用于获取filter在web.xml下的配置。</p><p><code>filterConfig.getInitParameter(&quot;Site&quot;);</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>LogFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>LogFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>Site<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>测试<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>LogFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></div></pre></td></tr></table></figure><p>一个处理中文编码的过滤器</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Utf8Filter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</div><div class="line">        HttpServletRequest request = (HttpServletRequest) servletRequest;</div><div class="line">        request.setCharacterEncoding(<span class="string">"utf-8"</span>);</div><div class="line">        filterChain.doFilter(request, servletResponse);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="应用过滤器的顺序"><a href="#应用过滤器的顺序" class="headerlink" title="应用过滤器的顺序"></a>应用过滤器的顺序</h4><p>多个过滤器应用的顺序依据<code>web.xml</code>中<code>filter-mapping</code>定义的顺序。</p><h4 id="规范建议的过滤器"><a href="#规范建议的过滤器" class="headerlink" title="规范建议的过滤器"></a>规范建议的过滤器</h4><ul><li><p>身份验证过滤器（Authentication Filters）。</p><p>指定页面不使用过滤器，在filter的init参数里定义不过滤的url，然后在Filter里先获取初始参数，然后过滤方法里判断是否需要过滤。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>LoginFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>filter.LoginFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>excludedPages<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>/index.jsp,/register.html,/login.html,/login,/jquery.min.js,<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> String excludeParam;</div><div class="line">    <span class="keyword">private</span> String[] excludePages;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</div><div class="line">        excludeParam = filterConfig.getInitParameter(<span class="string">"excludedPages"</span>);</div><div class="line">        <span class="keyword">if</span>(excludeParam!=<span class="keyword">null</span> &amp;&amp; excludeParam.length()&gt;<span class="number">0</span>)&#123;</div><div class="line">            excludePages = excludeParam.split(<span class="string">","</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</div><div class="line">        HttpServletRequest request = (HttpServletRequest) servletRequest;</div><div class="line">        HttpServletResponse response = (HttpServletResponse) servletResponse;</div><div class="line">        String username = (String) request.getSession().getAttribute(<span class="string">"username"</span>);</div><div class="line">        <span class="keyword">boolean</span> notFilter = <span class="keyword">false</span>;</div><div class="line">        <span class="comment">// 判断是否过滤页面</span></div><div class="line">        <span class="keyword">for</span>(String excludeUrl: excludePages)&#123;</div><div class="line"><span class="comment">//            System.out.println(excludeUrl);</span></div><div class="line"><span class="comment">//            System.out.println(request.getRequestURI());</span></div><div class="line">            String uri = request.getRequestURI();</div><div class="line">            <span class="keyword">if</span>(excludeUrl.trim().equals(uri))&#123;</div><div class="line">                notFilter = <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(uri.endsWith(<span class="string">".css"</span>)||uri.endsWith(<span class="string">".js"</span>))&#123;</div><div class="line">                notFilter = <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line"><span class="comment">//            System.out.println(request.getServletPath());</span></div><div class="line"><span class="comment">//            if(excludeUrl.trim().equals(request.getRequestURI()))&#123;</span></div><div class="line"><span class="comment">//                NotFilter = true;</span></div><div class="line"><span class="comment">//            &#125;</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (notFilter)&#123;</div><div class="line">            filterChain.doFilter(request, response);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">if</span> (username!=<span class="keyword">null</span> &amp;&amp; username.length()&gt;<span class="number">0</span>)&#123;</div><div class="line">                System.out.println(username);</div><div class="line">                filterChain.doFilter(request, servletResponse);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                response.sendRedirect(<span class="string">"login.html"</span>);</div><div class="line"><span class="comment">//            request.getRequestDispatcher("login.html").forward(request, response);</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>数据压缩过滤器（Data compression Filters）。</p></li><li><p>加密过滤器（Encryption Filters）。</p></li><li><p>触发资源访问事件过滤器。</p></li><li><p>图像转换过滤器（Image Conversion Filters）。</p></li><li><p>日志记录和审核过滤器（Logging and Auditing Filters）。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123; &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</div><div class="line">        HttpServletRequest request = (HttpServletRequest) servletRequest;</div><div class="line">        String ip = request.getRemoteAddr();</div><div class="line">        String url = request.getRequestURL().toString();</div><div class="line">        System.out.println(ip +<span class="string">"在"</span>+ <span class="keyword">new</span> Date().toString() + <span class="string">"访问了网址："</span>+ url);</div><div class="line">        <span class="comment">// 允许过滤器链的后续过滤</span></div><div class="line">        filterChain.doFilter(servletRequest, servletResponse);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li><li><p>MIME-TYPE 链过滤器（MIME-TYPE Chain Filters）。</p></li><li><p>标记化过滤器（Tokenizing Filters）。</p></li><li><p>XSL/T 过滤器（XSL/T Filters），转换 XML 内容。</p></li></ul><h3 id="Listener"><a href="#Listener" class="headerlink" title="Listener"></a>Listener</h3><ul><li><p>监听 web应用的创建和销毁，以及其attribute发生的变化。 </p><p>web应用即ServletContext对象(jsp的<a href="http://how2j.cn/k/jsp/jsp-object/580.html" target="_blank" rel="external">隐式对象application</a>) </p></li><li><p>监听<a href="http://how2j.cn/k/listener/listener-session/606.html" target="_blank" rel="external">session</a>和<a href="http://how2j.cn/k/listener/listener-request/607.html" target="_blank" rel="external">request</a>的生命周期，以及其attribute发生的变化。</p></li></ul><h4 id="监听Context"><a href="#监听Context" class="headerlink" title="监听Context"></a>监听Context</h4><ul><li><p>web.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>listener.ContextListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></div></pre></td></tr></table></figure><p>​</p></li><li><p>Listener,实现两个接口方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ContextListener</span> <span class="keyword">implements</span> <span class="title">ServletContextListener</span>, <span class="title">ServletContextAttributeListener</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent servletContextEvent)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"web应用初始化"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextDestroyed</span><span class="params">(ServletContextEvent servletContextEvent)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"web 应用销毁"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeAdded</span><span class="params">(ServletContextAttributeEvent servletContextAttributeEvent)</span> </span>&#123;</div><div class="line">        ServletContextAttributeEvent e = servletContextAttributeEvent;</div><div class="line">        System.out.println(String.format(<span class="string">"添加了属性：%s ---- %s"</span>, e.getName(), e.getValue()));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span><span class="params">(ServletContextAttributeEvent servletContextAttributeEvent)</span> </span>&#123;</div><div class="line">        ServletContextAttributeEvent e = servletContextAttributeEvent;</div><div class="line">        System.out.println(String.format(<span class="string">"移除了属性：%s ---- %s"</span>, e.getName(), e.getValue()));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span><span class="params">(ServletContextAttributeEvent servletContextAttributeEvent)</span> </span>&#123;</div><div class="line">        ServletContextAttributeEvent e = servletContextAttributeEvent;</div><div class="line">        System.out.println(String.format(<span class="string">"替换了属性：%s ---- %s"</span>, e.getName(), e.getValue()));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ul><h4 id="监听Session"><a href="#监听Session" class="headerlink" title="监听Session"></a>监听Session</h4><ul><li><p>实现<code>HttpSessionListener</code>  <code>HttpSessionAttributeListener</code> 接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SessionListener</span> <span class="keyword">implements</span> <span class="title">HttpSessionListener</span>, <span class="title">HttpSessionAttributeListener</span></span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionCreated</span><span class="params">(HttpSessionEvent httpSessionEvent)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"session创建，session_id"</span> + httpSessionEvent.getSession().getId());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionDestroyed</span><span class="params">(HttpSessionEvent httpSessionEvent)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"session销毁，session_id"</span> + httpSessionEvent.getSession().getId());</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeAdded</span><span class="params">(HttpSessionBindingEvent httpSessionBindingEvent)</span> </span>&#123;</div><div class="line">        HttpSessionBindingEvent e = httpSessionBindingEvent;</div><div class="line">        System.out.println(String.format(<span class="string">"session属性添加：%s --- %s"</span>, e.getName(), e.getValue()));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span><span class="params">(HttpSessionBindingEvent httpSessionBindingEvent)</span> </span>&#123;</div><div class="line">        HttpSessionBindingEvent e = httpSessionBindingEvent;</div><div class="line">        System.out.println(String.format(<span class="string">"session属性移除：%s --- %s"</span>, e.getName(), e.getValue()));</div><div class="line">&#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span><span class="params">(HttpSessionBindingEvent httpSessionBindingEvent)</span> </span>&#123;</div><div class="line">        HttpSessionBindingEvent e = httpSessionBindingEvent;</div><div class="line">        System.out.println(String.format(<span class="string">"session属性替换：%s --- %s"</span>, e.getName(), e.getValue()));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ul><h4 id="监听Request"><a href="#监听Request" class="headerlink" title="监听Request"></a>监听Request</h4><ul><li><p>实现接口<code>ServletRequestListener</code> ,<code>ServletRequestAttributeListener</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestListener</span> <span class="keyword">implements</span> <span class="title">ServletRequestListener</span>,<span class="title">ServletRequestAttributeListener</span></span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestDestroyed</span><span class="params">(ServletRequestEvent servletRequestEvent)</span> </span>&#123;</div><div class="line">        ServletRequestEvent e = servletRequestEvent;</div><div class="line">        System.out.println(<span class="string">"request被销毁！"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestInitialized</span><span class="params">(ServletRequestEvent servletRequestEvent)</span> </span>&#123;</div><div class="line">        ServletRequestEvent e = servletRequestEvent;</div><div class="line">        System.out.println(<span class="string">"request创建！"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeAdded</span><span class="params">(ServletRequestAttributeEvent servletRequestAttributeEvent)</span> </span>&#123;</div><div class="line">        ServletRequestAttributeEvent e = servletRequestAttributeEvent;</div><div class="line">        System.out.println(String.format(<span class="string">"request添加属性：%s --- %s"</span>, e.getName(), e.getValue()));</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span><span class="params">(ServletRequestAttributeEvent servletRequestAttributeEvent)</span> </span>&#123;</div><div class="line">        ServletRequestAttributeEvent e = servletRequestAttributeEvent;</div><div class="line">        System.out.println(String.format(<span class="string">"request移除了属性：%s --- %s"</span>, e.getName(), e.getValue()));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span><span class="params">(ServletRequestAttributeEvent servletRequestAttributeEvent)</span> </span>&#123;</div><div class="line">        ServletRequestAttributeEvent e = servletRequestAttributeEvent;</div><div class="line">        System.out.println(String.format(<span class="string">"request替换属性：%s --- %s"</span>, e.getName(), e.getValue()));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ul><h4 id="web在线人数统计"><a href="#web在线人数统计" class="headerlink" title="web在线人数统计"></a>web在线人数统计</h4><p>监听session的创建和销毁，一个session对应一个在线用户，设置一个application全局变量userNum保存在线用户数。创建session时userNum 加1，销毁时-1，如果不存在，则初始化值为0。</p><ul><li><p>OnlineUserListener</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OnlineUserListener</span> <span class="keyword">implements</span> <span class="title">HttpSessionListener</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionCreated</span><span class="params">(HttpSessionEvent httpSessionEvent)</span> </span>&#123;</div><div class="line">        HttpSessionEvent e = httpSessionEvent;</div><div class="line">        ServletContext application = e.getSession().getServletContext();</div><div class="line">        Integer userNum = (Integer) application.getAttribute(<span class="string">"userNum"</span>);</div><div class="line">        <span class="keyword">if</span> (userNum == <span class="keyword">null</span>)&#123;</div><div class="line">            application.setAttribute(<span class="string">"userNum"</span>, <span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        userNum++;</div><div class="line">        application.setAttribute(<span class="string">"userNum"</span>, userNum);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionDestroyed</span><span class="params">(HttpSessionEvent httpSessionEvent)</span> </span>&#123;</div><div class="line">        HttpSessionEvent e = httpSessionEvent;</div><div class="line">        ServletContext application = e.getSession().getServletContext();</div><div class="line">        Integer userNum = (Integer) application.getAttribute(<span class="string">"userNum"</span>);</div><div class="line">        <span class="keyword">if</span> (userNum == <span class="keyword">null</span> || userNum &lt; <span class="number">1</span>)&#123;</div><div class="line">            application.setAttribute(<span class="string">"userNum"</span>, <span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            userNum--;</div><div class="line">            application.setAttribute(<span class="string">"userNum"</span>, userNum);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>​</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Tomcat&quot;&gt;&lt;a href=&quot;#Tomcat&quot; class=&quot;headerlink&quot; title=&quot;Tomcat&quot;&gt;&lt;/a&gt;Tomcat&lt;/h3&gt;&lt;h4 id=&quot;下载Tomcat&quot;&gt;&lt;a href=&quot;#下载Tomcat&quot; class=&quot;headerlink&quot; title=&quot;下载Tomcat&quot;&gt;&lt;/a&gt;下载Tomcat&lt;/h4&gt;&lt;p&gt;进入官网&lt;a href=&quot;http://tomcat.apache.org/，选择download，下载所需Tomcat版本。&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://tomcat.apache.org/，选择download，下载所需Tomcat版本。&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;我用的是Tomcat7，core x64 zip。不同版本的比较参考&lt;a href=&quot;http://tomcat.apache.org/whichversion.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官网&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;解压后，点击bin里的startup.bat运行，访问&lt;a href=&quot;http://127.0.0.1:8080，可以看到欢迎界面，运行shutdown.bat关闭Tomcat。&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://127.0.0.1:8080，可以看到欢迎界面，运行shutdown.bat关闭Tomcat。&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;配置环境变量&quot;&gt;&lt;a href=&quot;#配置环境变量&quot; class=&quot;headerlink&quot; title=&quot;配置环境变量&quot;&gt;&lt;/a&gt;配置环境变量&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;在系统变量里添加2个变量 CATALINA_BASE，CATALINA_HOME&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;变量名：CATALINA_BASE&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;变量值：C:\Program Files\Java\apache-tomcat-7.0.85       //Tomcat安装目录&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;变量名：CATALINA_HOME&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;变量值：C:\Program Files\Java\apache-tomcat-7.0.85&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;修改classpath和path&lt;/p&gt;
&lt;p&gt;在ClassPath的变量值中加入：&lt;code&gt;%CATALINA_HOME%\lib\servlet-api.jar;&lt;/code&gt;（注意加的时候在原变量值后加&lt;code&gt;;&lt;/code&gt;）&lt;/p&gt;
&lt;p&gt;在path中添加 &lt;code&gt;%CATALINA_HOME%\bin;%CATALINA_HOME%\lib;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;验证&lt;/p&gt;
&lt;p&gt;新打开一个cmd，输入startup：&lt;/p&gt;
&lt;figure class=&quot;highlight powershell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;C:\Users\&lt;span class=&quot;number&quot;&gt;20189&lt;/span&gt;&amp;gt;startup&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Using CATALINA_BASE:   &lt;span class=&quot;string&quot;&gt;&quot;C:\Program Files\Java\apache-tomcat-7.0.85&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Using CATALINA_HOME:   &lt;span class=&quot;string&quot;&gt;&quot;C:\Program Files\Java\apache-tomcat-7.0.85&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Using CATALINA_TMPDIR: &lt;span class=&quot;string&quot;&gt;&quot;C:\Program Files\Java\apache-tomcat-7.0.85\temp&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Using JRE_HOME:        &lt;span class=&quot;string&quot;&gt;&quot;C:\Program Files\Java\jdk1.8.0_151&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Using CLASSPATH:       &lt;span class=&quot;string&quot;&gt;&quot;C:\Program Files\Java\apache-tomcat-7.0.85\bin\bootstrap.jar;C:\Program Files\Java\apache-tomcat-7.0.85\bin\tomcat-juli.jar&quot;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="技术" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Java" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/"/>
    
      <category term="标准库" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Java/%E6%A0%87%E5%87%86%E5%BA%93/"/>
    
    
      <category term="Java" scheme="http://shuaiyy.cn/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>JQuery学习</title>
    <link href="http://shuaiyy.cn/2018/02/06/%E6%8A%80%E6%9C%AF/JQuery%E5%85%A5%E9%97%A8/"/>
    <id>http://shuaiyy.cn/2018/02/06/技术/JQuery入门/</id>
    <published>2018-02-05T16:00:00.000Z</published>
    <updated>2018-11-27T07:32:43.032Z</updated>
    
    <content type="html"><![CDATA[<h2 id="JQuery学习"><a href="#JQuery学习" class="headerlink" title="JQuery学习"></a>JQuery学习</h2><blockquote><p>前端开发的库</p></blockquote><h3 id="用jquery实现一个前端小程序"><a href="#用jquery实现一个前端小程序" class="headerlink" title="用jquery实现一个前端小程序"></a>用jquery实现一个前端小程序</h3><p><strong>简介</strong></p><p>使用jquery开发一个纯前端实现的Todo-List任务清单管理器。</p><p><img src="http://ww1.sinaimg.cn/large/af9df239ly1fhoa3rjgqbj20kv0hn43b.jpg" alt=""></p><ul><li>定时提醒功能的实现</li><li>最大限度的重用数据</li><li>自定义更强大的alert()函数</li><li><p>position的属性</p><p><strong>逻辑和功能</strong></p></li></ul><ol><li>应用的整体布局</li><li>应用的细节完善</li><li>需求和逻辑分析</li><li>应用的架构方式</li><li>数据存储方式</li><li>数据组织方式</li><li>模板的实现和使用</li><li>定时功能的实现</li><li>应用响铃提醒的实现</li></ol><p><strong>用到的插件和API</strong></p><ul><li>Store.js实现与localStorage读取与存储</li><li>JQuery插件，datetimepicker</li><li>JQuery API：deferred的使用</li><li>JQuery API：选择器的应用和实现</li><li>JQuery promise机制</li></ul><h3 id="安装JS库和相关依赖"><a href="#安装JS库和相关依赖" class="headerlink" title="安装JS库和相关依赖"></a>安装JS库和相关依赖</h3><p>在项目根目录下使用npm管理器安装js插件，默认安装到node_modules。</p><p>使用save参数，会把安装的package写入到package.json文件的depend中，项目迁移或部署时直接<code>npm install</code>就会安装所有的依赖包。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm init</div><div class="line">npm install jquery --save</div></pre></td></tr></table></figure><h3 id="JS实现局部域变量定义"><a href="#JS实现局部域变量定义" class="headerlink" title="JS实现局部域变量定义"></a>JS实现局部域变量定义</h3><p>如果直接定义<code>var a = 1;</code>则a是window根对象的一个属性，容易造成变量污染。</p><p>因此应该将变量定义在函数内。把内置js函数的运行也可以放入一个匿名函数当中。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">;(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"><span class="meta">  'use strict'</span>;</div><div class="line">  <span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line">  alert(a);  <span class="comment">// 1</span></div><div class="line">  alert(<span class="built_in">window</span>.a);  <span class="comment">//这个会是undefined</span></div><div class="line">  <span class="comment">//自己实现的代码</span></div><div class="line">&#125;)();</div></pre></td></tr></table></figure><h3 id="整体页面布局"><a href="#整体页面布局" class="headerlink" title="整体页面布局"></a>整体页面布局</h3><p><img src="http://ww1.sinaimg.cn/large/af9df239gy1fho9a34cg4j20af098q2z.jpg" alt=""></p><ul><li>页面背景</li><li>默认显示列表</li><li>可以标记为已完成</li><li>双击或点击detail查看详情</li><li>可以编辑，修改，删除</li><li>有时间设置页面</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span> <span class="comment">&lt;!-- 总容器 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"add-task"</span>&gt;</span>  <span class="comment">&lt;!-- 添加一个任务 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span>&gt;</span>submmit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"task-list"</span>&gt;</span>  <span class="comment">&lt;!-- 任务list --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"task-item"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"task-content"</span>&gt;</span>item content<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>delete<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>detail<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span>  <span class="comment">&lt;!-- 任务item --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"task-item"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"task-content"</span>&gt;</span>item content<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>delete<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>detail<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"task-item"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"task-content"</span>&gt;</span>item content<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>delete<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>detail<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"task-detail"</span>&gt;</span>  <span class="comment">&lt;!-- 任务详情 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"desc"</span>&gt;</span></div><div class="line"></div><div class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"remind"</span>&gt;</span>  <span class="comment">&lt;!-- 添加闹钟提醒 --&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"date"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><p>使用CSS进行布局美化</p><p><img src="http://ww1.sinaimg.cn/large/af9df239gy1fho9a33yjpj20tb0b9dg1.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/af9df239gy1fho9a32sqsj20ss0du3z1.jpg" alt=""></p><ul><li><p>重置/常规化浏览器默认的margin布局及样式。</p><p>不同的浏览器下的不同标签有不同的默认设置，比如body，html等等标签。解决方法， normalize.css  在bootcdn里找到在线版本的css库。或npm install 安装后引入。引入应该是最先引入。</p></li><li><p>如果使用第三方库比如bootstrap，一般库会自动先进行常规化。</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">npm install normalize.css --save</div><div class="line"></div><div class="line"><span class="meta">#</span> ----- index.html</div><div class="line">&lt;link src='xxx/normalize.css'&gt;</div></pre></td></tr></table></figure><p>CSS属性</p><ul><li>margin 属性：元素的4个外边距</li><li>border属性：边框样式属性 </li></ul><h3 id="JS修改渲染HTML页面"><a href="#JS修改渲染HTML页面" class="headerlink" title="JS修改渲染HTML页面"></a>JS修改渲染HTML页面</h3><ul><li><p>定义一个函数返回包含HTMl的字符串</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> item = task_list[index]</div><div class="line"><span class="keyword">var</span> task_detail_tpl=</div><div class="line">            <span class="string">'&lt;form class="forms"&gt;'</span>+</div><div class="line">            <span class="string">'&lt;div class="content"&gt;'</span> +</div><div class="line">            item.content +</div><div class="line">            <span class="string">'&lt;/div&gt;'</span>+</div><div class="line">            <span class="string">'&lt;input style="display:none;" name="content" class="content" value="'</span> +</div><div class="line">            item.content+</div><div class="line">            <span class="string">'"/&gt;'</span> +</div><div class="line">            <span class="string">'&lt;div&gt;'</span> +</div><div class="line">            <span class="string">'&lt;div class="desc input-item"&gt;'</span> +</div><div class="line">            <span class="string">'&lt;textarea name="desc" id=""&gt;'</span>+</div><div class="line">            (item.desc||<span class="string">''</span>)+</div><div class="line">            <span class="string">'&lt;/textarea&gt;'</span> +</div><div class="line">            <span class="string">'&lt;/div&gt;'</span> +</div><div class="line">            <span class="string">'&lt;/div&gt;'</span> +</div><div class="line">            <span class="string">'&lt;div class="remind input-item"&gt;'</span> +</div><div class="line">            <span class="string">'&lt;input type="date" name="remind_date" value="'</span> +</div><div class="line">            item.remind_date +</div><div class="line">            <span class="string">'" /&gt;'</span> +</div><div class="line">            <span class="string">'&lt;/div&gt;'</span>+</div><div class="line">            <span class="string">'&lt;div class="input-item"&gt;&lt;button type="submit" class="fr"&gt;Update&lt;/button&gt;&lt;/div&gt;'</span>+</div><div class="line">            <span class="string">'&lt;/form&gt;'</span>;</div></pre></td></tr></table></figure><p>​</p></li><li><p>将要修改的tag内容清空，然后填充我们自定义的html代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> $form_add_task = $(<span class="string">".add-task"</span>)</div><div class="line">        ,$task_detail_mask=$(<span class="string">".task-detail-mask"</span>)</div><div class="line">        ,$task_detail = $(<span class="string">".task-detail"</span>)   <span class="comment">// css selector选择器</span></div><div class="line">        ,$task_detail_trigger  <span class="comment">//这个元素是js后添加的，要在添加完成后在调用选择器</span></div><div class="line">        ,$task_detail_content;</div><div class="line"><span class="comment">//清空旧模板</span></div><div class="line">$task_detail.html(<span class="string">""</span>);</div><div class="line"><span class="comment">//使用新模板代替旧模板</span></div><div class="line">$task_detail.html(task_detail_tpl);</div></pre></td></tr></table></figure></li><li><p>如果有选择器，要在更新完HTML代码之后执行。之前定义的Jquery不会再次执行，浴室没选到tag，结果undefinded。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$task_detail_content =$task_detail.find(<span class="string">'[class=content]'</span>)</div></pre></td></tr></table></figure></li><li><p>为同一类tag绑定事件监听。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">listen_task_detail</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  $task_detail_trigger=$(<span class="string">".action.detail"</span>);</div><div class="line">        $task_detail_trigger.on(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> $<span class="keyword">this</span> = $(<span class="keyword">this</span>);</div><div class="line">            <span class="keyword">var</span>  $item = $<span class="keyword">this</span>.parent().parent();</div><div class="line">            <span class="keyword">var</span> index = $item.data(<span class="string">'index'</span>);</div><div class="line">           show_task_detail(index);</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line"><span class="comment">// 然后在js执行时调用函数</span></div><div class="line">listen_task_detail()</div></pre></td></tr></table></figure></li></ul><p><img src="http://ww1.sinaimg.cn/large/af9df239ly1fhoa3rjgqbj20kv0hn43b.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;JQuery学习&quot;&gt;&lt;a href=&quot;#JQuery学习&quot; class=&quot;headerlink&quot; title=&quot;JQuery学习&quot;&gt;&lt;/a&gt;JQuery学习&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;前端开发的库&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;
      
    
    </summary>
    
      <category term="技术" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Web" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Web/"/>
    
      <category term="JavaScript" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Web/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="http://shuaiyy.cn/tags/JavaScript/"/>
    
      <category term="JQuery" scheme="http://shuaiyy.cn/tags/JQuery/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript实现的部分功能</title>
    <link href="http://shuaiyy.cn/2018/02/05/%E6%8A%80%E6%9C%AF/JavaScript%E5%89%8D%E7%AB%AF%E9%83%A8%E5%88%86%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/"/>
    <id>http://shuaiyy.cn/2018/02/05/技术/JavaScript前端部分功能实现/</id>
    <published>2018-02-04T16:00:00.000Z</published>
    <updated>2018-06-03T08:05:12.214Z</updated>
    
    <content type="html"><![CDATA[<ul><li>JavaScript判断表单内容，不满足条件则不提交</li></ul><p><code>&lt;form method=&quot;post&quot; action=&quot;/study/register.jsp&quot; onsubmit=&quot;return register()&quot;&gt;</code><br>长度判断<br>整数判断<br>正则判断</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"/study/register.jsp"</span> <span class="attr">onsubmit</span>=<span class="string">"return register()"</span>&gt;</span></div><div class="line">账号：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"></div><div class="line">年龄：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"age"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"age"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">  </div><div class="line">EMail：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"email"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"email"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">  </div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"注册"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">    </div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params"></span>)</span>&#123;</span></div><div class="line"><span class="javascript">   <span class="keyword">var</span> name = <span class="built_in">document</span>.getElementById(<span class="string">"name"</span>);</span></div><div class="line"><span class="javascript">   <span class="keyword">if</span>(name.value.length&lt;<span class="number">3</span>)&#123;</span></div><div class="line"><span class="javascript">     alert(<span class="string">"用户名至少需要3位长度"</span>);</span></div><div class="line"><span class="javascript">     <span class="keyword">return</span> <span class="literal">false</span>;</span></div><div class="line"><span class="undefined">   &#125;</span></div><div class="line"><span class="undefined"></span></div><div class="line"><span class="javascript">   <span class="keyword">var</span> age = <span class="built_in">document</span>.getElementById(<span class="string">"age"</span>);</span></div><div class="line"><span class="undefined"></span></div><div class="line"><span class="javascript">   <span class="keyword">if</span>(<span class="built_in">isNaN</span>(age.value))&#123;</span></div><div class="line"><span class="javascript">     alert(<span class="string">"年龄必须是数字"</span>);</span></div><div class="line"><span class="javascript">     <span class="keyword">return</span> <span class="literal">false</span>;</span></div><div class="line"><span class="undefined">   &#125;</span></div><div class="line"><span class="undefined">  </span></div><div class="line"><span class="javascript">  <span class="keyword">var</span> email = <span class="built_in">document</span>.getElementById(<span class="string">"email"</span>);</span></div><div class="line"><span class="undefined">       </span></div><div class="line"><span class="javascript">  <span class="keyword">if</span>(<span class="number">0</span>==email.value.length)&#123;</span></div><div class="line"><span class="javascript">     alert(<span class="string">"email不能为空"</span>);</span></div><div class="line"><span class="javascript">    <span class="keyword">return</span> <span class="literal">false</span>;</span></div><div class="line"><span class="undefined">  &#125;</span></div><div class="line"><span class="undefined">    </span></div><div class="line"><span class="javascript">  <span class="keyword">var</span> Regex = <span class="regexp">/^(?:\w+\.?)*\w+@(?:\w+\.)*\w+$/</span>;       </span></div><div class="line"><span class="undefined">    </span></div><div class="line"><span class="javascript">  <span class="keyword">if</span> (!Regex.test(email.value))&#123;                </span></div><div class="line"><span class="javascript">       alert(<span class="string">"email格式不正确"</span>);</span></div><div class="line"><span class="javascript">       <span class="keyword">return</span> <span class="literal">false</span>;</span></div><div class="line"><span class="undefined">  &#125;            </span></div><div class="line"><span class="javascript">   <span class="keyword">return</span> <span class="literal">true</span>;</span></div><div class="line"><span class="undefined">  &#125;</span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure><a id="more"></a><ul><li>javascript 显示或隐藏元素</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">hide</span>(<span class="params"></span>)</span>&#123;</div><div class="line"> <span class="keyword">var</span> d = <span class="built_in">document</span>.getElementById(<span class="string">"d"</span>);</div><div class="line"> d.style.display=<span class="string">"none"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</div><div class="line"> <span class="keyword">var</span> d = <span class="built_in">document</span>.getElementById(<span class="string">"d"</span>);</div><div class="line"> d.style.display=<span class="string">"block"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li><p>javascript 删除内容前提示</p><p>window.confirm<br>parentNode<br>removeChild<br>deleteRow(rowIndex)</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">deleteRow</span>(<span class="params">link</span>)</span>&#123;</span></div><div class="line"><span class="javascript"> <span class="keyword">var</span> b =  confirm(<span class="string">"确定删除？"</span>)</span></div><div class="line"><span class="javascript"> <span class="keyword">if</span>(!b)</span></div><div class="line"><span class="javascript">   <span class="keyword">return</span>;</span></div><div class="line"><span class="undefined"></span></div><div class="line"><span class="javascript"><span class="keyword">var</span> table = <span class="built_in">document</span>.getElementById(<span class="string">"heroTable"</span>);</span></div><div class="line"><span class="javascript"><span class="keyword">var</span> td = link.parentNode;</span></div><div class="line"><span class="javascript"><span class="keyword">var</span> tr = td.parentNode;</span></div><div class="line"><span class="javascript"><span class="keyword">var</span> index=tr.rowIndex;</span></div><div class="line"><span class="undefined">table.deleteRow(index);</span></div><div class="line"><span class="undefined"></span></div><div class="line"><span class="undefined">&#125;</span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">border</span>=<span class="string">"1"</span> <span class="attr">cellspacing</span>=<span class="string">"0"</span> <span class="attr">id</span>=<span class="string">"heroTable"</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">tbody</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">"50%"</span>&gt;</span>英雄名称<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">td</span>&gt;</span></div><div class="line">       操作</div><div class="line">   <span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">td</span>&gt;</span>盖伦<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">td</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">onclick</span>=<span class="string">"deleteRow(this)"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span>     </div><div class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">td</span>&gt;</span>提莫<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">td</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">onclick</span>=<span class="string">"deleteRow(this)"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span>     </div><div class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">td</span>&gt;</span>祈求者<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">td</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">onclick</span>=<span class="string">"deleteRow(this)"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span>     </div><div class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>javascript 实现表格排序</li></ul><p>使用col记录上次点击的列，reverse记录升序还是降序；如果再次点击该列，则排序方式取逆。<br>table append节点时，由于插入的是原有的元素节点，因而tr的内容和总行数不会发生变化，只有顺序改变。<br>比较器自定义，使用String.localeCompare比较字符串。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="undefined">table&#123;</span></div><div class="line"><span class="css"><span class="selector-tag">border-collapse</span><span class="selector-pseudo">:collapse</span>;</span></div><div class="line"><span class="css"><span class="selector-tag">width</span><span class="selector-pseudo">:90</span>%;</span></div><div class="line"><span class="undefined">&#125;</span></div><div class="line"><span class="undefined">tr&#123;</span></div><div class="line"><span class="undefined">border-bottom-style: solid;</span></div><div class="line"><span class="undefined">border-bottom-width: 1px;</span></div><div class="line"><span class="undefined">border-bottom-color: lightgray;</span></div><div class="line"><span class="css"><span class="selector-tag">height</span><span class="selector-pseudo">:35px</span>;</span></div><div class="line"><span class="undefined">&#125;</span></div><div class="line"><span class="undefined">    </span></div><div class="line"><span class="undefined">td&#123;</span></div><div class="line"><span class="css"><span class="selector-tag">width</span><span class="selector-pseudo">:25</span>%;</span></div><div class="line"><span class="css"><span class="selector-tag">text-align</span><span class="selector-pseudo">:center</span>;</span></div><div class="line"><span class="undefined">&#125;</span></div><div class="line"><span class="undefined">  </span></div><div class="line"><span class="undefined">a&#123;</span></div><div class="line"><span class="undefined">  text-decoration: none;</span></div><div class="line"><span class="css">  <span class="selector-tag">color</span><span class="selector-pseudo">:skyblue</span>;</span></div><div class="line"><span class="undefined">&#125;  </span></div><div class="line"><span class="undefined">  </span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="javascript"><span class="keyword">var</span> col = <span class="number">0</span>;</span></div><div class="line"><span class="javascript"><span class="keyword">var</span> reverse = <span class="literal">false</span>;</span></div><div class="line"><span class="undefined"></span></div><div class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">sort</span>(<span class="params">column</span>)</span>&#123;</span></div><div class="line"><span class="javascript"> <span class="keyword">if</span>(column == col)</span></div><div class="line"><span class="undefined">     reverse = !reverse;</span></div><div class="line"><span class="undefined"> col = column;</span></div><div class="line"><span class="javascript"> <span class="keyword">var</span> tbody = <span class="built_in">document</span>.getElementById(<span class="string">"tbody"</span>);</span></div><div class="line"><span class="javascript"> <span class="comment">//通过getElementsByTagName取出来是一个Collection</span></span></div><div class="line"><span class="javascript"> <span class="keyword">var</span> trsCollection =  <span class="built_in">document</span>.getElementsByTagName(<span class="string">"tr"</span>);</span></div><div class="line"><span class="javascript"> <span class="comment">//因为Collection没有自带的排序函数，所以需要转换为数组，利用数组自带的排序</span></span></div><div class="line"><span class="javascript"> <span class="keyword">var</span> trs =<span class="keyword">new</span> <span class="built_in">Array</span>();</span></div><div class="line"><span class="javascript"> <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i &lt;trsCollection.length; i++) &#123;</span></div><div class="line"><span class="undefined">    trs.push(trsCollection[i]);</span></div><div class="line"><span class="undefined"> &#125;</span></div><div class="line"><span class="undefined"> trs.sort(comparator);</span></div><div class="line"><span class="javascript"> <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt;trs.length; i++) &#123;</span></div><div class="line"><span class="undefined">  tbody.appendChild(trs[i]);</span></div><div class="line"><span class="undefined"> &#125;</span></div><div class="line"><span class="undefined">&#125;</span></div><div class="line"><span class="undefined"></span></div><div class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">comparator</span>(<span class="params">tr1,tr2</span>)</span>&#123;</span></div><div class="line"><span class="javascript">   <span class="keyword">var</span> td1 = tr1.children[col].innerHTML; <span class="comment">//取某一行的第col列中的内容</span></span></div><div class="line"><span class="javascript">   <span class="keyword">var</span> td2 = tr2.children[col].innerHTML;</span></div><div class="line"><span class="javascript">   <span class="keyword">if</span>(reverse)</span></div><div class="line"><span class="javascript">    <span class="keyword">return</span> td1.localeCompare(td2);</span></div><div class="line"><span class="javascript">   <span class="keyword">else</span></span></div><div class="line"><span class="javascript">    <span class="keyword">return</span> td2.localeCompare(td1);</span></div><div class="line"><span class="undefined">&#125;</span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">tbody</span> <span class="attr">id</span>=<span class="string">"tbody"</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void(0)"</span> <span class="attr">onclick</span>=<span class="string">"sort(0)"</span>&gt;</span>id<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void(0)"</span> <span class="attr">onclick</span>=<span class="string">"sort(1)"</span>&gt;</span>名称<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void(0)"</span> <span class="attr">onclick</span>=<span class="string">"sort(2)"</span>&gt;</span>血量<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void(0)"</span> <span class="attr">onclick</span>=<span class="string">"sort(3)"</span>&gt;</span>伤害<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>annie<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>380<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>38<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>gareen<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>340<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>58<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>teemo<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>320<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>76<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>4<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>deadbrother<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>400<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>90<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>JavaScript中的json对象</li></ul><p>定义和使用json对象和数组<br>字符串转json对象，通过字符串拼接得到一个JSON结构的字符串，并不是一个JSON对象。 需要通过eval转换得到<br>转换的时候注意,eval 函数的字符串参数以<code>(</code>开头 <code>)</code>结尾。<br>或者使用JQuery的$.parseJSON转换函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">var gareen = &#123;&quot;name&quot;:&quot;盖伦&quot;,&quot;hp&quot;:616&#125;;</div><div class="line">alert(&quot;这是一个JSON对象: &quot;+gareen);</div><div class="line">alert(&quot;英雄名称: &quot; + gareen.name + &quot;&lt;br&gt;&quot;);</div><div class="line">alert(&quot;英雄血量: &quot; + gareen.hp + &quot;&lt;br&gt;&quot;);</div><div class="line"></div><div class="line">var heros=</div><div class="line">[</div><div class="line">    &#123;&quot;name&quot;:&quot;盖伦&quot;,&quot;hp&quot;:616&#125;,</div><div class="line">    &#123;&quot;name&quot;:&quot;提莫&quot;,&quot;hp&quot;:313&#125;,</div><div class="line">    &#123;&quot;name&quot;:&quot;死哥&quot;,&quot;hp&quot;:432&#125;,</div><div class="line">    &#123;&quot;name&quot;:&quot;火女&quot;,&quot;hp&quot;:389&#125;</div><div class="line">]</div><div class="line">alert( &quot;第4个英雄是:&quot; +  heros[3].name);</div><div class="line"></div><div class="line">var s1 = &quot;&#123;\&quot;name\&quot;:\&quot;盖伦\&quot;&quot;;</div><div class="line">var s2 = &quot;,\&quot;hp\&quot;:616&#125;&quot;;</div><div class="line">var s3 = s1+s2;</div><div class="line">var gareen = eval(&quot;(&quot;+s3+&quot;)&quot;);</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><ul><li>AJAX实现登录前表单验证</li></ul><p>AJAX: Asynchronous JAvaScript and XML<br>判断账户是否存在<br>1、定义一个XMLHttpRequest对象，即XHR对象<br>2、设置响应函数  <code>xmlhttp.onreadystatechange=checkResult; //响应函数</code><br>3、设置访问URL和参数<br>4、执行请求</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>输入账号 :<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">onkeyup</span>=<span class="string">"check()"</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"checkResult"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="javascript"><span class="keyword">var</span> xmlhttp;</span></div><div class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span></div><div class="line"><span class="javascript">  <span class="keyword">var</span> name = <span class="built_in">document</span>.getElementById(<span class="string">"name"</span>).value;</span></div><div class="line"><span class="javascript">  <span class="keyword">var</span> url = <span class="string">"http://how2j.cn/study/checkName.jsp?name="</span>+name;</span></div><div class="line"><span class="undefined"> </span></div><div class="line"><span class="javascript">  xmlhttp =<span class="keyword">new</span> XMLHttpRequest();</span></div><div class="line"><span class="javascript">  xmlhttp.onreadystatechange=checkResult; <span class="comment">//响应函数</span></span></div><div class="line"><span class="javascript">  xmlhttp.open(<span class="string">"GET"</span>,url,<span class="literal">true</span>);   <span class="comment">//设置访问的页面</span></span></div><div class="line"><span class="javascript">  xmlhttp.send(<span class="literal">null</span>);  <span class="comment">//执行访问</span></span></div><div class="line"><span class="undefined">&#125;</span></div><div class="line"><span class="undefined"> </span></div><div class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">checkResult</span>(<span class="params"></span>)</span>&#123;</span></div><div class="line"><span class="javascript">  <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span></div><div class="line"><span class="javascript">    <span class="built_in">document</span>.getElementById(<span class="string">'checkResult'</span>).innerHTML=xmlhttp.responseText;</span></div><div class="line"><span class="undefined">  </span></div><div class="line"><span class="undefined">&#125;</span></div><div class="line"><span class="undefined"> </span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>jquery</li></ul><p>使用前先引入jQuery库</p><p><code>$(function(){...});</code> 表示在HTML文档加载完成后在执行()里的内容 function，防止jQuery代码被提前执行；<br><code>$(&quot;css selector&quot;)</code> 用于选中元素对象<br>jQuery可以方便的在元素对象上监听事件<code>$(&quot;css selector&quot;).click(function(){})</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://how2j.cn/study/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="javascript">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></div><div class="line"><span class="javascript">   $(<span class="string">"#b1"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></div><div class="line"><span class="javascript">      $(<span class="string">"#d"</span>).hide();</span></div><div class="line"><span class="undefined">   &#125;);</span></div><div class="line"><span class="javascript">   $(<span class="string">"#b2"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></div><div class="line"><span class="javascript">      $(<span class="string">"#d"</span>).show();</span></div><div class="line"><span class="undefined">   &#125;);</span></div><div class="line"><span class="undefined">&#125;);</span></div><div class="line"><span class="undefined"> </span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"b1"</span>&gt;</span>隐藏div<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"b2"</span>&gt;</span>显示div<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"> </div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"d"</span>&gt;</span></div><div class="line"> </div><div class="line">这是一个div</div><div class="line"> </div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><h3 id="JQuery元素提取内容"><a href="#JQuery元素提取内容" class="headerlink" title="JQuery元素提取内容"></a>JQuery元素提取内容</h3><p>取值使用 <code>$(&quot;css selector&quot;).val();</code> 相当于 <code>document.getElementById(&quot;input1&quot;).value;</code><br>获取元素使用 <code>$(&quot;css selector&quot;).html();</code><br>不包含标签的元素 <code>$(&quot;css selector&quot;).text();</code></p><h3 id="操作css"><a href="#操作css" class="headerlink" title="操作css"></a>操作css</h3><p>增加、移除class，切换class状态，以及css函数的使用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   $(<span class="string">"#b1"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      $(<span class="string">"#d"</span>).addClass(<span class="string">"pink"</span>); <span class="comment">//增加class pink，要有.pink的class定义，样式才会生效</span></div><div class="line">      $(<span class="string">"#d"</span>).removeClass(<span class="string">"pink"</span>);<span class="comment">// 移除class </span></div><div class="line">      $(<span class="string">"#d"</span>).toggleClass(<span class="string">"pink"</span>); <span class="comment">//切换class，如果存在pink则移除，不存在则添加</span></div><div class="line">      $(<span class="string">"#d2"</span>).css(&#123;<span class="string">"background-color"</span>:<span class="string">"pink"</span>,<span class="string">"color"</span>:<span class="string">"green"</span>&#125;); <span class="comment">// 使用css函数，修改style里的属性键值。</span></div><div class="line">      $(<span class="string">"#d1"</span>).css(<span class="string">"background-color"</span>,<span class="string">"pink"</span>);</div><div class="line">   &#125;);</div><div class="line">  </div><div class="line">&#125;);</div><div class="line"></div><div class="line">&lt;style&gt;</div><div class="line">.pink&#123;</div><div class="line">   background-color:pink;</div><div class="line">&#125;</div><div class="line">&lt;<span class="regexp">/style&gt;</span></div></pre></td></tr></table></figure><h3 id="jQuery选择器"><a href="#jQuery选择器" class="headerlink" title="jQuery选择器"></a>jQuery选择器</h3><p>准确的将应该是css选择器，利用标签、样式、属性选择元素。</p><ul><li><code>$(this)</code> 表示当前元素</li><li><code>$(&quot;tagName&quot;)</code></li><li><code>$(&quot;#id&quot;)</code></li><li><code>$(&quot;.className&quot;)</code></li><li><code>$(&quot;tagName&quot;)</code></li><li><code>$(&quot;div#id1 span.red a&quot;)</code></li></ul><p>有条件的选中元素</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">"div:first"</span>).addClass(<span class="string">"pink"</span>); <span class="comment">// 选中第一个元素</span></div><div class="line">$(<span class="string">"div:last"</span>).addClass(<span class="string">"pink"</span>); <span class="comment">// 选中最后一个元素</span></div><div class="line">$(<span class="string">"div:odd"</span>).toggleClass(<span class="string">"pink"</span>); <span class="comment">// 选中偶数元素</span></div><div class="line">$(<span class="string">"div:even"</span>).toggleClass(<span class="string">"pink"</span>); <span class="comment">// 选中奇数元素</span></div><div class="line">$(<span class="string">"selector:hidden"</span>)  <span class="comment">// 满足选择器条件的不可见的元素</span></div><div class="line">$(<span class="string">"selector:visible"</span>)   <span class="comment">//  满足选择器条件的可见的元素</span></div></pre></td></tr></table></figure><p>根据属性选择元素，属性值的比较</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">"selector[attribute]"</span>)   <span class="comment">// 满足选择器条件的有某属性的元素</span></div><div class="line">$(<span class="string">"selector[attribute=value]"</span>) <span class="comment">// 满足选择器条件的属性等于value的元素</span></div><div class="line">$(<span class="string">"selector[attribute!=value]"</span>) <span class="comment">// 满足选择器条件的属性不等于value的元素</span></div><div class="line">$(<span class="string">"selector[attribute^=value]"</span>) <span class="comment">// 满足选择器条件的属性以value开头的元素</span></div><div class="line">$(<span class="string">"selector[attribute$=value]"</span>) <span class="comment">// 满足选择器条件的属性以value结尾的元素</span></div><div class="line">$(<span class="string">"selector[attribute*=value]"</span>) <span class="comment">// 满足选择器条件的属性包含value的元素</span></div></pre></td></tr></table></figure><p>表单对象和表单对象属性</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">"selector:input"</span>) <span class="comment">// 会选择所有的输入元素，不仅仅是input标签开始的那些，还包括textarea,select和button</span></div><div class="line">$(<span class="string">"selector:button"</span>) <span class="comment">// 会选择type=button的input元素和button元素</span></div><div class="line">$(<span class="string">"selector:radio"</span>) <span class="comment">// 会选择单选框</span></div><div class="line">$(<span class="string">"selector:checkbox"</span>) <span class="comment">// 会选择复选框</span></div><div class="line">$(<span class="string">"selector:text"</span>) <span class="comment">// 会选择文本框，但是不会选择文本域</span></div><div class="line">$(<span class="string">"selector:submit"</span>) <span class="comment">// 会选择提交按钮</span></div><div class="line">$(<span class="string">"selector:image"</span>) <span class="comment">// 会选择图片型提交按钮</span></div><div class="line">$(<span class="string">"selector:reset"</span>) <span class="comment">// 会选择重置按钮</span></div><div class="line"></div><div class="line"><span class="comment">//表单对象属性</span></div><div class="line"></div><div class="line">$(<span class="string">"selector:enabled"</span>) <span class="comment">// 会选择可用的输入元素 注：输入元素的默认状态都是可用 </span></div><div class="line">$(<span class="string">"selector:disabled"</span>) <span class="comment">// 会选择不可用的输入元素 </span></div><div class="line">$(<span class="string">"selector:checked"</span>) <span class="comment">// 会选择被选中的单选框和复选框 注： checked在部分浏览器上(火狐,chrome)也可以选中selected的option </span></div><div class="line">$(<span class="string">"selector:select"</span>) <span class="comment">// 会选择被选中的option元素</span></div></pre></td></tr></table></figure><h3 id="jQuery筛选器"><a href="#jQuery筛选器" class="headerlink" title="jQuery筛选器"></a>jQuery筛选器</h3><p>在选择器后可以使用的筛选函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">"div"</span>).first().toggleClass(<span class="string">"pink"</span>); <span class="comment">// 选中第一个元素</span></div><div class="line">$(<span class="string">"div"</span>).last().toggleClass(<span class="string">"pink"</span>); <span class="comment">// 选中最后一个元素</span></div><div class="line">$(<span class="string">"div"</span>).eq(<span class="number">4</span>).toggleClass(<span class="string">"pink"</span>); <span class="comment">// 选中第n个元素，n起始为0</span></div><div class="line">$(<span class="string">"#currentDiv"</span>).parent().toggleClass(<span class="string">"b"</span>); <span class="comment">// 选中父元素</span></div><div class="line">$(<span class="string">"#currentDiv"</span>).parents().toggleClass(<span class="string">"b"</span>); <span class="comment">// 选中祖先元素</span></div><div class="line">$(<span class="string">"#currentDiv"</span>).children().toggleClass(<span class="string">"b"</span>); <span class="comment">// 选中直接子元素</span></div><div class="line">$(<span class="string">"#currentDiv"</span>).siblings().toggleClass(<span class="string">"b"</span>); <span class="comment">// 选中同级元素</span></div><div class="line">$(<span class="string">"#currentDiv"</span>).find(<span class="string">"div"</span>).toggleClass(<span class="string">"b"</span>); <span class="comment">// 在当前元素下继续使用selector查找</span></div></pre></td></tr></table></figure><h3 id="jQuery操作元素属性"><a href="#jQuery操作元素属性" class="headerlink" title="jQuery操作元素属性"></a>jQuery操作元素属性</h3><p>attr 和 prop 获取、修改、删除</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">"#h"</span>).attr(<span class="string">"align"</span>) <span class="comment">// 获取align属性</span></div><div class="line">$(<span class="string">"#h"</span>).attr(<span class="string">"align"</span>,<span class="string">"right"</span>) ; <span class="comment">// 修改align属性</span></div><div class="line">$(<span class="string">"#h"</span>).removeAttr(<span class="string">"align"</span>); <span class="comment">// 删除属性</span></div><div class="line"></div><div class="line"><span class="comment">// prop无法获取用户自定义的属性</span></div><div class="line">$(<span class="string">"#c"</span>).prop(<span class="string">"game"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 对于选中属性，如checked，attr获取的是初始值即checked, prop获取的是当前状态，返回的是true or false</span></div><div class="line">$(<span class="string">"#c"</span>).attr(<span class="string">"checked"</span>); <span class="comment">// 结果是不变的初始值</span></div><div class="line">$(<span class="string">"#c"</span>).prop(<span class="string">"checked"</span>); <span class="comment">// 结果为当前状态</span></div></pre></td></tr></table></figure><h3 id="jQuery动画效果"><a href="#jQuery动画效果" class="headerlink" title="jQuery动画效果"></a>jQuery动画效果</h3><p>效果函数允许传入一个延时参数和动画完成后的回调函数</p><ul><li>显示 隐藏 切换<br>显示 隐藏 切换 分别通过show(), hide(),toggle()实现；<br>也可以加上毫秒数，表示延时操作,比如show(2000)</li><li>滑动<br>向上滑动 向下滑动 滑动切换 分别通过slideUp(), slideDown(),slideToggle()实现<br>也可以加上毫秒数，表示延时操作，比如slideUp(2000) </li><li>淡入 淡出<br>淡入 淡出 淡入淡出切换 指定淡入程度 分别通过fadeIn(), fadeOut(),fadeToggle() fadeTo()实现<br>也可以加上毫秒数，表示延时操作，比如fadeIn(2000)<br>fadeTo跟的参数是0-1之间的小数。 0表示不淡入，1表示全部淡入</li><li>自定义动画效果<br>通过animate 可以实现更为丰富的动画效果<br>animate()第一个参数为css样式<br>animate()第二个参数为延时毫秒<br>注： 默认情况下，html中的元素都是固定，并且无法改变的位置的。 为了使用animate()自定义动画效果，需要通过css把元素的position设置为relative、absolute或者fixed。</li><li>回调函数<br>效果一般需要一定的时间，并且这个时间可长可短，所以就无法精确的确定该效果合适结束。<br>好在，效果方法都提供对回调函数callback()的支持。<br>只需要在调用效果方法的最后一个参数传入一个function，当效果结束的时候，就会自动调用该function了。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> div = $(<span class="string">"#d"</span>);</div><div class="line">div.hide();  <span class="comment">// 隐藏元素div</span></div><div class="line">div.show(); <span class="comment">// 显示元素div</span></div><div class="line">div.toggle(); <span class="comment">// 切换状态，显示或隐藏元素div</span></div><div class="line"><span class="comment">// 延时1000毫秒</span></div><div class="line">div.hide(<span class="number">1000</span>);</div><div class="line">div.show(<span class="number">1000</span>);</div><div class="line">div.toggle(<span class="number">1000</span>);</div><div class="line"></div><div class="line">div.slideUp(); <span class="comment">// 向上滑动</span></div><div class="line">div.slideDown(<span class="number">1000</span>);  <span class="comment">// 向下滑动</span></div><div class="line">div.slideToggle(); <span class="comment">// 滑动切换</span></div><div class="line"></div><div class="line">div.fadeIn(<span class="number">2000</span>); <span class="comment">// 延时2000毫秒淡入</span></div><div class="line">div.fadeOut(<span class="number">2000</span>); <span class="comment">// 延时2000毫秒淡出</span></div><div class="line">div.fadeToggle(<span class="number">2000</span>); <span class="comment">// 淡入淡出切换</span></div><div class="line"></div><div class="line"><span class="comment">// 指定淡入程度，0完全淡出元素不可见，1完全显示</span></div><div class="line">$(<span class="string">"#d1"</span>).fadeTo(<span class="string">"slow"</span>,<span class="number">0.2</span>);</div><div class="line">$(<span class="string">"#d2"</span>).fadeTo(<span class="string">"slow"</span>,<span class="number">0.5</span>);</div><div class="line">$(<span class="string">"#d3"</span>).fadeTo(<span class="string">"slow"</span>,<span class="number">0.8</span>);</div><div class="line"></div><div class="line"><span class="comment">// 自定义动画效果</span></div><div class="line">div.animate(&#123;<span class="attr">left</span>:<span class="string">'100px'</span>&#125;,<span class="number">2000</span>); <span class="comment">// 移动到距离左侧100px的位置</span></div><div class="line">div.animate(&#123;<span class="attr">left</span>:<span class="string">'0px'</span>,<span class="attr">top</span>:<span class="string">'50px'</span>,<span class="attr">height</span>:<span class="string">'50px'</span>&#125;,<span class="number">2000</span>); <span class="comment">// 移动到距左侧0px，距离顶部50px的位置，同时改变高度为50px；</span></div><div class="line"><span class="comment">// 动画结束后调用回调函数</span></div><div class="line">div.animate(&#123;<span class="attr">left</span>:<span class="string">'0px'</span>,<span class="attr">top</span>:<span class="string">'50px'</span>,<span class="attr">height</span>:<span class="string">'50px'</span>&#125;,<span class="number">2000</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">     alert(<span class="string">"动画演示结束"</span>);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure><h3 id="jQuery事件"><a href="#jQuery事件" class="headerlink" title="jQuery事件"></a>jQuery事件</h3><p>加载 ：<code>$(document).ready()</code> <code>$()</code><br>图片加载： <code>load()</code><br>鼠标事件：<code>click()</code> <code>dblclick()</code>  <code>mousedown()</code> <code>mouseup()</code> <code>mousemove()</code> <code>mouseenter()</code> <code>mouseleave()</code> <code>mouseover()</code> <code>mouseout()</code><br>    mousedown 表示鼠标按下<br>mouseup表示鼠标弹起 </p><p>mousemove表示鼠标进入<br>mouseenter表示鼠标进入<br>mouseover表示鼠标进入 </p><p>mouseleave表示鼠标离开<br>mouseout表示鼠标离开 </p><p>进入事件有3个 mousemove mouseenter mouseover<br>mousemove ：当鼠标进入元素，每移动一下都会被调用<br>mouseenter ：当鼠标进入元素，调用一下，在其中移动，不调用<br>mouseover：当鼠标进入元素，调用一下，在其中移动，不调用 </p><p>mouseenter 和 mouseover的区别<br>mouseenter: 当鼠标经过其子元素不会被调用<br>mouseover：当鼠标经过其子元素会被调用 </p><p>mouseleave 和 mouseout的区别<br>mouseleave: 当鼠标经过其子元素不会被调用<br>mouseout：当鼠标经过其子元素会被调用</p><p>键盘事件 <code>keydown()</code> <code>keypress()</code> <code>keyup</code><br>    先后顺序： 按照 keydown keypress keyup 顺序发生<br>    键盘按钮值：<br>    通过event对象的which属性获取键盘的值<br>    keydown和keyup 能获取所有按键，不能识别大小写<br>    keypress 不能获取功能键，如F1 SHIFT等，能够识别大小写<br>    文本取值：<br>        keydown和keypress：不能获取最后一个字符<br>        keyup： 获取所有字符</p><p>焦点：     <code>focus()</code> <code>blur()</code><br>内容改变： <code>change()</code>  注： 对于文本框，只有当该文本失去焦点的时候，才会触发change事件。<br>提交： <code>submit()</code><br>绑定事件：<code>on()</code><br>触发事件： <code>trigger()</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// 页面加载</span></div><div class="line"> $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $(<span class="string">"#message1"</span>).html(<span class="string">"页面加载成功"</span>);</div><div class="line">  &#125;);</div><div class="line"> </div><div class="line"> $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  <span class="comment">// 不常用</span></div><div class="line">    $(<span class="string">"#message1"</span>).html(<span class="string">"页面加载成功"</span>);</div><div class="line">  &#125;);</div><div class="line">  </div><div class="line">  <span class="comment">// 图片加载</span></div><div class="line"> $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $(<span class="string">"#img"</span>).load(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      $(<span class="string">"#message2"</span>).html(<span class="string">"图片加载成功"</span>);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">  </div><div class="line"><span class="comment">/* click() 表示单击 dblclick() 表示双击; </span></div><div class="line"><span class="comment">注: 空白键和回车键也可以触发click事件，但是只有双击鼠标才能造成dblclick事件 */</span></div><div class="line">  $(<span class="string">"#b"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">          $(<span class="string">"#message"</span>).html(<span class="string">"单击按钮"</span>);</div><div class="line">      &#125;);</div><div class="line">  $(<span class="string">"#b"</span>).dblclick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">          $(<span class="string">"#message"</span>).html(<span class="string">"双击按钮"</span>);</div><div class="line">      &#125;);</div><div class="line">  <span class="comment">// 键盘事件</span></div><div class="line">  $(<span class="string">"#i"</span>).keydown(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">     alert(e.which)</div><div class="line">  &#125;);</div><div class="line">  </div><div class="line">  <span class="comment">// 焦点</span></div><div class="line">  $(<span class="string">"input"</span>).focus(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $(<span class="keyword">this</span>).val(<span class="string">"获取了焦点"</span>);</div><div class="line"> &#125;);</div><div class="line">  </div><div class="line">  $(<span class="string">"input"</span>).blur(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $(<span class="keyword">this</span>).val(<span class="string">"失去了焦点"</span>);</div><div class="line"> &#125;);</div><div class="line"> <span class="comment">// 内容改变：</span></div><div class="line"> $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $(<span class="string">"#input1"</span>).change(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> text = $(<span class="keyword">this</span>).val();</div><div class="line">        $(<span class="string">"#message"</span>).html(<span class="string">"input1的内容变为了"</span>+text);</div><div class="line">    &#125;);</div><div class="line"> &#125;);</div><div class="line"> </div><div class="line"> <span class="comment">// 以上操作都可以用$(element).on(event,function)形式实现</span></div><div class="line"> $(<span class="string">"#b"</span>).on(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">          $(<span class="string">"#message"</span>).html(<span class="string">"单击按钮"</span>);</div><div class="line">      &#125;);</div><div class="line"> </div><div class="line"> <span class="comment">// 事件也可以主动触发</span></div><div class="line"> $(<span class="string">"#b"</span>).trigger(<span class="string">"dblclick"</span>); <span class="comment">// 触发双击事件</span></div></pre></td></tr></table></figure><h3 id="JQuery实现AJAX"><a href="#JQuery实现AJAX" class="headerlink" title="JQuery实现AJAX"></a>JQuery实现AJAX</h3><ul><li><code>$.ajax()</code><br>默认type参数为GET请求方式<br>重要的参数有url，data，type，回调函数success、error、complete，dataType包括”xml html script json jsonp text”, 不指定则由JQuery自行判断。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">"#name"</span>).keyup(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">     <span class="keyword">var</span> page = <span class="string">"/study/checkName.jsp"</span>;</div><div class="line">     <span class="keyword">var</span> value = $(<span class="keyword">this</span>).val();</div><div class="line">        $.ajax(&#123;</div><div class="line">            url: page,  <span class="comment">// 提交的页面</span></div><div class="line">            data:&#123;<span class="string">"name"</span>:value&#125;, <span class="comment">// 提交的数据</span></div><div class="line">            success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123; <span class="comment">// 成功后处理返回结果</span></div><div class="line">              $(<span class="string">"#checkResult"</span>).html(result);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure><ul><li><code>$.get()</code> 和 <code>s.post()</code></li></ul><p>使用3个参数 访问的页面,提交的数据,回调函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$.get(</div><div class="line">            page,</div><div class="line">            &#123;<span class="string">"name"</span>:value&#125;,</div><div class="line">            <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</div><div class="line">              $(<span class="string">"#checkResult"</span>).html(result);</div><div class="line">            &#125;</div><div class="line">        );</div><div class="line">        </div><div class="line"> $.post(</div><div class="line">            page,</div><div class="line">            &#123;<span class="string">"name"</span>:value&#125;,</div><div class="line">            <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</div><div class="line">              $(<span class="string">"#checkResult"</span>).html(result);</div><div class="line">            &#125;</div><div class="line">        );</div></pre></td></tr></table></figure><ul><li><p><code>$(&quot;div&quot;).load(pageUrl, data)</code> 在指定的div里显示请求pageUrl获取到的数据</p></li><li><p><code>var data = $(&quot;#form&quot;).serialize();</code> 将表单输入值格式化字符串</p></li></ul><h3 id="JQuery操作数组、字符串、json"><a href="#JQuery操作数组、字符串、json" class="headerlink" title="JQuery操作数组、字符串、json"></a>JQuery操作数组、字符串、json</h3><ul><li><code>$.each(array, function(index, data){})</code><br> 接收一个数组和一个回调函数，回调函数的参数为下标和数组元素值</li><li><code>$.unique(array)</code>  数组去重，去重前需要先排序</li><li><code>$.inArray(data,array)</code>  判断data是否在数组中</li><li><code>$.trim(&quot; Hello JQuery    &quot;)</code>  去掉字符串首尾的空格</li><li><code>$.parseJSON(&quot;{\&quot;name\&quot;: \&quot;Teemo\&quot;}&quot;)</code> 将json字符串解析成json对象</li></ul><h3 id="JQuery对象和JavaScript-DOM对象切换"><a href="#JQuery对象和JavaScript-DOM对象切换" class="headerlink" title="JQuery对象和JavaScript DOM对象切换"></a>JQuery对象和JavaScript DOM对象切换</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// jQuery转DOM</span></div><div class="line"><span class="keyword">var</span> div= $(<span class="string">"#d"</span>);  <span class="comment">// jQuery对象</span></div><div class="line"><span class="keyword">var</span> d = div[<span class="number">0</span>];    <span class="comment">// DOM对象</span></div><div class="line"><span class="keyword">var</span> d = div.get(<span class="number">0</span>); <span class="comment">// DOM对象</span></div><div class="line"></div><div class="line"><span class="comment">// DOM转jQuery</span></div><div class="line"><span class="keyword">var</span> div= <span class="built_in">document</span>.getElementById(<span class="string">"d"</span>); <span class="comment">//DOM对象</span></div><div class="line"><span class="keyword">var</span> d = $(div); <span class="comment">// jQuery对象</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;JavaScript判断表单内容，不满足条件则不提交&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;form method=&amp;quot;post&amp;quot; action=&amp;quot;/study/register.jsp&amp;quot; onsubmit=&amp;quot;return register()&amp;quot;&amp;gt;&lt;/code&gt;&lt;br&gt;长度判断&lt;br&gt;整数判断&lt;br&gt;正则判断&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;method&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;post&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;action&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;/study/register.jsp&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;onsubmit&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;return register()&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;账号：&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;br&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;br&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;年龄：&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;age&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;age&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;br&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;br&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;EMail：&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;email&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;email&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;br&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;br&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;submit&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;注册&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;br&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;form&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;undefined&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;register&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; name = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(name.value.length&amp;lt;&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;     alert(&lt;span class=&quot;string&quot;&gt;&quot;用户名至少需要3位长度&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;     &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;   &amp;#125;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; age = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&quot;age&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;built_in&quot;&gt;isNaN&lt;/span&gt;(age.value))&amp;#123;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;     alert(&lt;span class=&quot;string&quot;&gt;&quot;年龄必须是数字&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;     &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;   &amp;#125;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;  &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; email = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&quot;email&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;       &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;==email.value.length)&amp;#123;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;     alert(&lt;span class=&quot;string&quot;&gt;&quot;email不能为空&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;    &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; Regex = &lt;span class=&quot;regexp&quot;&gt;/^(?:\w+\.?)*\w+@(?:\w+\.)*\w+$/&lt;/span&gt;;       &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;    &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!Regex.test(email.value))&amp;#123;                &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;       alert(&lt;span class=&quot;string&quot;&gt;&quot;email格式不正确&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;  &amp;#125;            &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;javascript&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;undefined&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="技术" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="Web" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Web/"/>
    
      <category term="JavaScript" scheme="http://shuaiyy.cn/categories/%E6%8A%80%E6%9C%AF/Web/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="http://shuaiyy.cn/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Zeal自制docset</title>
    <link href="http://shuaiyy.cn/2018/01/15/%E5%AD%A6%E4%B9%A0/%E5%86%99%E4%BD%9C/Zeal%E8%87%AA%E5%88%B6docset/"/>
    <id>http://shuaiyy.cn/2018/01/15/学习/写作/Zeal自制docset/</id>
    <published>2018-01-14T16:00:00.000Z</published>
    <updated>2018-11-27T04:51:57.991Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Zeal自制docset"><a href="#Zeal自制docset" class="headerlink" title="Zeal自制docset"></a>Zeal自制docset</h2><h3 id="Zeal使用"><a href="#Zeal使用" class="headerlink" title="Zeal使用"></a>Zeal使用</h3><blockquote><p> Zeal是一款离线文档浏览器（类似于MAC下的dash），可以配合各种编辑器，IDE使用。官方提供的数百个不同应用的离线文档(docset格式)，当某个文档官方没有提供时，我们可以自己制作一个。本文以Scrapy 1.5的文档为例。</p></blockquote><p>在IDEA、Pycharm中使用，安装Dash插件，选中要查找的字符串，<code>ctrl shift b</code>在Zeal中查看API。</p><h3 id="docset文档源"><a href="#docset文档源" class="headerlink" title="docset文档源"></a>docset文档源</h3><ol><li>任意的HTML文档</li><li>AppleDoc</li><li>Python, Sphinx or PyDoctor</li><li>javadoc</li><li>Rdoc</li><li>Scaladoc</li><li>goDoc</li><li>JSDoc</li><li>Doxygen</li></ol><p>基本上所有的文档都可以转换为docset。</p><a id="more"></a><h3 id="生成Docset"><a href="#生成Docset" class="headerlink" title="生成Docset"></a>生成Docset</h3><p><a href="https://kapeli.com/docsets#python" target="_blank" rel="external">官方指南-生成docset</a></p><blockquote><p> 本例使用的是python doc生成docset，使用的工具为<a href="https://doc2dash.readthedocs.io/en/stable/usage.html" target="_blank" rel="external">doc2dash</a>, scrapy文档源可以下载官方源码，解压源码中的doc文件夹。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> 在Python的虚拟环境里安装</span></div><div class="line">pip install Sphinx&gt;=1.3</div><div class="line">pip install sphinx_rtd_theme</div><div class="line">pip install doc2dash</div></pre></td></tr></table></figure><h4 id="下载doc源文档"><a href="#下载doc源文档" class="headerlink" title="下载doc源文档"></a>下载doc源文档</h4><p>在github上下载scrapy的源码，其中包含<a href="https://github.com/scrapy/scrapy/tree/1.5/docs" target="_blank" rel="external">doc文档的源码</a></p><h4 id="编译doc文档"><a href="#编译doc文档" class="headerlink" title="编译doc文档"></a>编译doc文档</h4><p>使用sphinx编译doc文档源码。sphinx是Python下广泛使用的文档编写工具，可以将srt格式的文档编译成HTMl，大多数python第三方库使用的都是该工具，并且发布在免费的文档托管网站，read the doc。</p><p> 编译<code>sphinx-build -b html docs docs_dir</code> , 如果想要自己创建、编写文档，可以参考sphix的<a href="https://zh-sphinx-doc.readthedocs.io/en/latest/tutorial.html" target="_blank" rel="external">用法</a></p><h4 id="生成docset"><a href="#生成docset" class="headerlink" title="生成docset"></a>生成docset</h4><p>将编译好的html转换成docset，doc2dash<a href="https://doc2dash.readthedocs.io/en/stable/usage.html" target="_blank" rel="external">用法</a> </p><p><code>doc2dash -u https://doc.scrapy.org/en/1.5/ -n scrapy_1.5 docs_dir</code> </p><p>将得到的 <code>scrapy_1.5.docset</code> 文件夹拷贝到Zeal的文档文件下。</p><h4 id="添加图标和meta信息"><a href="#添加图标和meta信息" class="headerlink" title="添加图标和meta信息"></a>添加图标和meta信息</h4><p>在docset文件夹里添加文件icon.png和meta.json </p><p><img src="http://img.shuaiyy.cn/blog/180124/hgk7la7E56.png?imageslim" alt="mark"> </p><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># meta.json</div><div class="line"></div><div class="line">&#123;</div><div class="line">    <span class="attr">"name"</span>: <span class="string">"Scrapy"</span>,</div><div class="line">    <span class="attr">"revision"</span>: <span class="string">"0"</span>,</div><div class="line">    <span class="attr">"title"</span>: <span class="string">"Scrapy"</span>,</div><div class="line">    <span class="attr">"version"</span>: <span class="string">"1.5.0"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>打开Zeal查看效果：</p><p><img src="http://img.shuaiyy.cn/blog/180124/fbBg250EGh.png?imageslim" alt="mark"> </p><h3 id="发布docset"><a href="#发布docset" class="headerlink" title="发布docset"></a>发布docset</h3><p><a href="https://kapeli.com/docsets#improveDocset" target="_blank" rel="external">参考</a></p><ul><li><p>可以将其贡献给Dash，方便其他的dash用户下载使用。</p></li><li><p>制作feed分享</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># scrapy.xml</div><div class="line"><span class="tag">&lt;<span class="name">entry</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://github.com/shuaiyy/Scrapy_1.5.docset/files/1658982/Scrapy_1.5.docset.tar.gz<span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></div></pre></td></tr></table></figure><p>feed 的url  <a href="https://raw.githubusercontent.com/shuaiyy/Scrapy_1.5.docset/master/scrapy.xml" target="_blank" rel="external">https://raw.githubusercontent.com/shuaiyy/Scrapy_1.5.docset/master/scrapy.xml</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Zeal自制docset&quot;&gt;&lt;a href=&quot;#Zeal自制docset&quot; class=&quot;headerlink&quot; title=&quot;Zeal自制docset&quot;&gt;&lt;/a&gt;Zeal自制docset&lt;/h2&gt;&lt;h3 id=&quot;Zeal使用&quot;&gt;&lt;a href=&quot;#Zeal使用&quot; class=&quot;headerlink&quot; title=&quot;Zeal使用&quot;&gt;&lt;/a&gt;Zeal使用&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt; Zeal是一款离线文档浏览器（类似于MAC下的dash），可以配合各种编辑器，IDE使用。官方提供的数百个不同应用的离线文档(docset格式)，当某个文档官方没有提供时，我们可以自己制作一个。本文以Scrapy 1.5的文档为例。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在IDEA、Pycharm中使用，安装Dash插件，选中要查找的字符串，&lt;code&gt;ctrl shift b&lt;/code&gt;在Zeal中查看API。&lt;/p&gt;
&lt;h3 id=&quot;docset文档源&quot;&gt;&lt;a href=&quot;#docset文档源&quot; class=&quot;headerlink&quot; title=&quot;docset文档源&quot;&gt;&lt;/a&gt;docset文档源&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;任意的HTML文档&lt;/li&gt;
&lt;li&gt;AppleDoc&lt;/li&gt;
&lt;li&gt;Python, Sphinx or PyDoctor&lt;/li&gt;
&lt;li&gt;javadoc&lt;/li&gt;
&lt;li&gt;Rdoc&lt;/li&gt;
&lt;li&gt;Scaladoc&lt;/li&gt;
&lt;li&gt;goDoc&lt;/li&gt;
&lt;li&gt;JSDoc&lt;/li&gt;
&lt;li&gt;Doxygen&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;基本上所有的文档都可以转换为docset。&lt;/p&gt;
    
    </summary>
    
      <category term="学习" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="写作" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E5%86%99%E4%BD%9C/"/>
    
      <category term="Doc" scheme="http://shuaiyy.cn/categories/%E5%AD%A6%E4%B9%A0/%E5%86%99%E4%BD%9C/Doc/"/>
    
    
      <category term="Zeal" scheme="http://shuaiyy.cn/tags/Zeal/"/>
    
      <category term="Docset" scheme="http://shuaiyy.cn/tags/Docset/"/>
    
  </entry>
  
</feed>
